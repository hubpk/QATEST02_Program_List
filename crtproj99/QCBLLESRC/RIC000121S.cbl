       PROCESS APOST GRAPHIC.
      ***************************************************************
       IDENTIFICATION DIVISION.
     H/TITLE Create Export Vehicle     Execute external functio
     Z* CRTBNDCBL
     Z* CVTOPT(*DATETIME) DBGVIEW(*SOURCE) OPTIMIZE(*BASIC)
     Z* BNDDIR(YBNDDIR) ACTGRP(*CALLER)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Execute external function  Version:  8.7
     H* Object type   : *PGM
      *
     H* Company    : Renault (UK) Applications
     H* System     : Renault (UK) Applications
     H* User name  : PRAGTSK
     H* Date       : 20/09/19 time: 14:20:40
     H* Copyright  : Renault (UK) Applications
      *
      *==============================================================
     M* MAINTENANCE   :
      *==============================================================
       PROGRAM-ID.  RIC000121S.
      /EJECT
      ***************************************************************
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       SOURCE-COMPUTER.  IBM-AS400.
       OBJECT-COMPUTER.  IBM-AS400.
       SPECIAL-NAMES.  OPEN-FEEDBACK IS OPEN-FEEDBACK-AREA,
           I-O-FEEDBACK IS I-O-FEEDBACK-AREA.
      /EJECT
      ***************************************************************
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
      *
           SELECT VAMDLVERL1
             ASSIGN TO DATABASE-VAMDLVERL1
             ORGANIZATION IS INDEXED
             ACCESS MODE IS DYNAMIC
             RECORD KEY IS EXTERNALLY-DESCRIBED-KEY
             FILE STATUS IS FILE-STATUS.
      *    RTV : Vehicle Model Version     Retrieval index
      *
           SELECT COORDDTAL1
             ASSIGN TO DATABASE-COORDDTAL1
             ORGANIZATION IS INDEXED
             ACCESS MODE IS DYNAMIC
             RECORD KEY IS EXTERNALLY-DESCRIBED-KEY
             FILE STATUS IS FILE-STATUS.
      *    RTV : Customer Order            Retrieval index
      *
           SELECT RAOBEXTRL2
             ASSIGN TO DATABASE-RAOBEXTRL2
             ORGANIZATION IS INDEXED
             ACCESS MODE IS DYNAMIC
             RECORD KEY IS EXTERNALLY-DESCRIBED-KEY
             FILE STATUS IS FILE-STATUS.
      *    RSQ : OBT Extract               By Dlr/Mdl/ON
      *
           SELECT DIDLRDTAL2
             ASSIGN TO DATABASE-DIDLRDTAL2
             ORGANIZATION IS INDEXED
             ACCESS MODE IS DYNAMIC
             RECORD KEY IS EXTERNALLY-DESCRIBED-KEY
             FILE STATUS IS FILE-STATUS.
      *    RTV : Dealer                    Retrieval (No Virtuals)
      *
           SELECT RIC00SALL1
             ASSIGN TO DATABASE-RIC00SALL1
             ORGANIZATION IS INDEXED
             ACCESS MODE IS DYNAMIC
             RECORD KEY IS EXTERNALLY-DESCRIBED-KEY
             FILE STATUS IS FILE-STATUS.
      *    RTV : RI Sales Channel          Retrieval index
      *
           SELECT RIC00DELL1
             ASSIGN TO DATABASE-RIC00DELL1
             ORGANIZATION IS INDEXED
             ACCESS MODE IS DYNAMIC
             RECORD KEY IS EXTERNALLY-DESCRIBED-KEY
             FILE STATUS IS FILE-STATUS.
      *    RTV : RI Dealer Status          Retrieval index
      *
           SELECT RAV55EMFL1
             ASSIGN TO DATABASE-RAV55EMFL1
             ORGANIZATION IS INDEXED
             ACCESS MODE IS DYNAMIC
             RECORD KEY IS EXTERNALLY-DESCRIBED-KEY
             FILE STATUS IS FILE-STATUS.
      *    RTV : V55 Emissions Controls    Retrieval index
      *
           SELECT RIC00MOVL0
             ASSIGN TO DATABASE-RIC00MOVL0
             ORGANIZATION IS INDEXED
             ACCESS MODE IS DYNAMIC
             RECORD KEY IS EXTERNALLY-DESCRIBED-KEY
             FILE STATUS IS FILE-STATUS.
      *    RTV : RI Model Version          Retrieval index
      *
           SELECT VAMDLDTAL1
             ASSIGN TO DATABASE-VAMDLDTAL1
             ORGANIZATION IS INDEXED
             ACCESS MODE IS DYNAMIC
             RECORD KEY IS EXTERNALLY-DESCRIBED-KEY
             FILE STATUS IS FILE-STATUS.
      *    RTV : Vehicle Model             Retrieval index
      *
           SELECT RIC00VEHL0
             ASSIGN TO DATABASE-RIC00VEHL0
             ORGANIZATION IS INDEXED
             ACCESS MODE IS DYNAMIC
             RECORD KEY IS EXTERNALLY-DESCRIBED-KEY
             FILE STATUS IS FILE-STATUS.
      *    UPD : RI Vehicle Detail         Update index
      *
           SELECT RIC00MOVL1
             ASSIGN TO DATABASE-RIC00MOVL1
             ORGANIZATION IS INDEXED
             ACCESS MODE IS DYNAMIC
             RECORD KEY IS EXTERNALLY-DESCRIBED-KEY
             FILE STATUS IS FILE-STATUS.
      *    UPD : RI Model Version          Update index
      *
       I-O-CONTROL.
      *
      /EJECT
      ***************************************************************
       DATA DIVISION.
       FILE SECTION.
      *
      *
       FD  VAMDLVERL1
           LABEL RECORDS ARE STANDARD.
       01  VAMDLVERL1-R.
           COPY DDS-ALL-FORMATS OF VAMDLVERL1.
      *
       FD  COORDDTAL1
           LABEL RECORDS ARE STANDARD.
       01  COORDDTAL1-R.
           COPY DDS-ALL-FORMATS OF COORDDTAL1.
      *
       FD  RAOBEXTRL2
           LABEL RECORDS ARE STANDARD.
       01  RAOBEXTRL2-R.
           COPY DDS-ALL-FORMATS OF RAOBEXTRL2.
      *
       FD  DIDLRDTAL2
           LABEL RECORDS ARE STANDARD.
       01  DIDLRDTAL2-R.
           COPY DDS-ALL-FORMATS OF DIDLRDTAL2.
      *
       FD  RIC00SALL1
           LABEL RECORDS ARE STANDARD.
       01  RIC00SALL1-R.
           COPY DDS-ALL-FORMATS OF RIC00SALL1.
      *
       FD  RIC00DELL1
           LABEL RECORDS ARE STANDARD.
       01  RIC00DELL1-R.
           COPY DDS-ALL-FORMATS OF RIC00DELL1.
      *
       FD  RAV55EMFL1
           LABEL RECORDS ARE STANDARD.
       01  RAV55EMFL1-R.
           COPY DDS-ALL-FORMATS OF RAV55EMFL1.
      *
       FD  RIC00MOVL0
           LABEL RECORDS ARE STANDARD.
       01  RIC00MOVL0-R.
           COPY DDS-ALL-FORMATS OF RIC00MOVL0.
      *
       FD  VAMDLDTAL1
           LABEL RECORDS ARE STANDARD.
       01  VAMDLDTAL1-R.
           COPY DDS-ALL-FORMATS OF VAMDLDTAL1.
      *
       FD  RIC00VEHL0
           LABEL RECORDS ARE STANDARD.
       01  RIC00VEHL0-R.
           COPY DDS-ALL-FORMATS OF RIC00VEHL0.
      *
       FD  RIC00MOVL1
           LABEL RECORDS ARE STANDARD.
       01  RIC00MOVL1-R.
           COPY DDS-ALL-FORMATS OF RIC00MOVL1.
      /EJECT
      ***************************************************************
       WORKING-STORAGE SECTION.
      *
      *    Job context
       01  JOB-CONTEXT.
           COPY DDS-ALL-FORMATS OF Y2PGDSPK.
      *    Job date/time
           03  IJBDTTM.
           05  ZZJDT PIC S9(7).
           05  ZZJDTE REDEFINES ZZJDT.
           07  ZZJCC PIC S9(1).
           07  ZZJYY PIC S9(2).
           07  ZZJMM PIC S9(2).
           07  ZZJDD PIC S9(2).
           05  ZZJTM PIC S9(6).
           05  ZZJTME REDEFINES ZZJTM.
           07  ZZJHH PIC S9(2).
           07  ZZJNN PIC S9(2).
           07  ZZJSS PIC S9(2).
           03  ZZFQL PIC X(21).
           03  ZZFLB PIC X(10).
           03  ZZFFL PIC X(10).
           03  ZZFMB PIC X(10).
           03  ZZCDB PIC X(18).
           03  ZZLDB PIC X(18).
           03  ZZTMS PIC X(26).
       01  ZZTIME.
           03  ZZHNS PIC S9(6).
           03  ZZHH PIC S9(2).
      *
       77  C-IND-OFF PIC 1(1) VALUE B'0'.
       77  C-IND-ON PIC 1(1) VALUE B'1'.
       77  W0STRNG PIC X(32766).
      *
       01  FILE-STATUS PIC X(2).
           88  C-IO-OK VALUE '00'.
           88  C-EOF VALUE '10' '46'.
           88  C-NO-MOD-SFLRCDS VALUE '12'.
           88  C-IO-ERR VALUE '21' '22' '24' '30' '34' '90' '91' '92' '9
      -     '4' '95' '9A' '9H' '9I' '9K' '9M' '9N' '9P'.
           88  C-NO-RECORD VALUE '23'.
           88  C-RECORD-LOCKED VALUE '9D'.
      *
       01  UNTIL-CONDITION PIC 1(1).
           88  C-UNTIL-FALSE VALUE B'0'.
           88  C-UNTIL-TRUE VALUE B'1'.
      *
       01  FOREVER PIC 1(1) VALUE B'1'.
           88  C-FOREVER VALUE B'1'.
      *
       01  WRK-IO-TRASH-AREA PIC X(1).
      *
       01  P2PARM.
      *    U:Date D8#
           03  P2UDATED8A PIC S9(8) COMP-3.
       01  P3PARM.
      *    U:Date D8# b
           03  P3UDTED8B PIC S9(8) COMP-3.
       01  P4PARM.
      *    U:Date D8# c
           03  P4Y2DX PIC S9(8) COMP-3.
       01  W0RTN PIC X(7).
       01  W0RSF PIC X(1).
       01  W0ENV PIC X(3).
       01  W0RTW PIC S9(9) COMP-4.
       01  W0ICL PIC X(1).
      *    *Synon (5,0) work field
       01  YRSW00 PIC S9(5) COMP-3.
      *    *Synon (5,0) work field
       01  YRSW01 PIC S9(5) COMP-3.
      *    *Synon (5,0) work field
       01  YRSW02 PIC S9(5) COMP-3.
      *    *Synon (5,0) work field
       01  YRSW03 PIC S9(5) COMP-3.
      *    *Synon (5,0) work field
       01  YRSW04 PIC S9(5) COMP-3.
       01  YRSW05.
           03  YRSW05X PIC X(1) OCCURS 10000.
       01  YRSW06.
           03  YRSW06X PIC X(1) OCCURS 10000.
      *    Define keylist
       01  KRSSA1.
      *    SCP Model Code
           03  COSCMDLCDE PIC X(3).
      *    Model Phase
           03  COPHASE PIC X(1).
      *    SCP Model Version Code
           03  COSCVERCDE PIC X(12).
      *    Define keylist
       01  KRSSA1-TMP.
      *    SCP Model Code
           03  COSCMDLCDE PIC X(3).
      *    Model Phase
           03  COPHASE PIC X(1).
      *    SCP Model Version Code
           03  COSCVERCDE PIC X(12).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSA1.
      *    SCP Model Code
           03  COSCMDLCDE PIC X(3).
      *    Model Phase
           03  COPHASE PIC X(1).
      *    SCP Model Version Code
           03  COSCVERCDE PIC X(12).
      *..............................................................
      *    Define keylist
       01  KRSSA2.
      *    Owning Account
           03  C5OWNACC PIC X(6).
      *    Customer Ord Number
           03  C5CUSORDNB PIC X(6).
      *    Define keylist
       01  KRSSA2-TMP.
      *    Owning Account
           03  C5OWNACC PIC X(6).
      *    Customer Ord Number
           03  C5CUSORDNB PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSA2.
      *    Owning Account
           03  C5OWNACC PIC X(6).
      *    Customer Ord Number
           03  C5CUSORDNB PIC X(6).
      *..............................................................
      *    *Synon (17,7) work field
       01  W0WD01 PIC S9(10)V9(7) COMP-3.
      *    *Synon (17,7) work field
       01  W0WD00 PIC S9(10)V9(7) COMP-3.
      *    *Synon (5,0) work field
       01  YRSW07 PIC S9(5) COMP-3.
      *    *String work field
       01  YRSW08 PIC X(1).
      *    *Synon (9999) work field
       01  YRSW09 PIC X(9999).
      *    VEH-RECORD-AVEHBR2CB
       01  WQ0001 PIC X(90).
       01  W0CLPG PIC X(10).
      *    Define keylist
       01  KRSSA3.
      *    Dealer number (Num key)
           03  Q2DLRNOKEY PIC S9(5) COMP-3.
      *    BDC Model
           03  Q2BDCM PIC X(3).
      *    BDC Customer Order Number
           03  Q2BDCCON PIC X(6).
      *    Define keylist
       01  KRSSA3-TMP.
      *    Dealer number (Num key)
           03  Q2DLRNOKEY PIC S9(5) COMP-3.
      *    BDC Model
           03  Q2BDCM PIC X(3).
      *    BDC Customer Order Number
           03  Q2BDCCON PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSA3.
      *    Dealer number (Num key)
           03  Q2DLRNOKEY PIC S9(5) COMP-3.
      *    BDC Model
           03  Q2BDCM PIC X(3).
      *    BDC Customer Order Number
           03  Q2BDCCON PIC X(6).
      *..............................................................
      *    Define keylist
       01  KRSSA4.
      *    Dealer Number
           03  ABDLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  ABDLRSFX PIC X(2).
      *    Define keylist
       01  KRSSA4-TMP.
      *    Dealer Number
           03  ABDLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  ABDLRSFX PIC X(2).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSA4.
      *    Dealer Number
           03  ABDLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  ABDLRSFX PIC X(2).
      *..............................................................
      *    U:Date
       01  WN0001 PIC S9(7) COMP-3.
      *    U:Number of Days in Month
       01  WN0002 PIC S9(2) COMP-3.
      *    U:Period CCYYMM
       01  WN0003 PIC S9(6) COMP-3.
      *    U:Date (8) CCYYMMDD
       01  WN0004 PIC S9(8) COMP-3.
       01  XDWK1 PIC S9(8) COMP-3.
       01  XDAY1 PIC S9(6) COMP-3.
       01  XDWK4 PIC S9(6) COMP-3.
       01  XDAY2 PIC S9(6) COMP-3.
       01  XDSEL PIC X(1).
       01  YDOW.
           03  YDOE PIC X(1) OCCURS 7.
       01  XDCDW PIC X(7).
       01  XDWSL PIC S9(1) COMP-3.
       01  XABEG PIC S9(6) COMP-3.
       01  XAEND PIC S9(6) COMP-3.
       01  XDURR PIC S9(8) COMP-3.
       01  XDLSW PIC S9(1) COMP-3.
       01  YY PIC S9(6) COMP-3.
      *    Define keylist
       01  KRSSA5.
      *    Sales Channel Code
           03  DASDSCHN PIC X(2).
      *    Define keylist
       01  KRSSA5-TMP.
      *    Sales Channel Code
           03  DASDSCHN PIC X(2).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSA5.
      *    Sales Channel Code
           03  DASDSCHN PIC X(2).
      *..............................................................
      *    Define keylist
       01  KRSSA6.
      *    Dealer Number Code (5)
           03  DBBDCO PIC X(5).
      *    Define keylist
       01  KRSSA6-TMP.
      *    Dealer Number Code (5)
           03  DBBDCO PIC X(5).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSA6.
      *    Dealer Number Code (5)
           03  DBBDCO PIC X(5).
      *..............................................................
      *    Define keylist
       01  KRSSA7.
      *    Emissions C.O.C. Version
           03  BWEMCOCVER PIC X(18).
      *    Emissions C.O.C. Approv.
           03  BWEMCOCAPV PIC X(26).
      *    Define keylist
       01  KRSSA7-TMP.
      *    Emissions C.O.C. Version
           03  BWEMCOCVER PIC X(18).
      *    Emissions C.O.C. Approv.
           03  BWEMCOCAPV PIC X(26).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSA7.
      *    Emissions C.O.C. Version
           03  BWEMCOCVER PIC X(18).
      *    Emissions C.O.C. Approv.
           03  BWEMCOCAPV PIC X(26).
      *..............................................................
      *    Message data for message Y2U0009.
       01  MD0009.
           03  MDPGM PIC X(10).
           03  MDACP PIC X(10).
           03  MDFMT PIC X(10).
           03  MDACT PIC X(4).
           03  MDLBL PIC X(6).
      *    Define keylist
       01  KRSSB1.
      *    SCP Model Code (ATR)
           03  C9SCPMDLC PIC X(3).
      *    SCP Model Version Code
           03  C9SCVERCDE PIC X(12).
      *    Model Phase
           03  C9PHASE PIC X(1).
      *    SCR Model Code
           03  C9SCRMDL PIC X(3).
      *    SCR Model Version Code(A)
           03  C9SCRVERC PIC X(12).
      *    Define keylist
       01  KRSSB1-TMP.
      *    SCP Model Code (ATR)
           03  C9SCPMDLC PIC X(3).
      *    SCP Model Version Code
           03  C9SCVERCDE PIC X(12).
      *    Model Phase
           03  C9PHASE PIC X(1).
      *    SCR Model Code
           03  C9SCRMDL PIC X(3).
      *    SCR Model Version Code(A)
           03  C9SCRVERC PIC X(12).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSB1.
      *    SCP Model Code (ATR)
           03  C9SCPMDLC PIC X(3).
      *    SCP Model Version Code
           03  C9SCVERCDE PIC X(12).
      *    Model Phase
           03  C9PHASE PIC X(1).
      *    SCR Model Code
           03  C9SCRMDL PIC X(3).
      *    SCR Model Version Code(A)
           03  C9SCRVERC PIC X(12).
      *..............................................................
      *    Define keylist
       01  KRSSB2.
      *    SCP Model Code
           03  COSCMDLCDE PIC X(3).
      *    Model Phase
           03  COPHASE PIC X(1).
      *    SCP Model Version Code
           03  COSCVERCDE PIC X(12).
      *    Define keylist
       01  KRSSB2-TMP.
      *    SCP Model Code
           03  COSCMDLCDE PIC X(3).
      *    Model Phase
           03  COPHASE PIC X(1).
      *    SCP Model Version Code
           03  COSCVERCDE PIC X(12).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSB2.
      *    SCP Model Code
           03  COSCMDLCDE PIC X(3).
      *    Model Phase
           03  COPHASE PIC X(1).
      *    SCP Model Version Code
           03  COSCVERCDE PIC X(12).
      *..............................................................
      *    Define keylist
       01  KRSSB3.
      *    SCP Model Code
           03  CNSCMDLCDE PIC X(3).
      *    Model Phase
           03  CNPHASE PIC X(1).
      *    Define keylist
       01  KRSSB3-TMP.
      *    SCP Model Code
           03  CNSCMDLCDE PIC X(3).
      *    Model Phase
           03  CNPHASE PIC X(1).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSB3.
      *    SCP Model Code
           03  CNSCMDLCDE PIC X(3).
      *    Model Phase
           03  CNPHASE PIC X(1).
      *..............................................................
       01  ZADFMF PIC X(10).
       01  DATA-AREA-NAME PIC X(10).
       01  ZAPGMQ PIC X(10).
       01  ZAPGRL PIC X(5).
       01  ZAMSID PIC X(7).
       01  ZAMSGF PIC X(10).
       01  ZAMSDA PIC X(132).
       01  ZAMSTP PIC X(7).
       01  ZAILE PIC X(1).
       01  ZAFSMS PIC X(1).
       01  VAMDLVERL1-OPEN.
           COPY DDS-ALL-FORMATS OF Y2IOPEN.
      *    Open feedback area
      *
       01  COORDDTAL1-OPEN.
           COPY DDS-ALL-FORMATS OF Y2IOPEN.
      *    Open feedback area
      *
       01  RAOBEXTRL2-OPEN.
           COPY DDS-ALL-FORMATS OF Y2IOPEN.
      *    Open feedback area
      *
       01  DIDLRDTAL2-OPEN.
           COPY DDS-ALL-FORMATS OF Y2IOPEN.
      *    Open feedback area
      *
       01  RIC00SALL1-OPEN.
           COPY DDS-ALL-FORMATS OF Y2IOPEN.
      *    Open feedback area
      *
       01  RIC00DELL1-OPEN.
           COPY DDS-ALL-FORMATS OF Y2IOPEN.
      *    Open feedback area
      *
       01  RAV55EMFL1-OPEN.
           COPY DDS-ALL-FORMATS OF Y2IOPEN.
      *    Open feedback area
      *
       01  RIC00MOVL0-OPEN.
           COPY DDS-ALL-FORMATS OF Y2IOPEN.
      *    Open feedback area
      *
       01  VAMDLDTAL1-OPEN.
           COPY DDS-ALL-FORMATS OF Y2IOPEN.
      *    Open feedback area
      *
       01  RIC00VEHL0-OPEN.
           COPY DDS-ALL-FORMATS OF Y2IOPEN.
      *    Open feedback area
      *
       01  RIC00MOVL1-OPEN.
           COPY DDS-ALL-FORMATS OF Y2IOPEN.
      *    Open feedback area
      *
       01  W0OPN PIC X(1).
       01  W0PMT PIC X(1).
      *    Build Week
       01  WORK-CONTEXT.
           03  YL0001 PIC X(2).
      *    Build Year (A)
           03  YL0002 PIC X(4).
      *    Customer Order Date(char)
           03  YL0003 PIC X(8).
      *    U:Job Date DTX
           03  YL0004 PIC S9(8) COMP-3.
      *    Extract date  (8)
           03  YL0005 PIC X(8).
      *    De-Reg Date
           03  YL0006 PIC S9(8).
      *    U:Date CDE(8)
           03  YL0007 PIC X(8).
      *    Deliverable Period YYYYMM
           03  YL0008 PIC X(6).
      *    Order Period YYYYMM
           03  YL0009 PIC X(6).
      *    Order Month
           03  YL0010 PIC X(2).
      *    Cancelled Period YYYYMM
           03  YL0011 PIC X(6).
      *    Extraction Type
           03  YL0012 PIC X(3).
      *    Reg Count
           03  YL0013 PIC X(1).
      *    Order Count
           03  YL0014 PIC X(1).
      *    Cancellation count
           03  YL0015 PIC X(1).
      *    Car/Van text
           03  YL0016 PIC X(3).
      *    Version Marketing Desc
           03  YN0001 PIC X(50).
      *    V55 Model Version Desc
           03  YN0002 PIC X(20).
      *    Manufacturer Code
           03  YN0003 PIC X(3).
      *    SMMT MVRIS Make Code
           03  YN0004 PIC X(2).
      *    SMMT MVRIS Model Code
           03  YN0005 PIC X(3).
      *    SMMT DVLA Make Code
           03  YN0006 PIC X(2).
      *    SMMT DVLA Model Code
           03  YN0007 PIC X(3).
      *    Vehicle Body Class Code
           03  YL0017 PIC X(2).
      *    Vehicle Body Code
           03  YN0008 PIC X(2).
      *    Vehicle Body Name
           03  YN0009 PIC X(20).
      *    DVLA Type Approval Categ
           03  YN0010 PIC X(2).
      *    Vehicle Fuel Code
           03  YN0011 PIC X(1).
      *    Model Engine Capacity
           03  YN0012 PIC S9(5) COMP-3.
      *    Gross Weight
           03  YN0013 PIC S9(4)V9(1).
      *    Net Weight
           03  YN0014 PIC S9(4)V9(1).
      *    Typemines
           03  YN0015 PIC X(6).
      *    High Performance (Y/N)
           03  YN0016 PIC X(1).
      *    Special Edition  (Y/N)
           03  YN0017 PIC X(1).
      *    Gearbox Type
           03  YN0018 PIC X(1).
      *    Number of doors
           03  YN0019 PIC S9(1).
      *    Seating Capacity V55
           03  YN0020 PIC S9(5).
      *    Tax Class Code
           03  YN0021 PIC S9(2) COMP-3.
      *    Vehicle Database Rec Sts
           03  YN0022 PIC X(1).
      *    On Block
           03  YL0018 PIC X(1).
      *    Chassis Situation
           03  YL0019 PIC X(12).
      *    Customer Order Date #
           03  YN0023 PIC S9(8) COMP-3.
      *    Secondary Network Account
           03  YL0020 PIC X(6).
      *    Owning Account Maille
           03  YN0024 PIC X(5).
      *    Owning Account Category
           03  YN0025 PIC X(2).
      *    Order Type code
           03  YN0026 PIC X(1).
      *    Order Type(Local)
           03  YN0027 PIC X(2).
      *    Order Type(Central)
           03  YN0028 PIC X(2).
      *    SD Sales Channel Code
           03  YL0021 PIC X(2).
      *    SEDRE Customer Type
           03  YL0022 PIC X(1).
      *    CO cust type P/S-derived
           03  YN0029 PIC X(1).
      *    Cust OLD DVLA Flag
           03  YN0030 PIC X(1).
      *    SD Order Status Code
           03  YN0031 PIC X(4).
      *    SEDRE last message update
           03  YN0032 PIC X(3).
      *    Last Msg Sending Code
           03  YN0033 PIC X(8).
      *    APL Code
           03  YN0034 PIC X(6).
      *    SCP Model Code
           03  YN0035 PIC X(3).
      *    Model Phase
           03  YN0036 PIC X(1).
      *    SCP Model Version Code
           03  YN0037 PIC X(12).
      *    Colour Code
           03  YN0038 PIC X(3).
      *    Colour Short Description
           03  YN0039 PIC X(6).
      *    SCP Options
           03  YN0040 PIC X(120).
      *    SCP Trim Type
           03  YN0041 PIC X(6).
      *    SCP Trim Colour
           03  YN0042 PIC X(6).
      *    Cust Desired Delivery Dte
           03  YL0023 PIC S9(8) COMP-3.
      *    Type VP/VU
           03  YN0043 PIC X(1).
      *    Order Changed Date
           03  YN0044 PIC S9(8) COMP-3.
      *    Order Cancelled Date
           03  YN0045 PIC S9(8) COMP-3.
      *    Order Cancellation Reason
           03  YL0024 PIC X(4).
      *    Salesperson Code
           03  YL0025 PIC X(13).
      *    Fleet Operator Number
           03  YN0046 PIC X(5).
      *    SEDRE Customer Code
           03  YN0047 PIC X(6).
      *    Surname/Company name
           03  YL0026 PIC X(108).
      *    Customer Forename
           03  YN0048 PIC X(25).
      *    Initials
           03  YN0049 PIC X(3).
      *    Title Code
           03  YN0050 PIC X(4).
      *    Address L1
           03  YN0051 PIC X(50).
      *    Address L2
           03  YN0052 PIC X(40).
      *    Address L3
           03  YN0053 PIC X(40).
      *    Address Town (40)
           03  YN0054 PIC X(40).
      *    Postcode
           03  YN0055 PIC X(8).
      *    Gender
           03  YN0056 PIC X(1).
      *    Customer Date of Birth
           03  YN0057 PIC S9(8) COMP-3.
      *    Cust. daytime phone code
           03  YN0058 PIC X(6).
      *    Cust. daytime phone nbr
           03  YN0059 PIC X(10).
      *    Cust. evening phone code
           03  YN0060 PIC X(6).
      *    Cust. evening phone nbr
           03  YN0061 PIC X(10).
      *    Cust. mobile phone code
           03  YN0062 PIC X(6).
      *    Cust. mobile phone nbr
           03  YN0063 PIC X(10).
      *    Cust. fax phone code
           03  YN0064 PIC X(6).
      *    Cust. fax phone nbr
           03  YN0065 PIC X(10).
      *    Cust. Email Address
           03  YN0066 PIC X(100).
      *    Annual Mileage
           03  YN0067 PIC S9(7).
      *    OK to mail?
           03  YN0068 PIC X(1).
      *    OK to phone?
           03  YN0069 PIC X(1).
      *    OK to email?
           03  YN0070 PIC X(1).
      *    OK to text?
           03  YN0071 PIC X(1).
      *    OK to fax?
           03  YN0072 PIC X(1).
      *    Share mail data?
           03  YN0073 PIC X(1).
      *    Share email data?
           03  YN0074 PIC X(1).
      *    Profession
           03  YN0075 PIC X(4).
      *    Job Function
           03  YN0076 PIC X(4).
      *    Customer Business Type
           03  YN0077 PIC X(10).
      *    Customer VAT Number
           03  YN0078 PIC X(20).
      *    VED Exempt Certificate
           03  YN0079 PIC X(7).
      *    VED Exempt Expiry Date
           03  YN0080 PIC S9(8) COMP-3.
      *    Social Security Number
           03  YN0081 PIC X(9).
      *    DVLA Fleet Number
           03  YN0082 PIC X(6).
      *    Part Ex-change Flag
           03  YN0083 PIC X(1).
      *    Current Vehicle Model
           03  YN0084 PIC X(4).
      *    Current Vehicle Reg Nbr
           03  YN0085 PIC X(8).
      *    Part-Ex Veh Mileage
           03  YN0086 PIC S9(7).
      *    Finance Period (Months)
           03  YN0087 PIC S9(3) COMP-3.
      *    No. Renaults Owned
           03  YN0088 PIC S9(3).
      *    No. Vehs in Household
           03  YN0089 PIC S9(3).
      *    Planned Retention Period
           03  YN0090 PIC S9(2).
      *    Insurance Renewal Date #
           03  YN0091 PIC S9(8) COMP-3.
      *    Payment/Finance Type
           03  YN0092 PIC X(3).
      *    V55 Requested?
           03  YN0093 PIC X(1).
      *    Offer Code 1
           03  YN0094 PIC X(4).
      *    Offer Code 2
           03  YN0095 PIC X(4).
      *    Prospect Lead Id
           03  YN0096 PIC X(10).
      *    Customer Order Comments
           03  YN0097 PIC X(50).
      *    Customer Ref/P.O. Number
           03  YN0098 PIC X(20).
      *    Special Deal Id
           03  YN0099 PIC X(1).
      *    Fleet PCN
           03  YN0100 PIC X(5).
      *    Date of first allocation
           03  YN0101 PIC S9(8) COMP-3.
      *    Date of last deallocation
           03  YN0102 PIC S9(8) COMP-3.
      *    CO Buy/Lease Flag
           03  YN0103 PIC X(1).
      *    CO Spare Status 2
           03  YN0104 PIC X(1).
      *    CO Spare Status 3
           03  YN0105 PIC X(1).
      *    CO MR contract date
           03  YN0106 PIC S9(8) COMP-3.
      *    CO Spare Date 2
           03  YN0107 PIC S9(8) COMP-3.
      *    CO MR Contract number
           03  YN0108 PIC X(6).
      *    CO Spare Code 2
           03  YN0109 PIC X(6).
      *    CO Spare Code 3
           03  YN0110 PIC X(6).
      *    Agreement (DEFIPRO) Num
           03  YN0111 PIC X(20).
      *    CO Spare Text 2
           03  YN0112 PIC X(20).
      *    CO Spare Status 4
           03  YN0113 PIC X(1).
      *    FM Fleet Account Code
           03  YN0114 PIC X(10).
      *    FM Agreement Number (FON)
           03  YL0027 PIC X(10).
      *    FM Agreement Version Nbr
           03  YL0028 PIC X(2).
      *    Cust Ord Exists
           03  YN0115 PIC X(1).
      *    Order Cancellation desti
           03  YL0029 PIC X(30).
      *    Customer Delivery Date(a)
           03  YL0030 PIC X(8).
      *    CDD Period YYYYMM
           03  YL0031 PIC X(6).
      *    U:Date YYYYMM (CDE)
           03  YL0032 PIC X(6).
      *    U:Job Date DTX
           03  YL0033 PIC S9(8) COMP-3.
      *    U:Date CDE(8)
           03  YL0034 PIC X(8).
      *    U:Month Current
           03  YL0035 PIC X(2).
      *    U:Date YYYYMM a
           03  YL0036 PIC X(6).
      *    U:Month YYYYMM
           03  YL0037 PIC S9(6) COMP-3.
      *    U:Number (3.0)
           03  YL0038 PIC S9(3) COMP-3.
      *    Date change (YYYYMM)
           03  YL0039 PIC X(6).
      *    U:Month Ref
           03  YL0040 PIC X(2).
      *    U:Month 2
           03  YL0041 PIC S9(2) COMP-3.
      *    U:Date YYYYMM b
           03  YL0042 PIC X(6).
      *    U:Date YYYYMM c
           03  YL0043 PIC X(6).
      *    CDD M Ind
           03  YL0044 PIC X(5).
      *    Arrival Date
           03  YL0045 PIC S9(8).
      *    U:Date
           03  YL0046 PIC S9(7) COMP-3.
      *    U:Number (2.0)
           03  WUNBR2 PIC S9(2) COMP-3.
      *    U:Number (6.0)
           03  WUNUM6 PIC S9(6) COMP-3.
      *    U:Date
           03  WUDATE PIC S9(7) COMP-3.
      *    U:Date From
           03  YL0047 PIC S9(7) COMP-3.
      *    U:Days 2
           03  WUUDAYS2 PIC S9(7) COMP-3.
      *    U:Days 3
           03  WUUDAYS3 PIC S9(7) COMP-3.
      *    U:Date YYYYMMDD
           03  YL0048 PIC S9(8) COMP-3.
      *    Arrival Period YYYYMM
           03  YL0049 PIC X(6).
      *    Fleet Channel
           03  YL0050 PIC X(15).
      *    VEH-RETCODE
           03  YL0051 PIC X(2).
      *    VEH-RECORD-AVEHBR2CB
           03  YL0052 PIC X(90).
      *    U:Text (7) b
           03  YL0053 PIC X(7).
      *    SEDRE hdr APL code
           03  YL0054 PIC X(6).
      *    Brand Name Display
           03  YL0055 PIC X(12).
      *    Dealer number (Num key)
           03  YL0056 PIC S9(5) COMP-3.
      *    U:Code (5)
           03  WUUCODE5 PIC X(5).
      *    BDC Order Date YYYYMM
           03  YN0116 PIC X(6).
      *    Zone Code
           03  YN0117 PIC X(2).
      *    Network/Non Network Ind
           03  YL0057 PIC X(1).
      *    BDC Order Cnl Dte YYYYMM
           03  YN0118 PIC X(6).
      *    BDC Model Version
           03  YN0119 PIC X(12).
      *    Chassis number
           03  YN0120 PIC X(14).
      *    BDC Order Crt Date
           03  YN0121 PIC S9(8) COMP-3.
      *    BDC Order Cnl Date
           03  YN0122 PIC S9(8) COMP-3.
      *    TYPE CLIENT SEDRE
           03  YN0123 PIC X(1).
      *    TYPE DR CENTRAL
           03  YN0124 PIC X(2).
      *    SD Sales Channel Code
           03  YN0125 PIC X(2).
      *    Fleet Report Group Code
           03  YL0058 PIC X(2).
      *    Fleet Report Group Plan
           03  YL0059 PIC X(1).
      *    Sell Price
           03  YN0126 PIC S9(5)V9(2) COMP-3.
      *    BDC Payment Method
           03  YL0060 PIC X(3).
      *    BDC Payment Term
           03  YL0061 PIC X(4).
      *    Report Group Description
           03  YN0127 PIC X(35).
      *    OBT Count Target Status
           03  YL0062 PIC X(1).
      *    Registration Date 58
           03  YN0128 PIC S9(8) COMP-3.
      *    De-registration Date #
           03  YN0129 PIC S9(8) COMP-3.
      *    SD Order Type Assoc w FON
           03  YN0130 PIC X(2).
      *    Fleet Programmes Code
           03  YL0063 PIC X(3).
      *    Fleet Programmes Desc
           03  YL0064 PIC X(25).
      *    FM Agreement Number (FON)
           03  YN0131 PIC X(10).
      *    FM Agreement Version Nbr
           03  YN0132 PIC X(2).
      *    Target Market
           03  YL0065 PIC X(1).
      *    Dealer Number
           03  YL0066 PIC X(4).
      *    Delivery Account
           03  YL0067 PIC X(6).
      *    Dealer Number Suffix
           03  YL0068 PIC X(2).
      *    Dealer Network Type
           03  YL0069 PIC X(1).
      *    Name Number
           03  YN0133 PIC X(9).
      *    Address Number
           03  YN0134 PIC X(7).
      *    Dealer Region Code
           03  YN0135 PIC X(2).
      *    Dealer Zone Code
           03  YN0136 PIC X(2).
      *    Dealer Trading Name
           03  YN0137 PIC X(40).
      *    Dealer Known by Name
           03  YN0138 PIC X(40).
      *    Dealer short name
           03  YN0139 PIC X(20).
      *    Dealer Activity Start Dte
           03  YN0140 PIC S9(8) COMP-3.
      *    Dealer Servicing End Date
           03  YN0141 PIC S9(8) COMP-3.
      *    Dealer Cancel Final Date
           03  YN0142 PIC S9(8) COMP-3.
      *    Dealer Set-Up Date
           03  YN0143 PIC S9(8).
      *    Dealer Change Date
           03  YN0144 PIC S9(8).
      *    Dealer Cancel Date
           03  YN0145 PIC S9(8).
      *    Dealer Financial Status
           03  YN0146 PIC X(1).
      *    Dealer Record Status
           03  YN0147 PIC X(1).
      *    BIR Address Identifier
           03  YN0148 PIC X(7).
      *    Dealer Address Line#1
           03  YN0149 PIC X(35).
      *    Dealer Address Line#2
           03  YN0150 PIC X(35).
      *    Dealer Address Line#3
           03  YN0151 PIC X(35).
      *    Dealer Address Line#4 ?
           03  YN0152 PIC X(35).
      *    Dealer Postal Code
           03  YN0153 PIC X(9).
      *    Dealer Town
           03  YN0154 PIC X(35).
      *    Dealer Telephone Number
           03  YN0155 PIC X(14).
      *    Dealer Fax Number
           03  YN0156 PIC X(14).
      *    Dealer Country Identifier
           03  YN0157 PIC X(3).
      *    Network/Non Network Ind
           03  YN0158 PIC X(1).
      *    Dealer Number (Numeric)
           03  YN0159 PIC S9(5).
      *    Lead Dealer Number
           03  YN0160 PIC X(4).
      *    Lead Dealer Number Suffix
           03  YN0161 PIC X(2).
      *    Lead Dealer Nbr (Numeric)
           03  YN0162 PIC S9(5).
      *    Lead Country Identifier
           03  YN0163 PIC X(3).
      *    Dealer AFRL/V55 flag
           03  YN0164 PIC X(1).
      *    Dealer Spare Flag 2
           03  YN0165 PIC X(1).
      *    Dealer Spare Flag 3
           03  YN0166 PIC X(1).
      *    Dealer Spare Code 1
           03  YN0167 PIC X(2).
      *    Dealer Spare Code 2
           03  YN0168 PIC X(2).
      *    Dealer Percentage 1
           03  YN0169 PIC S9(4)V9(3) COMP-3.
      *    Dealer Percentage 2
           03  YN0170 PIC S9(4)V9(3) COMP-3.
      *    Dealer Percentage 3
           03  YN0171 PIC S9(4)V9(3) COMP-3.
      *    Dealer Percentage 4
           03  YN0172 PIC S9(4)V9(3) COMP-3.
      *    Conversion Count
           03  YL0070 PIC X(1).
      *    U:Start date DTX
           03  YN0173 PIC S9(8) COMP-3.
      *    U:date last of M
           03  YL0071 PIC S9(8) COMP-3.
           03  WUDLN PIC X(10).
      *    U:date last of M+1
           03  YL0072 PIC S9(8) COMP-3.
      *    U:date last of M+2
           03  YL0073 PIC S9(8) COMP-3.
      *    U:date last of M+3
           03  YL0074 PIC S9(8) COMP-3.
      *    Pull Forward M+1
           03  YL0075 PIC X(1).
      *    Pull Forward M+2
           03  YL0076 PIC X(1).
      *    Pull Forward M+3
           03  YL0077 PIC X(1).
      *    Pull Forward M+4
           03  YL0078 PIC X(1).
      *    Available Count
           03  YL0079 PIC X(1).
      *    Sales Channel Desc
           03  YL0080 PIC X(50).
      *    SMMT / Market Channel
           03  YN0174 PIC X(15).
      *    MVRIS Channel
           03  YL0081 PIC X(15).
      *    PM Channel
           03  YL0082 PIC X(20).
      *    Target Channel
           03  YL0083 PIC X(20).
      *    Dealer Number Code (5)
           03  YL0084 PIC X(5).
      *    AMF Code
           03  YL0085 PIC X(4).
      *    Dealer Status
           03  YL0086 PIC X(25).
      *    Effective Date (/)
           03  YL0087 PIC X(10).
      *    Effective Date
           03  YN0175 PIC S9(8).
      *    Variant
           03  YN0176 PIC X(4).
      *    Category
           03  YN0177 PIC X(2).
      *    Length
           03  YN0178 PIC S9(4).
      *    Width
           03  YN0179 PIC S9(4).
      *    Mass (kg)
           03  YN0180 PIC S9(4).
      *    COC EURO code
           03  YN0181 PIC X(4).
      *    Exhaust Emissions
           03  YN0182 PIC X(30).
      *    CO g/km
           03  YN0183 PIC S9(4).
      *    HC / THC
           03  YN0184 PIC S9(4).
      *    NOx
           03  YN0185 PIC S9(4).
      *    HC+NOx
           03  YN0186 PIC S9(4).
      *    Non-Methane Hydrocarbons
           03  YN0187 PIC S9(4).
      *    Particulates (pm)
           03  YN0188 PIC S9(4).
      *    CO2 g/km
           03  YL0088 PIC S9(3).
      *    Max Permissible Mass
           03  YN0189 PIC S9(5).
      *    Max Net Power
           03  YN0190 PIC S9(3).
      *    Max Towable Mass-braked
           03  YN0191 PIC S9(5).
      *    Max Towable Mass-Unbraked
           03  YN0192 PIC S9(5).
      *    Sound Level - stationary
           03  YN0193 PIC S9(3)V9(1).
      *    Sound Level - engine spd
           03  YN0194 PIC S9(5).
      *    Sound level - Drive-By
           03  YN0195 PIC S9(2)V9(1).
      *    Fuel Consumption LT Urban
           03  YN0196 PIC S9(3)V9(2) COMP-3.
      *    Fuel Consumption LT ExUb
           03  YN0197 PIC S9(3)V9(2) COMP-3.
      *    Fuel Consumption LT Comb
           03  YN0198 PIC S9(3)V9(2) COMP-3.
      *    AFRL Manufacturer Code
           03  YN0199 PIC X(2).
      *    Type Approval category
           03  YN0200 PIC X(4).
      *    Manufacturer Vehicle Type
           03  YN0201 PIC X(15).
      *    Wheelbase
           03  YN0202 PIC X(5).
      *    Track width #1 minimum
           03  YN0203 PIC X(4).
      *    Track width #1 maximum
           03  YN0204 PIC X(4).
      *    Track width #2 minimum
           03  YN0205 PIC X(4).
      *    Track width #2 maximum
           03  YN0206 PIC X(4).
      *    Track width #3 minimum
           03  YN0207 PIC X(4).
      *    Track width #3 maximum
           03  YN0208 PIC X(4).
      *    Elect. energy consumption
           03  YN0209 PIC S9(5) COMP-3.
      *    Electric range
           03  YN0210 PIC S9(5) COMP-3.
      *    Power/Weight ratio
           03  YN0211 PIC S9(3)V9(2) COMP-3.
      *    U:Effective date
           03  YL0089 PIC S9(8) COMP-3.
      *    U:Number (2.0)
           03  YL0090 PIC S9(2) COMP-3.
      *    Core Fleet Dealer Ind
           03  YL0091 PIC X(1).
      *    Planned Arrival UK DATE
           03  WUARDATE PIC X(8).
      *    Planned Arrival in UK 2
           03  WUPLADATE2 PIC S9(8).
      *    Order Business Day
           03  WUORBUSDAY PIC S9(4).
      *    FON
           03  WUFON PIC X(5).
      *    Version Marketing Desc
           03  YN0212 PIC X(50).
      *    V55 Model Version Desc
           03  YN0213 PIC X(20).
      *    Manufacturer Code
           03  YN0214 PIC X(3).
      *    SMMT MVRIS Make Code
           03  YN0215 PIC X(2).
      *    SMMT MVRIS Model Code
           03  YN0216 PIC X(3).
      *    SMMT DVLA Make Code
           03  YN0217 PIC X(2).
      *    SMMT DVLA Model Code
           03  YN0218 PIC X(3).
      *    Vehicle Body Class Code
           03  YL0092 PIC X(2).
      *    Vehicle Body Code
           03  YL0093 PIC X(2).
      *    Vehicle Body Name
           03  YL0094 PIC X(20).
      *    DVLA Type Approval Categ
           03  YN0219 PIC X(2).
      *    Vehicle Fuel Code
           03  YL0095 PIC X(1).
      *    Model Engine Capacity
           03  YN0220 PIC S9(5) COMP-3.
      *    Gross Weight
           03  YN0221 PIC S9(4)V9(1).
      *    Net Weight
           03  YN0222 PIC S9(4)V9(1).
      *    Typemines
           03  YN0223 PIC X(6).
      *    High Performance (Y/N)
           03  YN0224 PIC X(1).
      *    Special Edition  (Y/N)
           03  YN0225 PIC X(1).
      *    Gearbox Type
           03  YN0226 PIC X(1).
      *    Number of doors
           03  YN0227 PIC S9(1).
      *    Seating Capacity V55
           03  YN0228 PIC S9(5).
      *    Tax Class Code
           03  YN0229 PIC S9(2) COMP-3.
      *    Vehicle Database Rec Sts
           03  YN0230 PIC X(1).
      *    Model Marketing Desc
           03  YL0096 PIC X(40).
      *    SC Model Year (Millesme)
           03  YN0231 PIC X(2).
      *    Vehicle Fuel Desc
           03  YL0097 PIC X(25).
      *    SCP Model Version Code
           03  YL0098 PIC X(12).
      *    U:Number (2.0)
           03  YL0099 PIC S9(2) COMP-3.
      *    STEPWAY Ind
           03  YL0100 PIC X(2).
       01  IXDIN.
      /EJECT
      *    Internal date
           03  XDINDTS.
           05  XDINYY PIC S9(3).
           05  XDINMM PIC S9(2).
           05  XDINDD PIC S9(2).
           03  XDINDT REDEFINES XDINDTS PIC S9(7).
           03  XDINDTZ REDEFINES XDINDTS.
           05  XDINDI PIC X(1).
           05  XDIND6 PIC X(6).
       01  IXD2T.
      /EJECT
      *    Internal date
           03  XDINT2S.
           05  XDINY2 PIC S9(3).
           05  XDINM2 PIC S9(2).
           05  XDIND2 PIC S9(2).
           03  XDINT2 REDEFINES XDINT2S PIC S9(7).
      *
      *    Indicators
       01  INDICS.
           03  IND PIC 1(1) OCCURS 99 INDICATOR 1.
           88  C-INDICATOR-ON VALUE B'1'.
           88  C-INDICATOR-OFF VALUE B'0'.
      *
      /EJECT
      *    Parameter declarations
      /EJECT
      ***************************************************************
       LINKAGE SECTION.
      *    Return code
       01  P0RTN PIC X(7).
       01  P1PARM.
      *    Invariant BCV
           03  P1INVBCV PIC X(15).
      *    VIN
           03  P1VIN PIC X(17).
      *    Order Type code
           03  P1ORDTYPCD PIC X(1).
      *    Owning Account
           03  P1OWNACC PIC X(6).
      *    Delivery Account
           03  P1DLVACC PIC X(6).
      *    SCP Model Code
           03  P1SCMDLCDE PIC X(3).
      *    SCP Model Version Code
           03  P1SCVERCDE PIC X(12).
      *    SCR Model Code
           03  P1SCRMDL PIC X(3).
      *    SCR Version Code
           03  P1EUTT PIC X(12).
      *    Phase
           03  P1O2ST PIC X(1).
      *    Type VP/VU (2)
           03  P1RSCE PIC X(2).
      *    Registration number
           03  P1GNOX PIC X(7).
      *    Dealer Order Cancel Date
           03  P1DLORDCND PIC S9(8) COMP-3.
      *    C.O.C.
           03  P1NUMRECPT PIC X(26).
      *    Version TVV
           03  P1TVV PIC X(18).
      *    Build Year usr
           03  P1BLDYEAR PIC S9(4) COMP-3.
      *    Build Week usr
           03  P1BLDWEEK PIC S9(2) COMP-3.
      *    Build Day
           03  P1BLDDAY PIC X(1).
      *    TCM Date 07
           03  P1TCMDT07 PIC S9(8) COMP-3.
      *    PEC/MADC Date 10
           03  P1PECDT10 PIC S9(8) COMP-3.
      *    Vehicle Shipment Date 20
           03  P1SHPDT20 PIC S9(8) COMP-3.
      *    Arrival at Dock Date 28
           03  P1DOCDT28 PIC S9(8) COMP-3.
      *    Enter Import Ctr Date 32
           03  P1ENTIMP32 PIC S9(8) COMP-3.
      *    Block Start Date 33
           03  P1BLSTDT33 PIC S9(8) COMP-3.
      *    Record Block End Date 34
           03  P1BLENDT34 PIC S9(8) COMP-3.
      *    Dealer Invoiced Date 42
           03  P1DLRINV42 PIC S9(8) COMP-3.
      *    Exit Import Centre Dte 45
           03  P1EXICDT45 PIC S9(8) COMP-3.
      *    Requested AAD Date 53
           03  P1RAADDT53 PIC S9(8) COMP-3.
      *    Registration Date 58
           03  P1REGDT58 PIC S9(8) COMP-3.
      *    Veh Reg Cancelled Date
           03  P1VREGCNL PIC S9(8) COMP-3.
      *    Customer Ord Number
           03  P1CUSORDNB PIC X(6).
      *    Customer Order Date #
           03  P1CUSORDD8 PIC S9(8) COMP-3.
      *    Veh ARC Planned Date
           03  P1ARCPLN PIC S9(8) COMP-3.
      *    Veh DDD Requested Date
           03  P1DDDREQ PIC S9(8) COMP-3.
      *    Veh DDD Forecast Date
           03  P1DDDFCST PIC S9(8) COMP-3.
      *    Vehicle AAD Promise Date
           03  P1AADPRMDT PIC S9(8) COMP-3.
      *    Veh AAD Planned Date
           03  P1AADPLN PIC S9(8) COMP-3.
      *    Vehicle AAD Actual Date
           03  P1AADACTDT PIC S9(8) COMP-3.
      *    Veh Financial Block
           03  P1VBLKFIN PIC X(1).
      *    Veh Commercial Block
           03  P1VBLKCOM PIC X(1).
      *    Veh Quality/CAT Block
           03  P1VBLKQLT PIC X(1).
      *    SEDRE flexibility status
           03  P1SPFLXSTS PIC X(1).
      *    SEDRE hdr APL code
           03  P1SEDAPLCD PIC X(6).
      *    U:Date D8#
       01  WP0001 PIC S9(8) COMP-3.
      *    U:Date D8# b
       01  WP0002 PIC S9(8) COMP-3.
      *    U:Date D8# c
       01  WP0003 PIC S9(8) COMP-3.
      ***************************************************************
       PROCEDURE DIVISION USING
             P0RTN
      *    RCD: STR - Vehicle (JSMDL)
      *    I : MAP Invariant BCV
      *    I : MAP VIN
      *    I : MAP Order Type code
      *    I : MAP Owning Account
      *    I : MAP Delivery Account
      *    I : MAP SCP Model Code
      *    I : MAP SCP Model Version Code
      *    I : MAP SCR Model Code
      *    I : MAP SCR Version Code
      *    I : MAP Phase
      *    I : MAP Type VP/VU (2)
      *    I : MAP Registration number
      *    I : MAP Dealer Order Cancel Date
      *    I : MAP C.O.C.
      *    I : MAP Version TVV
      *    I : MAP Build Year usr
      *    I : MAP Build Week usr
      *    I : MAP Build Day
      *    I : MAP TCM Date 07
      *    I : MAP PEC/MADC Date 10
      *    I : MAP Vehicle Shipment Date 20
      *    I : MAP Arrival at Dock Date 28
      *    I : MAP Enter Import Ctr Date 32
      *    I : MAP Block Start Date 33
      *    I : MAP Record Block End Date 34
      *    I : MAP Dealer Invoiced Date 42
      *    I : MAP Exit Import Centre Dte 45
      *    I : MAP Requested AAD Date 53
      *    I : MAP Registration Date 58
      *    I : MAP Veh Reg Cancelled Date
      *    I : MAP Customer Ord Number
      *    I : MAP Customer Order Date #
      *    I : MAP Veh ARC Planned Date
      *    I : MAP Veh DDD Requested Date
      *    I : MAP Veh DDD Forecast Date
      *    I : MAP Vehicle AAD Promise Date
      *    I : MAP Veh AAD Planned Date
      *    I : MAP Vehicle AAD Actual Date
      *    I : MAP Veh Financial Block
      *    I : MAP Veh Commercial Block
      *    I : MAP Veh Quality/CAT Block
      *    I : MAP SEDRE flexibility status
      *    I : MAP SEDRE hdr APL code
      *    I : MAP U:Date D8#
      *    I : MAP U:Date D8# b
      *    I : MAP U:Date D8# c
      *    RCD : *Arrays
             P1PARM
      *    U:Date D8#
             WP0001
      *    U:Date D8# b
             WP0002
      *    U:Date D8# c
             WP0003
           .
      *    Initialise work fields from entry parameters
           MOVE WP0001 TO P2UDATED8A
           MOVE WP0002 TO P3UDTED8B
           MOVE WP0003 TO P4Y2DX
      ***************************************************************
           CONTINUE.
       MAINLINE SECTION.
      *    Initialize
           PERFORM ZZINIT
      *
      *    Create Export Vehicle
      *    desc
           PERFORM UA1SUBR
           MOVE P1BLDWEEK TO YL0001 OF WORK-CONTEXT
           MOVE P1BLDYEAR TO YL0002 OF WORK-CONTEXT
           MOVE P1CUSORDD8 TO YL0003 OF WORK-CONTEXT
      *    Cvt *Job date to DTX
      *    * Job date contains a leading 1 when the year is 2000 or
      *      greater
      *    U:Job Date DTX
           ADD ZZJDT OF JOB-CONTEXT, 19000000 GIVING YL0004 OF
             WORK-CONTEXT
           MOVE YL0004 OF WORK-CONTEXT TO YL0005 OF WORK-CONTEXT
           MOVE P1VREGCNL TO YL0006 OF WORK-CONTEXT
           MOVE P1ARCPLN TO YL0007 OF WORK-CONTEXT
           MOVE 6 TO YRSW04
           MOVE 1 TO YRSW03
           IF (YRSW03 NOT > 0 OR
               YRSW04 NOT > 0 OR
               YRSW03 > 00008 OR
               YRSW04 > 00008) THEN
               MOVE 'Y2U0510' TO W0RTN
           ELSE
               MOVE YL0007 OF WORK-CONTEXT TO W0STRNG
               MOVE W0STRNG(YRSW03:YRSW04) TO YL0008 OF WORK-CONTEXT
           END-IF
           MOVE P1CUSORDD8 TO YL0007 OF WORK-CONTEXT
           MOVE 6 TO YRSW04
           MOVE 1 TO YRSW03
           IF (YRSW03 NOT > 0 OR
               YRSW04 NOT > 0 OR
               YRSW03 > 00008 OR
               YRSW04 > 00008) THEN
               MOVE 'Y2U0510' TO W0RTN
           ELSE
               MOVE YL0007 OF WORK-CONTEXT TO W0STRNG
               MOVE W0STRNG(YRSW03:YRSW04) TO YL0009 OF WORK-CONTEXT
           END-IF
           MOVE 2 TO YRSW04
           MOVE 5 TO YRSW03
           IF (YRSW03 NOT > 0 OR
               YRSW04 NOT > 0 OR
               YRSW03 > 00008 OR
               YRSW04 > 00008) THEN
               MOVE 'Y2U0510' TO W0RTN
           ELSE
               MOVE YL0007 OF WORK-CONTEXT TO W0STRNG
               MOVE W0STRNG(YRSW03:YRSW04) TO YL0010 OF WORK-CONTEXT
           END-IF
           MOVE P1DLORDCND TO YL0007 OF WORK-CONTEXT
           MOVE 6 TO YRSW04
           MOVE 1 TO YRSW03
           IF (YRSW03 NOT > 0 OR
               YRSW04 NOT > 0 OR
               YRSW03 > 00006 OR
               YRSW04 > 00006) THEN
               MOVE 'Y2U0510' TO W0RTN
           ELSE
               MOVE YL0011 OF WORK-CONTEXT TO W0STRNG
               MOVE W0STRNG(YRSW03:YRSW04) TO YL0010 OF WORK-CONTEXT
           END-IF
      *    Extraction Type
      *    CASE: PAR.Registration Date 58 GT PAR.U:Date D8# b
      *    *IF
           IF (P1REGDT58 > P3UDTED8B) THEN
      *        Extraction Type
               MOVE 'Y-2' TO YL0012 OF WORK-CONTEXT
           ELSE
      *        CASE: PAR.Registration Date 58 GT PAR.U:Date D8#
      *        *IF
               IF (P1REGDT58 > P2UDATED8A) THEN
      *            Extraction Type
                   MOVE 'Y-1' TO YL0012 OF WORK-CONTEXT
               ELSE
      *            CASE: PAR.Registration Date 58 LE PAR.U:Date D8#
      *            *IF
                   IF (P1REGDT58 NOT > P2UDATED8A) THEN
      *                Extraction Type
                       MOVE SPACES TO YL0012 OF WORK-CONTEXT
                       MOVE 'Y' TO YL0012 OF WORK-CONTEXT
                   ELSE
      *                CASE: PAR.Registration Date 58 is EQ Zero
      *                *IF
                       IF (P1REGDT58 = 0) THEN
      *                    Extraction Type
                           MOVE SPACES TO YL0012 OF WORK-CONTEXT
                           MOVE 'N' TO YL0012 OF WORK-CONTEXT
                       END-IF
                   END-IF
               END-IF
           END-IF
      *    Reg Count
      *    CASE: PAR.Registration Date 58 is EQ Zero
      *    *IF
           IF (P1REGDT58 = 0) THEN
      *        Reg Count
               MOVE '0' TO YL0013 OF WORK-CONTEXT
           ELSE
      *        CASE: *OTHERWISE
      *        Reg Count
               MOVE '1' TO YL0013 OF WORK-CONTEXT
           END-IF
      *    Order Count
      *    CASE: PAR.Customer Order Date # is EQ Zero
      *    *IF
           IF (P1CUSORDD8 = 0) THEN
      *        Order Count
               MOVE '0' TO YL0014 OF WORK-CONTEXT
           ELSE
      *        CASE: *OTHERWISE
      *        Order Count
               MOVE '1' TO YL0014 OF WORK-CONTEXT
           END-IF
      *    Cancellation count
      *    CASE: PAR.Dealer Order Cancel Date is *zero
      *    *IF
           IF (P1DLORDCND = 0) THEN
      *        Cancellation count
               MOVE '0' TO YL0015 OF WORK-CONTEXT
           ELSE
      *        CASE: *OTHERWISE
      *        Cancellation count
               MOVE '1' TO YL0015 OF WORK-CONTEXT
           END-IF
      *    Car/Van text
      *    CASE:
      *    - c1 OR c2 OR c3
      *    |- c1    : PAR.Type VP/VU (2) is 1 = Car
      *    |- c2    : PAR.Type VP/VU (2) is _1 car bad value
      *    |- c3    : PAR.Type VP/VU (2) is VP = car
      *    '-
      *    *IF
           IF (P1RSCE = '1' OR
               P1RSCE = ' 1' OR
               P1RSCE = 'VP') THEN
      *        Car/Van text
               MOVE 'Car' TO YL0016 OF WORK-CONTEXT
           ELSE
      *        CASE:
      *        - c1 OR c2 OR c3
      *        |- c1    : PAR.Type VP/VU (2) is _2 Van bad value
      *        |- c2    : PAR.Type VP/VU (2) is VU = Van
      *        |- c3    : PAR.Type VP/VU (2) is 2 = Van
      *        '-
      *        *IF
               IF (P1RSCE = ' 2' OR
                   P1RSCE = 'VU' OR
                   P1RSCE = '2') THEN
      *            Car/Van text
                   MOVE 'Van' TO YL0016 OF WORK-CONTEXT
               ELSE
      *            CASE: *OTHERWISE
      *            Rtv Veh Mdl Ver - Vehicle Model Version  *
                   PERFORM SA1RVGN
      *            CASE: LCL.Vehicle Body Class Code is Car
      *            *IF
                   IF (YL0017 OF WORK-CONTEXT = 'C') THEN
      *                Car/Van text
                       MOVE 'Car' TO YL0016 OF WORK-CONTEXT
                   ELSE
      *                CASE: LCL.Vehicle Body Class Code is Vans
      *                *IF
                       IF (YL0017 OF WORK-CONTEXT = 'V') THEN
      *                    Car/Van text
                           MOVE 'Van' TO YL0016 OF WORK-CONTEXT
                       ELSE
      *                    CASE: LCL.Vehicle Body Class Code is HGV
      *                    *IF
                           IF (YL0017 OF WORK-CONTEXT = 'H') THEN
      *                        Car/Van text
                               MOVE 'Van' TO YL0016 OF WORK-CONTEXT
                           END-IF
                       END-IF
                   END-IF
               END-IF
           END-IF
      *    On Block
      *    CASE:
      *    - c1 AND c2
      *    |- c1    : PAR.Block Start Date 33 is > zero
      *    |- c2    : PAR.Record Block End Date 34 is > zero
      *    '-
      *    *IF
           IF (P1BLSTDT33 > 0 AND
               P1BLENDT34 > 0) THEN
      *        On Block
               MOVE '1' TO YL0018 OF WORK-CONTEXT
           ELSE
      *        CASE: *OTHERWISE
      *        On Block
               MOVE '0' TO YL0018 OF WORK-CONTEXT
           END-IF
      *    Chassis Situation
      *    CASE: PAR.TCM Date 07 is EQ Zero
      *    *IF
           IF (P1TCMDT07 = 0) THEN
      *        Chassis Situation
               MOVE SPACES TO YL0019 OF WORK-CONTEXT
               MOVE 'NOT BUILT' TO YL0019 OF WORK-CONTEXT
           ELSE
      *        CASE: PAR.PEC/MADC Date 10 is EQ Zero
      *        *IF
               IF (P1PECDT10 = 0) THEN
      *            Chassis Situation
                   MOVE SPACES TO YL0019 OF WORK-CONTEXT
                   MOVE 'BUILT' TO YL0019 OF WORK-CONTEXT
               ELSE
      *            CASE: PAR.Arrival at Dock Date 28 is EQ Zero
      *            *IF
                   IF (P1DOCDT28 = 0) THEN
      *                Chassis Situation
                       MOVE SPACES TO YL0019 OF WORK-CONTEXT
                       MOVE 'FR TRANS' TO YL0019 OF WORK-CONTEXT
                   ELSE
      *                CASE: PAR.Arrival at Dock Date 28 is EQ Zero
      *                *IF
                       IF (P1DOCDT28 = 0) THEN
      *                    Chassis Situation
                           MOVE SPACES TO YL0019 OF WORK-CONTEXT
                           MOVE 'ATIC' TO YL0019 OF WORK-CONTEXT
                       ELSE
      *                    CASE: PAR.Registration Date 58 is EQ Zero
      *                    *IF
                           IF (P1REGDT58 = 0) THEN
      *                        Chassis Situation
                               MOVE SPACES TO YL0019 OF WORK-CONTEXT
                               MOVE 'DELIVERED' TO YL0019 OF
                                 WORK-CONTEXT
                           ELSE
      *                        CASE: *OTHERWISE
      *                        Chassis Situation
                               MOVE '6 REGISTERED' TO YL0019 OF
                                 WORK-CONTEXT
                           END-IF
                       END-IF
                   END-IF
               END-IF
           END-IF
      *    Rtv by Customer Ord Numbr - Customer Order  *
           PERFORM SA2RVGN
      *    Order Cancellation desti
      *    CASE: LCL.Order Cancellation Reason is Customer cancellation
      *    *IF
           IF (YL0024 OF WORK-CONTEXT = '1') THEN
      *        Order Cancellation desti
               MOVE SPACES TO YL0029 OF WORK-CONTEXT
               MOVE 'Customer Cancellation' TO YL0029 OF WORK-CONTEXT
           ELSE
      *        CASE: LCL.Order Cancellation Reason is Duplicate
      *        *IF
               IF (YL0024 OF WORK-CONTEXT = '2') THEN
      *            Order Cancellation desti
                   MOVE SPACES TO YL0029 OF WORK-CONTEXT
                   MOVE 'Duplicate' TO YL0029 OF WORK-CONTEXT
               ELSE
      *            CASE: LCL.Order Cancellation Reason is CDD change
      *            *IF
                   IF (YL0024 OF WORK-CONTEXT = '3') THEN
      *                Order Cancellation desti
                       MOVE SPACES TO YL0029 OF WORK-CONTEXT
                       MOVE 'CDD Change' TO YL0029 OF WORK-CONTEXT
                   ELSE
      *                CASE: LCL.Order Cancellation Reason is Fleet -
      *                  details changed
      *                *IF
                       IF (YL0024 OF WORK-CONTEXT = '4') THEN
      *                    Order Cancellation desti
                           MOVE SPACES TO YL0029 OF WORK-CONTEXT
                           MOVE 'Fleet - details changed' TO YL0029 OF
                             WORK-CONTEXT
                       ELSE
      *                    CASE: LCL.Order Cancellation Reason is
      *                      Retail - details changed
      *                    *IF
                           IF (YL0024 OF WORK-CONTEXT = '5') THEN
      *                        Order Cancellation desti
                               MOVE SPACES TO YL0029 OF WORK-CONTEXT
                               MOVE 'Retail - details changed' TO
                                 YL0029 OF WORK-CONTEXT
                           ELSE
      *                        CASE: LCL.Order Cancellation Reason is
      *                          Other
      *                        *IF
                               IF (YL0024 OF WORK-CONTEXT = '6') THEN
      *                        Order Cancellation desti
                               MOVE SPACES TO YL0029 OF WORK-CONTEXT
                               MOVE 'Other' TO YL0029 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.Order Cancellation Reason is
      *                          Purge
      *                        *IF
                               IF (YL0024 OF WORK-CONTEXT = '7') THEN
      *                        Order Cancellation desti
                               MOVE SPACES TO YL0029 OF WORK-CONTEXT
                               MOVE 'Purge' TO YL0029 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.Order Cancellation Reason is
      *                          Mutation commande non aff
      *                        *IF
                               IF (YL0024 OF WORK-CONTEXT = '8') THEN
      *                        Order Cancellation desti
                               MOVE SPACES TO YL0029 OF WORK-CONTEXT
                               MOVE 'Mutation commande non aff' TO
                                 YL0029 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
      *                        Order Cancellation desti
                               MOVE SPACES TO YL0029 OF WORK-CONTEXT
                               MOVE SPACES TO YL0029 OF WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
                   END-IF
               END-IF
           END-IF
           MOVE YL0023 OF WORK-CONTEXT TO YL0030 OF WORK-CONTEXT
           MOVE 6 TO YRSW04
           MOVE 1 TO YRSW03
           IF (YRSW03 NOT > 0 OR
               YRSW04 NOT > 0 OR
               YRSW03 > 00008 OR
               YRSW04 > 00008) THEN
               MOVE 'Y2U0510' TO W0RTN
           ELSE
               MOVE YL0030 OF WORK-CONTEXT TO W0STRNG
               MOVE W0STRNG(YRSW03:YRSW04) TO YL0031 OF WORK-CONTEXT
           END-IF
      *    CDD M Ind
           PERFORM UA2SUBR
      *    Arrival Date
      *    CASE: PAR.Arrival at Dock Date 28 is EQ Zero
      *    *IF
           IF (P1DOCDT28 = 0) THEN
      *        LCL.Arrival Date = PAR.Veh ARC Planned Date
               MOVE P1ARCPLN TO YL0045 OF WORK-CONTEXT
           ELSE
      *        CASE: *OTHERWISE
      *        LCL.Arrival Date = PAR.Arrival at Dock Date 28
               MOVE P1DOCDT28 TO YL0045 OF WORK-CONTEXT
           END-IF
      *    Arrival Period YYYYMM
           PERFORM UA3SUBR
      *    Fleet Channel
      *    CASE: LCL.SD Sales Channel Code is Type 3
      *    *IF
           IF (YL0021 OF WORK-CONTEXT NOT < '3A' AND
               YL0021 OF WORK-CONTEXT NOT > '39') THEN
      *        Fleet Channel
               MOVE SPACES TO YL0050 OF WORK-CONTEXT
               MOVE 'Type3' TO YL0050 OF WORK-CONTEXT
           ELSE
      *        CASE: LCL.SD Sales Channel Code is Plan B
      *        *IF
               IF (YL0021 OF WORK-CONTEXT NOT < '4A' AND
                   YL0021 OF WORK-CONTEXT NOT > '49') THEN
      *            Fleet Channel
                   MOVE SPACES TO YL0050 OF WORK-CONTEXT
                   MOVE 'Plan B' TO YL0050 OF WORK-CONTEXT
               ELSE
      *            CASE:
      *            - c1 OR c2 OR c3 OR c4 OR c5
      *            |- c1    : LCL.SD Sales Channel Code is 5A
      *            |- c2    : LCL.SD Sales Channel Code is 5N
      *            |- c3    : LCL.SD Sales Channel Code is 5Q
      *            |- c4    : LCL.SD Sales Channel Code is 5P
      *            |- c5    : LCL.SD Sales Channel Code is 5O
      *            '-
      *            *IF
                   IF (YL0021 OF WORK-CONTEXT = '5A' OR
                       YL0021 OF WORK-CONTEXT = '5N' OR
                       YL0021 OF WORK-CONTEXT = '5Q' OR
                       YL0021 OF WORK-CONTEXT = '5P' OR
                       YL0021 OF WORK-CONTEXT = '5O') THEN
      *                Fleet Channel
                       MOVE SPACES TO YL0050 OF WORK-CONTEXT
                       MOVE 'Major Fleet' TO YL0050 OF WORK-CONTEXT
                   ELSE
      *                CASE:
      *                - c1 OR c2
      *                |- c1    : LCL.SD Sales Channel Code is 5R
      *                |- c2    : LCL.SD Sales Channel Code is 5X
      *                '-
      *                *IF
                       IF (YL0021 OF WORK-CONTEXT = '5R' OR
                           YL0021 OF WORK-CONTEXT = '5X') THEN
      *                    Fleet Channel
                           MOVE SPACES TO YL0050 OF WORK-CONTEXT
                           MOVE 'Network Rental' TO YL0050 OF
                             WORK-CONTEXT
                       ELSE
      *                    CASE: *OTHERWISE
      *                    CASE: LCL.SD Sales Channel Code is Local
      *                      Fleet
      *                    *IF
                           IF (YL0021 OF WORK-CONTEXT NOT < '5A' AND
                               YL0021 OF WORK-CONTEXT NOT > '59') THEN
      *                        Fleet Channel
                               MOVE SPACES TO YL0050 OF WORK-CONTEXT
                               MOVE 'Local Fleet' TO YL0050 OF
                                 WORK-CONTEXT
                           ELSE
      *                        CASE:
      *                        - c1 OR c2
      *                        |- c1    : LCL.SD Sales Channel Code is
      *                          6 Motabilty
      *                        |- c2    : LCL.SD Sales Channel Code is
      *                          7 Motabilty
      *                        '-
      *                        *IF
                               IF (YL0021 OF WORK-CONTEXT NOT < '6A' AND
                                   YL0021 OF WORK-CONTEXT NOT > '69' OR
                                   YL0021 OF WORK-CONTEXT NOT < '7A' AND
                                   YL0021 OF WORK-CONTEXT NOT > '79')
                                 THEN
      *                        Fleet Channel
                               MOVE SPACES TO YL0050 OF WORK-CONTEXT
                               MOVE 'Motabilty' TO YL0050 OF
                                 WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
      *                        Fleet Channel
                               MOVE SPACES TO YL0050 OF WORK-CONTEXT
                               MOVE 'NA' TO YL0050 OF WORK-CONTEXT
                               END-IF
                           END-IF
                       END-IF
                   END-IF
               END-IF
           END-IF
      *    VEH-RETCODE
           MOVE 'NN' TO YL0051 OF WORK-CONTEXT
      *    VEH-RECORD-AVEHBR2CB
           MOVE SPACES TO YL0052 OF WORK-CONTEXT
           MOVE SPACES TO YL0052 OF WORK-CONTEXT
           MOVE 'A' TO YRSW09
           MOVE ZEROS TO YRSW04
           MOVE 'T' TO YRSW08
           IF (YRSW09 = SPACES AND
               YRSW08 = 'T') THEN
               ADD  1 TO ZEROS GIVING YRSW07
           ELSE
               ADD  1 TO 00001 GIVING YRSW07
           END-IF
           MOVE 00001 TO YRSW03
           MOVE YRSW09 TO YRSW05
           PERFORM ZCATWK
           STRING YRSW05 DELIMITED BY X'FF',
                  YL0054 OF WORK-CONTEXT DELIMITED BY SIZE
           INTO   YRSW05
           MOVE YRSW05 TO YL0053 OF WORK-CONTEXT
           MOVE ZEROS TO YRSW04
           MOVE 'T' TO YRSW08
           IF (YL0053 OF WORK-CONTEXT = SPACES AND
               YRSW08 = 'T') THEN
               ADD  1 TO ZEROS GIVING YRSW07
           ELSE
               ADD  1 TO 00007 GIVING YRSW07
           END-IF
           MOVE 00007 TO YRSW03
           MOVE YL0053 OF WORK-CONTEXT TO YRSW05
           PERFORM ZCATWK
           STRING YRSW05 DELIMITED BY X'FF',
                  YL0052 OF WORK-CONTEXT DELIMITED BY SIZE
           INTO   YRSW05
           MOVE YRSW05 TO YL0052 OF WORK-CONTEXT
      *    Ext Rtv Brands for ALPCDE - #Foreign model access  *
           SET C-INDICATOR-OFF(90) TO TRUE
           MOVE YL0052 OF WORK-CONTEXT TO WQ0001
      *
           CALL 'AVEHBR2CB' USING
      *    VEH-RECORD-AVEHBR2CB
             WQ0001
                    ON OVERFLOW
                    SET C-INDICATOR-ON(90) TO TRUE
           END-CALL
      *
           MOVE WQ0001 TO YL0052 OF WORK-CONTEXT
      *
      *    Error on program call will terminate run unit
           IF (C-INDICATOR-ON(90)) THEN
               MOVE 'Y2U0032' TO W0RTN
               MOVE 'AVEHBR2CB' TO W0CLPG
      *        Send message '*Error occured on CALL...'
      *        Message ID
               MOVE 'Y2U0032' TO ZAMSID
      *        Message file
               MOVE 'Y2USRMSG' TO ZAMSGF
      *        Message data
               MOVE W0CLPG TO ZAMSDA
               PERFORM ZASNMS
               SET C-INDICATOR-ON(99) TO TRUE
           END-IF
           MOVE 2 TO YRSW04
           MOVE 89 TO YRSW03
           IF (YRSW03 NOT > 0 OR
               YRSW04 NOT > 0 OR
               YRSW03 > 00090 OR
               YRSW04 > 00090) THEN
               MOVE 'Y2U0510' TO W0RTN
           ELSE
               MOVE YL0052 OF WORK-CONTEXT TO W0STRNG
               MOVE W0STRNG(YRSW03:YRSW04) TO YL0051 OF WORK-CONTEXT
           END-IF
      *    Brand Name Display
      *    CASE:
      *    - c1 AND NOT c2
      *    |- c1    : LCL.VEH-RETCODE is Normal
      *    |- c2    : LCL.VEH-RECORD-AVEHBR2CB is Blank
      *    '-
      *    *IF
           IF (YL0051 OF WORK-CONTEXT = '00' AND
               NOT (YL0052 OF WORK-CONTEXT = SPACES)) THEN
               MOVE 15 TO YRSW04
               MOVE 29 TO YRSW03
               IF (YRSW03 NOT > 0 OR
                   YRSW04 NOT > 0 OR
                   YRSW03 > 00090 OR
                   YRSW04 > 00090) THEN
                   MOVE 'Y2U0510' TO W0RTN
               ELSE
                   MOVE YL0052 OF WORK-CONTEXT TO W0STRNG
                   MOVE W0STRNG(YRSW03:YRSW04) TO YL0055 OF WORK-CONTEXT
               END-IF
           ELSE
      *        CASE: *OTHERWISE
      *        CASE: LCL.SEDRE hdr APL code is Alpine
      *        *IF
               IF (YL0054 OF WORK-CONTEXT = 'APL18') THEN
      *            Brand Name Display
                   MOVE SPACES TO YL0055 OF WORK-CONTEXT
                   MOVE 'Alpine' TO YL0055 OF WORK-CONTEXT
               ELSE
      *            CASE: LCL.SEDRE hdr APL code is Dacia
      *            *IF
                   IF (YL0054 OF WORK-CONTEXT = 'APL05') THEN
      *                Brand Name Display
                       MOVE SPACES TO YL0055 OF WORK-CONTEXT
                       MOVE 'Dacia' TO YL0055 OF WORK-CONTEXT
                   ELSE
      *                CASE: LCL.SEDRE hdr APL code is Renault
      *                *IF
                       IF (YL0054 OF WORK-CONTEXT = 'APL03') THEN
      *                    Brand Name Display
                           MOVE SPACES TO YL0055 OF WORK-CONTEXT
                           MOVE 'Renault' TO YL0055 OF WORK-CONTEXT
                       END-IF
                   END-IF
               END-IF
           END-IF
      *    Utl Cvt Dealer 6 to 5N
           MOVE 5 TO YRSW04
           MOVE 2 TO YRSW03
           IF (YRSW03 NOT > 0 OR
               YRSW04 NOT > 0 OR
               YRSW03 > 00006 OR
               YRSW04 > 00006) THEN
               MOVE 'Y2U0510' TO W0RTN
           ELSE
               MOVE P1OWNACC TO W0STRNG
               MOVE W0STRNG(YRSW03:YRSW04) TO WUUCODE5 OF WORK-CONTEXT
           END-IF
           IF (WUUCODE5 OF WORK-CONTEXT = SPACES) THEN
               MOVE ZERO TO YL0056 OF WORK-CONTEXT
           ELSE
               MOVE WUUCODE5 OF WORK-CONTEXT TO YL0056 OF WORK-CONTEXT
           END-IF
      *    Rtv All Dtl by Dlr/Mdl/ON - OBT Extract  *
           PERFORM SA3RVGN
           MOVE 4 TO YRSW04
           MOVE 1 TO YRSW03
           IF (YRSW03 NOT > 0 OR
               YRSW04 NOT > 0 OR
               YRSW03 > 00006 OR
               YRSW04 > 00006) THEN
               MOVE 'Y2U0510' TO W0RTN
           ELSE
               MOVE YL0067 OF WORK-CONTEXT TO W0STRNG
               MOVE W0STRNG(YRSW03:YRSW04) TO YL0066 OF WORK-CONTEXT
           END-IF
           MOVE 2 TO YRSW04
           MOVE 5 TO YRSW03
           IF (YRSW03 NOT > 0 OR
               YRSW04 NOT > 0 OR
               YRSW03 > 00006 OR
               YRSW04 > 00006) THEN
               MOVE 'Y2U0510' TO W0RTN
           ELSE
               MOVE YL0067 OF WORK-CONTEXT TO W0STRNG
               MOVE W0STRNG(YRSW03:YRSW04) TO YL0068 OF WORK-CONTEXT
           END-IF
      *    Dealer Network Type
           MOVE SPACES TO YL0069 OF WORK-CONTEXT
      *    Rtv All Dealer Details - Dealer  *
           PERFORM SA4RVGN
      *    Conversion Count
      *    CASE:
      *    - c1 OR c2
      *    |- c1    : LCL.Fleet Programmes Code is PAC - Plan A
      *      Convertor
      *    |- c2    : LCL.Dealer Network Type is Converter Account
      *    '-
      *    *IF
           IF (YL0063 OF WORK-CONTEXT = 'PAC' OR
               YL0069 OF WORK-CONTEXT = 'C') THEN
      *        Conversion Count
               MOVE '1' TO YL0070 OF WORK-CONTEXT
           ELSE
      *        CASE: *OTHERWISE
      *        Conversion Count
               MOVE '0' TO YL0070 OF WORK-CONTEXT
           END-IF
      *    Pull Forward ...
      *    CASE:
      *    - c1 AND c2 AND (c3 OR (c4 AND c5 ))
      *    -  AND NOT c6 AND NOTc7
      *    |- c1    : PAR.Veh ARC Planned Date is > zero
      *    |- c2    : PAR.Registration Date 58 is EQ Zero
      *    |- c3    : PAR.Block Start Date 33 is EQ Zero
      *    |- c4    : PAR.Block Start Date 33 is > zero
      *    |- c5    : PAR.Record Block End Date 34 is > zero
      *    |- c6    : LCL.Fleet Programmes Code is PAC - Plan A
      *      Convertor
      *    |- c7    : LCL.Dealer Network Type is Converter Account
      *    '-
      *    *IF
           IF (P1ARCPLN > 0 AND
               P1REGDT58 = 0 AND
               (P1BLSTDT33 = 0 OR
               (P1BLSTDT33 > 0 AND
               P1BLENDT34 > 0)) AND
               NOT (YL0063 OF WORK-CONTEXT = 'PAC') AND
               NOT (YL0069 OF WORK-CONTEXT = 'C')) THEN
      *        Clear all neither parameters
      *        U:Date
               MOVE ZEROS TO WN0001
      *        U:Number of Days in Month
               MOVE ZEROS TO WN0002
      *        U:Period CCYYMM
               MOVE ZEROS TO WN0003
      *        U:Date (8) CCYYMMDD
               MOVE ZEROS TO WN0004
      *
      *        Rtn Get Month St and End
      *        Created G.Eavis,Consyse 13/09/1999
      *        Returns the date of the first and last day of the month
      *          for I/P date.
      *        Convert input DTX date to DTE, allowing use of 2E date
      *          functions
      *        U:Date
               SUBTRACT 19000000 FROM YL0004 OF WORK-CONTEXT GIVING
                 WN0001
      *        PAR.U:Number of Days in Month = PAR.U:Date *MONTH LENGTH
               ADD 1000000 TO WN0001 GIVING XDINDT
               MOVE 0 TO XDINDD
               PERFORM XCVTA
               MOVE XDAY1 TO XDAY2
               ADD 1 TO XDINMM
               PERFORM XCVTA
               MOVE '1' TO XDSEL
               MOVE '1111111' TO XDCDW
               PERFORM XDOWS
               MOVE 'NONE' TO WUDLN OF WORK-CONTEXT
               PERFORM XDUDY
               MOVE XDURR TO WN0002
      *        Remove days from DTX date
      *        U:Period CCYYMM
               DIVIDE 100 INTO YL0004 OF WORK-CONTEXT GIVING WN0003
      *        U:Date (8) CCYYMMDD
               MULTIPLY WN0003 BY 100 GIVING WN0004
      *        U:Start date DTX
               ADD WN0004, 1 GIVING YN0173 OF WORK-CONTEXT
      *        U:End date DTX
               ADD WN0004, WN0002 GIVING YL0071 OF WORK-CONTEXT
      *        Rtn Add Days to Date- DTX
      *        * Convert to days, add, then convert back.
      *        * NOTE: Use of 'Days 2' field to avoid clash in WRK
      *          context.
      *        Cvt DTX to DTE Format
      *        CASE: PAR.U:Date YYYYMMDD is *Not Zeros
      *        *IF
               IF (YL0071 OF WORK-CONTEXT NOT = 0) THEN
      *            U:Number (2.0)
      *            U:Number (6.0)
                   DIVIDE 1000000 INTO YL0071 OF WORK-CONTEXT GIVING
                     WUNBR2 OF WORK-CONTEXT REMAINDER WUNUM6 OF
                     WORK-CONTEXT
      *            Return Value of CYYMMDD
      *            CASE: WRK.U:Number (2.0) is *21 Century
      *            *IF
                   IF (WUNBR2 OF WORK-CONTEXT = 20) THEN
      *                U:Date
                       ADD WUNUM6 OF WORK-CONTEXT, 1000000 GIVING
                         WUDATE OF WORK-CONTEXT
                   ELSE
      *                CASE: *OTHERWISE
      *                WRK.U:Date = WRK.U:Number (6.0)
                       MOVE WUNUM6 OF WORK-CONTEXT TO WUDATE OF
                         WORK-CONTEXT
                   END-IF
      *            U:Date
                   MOVE WUDATE OF WORK-CONTEXT TO WUDATE OF WORK-CONTEXT
               ELSE
      *            CASE: *OTHERWISE
      *            U:Date
                   MOVE ZEROS TO WUDATE OF WORK-CONTEXT
               END-IF
      *        Cvt Date to Days - #Date Functions  *
     E* Y2V3114 - Source member UFGCVTDTDS not found.
      *        U:Days 2
               ADD WUUDAYS2 OF WORK-CONTEXT, 1 GIVING WUUDAYS2 OF
                 WORK-CONTEXT
      *        Cvt Days to Date - #Date Functions  *
     E* Y2V3114 - Source member UFGCVTDYDS not found.
      *        Cvt DTE to DTX Format
      *        CASE: PAR.U:Date is < 01/01/40
      *        *IF
               IF (WUDATE OF WORK-CONTEXT < 400101) THEN
      *            CASE: PAR.U:Date is *Zero
      *            *IF
                   IF (WUDATE OF WORK-CONTEXT = 0) THEN
      *                U:Date YYYYMMDD
                       MOVE ZEROS TO YL0072 OF WORK-CONTEXT
                   ELSE
      *                CASE: *OTHERWISE
      *                U:Date YYYYMMDD
                       ADD WUDATE OF WORK-CONTEXT, 20000000 GIVING
                         YL0072 OF WORK-CONTEXT
                   END-IF
               ELSE
      *            CASE: *OTHERWISE
      *            U:Date YYYYMMDD
                   ADD WUDATE OF WORK-CONTEXT, 19000000 GIVING YL0072
                     OF WORK-CONTEXT
               END-IF
      *        Rtn Add Days to Date- DTX
      *        * Convert to days, add, then convert back.
      *        * NOTE: Use of 'Days 2' field to avoid clash in WRK
      *          context.
      *        Cvt DTX to DTE Format
      *        CASE: PAR.U:Date YYYYMMDD is *Not Zeros
      *        *IF
               IF (YL0071 OF WORK-CONTEXT NOT = 0) THEN
      *            U:Number (2.0)
      *            U:Number (6.0)
                   DIVIDE 1000000 INTO YL0071 OF WORK-CONTEXT GIVING
                     WUNBR2 OF WORK-CONTEXT REMAINDER WUNUM6 OF
                     WORK-CONTEXT
      *            Return Value of CYYMMDD
      *            CASE: WRK.U:Number (2.0) is *21 Century
      *            *IF
                   IF (WUNBR2 OF WORK-CONTEXT = 20) THEN
      *                U:Date
                       ADD WUNUM6 OF WORK-CONTEXT, 1000000 GIVING
                         WUDATE OF WORK-CONTEXT
                   ELSE
      *                CASE: *OTHERWISE
      *                WRK.U:Date = WRK.U:Number (6.0)
                       MOVE WUNUM6 OF WORK-CONTEXT TO WUDATE OF
                         WORK-CONTEXT
                   END-IF
      *            U:Date
                   MOVE WUDATE OF WORK-CONTEXT TO WUDATE OF WORK-CONTEXT
               ELSE
      *            CASE: *OTHERWISE
      *            U:Date
                   MOVE ZEROS TO WUDATE OF WORK-CONTEXT
               END-IF
      *        Cvt Date to Days - #Date Functions  *
     E* Y2V3114 - Source member UFGCVTDTDS not found.
      *        U:Days 2
               ADD WUUDAYS2 OF WORK-CONTEXT, 2 GIVING WUUDAYS2 OF
                 WORK-CONTEXT
      *        Cvt Days to Date - #Date Functions  *
     E* Y2V3114 - Source member UFGCVTDYDS not found.
      *        Cvt DTE to DTX Format
      *        CASE: PAR.U:Date is < 01/01/40
      *        *IF
               IF (WUDATE OF WORK-CONTEXT < 400101) THEN
      *            CASE: PAR.U:Date is *Zero
      *            *IF
                   IF (WUDATE OF WORK-CONTEXT = 0) THEN
      *                U:Date YYYYMMDD
                       MOVE ZEROS TO YL0073 OF WORK-CONTEXT
                   ELSE
      *                CASE: *OTHERWISE
      *                U:Date YYYYMMDD
                       ADD WUDATE OF WORK-CONTEXT, 20000000 GIVING
                         YL0073 OF WORK-CONTEXT
                   END-IF
               ELSE
      *            CASE: *OTHERWISE
      *            U:Date YYYYMMDD
                   ADD WUDATE OF WORK-CONTEXT, 19000000 GIVING YL0073
                     OF WORK-CONTEXT
               END-IF
      *        Rtn Add Days to Date- DTX
      *        * Convert to days, add, then convert back.
      *        * NOTE: Use of 'Days 2' field to avoid clash in WRK
      *          context.
      *        Cvt DTX to DTE Format
      *        CASE: PAR.U:Date YYYYMMDD is *Not Zeros
      *        *IF
               IF (YL0071 OF WORK-CONTEXT NOT = 0) THEN
      *            U:Number (2.0)
      *            U:Number (6.0)
                   DIVIDE 1000000 INTO YL0071 OF WORK-CONTEXT GIVING
                     WUNBR2 OF WORK-CONTEXT REMAINDER WUNUM6 OF
                     WORK-CONTEXT
      *            Return Value of CYYMMDD
      *            CASE: WRK.U:Number (2.0) is *21 Century
      *            *IF
                   IF (WUNBR2 OF WORK-CONTEXT = 20) THEN
      *                U:Date
                       ADD WUNUM6 OF WORK-CONTEXT, 1000000 GIVING
                         WUDATE OF WORK-CONTEXT
                   ELSE
      *                CASE: *OTHERWISE
      *                WRK.U:Date = WRK.U:Number (6.0)
                       MOVE WUNUM6 OF WORK-CONTEXT TO WUDATE OF
                         WORK-CONTEXT
                   END-IF
      *            U:Date
                   MOVE WUDATE OF WORK-CONTEXT TO WUDATE OF WORK-CONTEXT
               ELSE
      *            CASE: *OTHERWISE
      *            U:Date
                   MOVE ZEROS TO WUDATE OF WORK-CONTEXT
               END-IF
      *        Cvt Date to Days - #Date Functions  *
     E* Y2V3114 - Source member UFGCVTDTDS not found.
      *        U:Days 2
               ADD WUUDAYS2 OF WORK-CONTEXT, 3 GIVING WUUDAYS2 OF
                 WORK-CONTEXT
      *        Cvt Days to Date - #Date Functions  *
     E* Y2V3114 - Source member UFGCVTDYDS not found.
      *        Cvt DTE to DTX Format
      *        CASE: PAR.U:Date is < 01/01/40
      *        *IF
               IF (WUDATE OF WORK-CONTEXT < 400101) THEN
      *            CASE: PAR.U:Date is *Zero
      *            *IF
                   IF (WUDATE OF WORK-CONTEXT = 0) THEN
      *                U:Date YYYYMMDD
                       MOVE ZEROS TO YL0074 OF WORK-CONTEXT
                   ELSE
      *                CASE: *OTHERWISE
      *                U:Date YYYYMMDD
                       ADD WUDATE OF WORK-CONTEXT, 20000000 GIVING
                         YL0074 OF WORK-CONTEXT
                   END-IF
               ELSE
      *            CASE: *OTHERWISE
      *            U:Date YYYYMMDD
                   ADD WUDATE OF WORK-CONTEXT, 19000000 GIVING YL0074
                     OF WORK-CONTEXT
               END-IF
      *        Pull Forward M+1
      *        CASE:
      *        - (c1 OR c2 AND c3 ) AND c4 AND c5 AND
      *        -  c6 AND c7
      *        |- c1    : PAR.Arrival at Dock Date 28 LE LCL.U:date
      *          last of M
      *        |- c2    : PAR.Arrival at Dock Date 28 is EQ Zero
      *        |- c3    : PAR.Veh ARC Planned Date LE LCL.U:date last
      *          of M
      *        |- c4    : LCL.Cust Desired Delivery Dte GT LCL.U:date
      *          last of M
      *        |- c5    : LCL.Cust Desired Delivery Dte LE LCL.U:date
      *          last of M+1
      *        |- c6    : LCL.SEDRE Customer Type is Motability VED
      *          exempt
      *        |- c7    : LCL.SEDRE Customer Type is Motability not
      *          VED exempt
      *        '-
      *        *IF
               IF ((P1DOCDT28 NOT > YL0071 OF WORK-CONTEXT OR
                    (P1DOCDT28 = 0 AND
                    P1ARCPLN NOT > YL0071 OF WORK-CONTEXT)) AND
                   YL0023 OF WORK-CONTEXT > YL0071 OF WORK-CONTEXT AND
                   YL0023 OF WORK-CONTEXT NOT > YL0072 OF WORK-CONTEXT
                 AND
                   YL0022 OF WORK-CONTEXT = '6' AND
                   YL0022 OF WORK-CONTEXT = '7') THEN
      *            Pull Forward M+1
                   MOVE '1' TO YL0075 OF WORK-CONTEXT
               ELSE
      *            CASE: *OTHERWISE
      *            Pull Forward M+1
                   MOVE '0' TO YL0075 OF WORK-CONTEXT
               END-IF
      *        Pull Forward M+2
      *        CASE:
      *        - (c1 OR c2 AND c3 ) AND c4 AND c5 AND
      *        -  c6 AND c7
      *        |- c1    : PAR.Arrival at Dock Date 28 LE LCL.U:date
      *          last of M
      *        |- c2    : PAR.Arrival at Dock Date 28 is EQ Zero
      *        |- c3    : PAR.Veh ARC Planned Date LE LCL.U:date last
      *          of M
      *        |- c4    : LCL.Cust Desired Delivery Dte GT LCL.U:date
      *          last of M+1
      *        |- c5    : LCL.Cust Desired Delivery Dte LE LCL.U:date
      *          last of M+2
      *        |- c6    : LCL.SEDRE Customer Type is Motability VED
      *          exempt
      *        |- c7    : LCL.SEDRE Customer Type is Motability not
      *          VED exempt
      *        '-
      *        *IF
               IF ((P1DOCDT28 NOT > YL0071 OF WORK-CONTEXT OR
                    (P1DOCDT28 = 0 AND
                    P1ARCPLN NOT > YL0071 OF WORK-CONTEXT)) AND
                   YL0023 OF WORK-CONTEXT > YL0072 OF WORK-CONTEXT AND
                   YL0023 OF WORK-CONTEXT NOT > YL0073 OF WORK-CONTEXT
                 AND
                   YL0022 OF WORK-CONTEXT = '6' AND
                   YL0022 OF WORK-CONTEXT = '7') THEN
      *            Pull Forward M+2
                   MOVE '1' TO YL0076 OF WORK-CONTEXT
               ELSE
      *            CASE: *OTHERWISE
      *            Pull Forward M+2
                   MOVE '0' TO YL0076 OF WORK-CONTEXT
               END-IF
      *        Pull Forward M+3
      *        CASE:
      *        - (c1 OR c2 AND c3 ) AND c4 AND c5 AND
      *        -  c6 AND c7
      *        |- c1    : PAR.Arrival at Dock Date 28 LE LCL.U:date
      *          last of M
      *        |- c2    : PAR.Arrival at Dock Date 28 is EQ Zero
      *        |- c3    : PAR.Veh ARC Planned Date LE LCL.U:date last
      *          of M
      *        |- c4    : LCL.Cust Desired Delivery Dte GT LCL.U:date
      *          last of M+2
      *        |- c5    : LCL.Cust Desired Delivery Dte LE LCL.U:date
      *          last of M+3
      *        |- c6    : LCL.SEDRE Customer Type is Motability VED
      *          exempt
      *        |- c7    : LCL.SEDRE Customer Type is Motability not
      *          VED exempt
      *        '-
      *        *IF
               IF ((P1DOCDT28 NOT > YL0071 OF WORK-CONTEXT OR
                    (P1DOCDT28 = 0 AND
                    P1ARCPLN NOT > YL0071 OF WORK-CONTEXT)) AND
                   YL0023 OF WORK-CONTEXT > YL0073 OF WORK-CONTEXT AND
                   YL0023 OF WORK-CONTEXT NOT > YL0074 OF WORK-CONTEXT
                 AND
                   YL0022 OF WORK-CONTEXT = '6' AND
                   YL0022 OF WORK-CONTEXT = '7') THEN
      *            Pull Forward M+3
                   MOVE '1' TO YL0077 OF WORK-CONTEXT
               ELSE
      *            CASE: *OTHERWISE
      *            Pull Forward M+3
                   MOVE '0' TO YL0077 OF WORK-CONTEXT
               END-IF
      *        Pull Forward M+4
      *        CASE:
      *        - (c1 OR c2 AND c3 ) AND c4 AND c6 AND
      *        -  c7
      *        |- c1    : PAR.Arrival at Dock Date 28 LE LCL.U:date
      *          last of M
      *        |- c2    : PAR.Arrival at Dock Date 28 is EQ Zero
      *        |- c3    : PAR.Veh ARC Planned Date LE LCL.U:date last
      *          of M
      *        |- c4    : LCL.Cust Desired Delivery Dte GT LCL.U:date
      *          last of M+3
      *        |- c6    : LCL.SEDRE Customer Type is Motability VED
      *          exempt
      *        |- c7    : LCL.SEDRE Customer Type is Motability not
      *          VED exempt
      *        '-
      *        *IF
               IF ((P1DOCDT28 NOT > YL0071 OF WORK-CONTEXT OR
                    (P1DOCDT28 = 0 AND
                    P1ARCPLN NOT > YL0071 OF WORK-CONTEXT)) AND
                   YL0023 OF WORK-CONTEXT > YL0074 OF WORK-CONTEXT AND
                   YL0022 OF WORK-CONTEXT = '6' AND
                   YL0022 OF WORK-CONTEXT = '7') THEN
      *            Pull Forward M+4
                   MOVE '1' TO YL0078 OF WORK-CONTEXT
               ELSE
      *            CASE: *OTHERWISE
      *            Pull Forward M+4
                   MOVE '0' TO YL0078 OF WORK-CONTEXT
               END-IF
      *        Available Count
      *        CASE:
      *        - (c1 OR c2 AND c3 ) AND c4
      *        |- c1    : PAR.Arrival at Dock Date 28 LE LCL.U:date
      *          last of M
      *        |- c2    : PAR.Arrival at Dock Date 28 is EQ Zero
      *        |- c3    : PAR.Veh ARC Planned Date LE LCL.U:date last
      *          of M
      *        |- c4    : LCL.Cust Desired Delivery Dte LE LCL.U:date
      *          last of M
      *        '-
      *        *IF
               IF ((P1DOCDT28 NOT > YL0071 OF WORK-CONTEXT OR
                    (P1DOCDT28 = 0 AND
                    P1ARCPLN NOT > YL0071 OF WORK-CONTEXT)) AND
                   YL0023 OF WORK-CONTEXT NOT > YL0071 OF WORK-CONTEXT)
                 THEN
      *            Available Count
                   MOVE '1' TO YL0079 OF WORK-CONTEXT
               ELSE
      *            CASE: *OTHERWISE
      *            Available Count
                   MOVE '0' TO YL0079 OF WORK-CONTEXT
               END-IF
           END-IF
      *    Rtv RI Sales Channel - RI Sales Channel  *
           PERFORM SA5RVGN
      *    Target Channel
      *    CASE: LCL.SEDRE Customer Type is Dealer's own
      *    *IF
           IF (YL0022 OF WORK-CONTEXT = '3') THEN
      *        Target Channel
               MOVE SPACES TO YL0083 OF WORK-CONTEXT
               MOVE 'Dealer Own' TO YL0083 OF WORK-CONTEXT
           ELSE
      *        CASE: *OTHERWISE
      *        CASE:
      *        - NOTc1 AND c2
      *        |- c1    : LCL.SEDRE Customer Type is Dealer's own
      *        |- c2    : LCL.Target Market is Retail
      *        '-
      *        *IF
               IF (NOT (YL0022 OF WORK-CONTEXT = '3') AND
                   YL0065 OF WORK-CONTEXT = 'R') THEN
      *            Target Channel
                   MOVE SPACES TO YL0083 OF WORK-CONTEXT
                   MOVE 'Dealer Own' TO YL0083 OF WORK-CONTEXT
               ELSE
      *            CASE:
      *            - c1 AND ( c2 OR c3 )
      *            |- c1    : LCL.Target Market is Motability
      *            |- c2    : LCL.SEDRE Customer Type is Motability
      *              VED exempt
      *            |- c3    : LCL.SEDRE Customer Type is Motability
      *              not VED exempt
      *            '-
      *            *IF
                   IF (YL0065 OF WORK-CONTEXT = 'W' AND
                       (YL0022 OF WORK-CONTEXT = '6' OR
                       YL0022 OF WORK-CONTEXT = '7')) THEN
      *                Target Channel
                       MOVE SPACES TO YL0083 OF WORK-CONTEXT
                       MOVE 'Motability' TO YL0083 OF WORK-CONTEXT
                   ELSE
      *                CASE:
      *                - c1 AND c2 AND c3
      *                |- c1    : LCL.Target Market is Local Fleet
      *                  Target
      *                |- c2    : LCL.SEDRE Customer Type is Fleet
      *                |- c3    : LCL.Car/Van text is Car (s)
      *                '-
      *                *IF
                       IF (YL0065 OF WORK-CONTEXT = 'L' AND
                           YL0022 OF WORK-CONTEXT = '5' AND
                           YL0016 OF WORK-CONTEXT = 'Car') THEN
      *                    Target Channel
                           MOVE SPACES TO YL0083 OF WORK-CONTEXT
                           MOVE 'Local Fleet Cars' TO YL0083 OF
                             WORK-CONTEXT
                       ELSE
      *                    CASE:
      *                    - c1 AND c2 AND c3
      *                    |- c1    : LCL.Target Market is Local Fleet
      *                      Target
      *                    |- c2    : LCL.SEDRE Customer Type is Fleet
      *                    |- c3    : LCL.Car/Van text is Van (s)
      *                    '-
      *                    *IF
                           IF (YL0065 OF WORK-CONTEXT = 'L' AND
                               YL0022 OF WORK-CONTEXT = '5' AND
                               YL0016 OF WORK-CONTEXT = 'Van') THEN
      *                        Target Channel
                               MOVE SPACES TO YL0083 OF WORK-CONTEXT
                               MOVE 'Local Fleet Vans' TO YL0083 OF
                                 WORK-CONTEXT
                           ELSE
      *                        CASE:
      *                        - c1 AND c2 AND c3
      *                        |- c1    : LCL.Target Market is Major
      *                          Fleet Target
      *                        |- c2    : LCL.SEDRE Customer Type is
      *                          Fleet
      *                        |- c3    : LCL.Car/Van text is Car (s)
      *                        '-
      *                        *IF
                               IF (YL0065 OF WORK-CONTEXT = 'M' AND
                                   YL0022 OF WORK-CONTEXT = '5' AND
                                   YL0016 OF WORK-CONTEXT = 'Car') THEN
      *                        Target Channel
                               MOVE SPACES TO YL0083 OF WORK-CONTEXT
                               MOVE 'Major Fleet Cars' TO YL0083 OF
                                 WORK-CONTEXT
                               ELSE
      *                        CASE:
      *                        - c1 AND c2 AND c3
      *                        |- c1    : LCL.Target Market is Major
      *                          Fleet Target
      *                        |- c2    : LCL.SEDRE Customer Type is
      *                          Fleet
      *                        |- c3    : LCL.Car/Van text is Van (s)
      *                        '-
      *                        *IF
                               IF (YL0065 OF WORK-CONTEXT = 'M' AND
                                   YL0022 OF WORK-CONTEXT = '5' AND
                                   YL0016 OF WORK-CONTEXT = 'Van') THEN
      *                        Target Channel
                               MOVE SPACES TO YL0083 OF WORK-CONTEXT
                               MOVE 'Major Fleet Vans' TO YL0083 OF
                                 WORK-CONTEXT
                               ELSE
      *                        CASE:
      *                        - c1 AND (c2 OR c4 )AND c3
      *                        |- c1    : LCL.Target Market is Plan B
      *                        |- c2    : LCL.Fleet Programmes Code is
      *                          DEM
      *                        |- c4    : LCL.Fleet Programmes Code is
      *                          SRG
      *                        |- c3    : LCL.Car/Van text is Van (s)
      *                        '-
      *                        *IF
                               IF (YL0065 OF WORK-CONTEXT = 'B' AND
                                   (YL0063 OF WORK-CONTEXT = 'DEM' OR
                                   YL0063 OF WORK-CONTEXT = 'SRG') AND
                                   YL0016 OF WORK-CONTEXT = 'Van') THEN
      *                        Target Channel
                               MOVE SPACES TO YL0083 OF WORK-CONTEXT
                               MOVE 'Head Office Vans' TO YL0083 OF
                                 WORK-CONTEXT
                               ELSE
      *                        CASE:
      *                        - c1 AND (c2 OR c4 )AND c3
      *                        |- c1    : LCL.Target Market is Plan B
      *                        |- c2    : LCL.Fleet Programmes Code is
      *                          DEM
      *                        |- c4    : LCL.Fleet Programmes Code is
      *                          SRG
      *                        |- c3    : LCL.Car/Van text is Car (s)
      *                        '-
      *                        *IF
                               IF (YL0065 OF WORK-CONTEXT = 'B' AND
                                   (YL0063 OF WORK-CONTEXT = 'DEM' OR
                                   YL0063 OF WORK-CONTEXT = 'SRG') AND
                                   YL0016 OF WORK-CONTEXT = 'Car') THEN
      *                        Target Channel
                               MOVE SPACES TO YL0083 OF WORK-CONTEXT
                               MOVE 'Head Office Cars' TO YL0083 OF
                                 WORK-CONTEXT
                               ELSE
      *                        CASE:
      *                        - c1 AND (NOTc2 AND NOTc4 )AND c3
      *                        |- c1    : LCL.Target Market is Plan B
      *                        |- c2    : LCL.Fleet Programmes Code is
      *                          DEM
      *                        |- c4    : LCL.Fleet Programmes Code is
      *                          SRG
      *                        |- c3    : LCL.Car/Van text is Car (s)
      *                        '-
      *                        *IF
                               IF (YL0065 OF WORK-CONTEXT = 'B' AND
                                   NOT (YL0063 OF WORK-CONTEXT = 'DEM')
                                 AND
                                   NOT (YL0063 OF WORK-CONTEXT = 'SRG')
                                 AND
                                   YL0016 OF WORK-CONTEXT = 'Car') THEN
      *                        Target Channel
                               MOVE SPACES TO YL0083 OF WORK-CONTEXT
                               MOVE 'Plan B Cars' TO YL0083 OF
                                 WORK-CONTEXT
                               ELSE
      *                        CASE:
      *                        - c1 AND (NOTc2 AND NOTc4 )AND c3
      *                        |- c1    : LCL.Target Market is Plan B
      *                        |- c2    : LCL.Fleet Programmes Code is
      *                          DEM
      *                        |- c4    : LCL.Fleet Programmes Code is
      *                          SRG
      *                        |- c3    : LCL.Car/Van text is Van (s)
      *                        '-
      *                        *IF
                               IF (YL0065 OF WORK-CONTEXT = 'B' AND
                                   NOT (YL0063 OF WORK-CONTEXT = 'DEM')
                                 AND
                                   NOT (YL0063 OF WORK-CONTEXT = 'SRG')
                                 AND
                                   YL0016 OF WORK-CONTEXT = 'Van') THEN
      *                        Target Channel
                               MOVE SPACES TO YL0083 OF WORK-CONTEXT
                               MOVE 'Plan B Vans' TO YL0083 OF
                                 WORK-CONTEXT
                               ELSE
      *                        CASE:
      *                        - c1 AND ( c2 OR c4 OR c5 OR c6 OR c7
      *                        -  ) AND c3
      *                        |- c1    : LCL.Target Market is *Not
      *                          Specified
      *                        |- c2    : LCL.SD Sales Channel Code is
      *                          5P
      *                        |- c4    : LCL.SD Sales Channel Code is
      *                          5Q
      *                        |- c5    : LCL.SD Sales Channel Code is
      *                          5R
      *                        |- c6    : LCL.SD Sales Channel Code is
      *                          5X
      *                        |- c7    : LCL.SD Sales Channel Code is
      *                          5N
      *                        |- c3    : LCL.Car/Van text is Car (s)
      *                        '-
      *                        *IF
                               IF (YL0065 OF WORK-CONTEXT = SPACES AND
                                   (YL0021 OF WORK-CONTEXT = '5P' OR
                                   YL0021 OF WORK-CONTEXT = '5Q' OR
                                   YL0021 OF WORK-CONTEXT = '5R' OR
                                   YL0021 OF WORK-CONTEXT = '5X' OR
                                   YL0021 OF WORK-CONTEXT = '5N') AND
                                   YL0016 OF WORK-CONTEXT = 'Car') THEN
      *                        Target Channel
                               MOVE SPACES TO YL0083 OF WORK-CONTEXT
                               MOVE 'Major Fleet Cars' TO YL0083 OF
                                 WORK-CONTEXT
                               ELSE
      *                        CASE:
      *                        - c1 AND ( c2 OR c4 OR c5 OR c6 OR c7
      *                        -  ) AND c3
      *                        |- c1    : LCL.Target Market is *Not
      *                          Specified
      *                        |- c2    : LCL.SD Sales Channel Code is
      *                          5P
      *                        |- c4    : LCL.SD Sales Channel Code is
      *                          5Q
      *                        |- c5    : LCL.SD Sales Channel Code is
      *                          5R
      *                        |- c6    : LCL.SD Sales Channel Code is
      *                          5X
      *                        |- c7    : LCL.SD Sales Channel Code is
      *                          5N
      *                        |- c3    : LCL.Car/Van text is Van (s)
      *                        '-
      *                        *IF
                               IF (YL0065 OF WORK-CONTEXT = SPACES AND
                                   (YL0021 OF WORK-CONTEXT = '5P' OR
                                   YL0021 OF WORK-CONTEXT = '5Q' OR
                                   YL0021 OF WORK-CONTEXT = '5R' OR
                                   YL0021 OF WORK-CONTEXT = '5X' OR
                                   YL0021 OF WORK-CONTEXT = '5N') AND
                                   YL0016 OF WORK-CONTEXT = 'Van') THEN
      *                        Target Channel
                               MOVE SPACES TO YL0083 OF WORK-CONTEXT
                               MOVE 'Major Fleet Vans' TO YL0083 OF
                                 WORK-CONTEXT
                               ELSE
      *                        CASE:
      *                        - c1 AND ( NOTc2 AND NOTc4 AND NOTc5
      *                        -  AND NOTc6 AND NOTc7 ) AND c3
      *                        |- c1    : LCL.Target Market is *Not
      *                          Specified
      *                        |- c2    : LCL.SD Sales Channel Code is
      *                          5P
      *                        |- c4    : LCL.SD Sales Channel Code is
      *                          5Q
      *                        |- c5    : LCL.SD Sales Channel Code is
      *                          5R
      *                        |- c6    : LCL.SD Sales Channel Code is
      *                          5X
      *                        |- c7    : LCL.SD Sales Channel Code is
      *                          5N
      *                        |- c3    : LCL.Car/Van text is Car (s)
      *                        '-
      *                        *IF
                               IF (YL0065 OF WORK-CONTEXT = SPACES AND
                                   NOT (YL0021 OF WORK-CONTEXT = '5P')
                                 AND
                                   NOT (YL0021 OF WORK-CONTEXT = '5Q')
                                 AND
                                   NOT (YL0021 OF WORK-CONTEXT = '5R')
                                 AND
                                   NOT (YL0021 OF WORK-CONTEXT = '5X')
                                 AND
                                   NOT (YL0021 OF WORK-CONTEXT = '5N')
                                 AND
                                   YL0016 OF WORK-CONTEXT = 'Car') THEN
      *                        Target Channel
                               MOVE SPACES TO YL0083 OF WORK-CONTEXT
                               MOVE 'Local Fleet Cars' TO YL0083 OF
                                 WORK-CONTEXT
                               ELSE
      *                        CASE:
      *                        - c1 AND ( NOTc2 AND NOTc4 AND NOTc5
      *                        -  AND NOTc6 AND NOTc7 ) AND c3
      *                        |- c1    : LCL.Target Market is *Not
      *                          Specified
      *                        |- c2    : LCL.SD Sales Channel Code is
      *                          5P
      *                        |- c4    : LCL.SD Sales Channel Code is
      *                          5Q
      *                        |- c5    : LCL.SD Sales Channel Code is
      *                          5R
      *                        |- c6    : LCL.SD Sales Channel Code is
      *                          5X
      *                        |- c7    : LCL.SD Sales Channel Code is
      *                          5N
      *                        |- c3    : LCL.Car/Van text is Van (s)
      *                        '-
      *                        *IF
                               IF (YL0065 OF WORK-CONTEXT = SPACES AND
                                   NOT (YL0021 OF WORK-CONTEXT = '5P')
                                 AND
                                   NOT (YL0021 OF WORK-CONTEXT = '5Q')
                                 AND
                                   NOT (YL0021 OF WORK-CONTEXT = '5R')
                                 AND
                                   NOT (YL0021 OF WORK-CONTEXT = '5X')
                                 AND
                                   NOT (YL0021 OF WORK-CONTEXT = '5N')
                                 AND
                                   YL0016 OF WORK-CONTEXT = 'Van') THEN
      *                        Target Channel
                               MOVE SPACES TO YL0083 OF WORK-CONTEXT
                               MOVE 'Local Fleet Vans' TO YL0083 OF
                                 WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
                   END-IF
               END-IF
           END-IF
           MOVE YL0056 OF WORK-CONTEXT TO YL0084 OF WORK-CONTEXT
      *    Rtv RI Dealer Status - RI Dealer Status  *
           PERFORM SA6RVGN
      *    AMF Code
      *    CASE:
      *    - NOTc1
      *    |- c1    : PAR.Customer Order Date # is GE 20190101
      *    '-
      *    *IF
           IF (NOT (P1CUSORDD8 NOT < 20190101)) THEN
      *        AMF Code
               MOVE SPACES TO YL0085 OF WORK-CONTEXT
           END-IF
      *    Rtv - V55 Emissions Controls  *
           PERFORM SA7RVGN
      *    Cvt DD/MM/YYYY to D8# - #Date Functions  *
     E* Y2V3114 - Source member UDTCMDDT8S not found.
      *    U:Number (2.0)
           MOVE ZEROS TO YL0090 OF WORK-CONTEXT
      *    Find string in strng VRY - #String Functions  *
     E* Y2V3114 - Source member UTFNDSTRVS not found.
      *    Core Fleet Dealer Ind
      *    CASE:
      *    - c1 AND c2
      *    |- c1    : PAR.Customer Order Date # GE LCL.U:Effective date
      *    |- c2    : LCL.U:Number (2.0) is not zero
      *    '-
      *    *IF
           IF (P1CUSORDD8 NOT < YL0089 OF WORK-CONTEXT AND
               YL0090 OF WORK-CONTEXT NOT = 0) THEN
      *        Core Fleet Dealer Ind
               MOVE 'Y' TO YL0091 OF WORK-CONTEXT
           ELSE
      *        CASE: *OTHERWISE
      *        Core Fleet Dealer Ind
               MOVE SPACES TO YL0091 OF WORK-CONTEXT
           END-IF
      *    ************************* output
      *      *****************************************
      *    * Create export Vehice Data
      *    Create RI Vehicle Detail - RI Vehicle Detail  *
           PERFORM SA8CRRC
      *    * Create export Model version
      *    Crt export model ver - RI Model Version  *
           PERFORM SB1RVGN
      *--------------------------------------------------------------
      *    Exit program
           CONTINUE.
       AAEXIT.
           MOVE SPACES TO P0RTN
           PERFORM ZYEXPG
      *==============================================================
      /EJECT
       SA1RVGN SECTION.
      *==============================================================
      *    Rtv Veh Mdl Ver - Vehicle Model Version  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    SCP Model Code
           MOVE P1SCMDLCDE TO COSCMDLCDE OF KRSSA1
      *    Model Phase
           MOVE P1O2ST TO COPHASE OF KRSSA1
      *    SCP Model Version Code
           MOVE P1SCVERCDE TO COSCVERCDE OF KRSSA1
      *    Initialise Full Externally Described Keylist
      *    SCP Model Code
           MOVE LOW-VALUES TO COSCMDLCDE OF EXTSA1
      *    Model Phase
           MOVE LOW-VALUES TO COPHASE OF EXTSA1
      *    SCP Model Version Code
           MOVE LOW-VALUES TO COSCVERCDE OF EXTSA1
           MOVE CORRESPONDING
             KRSSA1 TO
             VAMDLVERF1 OF VAMDLVERL1-R
           SET C-INDICATOR-OFF(90) TO TRUE
           READ VAMDLVERL1
             FORMAT IS 'VAMDLVERF1'
           END-READ
           IF (C-NO-RECORD) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               END-IF
           END-IF
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR6172' TO W0RTN
      *        USER: Processing if Data record not found
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
      *        PAR = CON By name
      *        Vehicle Body Class Code
               MOVE SPACES TO YL0017 OF WORK-CONTEXT
               GO SA1EXIT
           END-IF
      *
           IF (C-INDICATOR-OFF(90)) THEN
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Vehicle Body Class Code
               MOVE COBCBDYCLS OF VAMDLVERF1 OF VAMDLVERL1-R TO YL0017
                 OF WORK-CONTEXT
           END-IF
      *==============================================================
           CONTINUE.
       SA1EXIT.
           EXIT.
      /EJECT
       SA2RVGN SECTION.
      *==============================================================
      *    Rtv by Customer Ord Numbr - Customer Order  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    Owning Account
           MOVE P1OWNACC TO C5OWNACC OF KRSSA2
      *    Customer Ord Number
           MOVE P1CUSORDNB TO C5CUSORDNB OF KRSSA2
      *    Initialise Full Externally Described Keylist
      *    Owning Account
           MOVE LOW-VALUES TO C5OWNACC OF EXTSA2
      *    Customer Ord Number
           MOVE LOW-VALUES TO C5CUSORDNB OF EXTSA2
           MOVE CORRESPONDING
             KRSSA2 TO
             COORDDTAF1 OF COORDDTAL1-R
           SET C-INDICATOR-OFF(90) TO TRUE
           READ COORDDTAL1
             FORMAT IS 'COORDDTAF1'
           END-READ
           IF (C-NO-RECORD) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               END-IF
           END-IF
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR6221' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Secondary Network Account
               MOVE SPACES TO YL0020 OF WORK-CONTEXT
      *        SD Sales Channel Code
               MOVE SPACES TO YL0021 OF WORK-CONTEXT
      *        SEDRE Customer Type
               MOVE SPACES TO YL0022 OF WORK-CONTEXT
      *        Cust Desired Delivery Dte
               MOVE ZEROS TO YL0023 OF WORK-CONTEXT
      *        Order Cancellation Reason
               MOVE SPACES TO YL0024 OF WORK-CONTEXT
      *        Salesperson Code
               MOVE SPACES TO YL0025 OF WORK-CONTEXT
      *        Surname/Company name
               MOVE SPACES TO YL0026 OF WORK-CONTEXT
      *        FM Agreement Number (FON)
               MOVE SPACES TO YL0027 OF WORK-CONTEXT
      *        FM Agreement Version Nbr
               MOVE SPACES TO YL0028 OF WORK-CONTEXT
      *        Cust Ord Exists
               MOVE '0' TO YN0115 OF WORK-CONTEXT
               GO SA2EXIT
           END-IF
      *
           IF (C-INDICATOR-OFF(90)) THEN
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Secondary Network Account
               MOVE C5SECACC OF COORDDTAF1 OF COORDDTAL1-R TO YL0020 OF
                 WORK-CONTEXT
      *        SD Sales Channel Code
               MOVE C5SDSCHNCD OF COORDDTAF1 OF COORDDTAL1-R TO YL0021
                 OF WORK-CONTEXT
      *        SEDRE Customer Type
               MOVE C5TCCSTTYP OF COORDDTAF1 OF COORDDTAL1-R TO YL0022
                 OF WORK-CONTEXT
      *        Cust Desired Delivery Dte
               MOVE C5CUSDDDT OF COORDDTAF1 OF COORDDTAL1-R TO YL0023
                 OF WORK-CONTEXT
      *        Order Cancellation Reason
               MOVE C5ORDCANRS OF COORDDTAF1 OF COORDDTAL1-R TO YL0024
                 OF WORK-CONTEXT
      *        Salesperson Code
               MOVE C5SLPERCDE OF COORDDTAF1 OF COORDDTAL1-R TO YL0025
                 OF WORK-CONTEXT
      *        Surname/Company name
               MOVE C5CUSNAM OF COORDDTAF1 OF COORDDTAL1-R TO YL0026 OF
                 WORK-CONTEXT
      *        FM Agreement Number (FON)
               MOVE C5FMAGRNBR OF COORDDTAF1 OF COORDDTAL1-R TO YL0027
                 OF WORK-CONTEXT
      *        FM Agreement Version Nbr
               MOVE C5FMAGRVSN OF COORDDTAF1 OF COORDDTAL1-R TO YL0028
                 OF WORK-CONTEXT
      *        Cust Ord Exists
               MOVE '1' TO YN0115 OF WORK-CONTEXT
           END-IF
      *==============================================================
           CONTINUE.
       SA2EXIT.
           EXIT.
      /EJECT
       SA3RVGN SECTION.
      *==============================================================
      *    Rtv All Dtl by Dlr/Mdl/ON - OBT Extract  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    Dealer number (Num key)
           MOVE YL0056 OF WORK-CONTEXT TO Q2DLRNOKEY OF KRSSA3
      *    BDC Model
           MOVE P1SCMDLCDE TO Q2BDCM OF KRSSA3
      *    BDC Customer Order Number
           MOVE P1CUSORDNB TO Q2BDCCON OF KRSSA3
      *    Initialise Full Externally Described Keylist
      *    Dealer number (Num key)
           MOVE -99999 TO Q2DLRNOKEY OF EXTSA3
      *    BDC Model
           MOVE LOW-VALUES TO Q2BDCM OF EXTSA3
      *    BDC Customer Order Number
           MOVE LOW-VALUES TO Q2BDCCON OF EXTSA3
           MOVE CORRESPONDING
             EXTSA3 TO
             FOBEXCB OF RAOBEXTRL2-R
           MOVE CORRESPONDING
             KRSSA3 TO
             FOBEXCB OF RAOBEXTRL2-R
           START RAOBEXTRL2 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'FOBEXCB'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ RAOBEXTRL2 NEXT
             FORMAT IS 'FOBEXCB'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     FOBEXCB OF RAOBEXTRL2-R TO
                     EXTSA3
                   MOVE EXTSA3 TO KRSSA3-TMP
                   IF (KRSSA3 NOT = KRSSA3-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    Dealer number (Num key)
           MOVE -99999 TO Q2DLRNOKEY OF EXTSA3
      *    BDC Model
           MOVE LOW-VALUES TO Q2BDCM OF EXTSA3
      *    BDC Customer Order Number
           MOVE LOW-VALUES TO Q2BDCCON OF EXTSA3
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR5706' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Network/Non Network Ind
               MOVE SPACES TO YL0057 OF WORK-CONTEXT
      *        Fleet Report Group Code
               MOVE SPACES TO YL0058 OF WORK-CONTEXT
      *        Fleet Report Group Plan
               MOVE SPACES TO YL0059 OF WORK-CONTEXT
      *        BDC Payment Method
               MOVE SPACES TO YL0060 OF WORK-CONTEXT
      *        BDC Payment Term
               MOVE SPACES TO YL0061 OF WORK-CONTEXT
      *        OBT Count Target Status
               MOVE SPACES TO YL0062 OF WORK-CONTEXT
      *        Fleet Programmes Code
               MOVE SPACES TO YL0063 OF WORK-CONTEXT
      *        Fleet Programmes Desc
               MOVE SPACES TO YL0064 OF WORK-CONTEXT
      *        Target Market
               MOVE SPACES TO YL0065 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SA3EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Network/Non Network Ind
               MOVE Q2NETIND OF FOBEXCB OF RAOBEXTRL2-R TO YL0057 OF
                 WORK-CONTEXT
      *        Fleet Report Group Code
               MOVE Q2RPGPCD OF FOBEXCB OF RAOBEXTRL2-R TO YL0058 OF
                 WORK-CONTEXT
      *        Fleet Report Group Plan
               MOVE Q2RPGPPLN OF FOBEXCB OF RAOBEXTRL2-R TO YL0059 OF
                 WORK-CONTEXT
      *        BDC Payment Method
               MOVE Q2BDCPMT OF FOBEXCB OF RAOBEXTRL2-R TO YL0060 OF
                 WORK-CONTEXT
      *        BDC Payment Term
               MOVE Q2BDCPTRM OF FOBEXCB OF RAOBEXTRL2-R TO YL0061 OF
                 WORK-CONTEXT
      *        OBT Count Target Status
               MOVE Q2CNTTARG OF FOBEXCB OF RAOBEXTRL2-R TO YL0062 OF
                 WORK-CONTEXT
      *        Fleet Programmes Code
               MOVE Q2FLPGMCDE OF FOBEXCB OF RAOBEXTRL2-R TO YL0063 OF
                 WORK-CONTEXT
      *        Fleet Programmes Desc
               MOVE Q2FLPGMDSC OF FOBEXCB OF RAOBEXTRL2-R TO YL0064 OF
                 WORK-CONTEXT
      *        Target Market
               MOVE Q2TGTMRKET OF FOBEXCB OF RAOBEXTRL2-R TO YL0065 OF
                 WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
      *        *QUIT
               GO SA3EXIT
               SET C-INDICATOR-OFF(90) TO TRUE
               READ RAOBEXTRL2 NEXT
                 FORMAT IS 'FOBEXCB'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         FOBEXCB OF RAOBEXTRL2-R TO
                         EXTSA3
                       MOVE EXTSA3 TO KRSSA3-TMP
                       IF (KRSSA3 NOT = KRSSA3-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        Dealer number (Num key)
               MOVE -99999 TO Q2DLRNOKEY OF EXTSA3
      *        BDC Model
               MOVE LOW-VALUES TO Q2BDCM OF EXTSA3
      *        BDC Customer Order Number
               MOVE LOW-VALUES TO Q2BDCCON OF EXTSA3
           END-PERFORM
      *==============================================================
           CONTINUE.
       SA3EXIT.
           EXIT.
      /EJECT
       SA4RVGN SECTION.
      *==============================================================
      *    Rtv All Dealer Details - Dealer  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    Dealer Number
           MOVE YL0066 OF WORK-CONTEXT TO ABDLRNBR OF KRSSA4
      *    Dealer Number Suffix
           MOVE YL0068 OF WORK-CONTEXT TO ABDLRSFX OF KRSSA4
      *    Initialise Full Externally Described Keylist
      *    Dealer Number
           MOVE LOW-VALUES TO ABDLRNBR OF EXTSA4
      *    Dealer Number Suffix
           MOVE LOW-VALUES TO ABDLRSFX OF EXTSA4
           MOVE CORRESPONDING
             KRSSA4 TO
             FABCPAX OF DIDLRDTAL2-R
           SET C-INDICATOR-OFF(90) TO TRUE
           READ DIDLRDTAL2
             FORMAT IS 'FABCPAX'
           END-READ
           IF (C-NO-RECORD) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               END-IF
           END-IF
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR0003' TO W0RTN
      *        USER: Processing if Data record not found
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
      *        PAR = CON By name
      *        Dealer Network Type
               MOVE SPACES TO YL0069 OF WORK-CONTEXT
               GO SA4EXIT
           END-IF
      *
           IF (C-INDICATOR-OFF(90)) THEN
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Dealer Network Type
               MOVE ABDLRNET OF FABCPAX OF DIDLRDTAL2-R TO YL0069 OF
                 WORK-CONTEXT
           END-IF
      *==============================================================
           CONTINUE.
       SA4EXIT.
           EXIT.
      /EJECT
       SA5RVGN SECTION.
      *==============================================================
      *    Rtv RI Sales Channel - RI Sales Channel  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    Sales Channel Code
           MOVE YL0021 OF WORK-CONTEXT TO DASDSCHN OF KRSSA5
      *    Initialise Full Externally Described Keylist
      *    Sales Channel Code
           MOVE LOW-VALUES TO DASDSCHN OF EXTSA5
           MOVE CORRESPONDING
             KRSSA5 TO
             FC00STG OF RIC00SALL1-R
           SET C-INDICATOR-OFF(90) TO TRUE
           READ RIC00SALL1
             FORMAT IS 'FC00STG'
           END-READ
           IF (C-NO-RECORD) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               END-IF
           END-IF
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR7983' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Sales Channel Desc
               MOVE SPACES TO YL0080 OF WORK-CONTEXT
      *        MVRIS Channel
               MOVE SPACES TO YL0081 OF WORK-CONTEXT
      *        PM Channel
               MOVE SPACES TO YL0082 OF WORK-CONTEXT
               GO SA5EXIT
           END-IF
      *
           IF (C-INDICATOR-OFF(90)) THEN
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Sales Channel Desc
               MOVE DASALDESC OF FC00STG OF RIC00SALL1-R TO YL0080 OF
                 WORK-CONTEXT
      *        MVRIS Channel
               MOVE DAMVRICH OF FC00STG OF RIC00SALL1-R TO YL0081 OF
                 WORK-CONTEXT
      *        PM Channel
               MOVE DAPMCHAN OF FC00STG OF RIC00SALL1-R TO YL0082 OF
                 WORK-CONTEXT
           END-IF
      *==============================================================
           CONTINUE.
       SA5EXIT.
           EXIT.
      /EJECT
       SA6RVGN SECTION.
      *==============================================================
      *    Rtv RI Dealer Status - RI Dealer Status  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    Dealer Number Code (5)
           MOVE YL0084 OF WORK-CONTEXT TO DBBDCO OF KRSSA6
      *    Initialise Full Externally Described Keylist
      *    Dealer Number Code (5)
           MOVE LOW-VALUES TO DBBDCO OF EXTSA6
           MOVE CORRESPONDING
             KRSSA6 TO
             FC00DTD OF RIC00DELL1-R
           SET C-INDICATOR-OFF(90) TO TRUE
           READ RIC00DELL1
             FORMAT IS 'FC00DTD'
           END-READ
           IF (C-NO-RECORD) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               END-IF
           END-IF
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR7985' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        AMF Code
               MOVE SPACES TO YL0085 OF WORK-CONTEXT
      *        Dealer Status
               MOVE SPACES TO YL0086 OF WORK-CONTEXT
      *        Effective Date (/)
               MOVE SPACES TO YL0087 OF WORK-CONTEXT
               GO SA6EXIT
           END-IF
      *
           IF (C-INDICATOR-OFF(90)) THEN
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        AMF Code
               MOVE DBAMF OF FC00DTD OF RIC00DELL1-R TO YL0085 OF
                 WORK-CONTEXT
      *        Dealer Status
               MOVE DBTVTE OF FC00DTD OF RIC00DELL1-R TO YL0086 OF
                 WORK-CONTEXT
      *        Effective Date (/)
               MOVE DBINC1 OF FC00DTD OF RIC00DELL1-R TO YL0087 OF
                 WORK-CONTEXT
           END-IF
      *==============================================================
           CONTINUE.
       SA6EXIT.
           EXIT.
      /EJECT
       SA7RVGN SECTION.
      *==============================================================
      *    Rtv - V55 Emissions Controls  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    Emissions C.O.C. Version
           MOVE P1NUMRECPT TO BWEMCOCVER OF KRSSA7
      *    Emissions C.O.C. Approv.
           MOVE P1TVV TO BWEMCOCAPV OF KRSSA7
      *    Initialise Full Externally Described Keylist
      *    Emissions C.O.C. Version
           MOVE LOW-VALUES TO BWEMCOCVER OF EXTSA7
      *    Emissions C.O.C. Approv.
           MOVE LOW-VALUES TO BWEMCOCAPV OF EXTSA7
           MOVE CORRESPONDING
             KRSSA7 TO
             RAV55EMFF1 OF RAV55EMFL1-R
           SET C-INDICATOR-OFF(90) TO TRUE
           READ RAV55EMFL1
             FORMAT IS 'RAV55EMFF1'
           END-READ
           IF (C-NO-RECORD) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               END-IF
           END-IF
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR5455' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        CO2 g/km
               MOVE ZEROS TO YL0088 OF WORK-CONTEXT
               GO SA7EXIT
           END-IF
      *
           IF (C-INDICATOR-OFF(90)) THEN
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        CO2 g/km
               MOVE BWCO2X OF RAV55EMFF1 OF RAV55EMFL1-R TO YL0088 OF
                 WORK-CONTEXT
           END-IF
      *==============================================================
           CONTINUE.
       SA7EXIT.
           EXIT.
      /EJECT
       SA8CRRC SECTION.
      *==============================================================
      *    Create RI Vehicle Detail - RI Vehicle Detail  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *
      *    Move all fields to FC00VS3
      *    VIN
           MOVE P1VIN TO C7VIN OF RIC00VEHL0-R
      *    SCP Model Code (ATR)
           MOVE P1SCMDLCDE TO C7SCPMDLC OF RIC00VEHL0-R
      *    SCP Model Version Code
           MOVE P1SCVERCDE TO C7SCVERCDE OF RIC00VEHL0-R
      *    SCR Model Code
           MOVE P1SCRMDL TO C7SCRMDL OF RIC00VEHL0-R
      *    SCR Model Version Code(A)
           MOVE P1EUTT TO C7SCRVERC OF RIC00VEHL0-R
      *    Model Phase
           MOVE P1O2ST TO C7PHASE OF RIC00VEHL0-R
      *    Customer Ord Number
           MOVE P1CUSORDNB TO C7CUSORDNB OF RIC00VEHL0-R
      *    Owning Account
           MOVE P1OWNACC TO C7OWNACC OF RIC00VEHL0-R
      *    Delivery Account (A)
           MOVE P1DLVACC TO C7DELACA OF RIC00VEHL0-R
      *    Secondary Network Account
           MOVE YL0020 OF WORK-CONTEXT TO C7SECACC OF RIC00VEHL0-R
      *    Brand Name Display
           MOVE YL0055 OF WORK-CONTEXT TO C7BRANDSP OF RIC00VEHL0-R
      *    Brand Code (6)
           MOVE P1SEDAPLCD TO C7C8C1 OF RIC00VEHL0-R
      *    Build Day
           MOVE P1BLDDAY TO C7BLDDAY OF RIC00VEHL0-R
      *    Build Week
           MOVE YL0001 OF WORK-CONTEXT TO C7H6C1 OF RIC00VEHL0-R
      *    Build Year (A)
           MOVE YL0002 OF WORK-CONTEXT TO C7BLDYR OF RIC00VEHL0-R
      *    Date 07 TCM
           MOVE P1TCMDT07 TO C7DATE08 OF RIC00VEHL0-R
      *    Date 20 Vehicle ship
           MOVE P1SHPDT20 TO C7DATE20 OF RIC00VEHL0-R
      *    Date 28 Arrival at Dock
           MOVE P1DOCDT28 TO C7DATE28 OF RIC00VEHL0-R
      *    Date 32 At Import Centre
           MOVE P1ENTIMP32 TO C7DATE32 OF RIC00VEHL0-R
      *    Date 34 Out of Repair
           MOVE P1BLENDT34 TO C7DATE34 OF RIC00VEHL0-R
      *    Date 33 Into Repair
           MOVE P1BLSTDT33 TO C7DATE33 OF RIC00VEHL0-R
      *    Date 42 Dealer Invoiced
           MOVE P1DLRINV42 TO C7DATE42 OF RIC00VEHL0-R
      *    Date 45 Exit Import Ctr
           MOVE P1EXICDT45 TO C7DATE45 OF RIC00VEHL0-R
      *    Date 53 Requested AAD
           MOVE P1RAADDT53 TO C7DATE53 OF RIC00VEHL0-R
      *    Date 58 Registration
           MOVE P1REGDT58 TO C7DATE58 OF RIC00VEHL0-R
      *    Registration number
           MOVE P1GNOX TO C7GNOX OF RIC00VEHL0-R
      *    Reg Count
           MOVE YL0013 OF WORK-CONTEXT TO C7REGCOUNT OF RIC00VEHL0-R
      *    De-Reg Date
           MOVE YL0006 OF WORK-CONTEXT TO C7DEREGDAT OF RIC00VEHL0-R
      *    Planned Arrival UK DATE
           MOVE WUARDATE OF WORK-CONTEXT TO C7ARDATE OF RIC00VEHL0-R
      *    AAD Promise Date (A)
           MOVE P1AADPRMDT TO C7AADPDATE OF RIC00VEHL0-R
      *    DDD Forecast Date
           MOVE P1DDDFCST TO C7DDDFDATE OF RIC00VEHL0-R
      *    DDD Requested Date
           MOVE P1DDDREQ TO C7DDDRDATE OF RIC00VEHL0-R
      *    Planned Arrival in UK 2
           MOVE WUPLADATE2 OF WORK-CONTEXT TO C7PLADATE2 OF RIC00VEHL0-R
      *    Veh AAD Actual Date
           MOVE P1AADACTDT TO C7VAACDATE OF RIC00VEHL0-R
      *    Veh AAD Planned Date (A)
           MOVE P1AADPLN TO C7VAADDATE OF RIC00VEHL0-R
      *    Veh ARC Planned Date (A)
           MOVE P1ARCPLN TO C7VARCDATE OF RIC00VEHL0-R
      *    Deliverable Period YYYYMM
           MOVE YL0008 OF WORK-CONTEXT TO C7DELPER OF RIC00VEHL0-R
      *    Customer Order Date(char)
           MOVE YL0003 OF WORK-CONTEXT TO C7CUSORDDA OF RIC00VEHL0-R
      *    Order Period YYYYMM
           MOVE YL0009 OF WORK-CONTEXT TO C7ORPER OF RIC00VEHL0-R
      *    Order Month
           MOVE YL0010 OF WORK-CONTEXT TO C7ORMOUNT OF RIC00VEHL0-R
      *    Order Count
           MOVE YL0014 OF WORK-CONTEXT TO C7ORCOUT OF RIC00VEHL0-R
      *    Order Business Day
           MOVE WUORBUSDAY OF WORK-CONTEXT TO C7ORBUSDAY OF RIC00VEHL0-R
      *    Order Cancelled Date Zon
           MOVE P1DLORDCND TO C7B8NM OF RIC00VEHL0-R
      *    Cancelled Period YYYYMM
           MOVE YL0011 OF WORK-CONTEXT TO C7CANPER OF RIC00VEHL0-R
      *    Cancellation count
           MOVE YL0015 OF WORK-CONTEXT TO C7CANCOUNT OF RIC00VEHL0-R
      *    Order Cancellation desti
           MOVE YL0029 OF WORK-CONTEXT TO C7TUTE OF RIC00VEHL0-R
      *    Order Cancellation Reason
           MOVE YL0024 OF WORK-CONTEXT TO C7ORDCANRS OF RIC00VEHL0-R
      *    Customer Delivery Date(a)
           MOVE YL0030 OF WORK-CONTEXT TO C7CUDDDAT OF RIC00VEHL0-R
      *    CDD M Ind
           MOVE YL0044 OF WORK-CONTEXT TO C7RKNU OF RIC00VEHL0-R
      *    CDD Period YYYYMM
           MOVE YL0031 OF WORK-CONTEXT TO C7CDDPER OF RIC00VEHL0-R
      *    Arrival Date
           MOVE YL0045 OF WORK-CONTEXT TO C7DATEARIV OF RIC00VEHL0-R
      *    Arrival Period YYYYMM
           MOVE YL0049 OF WORK-CONTEXT TO C7ARPERI OF RIC00VEHL0-R
      *    Pull Forward M+1
           MOVE YL0075 OF WORK-CONTEXT TO C7PFM1 OF RIC00VEHL0-R
      *    Pull Forward M+2
           MOVE YL0076 OF WORK-CONTEXT TO C7PFM2 OF RIC00VEHL0-R
      *    Pull Forward M+3
           MOVE YL0077 OF WORK-CONTEXT TO C7PFM3 OF RIC00VEHL0-R
      *    Pull Forward M+4
           MOVE YL0078 OF WORK-CONTEXT TO C7PFM4 OF RIC00VEHL0-R
      *    Available Count
           MOVE YL0079 OF WORK-CONTEXT TO C7AVCOU OF RIC00VEHL0-R
      *    AMF Code
           MOVE YL0085 OF WORK-CONTEXT TO C7AMF OF RIC00VEHL0-R
      *    Core Fleet Dealer Ind
           MOVE YL0091 OF WORK-CONTEXT TO C7COFLDE OF RIC00VEHL0-R
      *    Vehicle Order Type (a)
           MOVE P1ORDTYPCD TO C7VEHORTYP OF RIC00VEHL0-R
      *    Sales Channel Code
           MOVE YL0021 OF WORK-CONTEXT TO C7SDSCHN OF RIC00VEHL0-R
      *    Sales Channel Desc
           MOVE YL0080 OF WORK-CONTEXT TO C7SALDESC OF RIC00VEHL0-R
      *    PM Channel
           MOVE YL0082 OF WORK-CONTEXT TO C7PMCHAN OF RIC00VEHL0-R
      *    MVRIS Channel
           MOVE YL0081 OF WORK-CONTEXT TO C7MVRICH OF RIC00VEHL0-R
      *    Fleet Channel
           MOVE YL0050 OF WORK-CONTEXT TO C7FLTCH OF RIC00VEHL0-R
      *    Target Channel
           MOVE YL0083 OF WORK-CONTEXT TO C7TARGCH OF RIC00VEHL0-R
      *    Agreement number
           MOVE YL0027 OF WORK-CONTEXT TO C7B2AGRNUM OF RIC00VEHL0-R
      *    Agreement Version Nbr
           MOVE YL0028 OF WORK-CONTEXT TO C7AGRVSNNB OF RIC00VEHL0-R
      *    FON
           MOVE WUFON OF WORK-CONTEXT TO C7FON OF RIC00VEHL0-R
      *    Conversion Count
           MOVE YL0070 OF WORK-CONTEXT TO C7CONCOUT OF RIC00VEHL0-R
      *    On Block
           MOVE YL0018 OF WORK-CONTEXT TO C7ONBLCK OF RIC00VEHL0-R
      *    Veh Commercial Block (A)
           MOVE P1VBLKCOM TO C7VBLKCO OF RIC00VEHL0-R
      *    Veh Financial Block (A)
           MOVE P1VBLKFIN TO C7VBLKFI OF RIC00VEHL0-R
      *    Veh Quality/CAT Block (A)
           MOVE P1VBLKQLT TO C7VBLKQL OF RIC00VEHL0-R
      *    BDC Payment Method
           MOVE YL0060 OF WORK-CONTEXT TO C7BDCPMT OF RIC00VEHL0-R
      *    BDC Payment Term
           MOVE YL0061 OF WORK-CONTEXT TO C7BDCPTRM OF RIC00VEHL0-R
      *    Fleet Programmes Code (A)
           MOVE YL0063 OF WORK-CONTEXT TO C7FLPGM OF RIC00VEHL0-R
      *    Fleet Programmes Desc
           MOVE YL0064 OF WORK-CONTEXT TO C7FLPGMDSC OF RIC00VEHL0-R
      *    Fleet Report Group Plan
           MOVE YL0059 OF WORK-CONTEXT TO C7RPGPPLN OF RIC00VEHL0-R
      *    Report Group Code (A)
           MOVE YL0058 OF WORK-CONTEXT TO C7RGPCD OF RIC00VEHL0-R
      *    OBT Count Target Status
           MOVE YL0062 OF WORK-CONTEXT TO C7CNTTARG OF RIC00VEHL0-R
      *    Target Market
           MOVE YL0065 OF WORK-CONTEXT TO C7TGTMRKET OF RIC00VEHL0-R
      *    Chassis Situation
           MOVE YL0019 OF WORK-CONTEXT TO C7CHASSTS OF RIC00VEHL0-R
      *    CO2 g/km
           MOVE YL0088 OF WORK-CONTEXT TO C7CO2X OF RIC00VEHL0-R
      *    Network/Non Network Ind
           MOVE YL0057 OF WORK-CONTEXT TO C7NETIND OF RIC00VEHL0-R
      *    Surname/Company name
           MOVE YL0026 OF WORK-CONTEXT TO C7CUSNAM OF RIC00VEHL0-R
      *    Salesperson Code
           MOVE YL0025 OF WORK-CONTEXT TO C7SLPERCDE OF RIC00VEHL0-R
      *    Extract date  (8)
           MOVE YL0005 OF WORK-CONTEXT TO C7EXDATE8 OF RIC00VEHL0-R
      *    Extraction Type
           MOVE YL0012 OF WORK-CONTEXT TO C7SSSU OF RIC00VEHL0-R
      *    Check for duplicate primary key
           START RIC00VEHL0 KEY = EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'FC00VS3'
           END-START
           IF (NOT C-NO-RECORD) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               SET C-INDICATOR-OFF(90) TO TRUE
           END-IF
           IF (C-INDICATOR-ON(90)) THEN
               MOVE 'USR7978' TO W0RTN
      *        USER: Processing if Data record already exists
     W* Y2W0053 - One or more arguments defaulted to available contexts
      *        Field '(DB1) C7CO2X OF FC00VS3 OF RIC0' defaulted for
      *          'CO2 g/km'.
      *        Change RI Vehicle Detail - RI Vehicle Detail  *
               PERFORM SA9CHRC
               GO SA8EXIT
           END-IF
      *
           WRITE RIC00VEHL0-R END-WRITE
           IF (C-IO-ERR) THEN
               SET C-INDICATOR-ON(91) TO TRUE
           ELSE
               SET C-INDICATOR-OFF(91) TO TRUE
           END-IF
      *
           IF (C-INDICATOR-ON(91)) THEN
      *        Write error detected
               MOVE 'Y2U0004' TO W0RTN
           ELSE
      *        DBF write successful
               CONTINUE
           END-IF
      *==============================================================
           CONTINUE.
       SA8EXIT.
           EXIT.
      /EJECT
       SA9CHRC SECTION.
      *==============================================================
      *    Change RI Vehicle Detail - RI Vehicle Detail  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Move key fields to FC00VS3
      *    VIN
           MOVE C7VIN OF FC00VS3 OF RIC00VEHL0-R TO C7VIN OF
             RIC00VEHL0-R
      *
           READ RIC00VEHL0 END-READ
           IF (C-NO-RECORD) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               SET C-INDICATOR-OFF(90) TO TRUE
           END-IF
           IF (C-IO-ERR OR
               C-RECORD-LOCKED) THEN
               SET C-INDICATOR-ON(91) TO TRUE
           ELSE
               SET C-INDICATOR-OFF(91) TO TRUE
           END-IF
      *
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'Y2U0009' TO W0RTN
               MOVE ZZPGM  OF JOB-CONTEXT TO MDPGM OF MD0009
               MOVE 'RIC00VEHL0' TO MDACP OF MD0009
               MOVE 'FC00VS3' TO MDFMT OF MD0009
               MOVE '*CHG' TO MDACT OF MD0009
      *        Record not found label: LBL001.
               MOVE 'LBL001' TO MDLBL OF MD0009
      *        Send message '*Record no longer on file'
      *        Message ID
               MOVE 'Y2U0009' TO ZAMSID
      *        Message file
               MOVE 'Y2USRMSG' TO ZAMSGF
      *        Message data
               MOVE MD0009 TO ZAMSDA
               PERFORM ZASNMS
               MOVE SPACES TO MD0009
               GO SA9EXIT
           END-IF
      *
           IF (C-INDICATOR-ON(91)) THEN
      *        Record locked
               MOVE 'Y2U0004' TO W0RTN
      *        Send message '*Database operation error'
      *        Message ID
               MOVE 'Y2U0004' TO ZAMSID
      *        Message file
               MOVE 'Y2USRMSG' TO ZAMSGF
               PERFORM ZASNMS
               GO SA9EXIT
           END-IF
      *
      *    Move all fields to FC00VS3
      *    SCP Model Code (ATR)
           MOVE P1SCMDLCDE TO C7SCPMDLC OF RIC00VEHL0-R
      *    SCP Model Version Code
           MOVE P1SCVERCDE TO C7SCVERCDE OF RIC00VEHL0-R
      *    SCR Model Code
           MOVE P1SCRMDL TO C7SCRMDL OF RIC00VEHL0-R
      *    SCR Model Version Code(A)
           MOVE P1EUTT TO C7SCRVERC OF RIC00VEHL0-R
      *    Model Phase
           MOVE P1O2ST TO C7PHASE OF RIC00VEHL0-R
      *    Customer Ord Number
           MOVE P1CUSORDNB TO C7CUSORDNB OF RIC00VEHL0-R
      *    Owning Account
           MOVE P1OWNACC TO C7OWNACC OF RIC00VEHL0-R
      *    Delivery Account (A)
           MOVE P1DLVACC TO C7DELACA OF RIC00VEHL0-R
      *    Secondary Network Account
           MOVE YL0020 OF WORK-CONTEXT TO C7SECACC OF RIC00VEHL0-R
      *    Brand Name Display
           MOVE YL0055 OF WORK-CONTEXT TO C7BRANDSP OF RIC00VEHL0-R
      *    Brand Code (6)
           MOVE P1SEDAPLCD TO C7C8C1 OF RIC00VEHL0-R
      *    Build Day
           MOVE P1BLDDAY TO C7BLDDAY OF RIC00VEHL0-R
      *    Build Week
           MOVE YL0001 OF WORK-CONTEXT TO C7H6C1 OF RIC00VEHL0-R
      *    Build Year (A)
           MOVE YL0002 OF WORK-CONTEXT TO C7BLDYR OF RIC00VEHL0-R
      *    Date 07 TCM
           MOVE P1TCMDT07 TO C7DATE08 OF RIC00VEHL0-R
      *    Date 20 Vehicle ship
           MOVE P1SHPDT20 TO C7DATE20 OF RIC00VEHL0-R
      *    Date 28 Arrival at Dock
           MOVE P1DOCDT28 TO C7DATE28 OF RIC00VEHL0-R
      *    Date 32 At Import Centre
           MOVE P1ENTIMP32 TO C7DATE32 OF RIC00VEHL0-R
      *    Date 34 Out of Repair
           MOVE P1BLENDT34 TO C7DATE34 OF RIC00VEHL0-R
      *    Date 33 Into Repair
           MOVE P1BLSTDT33 TO C7DATE33 OF RIC00VEHL0-R
      *    Date 42 Dealer Invoiced
           MOVE P1DLRINV42 TO C7DATE42 OF RIC00VEHL0-R
      *    Date 45 Exit Import Ctr
           MOVE P1EXICDT45 TO C7DATE45 OF RIC00VEHL0-R
      *    Date 53 Requested AAD
           MOVE P1RAADDT53 TO C7DATE53 OF RIC00VEHL0-R
      *    Date 58 Registration
           MOVE P1REGDT58 TO C7DATE58 OF RIC00VEHL0-R
      *    Registration number
           MOVE P1GNOX TO C7GNOX OF RIC00VEHL0-R
      *    Reg Count
           MOVE YL0013 OF WORK-CONTEXT TO C7REGCOUNT OF RIC00VEHL0-R
      *    De-Reg Date
           MOVE YL0006 OF WORK-CONTEXT TO C7DEREGDAT OF RIC00VEHL0-R
      *    Planned Arrival UK DATE
           MOVE WUARDATE OF WORK-CONTEXT TO C7ARDATE OF RIC00VEHL0-R
      *    AAD Promise Date (A)
           MOVE P1AADPRMDT TO C7AADPDATE OF RIC00VEHL0-R
      *    DDD Forecast Date
           MOVE P1DDDFCST TO C7DDDFDATE OF RIC00VEHL0-R
      *    DDD Requested Date
           MOVE P1DDDREQ TO C7DDDRDATE OF RIC00VEHL0-R
      *    Planned Arrival in UK 2
           MOVE WUPLADATE2 OF WORK-CONTEXT TO C7PLADATE2 OF RIC00VEHL0-R
      *    Veh AAD Actual Date
           MOVE P1AADACTDT TO C7VAACDATE OF RIC00VEHL0-R
      *    Veh AAD Planned Date (A)
           MOVE P1AADPLN TO C7VAADDATE OF RIC00VEHL0-R
      *    Veh ARC Planned Date (A)
           MOVE P1ARCPLN TO C7VARCDATE OF RIC00VEHL0-R
      *    Deliverable Period YYYYMM
           MOVE YL0008 OF WORK-CONTEXT TO C7DELPER OF RIC00VEHL0-R
      *    Customer Order Date(char)
           MOVE YL0003 OF WORK-CONTEXT TO C7CUSORDDA OF RIC00VEHL0-R
      *    Order Period YYYYMM
           MOVE YL0009 OF WORK-CONTEXT TO C7ORPER OF RIC00VEHL0-R
      *    Order Month
           MOVE YL0010 OF WORK-CONTEXT TO C7ORMOUNT OF RIC00VEHL0-R
      *    Order Count
           MOVE YL0014 OF WORK-CONTEXT TO C7ORCOUT OF RIC00VEHL0-R
      *    Order Business Day
           MOVE WUORBUSDAY OF WORK-CONTEXT TO C7ORBUSDAY OF RIC00VEHL0-R
      *    Order Cancelled Date Zon
           MOVE P1DLORDCND TO C7B8NM OF RIC00VEHL0-R
      *    Cancelled Period YYYYMM
           MOVE YL0011 OF WORK-CONTEXT TO C7CANPER OF RIC00VEHL0-R
      *    Cancellation count
           MOVE YL0015 OF WORK-CONTEXT TO C7CANCOUNT OF RIC00VEHL0-R
      *    Order Cancellation desti
           MOVE YL0029 OF WORK-CONTEXT TO C7TUTE OF RIC00VEHL0-R
      *    Order Cancellation Reason
           MOVE YL0024 OF WORK-CONTEXT TO C7ORDCANRS OF RIC00VEHL0-R
      *    Customer Delivery Date(a)
           MOVE YL0030 OF WORK-CONTEXT TO C7CUDDDAT OF RIC00VEHL0-R
      *    CDD M Ind
           MOVE YL0044 OF WORK-CONTEXT TO C7RKNU OF RIC00VEHL0-R
      *    CDD Period YYYYMM
           MOVE YL0031 OF WORK-CONTEXT TO C7CDDPER OF RIC00VEHL0-R
      *    Arrival Date
           MOVE YL0045 OF WORK-CONTEXT TO C7DATEARIV OF RIC00VEHL0-R
      *    Arrival Period YYYYMM
           MOVE YL0049 OF WORK-CONTEXT TO C7ARPERI OF RIC00VEHL0-R
      *    Pull Forward M+1
           MOVE YL0075 OF WORK-CONTEXT TO C7PFM1 OF RIC00VEHL0-R
      *    Pull Forward M+2
           MOVE YL0076 OF WORK-CONTEXT TO C7PFM2 OF RIC00VEHL0-R
      *    Pull Forward M+3
           MOVE YL0077 OF WORK-CONTEXT TO C7PFM3 OF RIC00VEHL0-R
      *    Pull Forward M+4
           MOVE YL0078 OF WORK-CONTEXT TO C7PFM4 OF RIC00VEHL0-R
      *    Available Count
           MOVE YL0079 OF WORK-CONTEXT TO C7AVCOU OF RIC00VEHL0-R
      *    AMF Code
           MOVE YL0085 OF WORK-CONTEXT TO C7AMF OF RIC00VEHL0-R
      *    Core Fleet Dealer Ind
           MOVE YL0091 OF WORK-CONTEXT TO C7COFLDE OF RIC00VEHL0-R
      *    Vehicle Order Type (a)
           MOVE P1ORDTYPCD TO C7VEHORTYP OF RIC00VEHL0-R
      *    Sales Channel Code
           MOVE YL0021 OF WORK-CONTEXT TO C7SDSCHN OF RIC00VEHL0-R
      *    Sales Channel Desc
           MOVE YL0080 OF WORK-CONTEXT TO C7SALDESC OF RIC00VEHL0-R
      *    PM Channel
           MOVE YL0082 OF WORK-CONTEXT TO C7PMCHAN OF RIC00VEHL0-R
      *    MVRIS Channel
           MOVE YL0081 OF WORK-CONTEXT TO C7MVRICH OF RIC00VEHL0-R
      *    Fleet Channel
           MOVE YL0050 OF WORK-CONTEXT TO C7FLTCH OF RIC00VEHL0-R
      *    Target Channel
           MOVE YL0083 OF WORK-CONTEXT TO C7TARGCH OF RIC00VEHL0-R
      *    Agreement number
           MOVE YL0027 OF WORK-CONTEXT TO C7B2AGRNUM OF RIC00VEHL0-R
      *    Agreement Version Nbr
           MOVE YL0028 OF WORK-CONTEXT TO C7AGRVSNNB OF RIC00VEHL0-R
      *    FON
           MOVE WUFON OF WORK-CONTEXT TO C7FON OF RIC00VEHL0-R
      *    Conversion Count
           MOVE YL0070 OF WORK-CONTEXT TO C7CONCOUT OF RIC00VEHL0-R
      *    On Block
           MOVE YL0018 OF WORK-CONTEXT TO C7ONBLCK OF RIC00VEHL0-R
      *    Veh Commercial Block (A)
           MOVE P1VBLKCOM TO C7VBLKCO OF RIC00VEHL0-R
      *    Veh Financial Block (A)
           MOVE P1VBLKFIN TO C7VBLKFI OF RIC00VEHL0-R
      *    Veh Quality/CAT Block (A)
           MOVE P1VBLKQLT TO C7VBLKQL OF RIC00VEHL0-R
      *    BDC Payment Method
           MOVE YL0060 OF WORK-CONTEXT TO C7BDCPMT OF RIC00VEHL0-R
      *    BDC Payment Term
           MOVE YL0061 OF WORK-CONTEXT TO C7BDCPTRM OF RIC00VEHL0-R
      *    Fleet Programmes Code (A)
           MOVE YL0063 OF WORK-CONTEXT TO C7FLPGM OF RIC00VEHL0-R
      *    Fleet Programmes Desc
           MOVE YL0064 OF WORK-CONTEXT TO C7FLPGMDSC OF RIC00VEHL0-R
      *    Fleet Report Group Plan
           MOVE YL0059 OF WORK-CONTEXT TO C7RPGPPLN OF RIC00VEHL0-R
      *    Report Group Code (A)
           MOVE YL0058 OF WORK-CONTEXT TO C7RGPCD OF RIC00VEHL0-R
      *    OBT Count Target Status
           MOVE YL0062 OF WORK-CONTEXT TO C7CNTTARG OF RIC00VEHL0-R
      *    Target Market
           MOVE YL0065 OF WORK-CONTEXT TO C7TGTMRKET OF RIC00VEHL0-R
      *    Chassis Situation
           MOVE YL0019 OF WORK-CONTEXT TO C7CHASSTS OF RIC00VEHL0-R
      *    CO2 g/km
           MOVE C7CO2X OF FC00VS3 OF RIC00VEHL0-R TO C7CO2X OF
             RIC00VEHL0-R
      *    Network/Non Network Ind
           MOVE YL0057 OF WORK-CONTEXT TO C7NETIND OF RIC00VEHL0-R
      *    Surname/Company name
           MOVE YL0026 OF WORK-CONTEXT TO C7CUSNAM OF RIC00VEHL0-R
      *    Salesperson Code
           MOVE YL0025 OF WORK-CONTEXT TO C7SLPERCDE OF RIC00VEHL0-R
      *    Extract date  (8)
           MOVE YL0005 OF WORK-CONTEXT TO C7EXDATE8 OF RIC00VEHL0-R
      *    Extraction Type
           MOVE YL0012 OF WORK-CONTEXT TO C7SSSU OF RIC00VEHL0-R
      *
           REWRITE RIC00VEHL0-R END-REWRITE
           IF (NOT C-IO-OK) THEN
               SET C-INDICATOR-ON(91) TO TRUE
           ELSE
               SET C-INDICATOR-OFF(91) TO TRUE
           END-IF
           IF (C-INDICATOR-ON(91)) THEN
      *        Change error detected
               MOVE 'Y2U0004' TO W0RTN
           ELSE
      *        DBF change successful
               CONTINUE
           END-IF
      *==============================================================
           CONTINUE.
       SA9EXIT.
           EXIT.
      /EJECT
       SB1RVGN SECTION.
      *==============================================================
      *    Crt export model ver - RI Model Version  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    SCP Model Code (ATR)
           MOVE P1SCMDLCDE TO C9SCPMDLC OF KRSSB1
      *    SCP Model Version Code
           MOVE P1SCVERCDE TO C9SCVERCDE OF KRSSB1
      *    Model Phase
           MOVE P1O2ST TO C9PHASE OF KRSSB1
      *    SCR Model Code
           MOVE P1SCRMDL TO C9SCRMDL OF KRSSB1
      *    SCR Model Version Code(A)
           MOVE P1EUTT TO C9SCRVERC OF KRSSB1
      *    Initialise Full Externally Described Keylist
      *    SCP Model Code (ATR)
           MOVE LOW-VALUES TO C9SCPMDLC OF EXTSB1
      *    SCP Model Version Code
           MOVE LOW-VALUES TO C9SCVERCDE OF EXTSB1
      *    Model Phase
           MOVE LOW-VALUES TO C9PHASE OF EXTSB1
      *    SCR Model Code
           MOVE LOW-VALUES TO C9SCRMDL OF EXTSB1
      *    SCR Model Version Code(A)
           MOVE LOW-VALUES TO C9SCRVERC OF EXTSB1
           MOVE CORRESPONDING
             KRSSB1 TO
             FC00MS5 OF RIC00MOVL0-R
           SET C-INDICATOR-OFF(90) TO TRUE
           READ RIC00MOVL0
             FORMAT IS 'FC00MS5'
           END-READ
           IF (C-NO-RECORD) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               END-IF
           END-IF
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR7981' TO W0RTN
      *        USER: Processing if Data record not found
      *        Rtv Veh Mdl Ver - Vehicle Model Version  *
               PERFORM SB2RVGN
      *        Rtv All Veh Mdl - Vehicle Model  *
               PERFORM SB3RVGN
      *        Vehicle Fuel Desc
      *        CASE: LCL.Vehicle Fuel Code is Petrol
      *        *IF
               IF (YL0095 OF WORK-CONTEXT = '1') THEN
      *            Vehicle Fuel Desc
                   MOVE SPACES TO YL0097 OF WORK-CONTEXT
                   MOVE 'Petrol' TO YL0097 OF WORK-CONTEXT
               ELSE
      *            CASE: LCL.Vehicle Fuel Code is Diesel
      *            *IF
                   IF (YL0095 OF WORK-CONTEXT = '2') THEN
      *                Vehicle Fuel Desc
                       MOVE SPACES TO YL0097 OF WORK-CONTEXT
                       MOVE 'Diesel' TO YL0097 OF WORK-CONTEXT
                   ELSE
      *                CASE: LCL.Vehicle Fuel Code is Electric
      *                *IF
                       IF (YL0095 OF WORK-CONTEXT = '3') THEN
      *                    Vehicle Fuel Desc
                           MOVE SPACES TO YL0097 OF WORK-CONTEXT
                           MOVE 'Electric' TO YL0097 OF WORK-CONTEXT
                       ELSE
      *                    CASE: LCL.Vehicle Fuel Code is Dual Fuel
      *                    *IF
                           IF (YL0095 OF WORK-CONTEXT = 'Z') THEN
      *                        Vehicle Fuel Desc
                               MOVE SPACES TO YL0097 OF WORK-CONTEXT
                               MOVE 'Dual Fuel' TO YL0097 OF
                                 WORK-CONTEXT
                           END-IF
                       END-IF
                   END-IF
               END-IF
      *        SCP Model Version Code
               MOVE P1SCVERCDE TO YL0098 OF WORK-CONTEXT
      *        Cvt A$ = UPPER(A$) - #String Functions  *
     E* Y2V3114 - Source member UTLCVTUPPS not found.
      *        Find string in strng VRY - #String Functions  *
     E* Y2V3114 - Source member UTFNDSTRVS not found.
      *        STEPWAY Ind
      *        CASE: LCL.U:Number (2.0) is not zero
      *        *IF
               IF (YL0099 OF WORK-CONTEXT NOT = 0) THEN
      *            STEPWAY Ind
                   MOVE 'SW' TO YL0100 OF WORK-CONTEXT
               ELSE
      *            CASE: *OTHERWISE
      *            STEPWAY Ind
                   MOVE SPACES TO YL0100 OF WORK-CONTEXT
                   MOVE ' ' TO YL0100 OF WORK-CONTEXT
               END-IF
      *        Create RI Model Version - RI Model Version  *
               PERFORM SB4CRRC
               GO SB1EXIT
           END-IF
      *
      *==============================================================
           CONTINUE.
       SB1EXIT.
           EXIT.
      /EJECT
       SB2RVGN SECTION.
      *==============================================================
      *    Rtv Veh Mdl Ver - Vehicle Model Version  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    SCP Model Code
           MOVE P1SCMDLCDE TO COSCMDLCDE OF KRSSB2
      *    Model Phase
           MOVE P1O2ST TO COPHASE OF KRSSB2
      *    SCP Model Version Code
           MOVE P1SCVERCDE TO COSCVERCDE OF KRSSB2
      *    Initialise Full Externally Described Keylist
      *    SCP Model Code
           MOVE LOW-VALUES TO COSCMDLCDE OF EXTSB2
      *    Model Phase
           MOVE LOW-VALUES TO COPHASE OF EXTSB2
      *    SCP Model Version Code
           MOVE LOW-VALUES TO COSCVERCDE OF EXTSB2
           MOVE CORRESPONDING
             KRSSB2 TO
             VAMDLVERF1 OF VAMDLVERL1-R
           SET C-INDICATOR-OFF(90) TO TRUE
           READ VAMDLVERL1
             FORMAT IS 'VAMDLVERF1'
           END-READ
           IF (C-NO-RECORD) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               END-IF
           END-IF
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR6172' TO W0RTN
      *        USER: Processing if Data record not found
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
      *        PAR = CON By name
      *        Vehicle Body Class Code
               MOVE SPACES TO YL0092 OF WORK-CONTEXT
      *        Vehicle Body Code
               MOVE SPACES TO YL0093 OF WORK-CONTEXT
      *        Vehicle Body Name
               MOVE SPACES TO YL0094 OF WORK-CONTEXT
      *        Vehicle Fuel Code
               MOVE SPACES TO YL0095 OF WORK-CONTEXT
               GO SB2EXIT
           END-IF
      *
           IF (C-INDICATOR-OFF(90)) THEN
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Vehicle Body Class Code
               MOVE COBCBDYCLS OF VAMDLVERF1 OF VAMDLVERL1-R TO YL0092
                 OF WORK-CONTEXT
      *        Vehicle Body Code
               MOVE COBTBDYCDE OF VAMDLVERF1 OF VAMDLVERL1-R TO YL0093
                 OF WORK-CONTEXT
      *        Vehicle Body Name
               MOVE COBTBDYNAM OF VAMDLVERF1 OF VAMDLVERL1-R TO YL0094
                 OF WORK-CONTEXT
      *        Vehicle Fuel Code
               MOVE COFTFUEL OF VAMDLVERF1 OF VAMDLVERL1-R TO YL0095 OF
                 WORK-CONTEXT
           END-IF
      *==============================================================
           CONTINUE.
       SB2EXIT.
           EXIT.
      /EJECT
       SB3RVGN SECTION.
      *==============================================================
      *    Rtv All Veh Mdl - Vehicle Model  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    SCP Model Code
           MOVE P1SCMDLCDE TO CNSCMDLCDE OF KRSSB3
      *    Model Phase
           MOVE P1O2ST TO CNPHASE OF KRSSB3
      *    Initialise Full Externally Described Keylist
      *    SCP Model Code
           MOVE LOW-VALUES TO CNSCMDLCDE OF EXTSB3
      *    Model Phase
           MOVE LOW-VALUES TO CNPHASE OF EXTSB3
           MOVE CORRESPONDING
             KRSSB3 TO
             VAMDLDTAF1 OF VAMDLDTAL1-R
           SET C-INDICATOR-OFF(90) TO TRUE
           READ VAMDLDTAL1
             FORMAT IS 'VAMDLDTAF1'
           END-READ
           IF (C-NO-RECORD) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               END-IF
           END-IF
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR6170' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Model Marketing Desc
               MOVE SPACES TO YL0096 OF WORK-CONTEXT
               GO SB3EXIT
           END-IF
      *
           IF (C-INDICATOR-OFF(90)) THEN
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Model Marketing Desc
               MOVE CNMODDSC OF VAMDLDTAF1 OF VAMDLDTAL1-R TO YL0096 OF
                 WORK-CONTEXT
           END-IF
      *==============================================================
           CONTINUE.
       SB3EXIT.
           EXIT.
      /EJECT
       SB4CRRC SECTION.
      *==============================================================
      *    Create RI Model Version - RI Model Version  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *
      *    Move all fields to FC00MS6
      *    SCP Model Code (ATR)
           MOVE P1SCMDLCDE TO C9SCPMDLC OF RIC00MOVL1-R
      *    SCP Model Version Code
           MOVE P1SCVERCDE TO C9SCVERCDE OF RIC00MOVL1-R
      *    Model Phase
           MOVE P1O2ST TO C9PHASE OF RIC00MOVL1-R
      *    SCR Model Code
           MOVE P1SCRMDL TO C9SCRMDL OF RIC00MOVL1-R
      *    SCR Model Version Code(A)
           MOVE P1EUTT TO C9SCRVERC OF RIC00MOVL1-R
      *    Vehicle Body Class Code
           MOVE YL0092 OF WORK-CONTEXT TO C9BCBDYCLS OF RIC00MOVL1-R
      *    Car/Van text
           MOVE YL0016 OF WORK-CONTEXT TO C9CAVA OF RIC00MOVL1-R
      *    Model Marketing Desc
           MOVE YL0096 OF WORK-CONTEXT TO C9MODDSC OF RIC00MOVL1-R
      *    Vehicle Body Code
           MOVE YL0093 OF WORK-CONTEXT TO C9BTBDYCDE OF RIC00MOVL1-R
      *    Vehicle Body Name
           MOVE YL0094 OF WORK-CONTEXT TO C9BTBDYNAM OF RIC00MOVL1-R
      *    Vehicle Fuel Code
           MOVE YL0095 OF WORK-CONTEXT TO C9FTFUEL OF RIC00MOVL1-R
      *    Vehicle Fuel Desc
           MOVE YL0097 OF WORK-CONTEXT TO C9FTFUELD OF RIC00MOVL1-R
      *    STEPWAY Ind
           MOVE YL0100 OF WORK-CONTEXT TO C9STEPW OF RIC00MOVL1-R
      *    Check for duplicate primary key
           START RIC00MOVL1 KEY = EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'FC00MS6'
           END-START
           IF (NOT C-NO-RECORD) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               SET C-INDICATOR-OFF(90) TO TRUE
           END-IF
           IF (C-INDICATOR-ON(90)) THEN
               MOVE 'USR7982' TO W0RTN
      *        Send message 'RI Model Version       EX'
      *        Message ID
               MOVE 'USR7982' TO ZAMSID
               PERFORM ZASNMS
               GO SB4EXIT
           END-IF
      *
           WRITE RIC00MOVL1-R END-WRITE
           IF (C-IO-ERR) THEN
               SET C-INDICATOR-ON(91) TO TRUE
           ELSE
               SET C-INDICATOR-OFF(91) TO TRUE
           END-IF
      *
           IF (C-INDICATOR-ON(91)) THEN
      *        Write error detected
               MOVE 'Y2U0004' TO W0RTN
           ELSE
      *        DBF write successful
               CONTINUE
           END-IF
      *==============================================================
           CONTINUE.
       SB4EXIT.
           EXIT.
      /EJECT
       UA1SUBR SECTION.
      *==============================================================
      *    desc
      *==============================================================
      *    Application : RIC   IRN-11945
      *    Created:   20.09.2019   JLT   bug:   90713
      *    Callet from  RIC000120S  in Jsmdl  .. Create export
      *    Utl @Copyright
      *    ------------------------------------------------------------
      *    COPYRIGHT
      *    (C) COPYRIGHT Renault UK Ltd. 2019
      *    Reproduction not allowed without prior permission
      *    ------------------------------------------------------------
      *==============================================================
           CONTINUE.
       UA1EXIT.
           EXIT.
      /EJECT
       UA2SUBR SECTION.
      *==============================================================
      *    CDD M Ind
      *==============================================================
      *    Cvt *Job to YYYYMM
      *    Cvt *Job date to DTX
      *    * Job date contains a leading 1 when the year is 2000 or
      *      greater
      *    U:Job Date DTX
           ADD ZZJDT OF JOB-CONTEXT, 19000000 GIVING YL0033 OF
             WORK-CONTEXT
           MOVE YL0033 OF WORK-CONTEXT TO YL0034 OF WORK-CONTEXT
           MOVE 6 TO YRSW04
           MOVE 1 TO YRSW03
           IF (YRSW03 NOT > 0 OR
               YRSW04 NOT > 0 OR
               YRSW03 > 00008 OR
               YRSW04 > 00008) THEN
               MOVE 'Y2U0510' TO W0RTN
           ELSE
               MOVE YL0034 OF WORK-CONTEXT TO W0STRNG
               MOVE W0STRNG(YRSW03:YRSW04) TO YL0032 OF WORK-CONTEXT
           END-IF
           MOVE 2 TO YRSW04
           MOVE 5 TO YRSW03
           IF (YRSW03 NOT > 0 OR
               YRSW04 NOT > 0 OR
               YRSW03 > 00006 OR
               YRSW04 > 00006) THEN
               MOVE 'Y2U0510' TO W0RTN
           ELSE
               MOVE YL0032 OF WORK-CONTEXT TO W0STRNG
               MOVE W0STRNG(YRSW03:YRSW04) TO YL0035 OF WORK-CONTEXT
           END-IF
      *    Rtn YYYYMM +/- MM
           IF (YL0032 OF WORK-CONTEXT = SPACES) THEN
               MOVE ZERO TO YL0037 OF WORK-CONTEXT
           ELSE
               MOVE YL0032 OF WORK-CONTEXT TO YL0037 OF WORK-CONTEXT
           END-IF
      *    add month
      *    CASE: PAR.U:Month (2) Unpacked is 1-12
      *    *IF
           IF (1 NOT < 1 AND
               1 NOT > 12) THEN
      *        U:Month YYYYMM
               ADD YL0037 OF WORK-CONTEXT, 1 GIVING YL0037 OF
                 WORK-CONTEXT
           ELSE
      *        CASE: PAR.U:Month (2) Unpacked is -12 - -1
      *        *IF
               IF (1 NOT < -12 AND
                   1 NOT > -1) THEN
      *            U:Month YYYYMM
                   ADD YL0037 OF WORK-CONTEXT, 1 GIVING YL0037 OF
                     WORK-CONTEXT
               ELSE
      *            CASE: PAR.U:Month (2) Unpacked is 13 - 24
      *            *IF
                   IF (1 NOT < 13 AND
                       1 NOT > 24) THEN
      *                U:Number (3.0)
                       MOVE 1 TO YL0038 OF WORK-CONTEXT
      *                LCL.U:Number (3.0) =
      *                *COMPUTE (x1 + x2 - x3)
      *                x1    : LCL.U:Number (3.0)
      *                +     : PGM.*Synon (17,7) work field
      *                x2    : CON.100
      *                -     : PGM.*Synon (17,7) work field
      *                x3    : CON.12
      *                *Synon (17,7) work field
                       ADD YL0038 OF WORK-CONTEXT, 100 GIVING W0WD01
      *                *Synon (17,7) work field
                       SUBTRACT 12 FROM W0WD01 GIVING W0WD00
      *                U:Number (3.0)
                       MOVE W0WD00 TO YL0038 OF WORK-CONTEXT
      *                U:Month YYYYMM
                       ADD YL0037 OF WORK-CONTEXT, YL0038 OF
                         WORK-CONTEXT GIVING YL0037 OF WORK-CONTEXT
                   ELSE
      *                CASE: PAR.U:Month (2) Unpacked is -24 - -13
      *                *IF
                       IF (1 NOT < -24 AND
                           1 NOT > -13) THEN
      *                    U:Number (3.0)
                           MOVE 1 TO YL0038 OF WORK-CONTEXT
      *                    LCL.U:Number (3.0) =
      *                    *COMPUTE (x1 - x2 + x3)
      *                    x1    : LCL.U:Number (3.0)
      *                    -     : PGM.*Synon (17,7) work field
      *                    x2    : CON.100
      *                    +     : PGM.*Synon (17,7) work field
      *                    x3    : CON.12
      *                    *Synon (17,7) work field
                           SUBTRACT 100 FROM YL0038 OF WORK-CONTEXT
                             GIVING W0WD01
      *                    *Synon (17,7) work field
                           ADD W0WD01, 12 GIVING W0WD00
      *                    U:Number (3.0)
                           MOVE W0WD00 TO YL0038 OF WORK-CONTEXT
      *                    U:Month YYYYMM
                           ADD YL0037 OF WORK-CONTEXT, YL0038 OF
                             WORK-CONTEXT GIVING YL0037 OF WORK-CONTEXT
                       END-IF
                   END-IF
               END-IF
           END-IF
           MOVE YL0037 OF WORK-CONTEXT TO YL0039 OF WORK-CONTEXT
           MOVE 2 TO YRSW04
           MOVE 5 TO YRSW03
           IF (YRSW03 NOT > 0 OR
               YRSW04 NOT > 0 OR
               YRSW03 > 00006 OR
               YRSW04 > 00006) THEN
               MOVE 'Y2U0510' TO W0RTN
           ELSE
               MOVE YL0039 OF WORK-CONTEXT TO W0STRNG
               MOVE W0STRNG(YRSW03:YRSW04) TO YL0040 OF WORK-CONTEXT
           END-IF
           MOVE YL0041 OF WORK-CONTEXT TO YL0040 OF WORK-CONTEXT
      *    more 12 ,24 month
      *    CASE: LCL.U:Month 2 is GT 12
      *    *IF
           IF (YL0041 OF WORK-CONTEXT > 12) THEN
      *        CASE: LCL.U:Month 2 is GT 24
      *        *IF
               IF (YL0041 OF WORK-CONTEXT > 24) THEN
      *            LCL.U:Month YYYYMM =
      *            *COMPUTE (x1 + x2 - x3)
      *            x1    : LCL.U:Month YYYYMM
      *            +     : PGM.*Synon (17,7) work field
      *            x2    : CON.200
      *            -     : PGM.*Synon (17,7) work field
      *            x3    : CON.24
      *            *Synon (17,7) work field
                   ADD YL0037 OF WORK-CONTEXT, 200 GIVING W0WD01
      *            *Synon (17,7) work field
                   SUBTRACT 24 FROM W0WD01 GIVING W0WD00
      *            U:Month YYYYMM
                   MOVE W0WD00 TO YL0037 OF WORK-CONTEXT
                   MOVE YL0037 OF WORK-CONTEXT TO YL0039 OF WORK-CONTEXT
               ELSE
      *            CASE: *OTHERWISE
      *            LCL.U:Month YYYYMM =
      *            *COMPUTE (x1 + x2 - x3)
      *            x1    : LCL.U:Month YYYYMM
      *            +     : PGM.*Synon (17,7) work field
      *            x2    : CON.100
      *            -     : PGM.*Synon (17,7) work field
      *            x3    : CON.12
      *            *Synon (17,7) work field
                   ADD YL0037 OF WORK-CONTEXT, 100 GIVING W0WD01
      *            *Synon (17,7) work field
                   SUBTRACT 12 FROM W0WD01 GIVING W0WD00
      *            U:Month YYYYMM
                   MOVE W0WD00 TO YL0037 OF WORK-CONTEXT
                   MOVE YL0037 OF WORK-CONTEXT TO YL0039 OF WORK-CONTEXT
               END-IF
           END-IF
      *    Rtn YYYYMM +/- MM
           IF (YL0032 OF WORK-CONTEXT = SPACES) THEN
               MOVE ZERO TO YL0037 OF WORK-CONTEXT
           ELSE
               MOVE YL0032 OF WORK-CONTEXT TO YL0037 OF WORK-CONTEXT
           END-IF
      *    add month
      *    CASE: PAR.U:Month (2) Unpacked is 1-12
      *    *IF
           IF (2 NOT < 1 AND
               2 NOT > 12) THEN
      *        U:Month YYYYMM
               ADD YL0037 OF WORK-CONTEXT, 2 GIVING YL0037 OF
                 WORK-CONTEXT
           ELSE
      *        CASE: PAR.U:Month (2) Unpacked is -12 - -1
      *        *IF
               IF (2 NOT < -12 AND
                   2 NOT > -1) THEN
      *            U:Month YYYYMM
                   ADD YL0037 OF WORK-CONTEXT, 2 GIVING YL0037 OF
                     WORK-CONTEXT
               ELSE
      *            CASE: PAR.U:Month (2) Unpacked is 13 - 24
      *            *IF
                   IF (2 NOT < 13 AND
                       2 NOT > 24) THEN
      *                U:Number (3.0)
                       MOVE 2 TO YL0038 OF WORK-CONTEXT
      *                LCL.U:Number (3.0) =
      *                *COMPUTE (x1 + x2 - x3)
      *                x1    : LCL.U:Number (3.0)
      *                +     : PGM.*Synon (17,7) work field
      *                x2    : CON.100
      *                -     : PGM.*Synon (17,7) work field
      *                x3    : CON.12
      *                *Synon (17,7) work field
                       ADD YL0038 OF WORK-CONTEXT, 100 GIVING W0WD01
      *                *Synon (17,7) work field
                       SUBTRACT 12 FROM W0WD01 GIVING W0WD00
      *                U:Number (3.0)
                       MOVE W0WD00 TO YL0038 OF WORK-CONTEXT
      *                U:Month YYYYMM
                       ADD YL0037 OF WORK-CONTEXT, YL0038 OF
                         WORK-CONTEXT GIVING YL0037 OF WORK-CONTEXT
                   ELSE
      *                CASE: PAR.U:Month (2) Unpacked is -24 - -13
      *                *IF
                       IF (2 NOT < -24 AND
                           2 NOT > -13) THEN
      *                    U:Number (3.0)
                           MOVE 2 TO YL0038 OF WORK-CONTEXT
      *                    LCL.U:Number (3.0) =
      *                    *COMPUTE (x1 - x2 + x3)
      *                    x1    : LCL.U:Number (3.0)
      *                    -     : PGM.*Synon (17,7) work field
      *                    x2    : CON.100
      *                    +     : PGM.*Synon (17,7) work field
      *                    x3    : CON.12
      *                    *Synon (17,7) work field
                           SUBTRACT 100 FROM YL0038 OF WORK-CONTEXT
                             GIVING W0WD01
      *                    *Synon (17,7) work field
                           ADD W0WD01, 12 GIVING W0WD00
      *                    U:Number (3.0)
                           MOVE W0WD00 TO YL0038 OF WORK-CONTEXT
      *                    U:Month YYYYMM
                           ADD YL0037 OF WORK-CONTEXT, YL0038 OF
                             WORK-CONTEXT GIVING YL0037 OF WORK-CONTEXT
                       END-IF
                   END-IF
               END-IF
           END-IF
           MOVE YL0037 OF WORK-CONTEXT TO YL0039 OF WORK-CONTEXT
           MOVE 2 TO YRSW04
           MOVE 5 TO YRSW03
           IF (YRSW03 NOT > 0 OR
               YRSW04 NOT > 0 OR
               YRSW03 > 00006 OR
               YRSW04 > 00006) THEN
               MOVE 'Y2U0510' TO W0RTN
           ELSE
               MOVE YL0039 OF WORK-CONTEXT TO W0STRNG
               MOVE W0STRNG(YRSW03:YRSW04) TO YL0040 OF WORK-CONTEXT
           END-IF
           MOVE YL0041 OF WORK-CONTEXT TO YL0040 OF WORK-CONTEXT
      *    more 12 ,24 month
      *    CASE: LCL.U:Month 2 is GT 12
      *    *IF
           IF (YL0041 OF WORK-CONTEXT > 12) THEN
      *        CASE: LCL.U:Month 2 is GT 24
      *        *IF
               IF (YL0041 OF WORK-CONTEXT > 24) THEN
      *            LCL.U:Month YYYYMM =
      *            *COMPUTE (x1 + x2 - x3)
      *            x1    : LCL.U:Month YYYYMM
      *            +     : PGM.*Synon (17,7) work field
      *            x2    : CON.200
      *            -     : PGM.*Synon (17,7) work field
      *            x3    : CON.24
      *            *Synon (17,7) work field
                   ADD YL0037 OF WORK-CONTEXT, 200 GIVING W0WD01
      *            *Synon (17,7) work field
                   SUBTRACT 24 FROM W0WD01 GIVING W0WD00
      *            U:Month YYYYMM
                   MOVE W0WD00 TO YL0037 OF WORK-CONTEXT
                   MOVE YL0037 OF WORK-CONTEXT TO YL0039 OF WORK-CONTEXT
               ELSE
      *            CASE: *OTHERWISE
      *            LCL.U:Month YYYYMM =
      *            *COMPUTE (x1 + x2 - x3)
      *            x1    : LCL.U:Month YYYYMM
      *            +     : PGM.*Synon (17,7) work field
      *            x2    : CON.100
      *            -     : PGM.*Synon (17,7) work field
      *            x3    : CON.12
      *            *Synon (17,7) work field
                   ADD YL0037 OF WORK-CONTEXT, 100 GIVING W0WD01
      *            *Synon (17,7) work field
                   SUBTRACT 12 FROM W0WD01 GIVING W0WD00
      *            U:Month YYYYMM
                   MOVE W0WD00 TO YL0037 OF WORK-CONTEXT
                   MOVE YL0037 OF WORK-CONTEXT TO YL0039 OF WORK-CONTEXT
               END-IF
           END-IF
      *    Rtn YYYYMM +/- MM
           IF (YL0032 OF WORK-CONTEXT = SPACES) THEN
               MOVE ZERO TO YL0037 OF WORK-CONTEXT
           ELSE
               MOVE YL0032 OF WORK-CONTEXT TO YL0037 OF WORK-CONTEXT
           END-IF
      *    add month
      *    CASE: PAR.U:Month (2) Unpacked is 1-12
      *    *IF
           IF (3 NOT < 1 AND
               3 NOT > 12) THEN
      *        U:Month YYYYMM
               ADD YL0037 OF WORK-CONTEXT, 3 GIVING YL0037 OF
                 WORK-CONTEXT
           ELSE
      *        CASE: PAR.U:Month (2) Unpacked is -12 - -1
      *        *IF
               IF (3 NOT < -12 AND
                   3 NOT > -1) THEN
      *            U:Month YYYYMM
                   ADD YL0037 OF WORK-CONTEXT, 3 GIVING YL0037 OF
                     WORK-CONTEXT
               ELSE
      *            CASE: PAR.U:Month (2) Unpacked is 13 - 24
      *            *IF
                   IF (3 NOT < 13 AND
                       3 NOT > 24) THEN
      *                U:Number (3.0)
                       MOVE 3 TO YL0038 OF WORK-CONTEXT
      *                LCL.U:Number (3.0) =
      *                *COMPUTE (x1 + x2 - x3)
      *                x1    : LCL.U:Number (3.0)
      *                +     : PGM.*Synon (17,7) work field
      *                x2    : CON.100
      *                -     : PGM.*Synon (17,7) work field
      *                x3    : CON.12
      *                *Synon (17,7) work field
                       ADD YL0038 OF WORK-CONTEXT, 100 GIVING W0WD01
      *                *Synon (17,7) work field
                       SUBTRACT 12 FROM W0WD01 GIVING W0WD00
      *                U:Number (3.0)
                       MOVE W0WD00 TO YL0038 OF WORK-CONTEXT
      *                U:Month YYYYMM
                       ADD YL0037 OF WORK-CONTEXT, YL0038 OF
                         WORK-CONTEXT GIVING YL0037 OF WORK-CONTEXT
                   ELSE
      *                CASE: PAR.U:Month (2) Unpacked is -24 - -13
      *                *IF
                       IF (3 NOT < -24 AND
                           3 NOT > -13) THEN
      *                    U:Number (3.0)
                           MOVE 3 TO YL0038 OF WORK-CONTEXT
      *                    LCL.U:Number (3.0) =
      *                    *COMPUTE (x1 - x2 + x3)
      *                    x1    : LCL.U:Number (3.0)
      *                    -     : PGM.*Synon (17,7) work field
      *                    x2    : CON.100
      *                    +     : PGM.*Synon (17,7) work field
      *                    x3    : CON.12
      *                    *Synon (17,7) work field
                           SUBTRACT 100 FROM YL0038 OF WORK-CONTEXT
                             GIVING W0WD01
      *                    *Synon (17,7) work field
                           ADD W0WD01, 12 GIVING W0WD00
      *                    U:Number (3.0)
                           MOVE W0WD00 TO YL0038 OF WORK-CONTEXT
      *                    U:Month YYYYMM
                           ADD YL0037 OF WORK-CONTEXT, YL0038 OF
                             WORK-CONTEXT GIVING YL0037 OF WORK-CONTEXT
                       END-IF
                   END-IF
               END-IF
           END-IF
           MOVE YL0037 OF WORK-CONTEXT TO YL0039 OF WORK-CONTEXT
           MOVE 2 TO YRSW04
           MOVE 5 TO YRSW03
           IF (YRSW03 NOT > 0 OR
               YRSW04 NOT > 0 OR
               YRSW03 > 00006 OR
               YRSW04 > 00006) THEN
               MOVE 'Y2U0510' TO W0RTN
           ELSE
               MOVE YL0039 OF WORK-CONTEXT TO W0STRNG
               MOVE W0STRNG(YRSW03:YRSW04) TO YL0040 OF WORK-CONTEXT
           END-IF
           MOVE YL0041 OF WORK-CONTEXT TO YL0040 OF WORK-CONTEXT
      *    more 12 ,24 month
      *    CASE: LCL.U:Month 2 is GT 12
      *    *IF
           IF (YL0041 OF WORK-CONTEXT > 12) THEN
      *        CASE: LCL.U:Month 2 is GT 24
      *        *IF
               IF (YL0041 OF WORK-CONTEXT > 24) THEN
      *            LCL.U:Month YYYYMM =
      *            *COMPUTE (x1 + x2 - x3)
      *            x1    : LCL.U:Month YYYYMM
      *            +     : PGM.*Synon (17,7) work field
      *            x2    : CON.200
      *            -     : PGM.*Synon (17,7) work field
      *            x3    : CON.24
      *            *Synon (17,7) work field
                   ADD YL0037 OF WORK-CONTEXT, 200 GIVING W0WD01
      *            *Synon (17,7) work field
                   SUBTRACT 24 FROM W0WD01 GIVING W0WD00
      *            U:Month YYYYMM
                   MOVE W0WD00 TO YL0037 OF WORK-CONTEXT
                   MOVE YL0037 OF WORK-CONTEXT TO YL0039 OF WORK-CONTEXT
               ELSE
      *            CASE: *OTHERWISE
      *            LCL.U:Month YYYYMM =
      *            *COMPUTE (x1 + x2 - x3)
      *            x1    : LCL.U:Month YYYYMM
      *            +     : PGM.*Synon (17,7) work field
      *            x2    : CON.100
      *            -     : PGM.*Synon (17,7) work field
      *            x3    : CON.12
      *            *Synon (17,7) work field
                   ADD YL0037 OF WORK-CONTEXT, 100 GIVING W0WD01
      *            *Synon (17,7) work field
                   SUBTRACT 12 FROM W0WD01 GIVING W0WD00
      *            U:Month YYYYMM
                   MOVE W0WD00 TO YL0037 OF WORK-CONTEXT
                   MOVE YL0037 OF WORK-CONTEXT TO YL0039 OF WORK-CONTEXT
               END-IF
           END-IF
      *    CDD M Ind
      *    CASE: LCL.CDD Period YYYYMM EQ LCL.U:Date YYYYMM (CDE)
      *    *IF
           IF (YL0031 OF WORK-CONTEXT = YL0032 OF WORK-CONTEXT) THEN
      *        CDD M Ind
               MOVE SPACES TO YL0044 OF WORK-CONTEXT
               MOVE 'M' TO YL0044 OF WORK-CONTEXT
           ELSE
      *        CASE: LCL.CDD Period YYYYMM EQ LCL.U:Date YYYYMM a
      *        *IF
               IF (YL0031 OF WORK-CONTEXT = YL0036 OF WORK-CONTEXT) THEN
      *            CDD M Ind
                   MOVE SPACES TO YL0044 OF WORK-CONTEXT
                   MOVE 'M1' TO YL0044 OF WORK-CONTEXT
               ELSE
      *            CASE: LCL.CDD Period YYYYMM EQ LCL.U:Date YYYYMM b
      *            *IF
                   IF (YL0031 OF WORK-CONTEXT = YL0042 OF WORK-CONTEXT)
                     THEN
      *                CDD M Ind
                       MOVE SPACES TO YL0044 OF WORK-CONTEXT
                       MOVE 'M2' TO YL0044 OF WORK-CONTEXT
                   ELSE
      *                CASE: LCL.CDD Period YYYYMM GE LCL.U:Date
      *                  YYYYMM c
      *                *IF
                       IF (YL0031 OF WORK-CONTEXT NOT < YL0043 OF
                         WORK-CONTEXT) THEN
      *                    CDD M Ind
                           MOVE 'M3_GT' TO YL0044 OF WORK-CONTEXT
                       END-IF
                   END-IF
               END-IF
           END-IF
      *==============================================================
           CONTINUE.
       UA2EXIT.
           EXIT.
      /EJECT
       UA3SUBR SECTION.
      *==============================================================
      *    Arrival Period YYYYMM
      *==============================================================
      *    Cvt DTX to DTE Format
      *    CASE: PAR.U:Date YYYYMMDD is *Not Zeros
      *    *IF
           IF (YL0045 OF WORK-CONTEXT NOT = 0) THEN
      *        U:Number (2.0)
      *        U:Number (6.0)
               DIVIDE 1000000 INTO YL0045 OF WORK-CONTEXT GIVING WUNBR2
                 OF WORK-CONTEXT REMAINDER WUNUM6 OF WORK-CONTEXT
      *        Return Value of CYYMMDD
      *        CASE: WRK.U:Number (2.0) is *21 Century
      *        *IF
               IF (WUNBR2 OF WORK-CONTEXT = 20) THEN
      *            U:Date
                   ADD WUNUM6 OF WORK-CONTEXT, 1000000 GIVING WUDATE OF
                     WORK-CONTEXT
               ELSE
      *            CASE: *OTHERWISE
      *            WRK.U:Date = WRK.U:Number (6.0)
                   MOVE WUNUM6 OF WORK-CONTEXT TO WUDATE OF WORK-CONTEXT
               END-IF
      *        U:Date
               MOVE WUDATE OF WORK-CONTEXT TO YL0046 OF WORK-CONTEXT
           ELSE
      *        CASE: *OTHERWISE
      *        U:Date
               MOVE ZEROS TO YL0046 OF WORK-CONTEXT
           END-IF
      *    Rtn Add Weeks to Date
      *    * NOTE: Use of 'Days 2' and 'Days 3' to avoid clash in WRK
      *      context.
      *    * Convert incoming Date to days.
      *    Cvt Date to Days - #Standard Functions  *
     E* Y2V3114 - Source member UFGCVTDTDS not found.
      *    * Convert incoming Weeks to days.
      *    U:Days 3
           MULTIPLY 2 BY 7 GIVING WUUDAYS3 OF WORK-CONTEXT
      *    * Add together, then convert back to a Date.
      *    U:Days 2
           ADD WUUDAYS2 OF WORK-CONTEXT, WUUDAYS3 OF WORK-CONTEXT
             GIVING WUUDAYS2 OF WORK-CONTEXT
      *    Cvt Days to Date - #Standard Functions  *
     E* Y2V3114 - Source member UFGCVTDYDS not found.
      *    Cvt DTE to DTX Format
      *    CASE: PAR.U:Date is < 01/01/40
      *    *IF
           IF (YL0047 OF WORK-CONTEXT < 400101) THEN
      *        CASE: PAR.U:Date is *Zero
      *        *IF
               IF (YL0047 OF WORK-CONTEXT = 0) THEN
      *            U:Date YYYYMMDD
                   MOVE ZEROS TO YL0048 OF WORK-CONTEXT
               ELSE
      *            CASE: *OTHERWISE
      *            U:Date YYYYMMDD
                   ADD YL0047 OF WORK-CONTEXT, 20000000 GIVING YL0048
                     OF WORK-CONTEXT
               END-IF
           ELSE
      *        CASE: *OTHERWISE
      *        U:Date YYYYMMDD
               ADD YL0047 OF WORK-CONTEXT, 19000000 GIVING YL0048 OF
                 WORK-CONTEXT
           END-IF
           MOVE YL0048 OF WORK-CONTEXT TO YL0007 OF WORK-CONTEXT
           MOVE 6 TO YRSW04
           MOVE 1 TO YRSW03
           IF (YRSW03 NOT > 0 OR
               YRSW04 NOT > 0 OR
               YRSW03 > 00008 OR
               YRSW04 > 00008) THEN
               MOVE 'Y2U0510' TO W0RTN
           ELSE
               MOVE YL0007 OF WORK-CONTEXT TO W0STRNG
               MOVE W0STRNG(YRSW03:YRSW04) TO YL0049 OF WORK-CONTEXT
           END-IF
      *==============================================================
           CONTINUE.
       UA3EXIT.
           EXIT.
      /EJECT
       XCVTA  SECTION.
      *==============================================================
      *    Convert date to absolute day (from 01/01/01)
      *==============================================================
      *    Absolute day =
      *    365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones)
      *      ...
           SUBTRACT 1 FROM XDINYY GIVING XDWK1
           MULTIPLY XDWK1 BY 365.25 GIVING XDAY1
           IF (XDWK1 NOT < 300) THEN
               SUBTRACT 2 FROM XDAY1
           ELSE
               IF (XDWK1 NOT < 100) THEN
                   SUBTRACT 1 FROM XDAY1
               END-IF
           END-IF
      *    (from the beginning of the year to the beginning of the
      *      month:)
           SUBTRACT 1 FROM XDINMM GIVING XDWK1
           IF (XDINMM < 3) THEN
      *        ...+31*(MM-1) (for January-February) ...
               MULTIPLY 31 BY XDWK1
               ADD XDWK1 TO XDAY1
           ELSE
      *        ...+30*(MM-1) (for March-December) ...
               MULTIPLY 30 BY XDWK1
               ADD XDWK1 TO XDAY1
      *        ...-2 (for preceding February) ...
               SUBTRACT 2 FROM XDAY1
               IF (XDINYY NOT = 300 AND
                   XDINYY NOT = 100) THEN
      *            ...+1 (for preceding February, if leap year) ...
                   DIVIDE XDINYY BY 4 GIVING XDWK4 REMAINDER XDWK1
                   IF (XDWK1 = 0) THEN
                       ADD 1 TO XDAY1
                   END-IF
               END-IF
               IF (XDINMM < 8) THEN
      *            ...+MM/2 (preceding 31-sts for March-July) ...
                   MULTIPLY XDINMM BY .5 GIVING XDWK1
                   ADD XDWK1 TO XDAY1
               ELSE
      *            ...+(MM+1)/2 (same for August-December) ...
                   ADD 1 TO XDINMM GIVING XDWK1
                   MULTIPLY .5 BY XDWK1
                   ADD XDWK1 TO XDAY1
               END-IF
           END-IF
      *    ...+DD (days in the month up to the ending date)
           ADD XDINDD TO XDAY1
      *==============================================================
           CONTINUE.
       XCVTAE.
           EXIT.
      /EJECT
       XDOWS  SECTION.
      *==============================================================
      *    Setup days of week array
      *==============================================================
           MOVE XDCDW TO YDOW
           MOVE 0 TO XDWSL
           MOVE 1 TO YY
           PERFORM UNTIL NOT (YY NOT > 7)
               IF (YDOE(YY) = XDSEL) THEN
                   ADD 1 TO XDWSL
               END-IF
               ADD 1 TO YY
           END-PERFORM
      *==============================================================
           CONTINUE.
       XDOWSE.
           EXIT.
      /EJECT
       XDUDY  SECTION.
      *==============================================================
      *    Calculate duration, *DAYS
      *==============================================================
           IF (XDAY1 < 1 OR
               XDAY2 < 1) THEN
               MOVE 0 TO XDURR
               MOVE 'Y2U0006' TO W0RTN
               GO XDUDYE
           END-IF
           IF (XDAY1 > XDAY2) THEN
      *        From date2 to date1
               MOVE XDAY2 TO XABEG
               MOVE XDAY1 TO XAEND
           ELSE
      *        From date1 to date2
               MOVE XDAY1 TO XABEG
               MOVE XDAY2 TO XAEND
           END-IF
           IF (XDWSL = 0) THEN
      *        None days of week selected
               MOVE 0 TO XDURR
               GO XDUDYC
           END-IF
           SUBTRACT XABEG FROM XAEND GIVING XDURR
           IF (XDWSL = 7) THEN
      *        All days of week selected
               GO XDUDYC
           END-IF
      *    Some days of week selected
           DIVIDE XDURR BY 7 GIVING XDURR REMAINDER XDLSW
           MULTIPLY XDWSL BY XDURR
           IF (XDLSW NOT = 0) THEN
      *        Determine day of week of the beginning date
               ADD 3 TO XABEG GIVING YY
               DIVIDE YY BY 7 GIVING XDWK4 REMAINDER YY
      *        Loop: Increment the date by the last week
               PERFORM UNTIL NOT (XDLSW > 0)
      *            Increment the day of week
                   ADD 1 TO YY
                   SUBTRACT 1 FROM XDLSW
      *            Put day of week into the range 1-7
                   IF (YY = 8) THEN
                       MOVE 1 TO YY
                   END-IF
      *            Selected day of the last week has been processed
                   IF (YDOE(YY) = XDSEL) THEN
      *                Increment duration
                       ADD 1 TO XDURR
                   END-IF
      *            End of loop
               END-PERFORM
           END-IF
           CONTINUE.
       XDUDYC.
           IF (XDURR = 0) THEN
      *        Return Code: Unable to calculate duration
               MOVE 'Y2U0060' TO W0RTN
           ELSE
               MOVE SPACES TO W0RTN
           END-IF
      *==============================================================
           CONTINUE.
       XDUDYE.
           EXIT.
      /EJECT
       ZASNMS SECTION.
      *==============================================================
      *    Send message to program's message queue
      *==============================================================
      *    Send if first error message or not an error message
           IF (ZAMSTP NOT = SPACES OR
               ZAFSMS NOT = 'N') THEN
               IF (ZAMSTP = SPACES) THEN
      *            Signal first error message sent
                   MOVE 'N' TO ZAFSMS
               END-IF
               IF (ZAPGMQ = SPACES) THEN
                   MOVE ZZPGM OF JOB-CONTEXT TO ZAPGMQ
               END-IF
      *        If no message file specified, use default
               IF (ZAMSGF = SPACES) THEN
                   MOVE ZADFMF TO ZAMSGF
               END-IF
               MOVE 'Y' TO ZAILE
               CALL 'Y2SNMGC' USING
      *        Program queue
                 ZAPGMQ
      *        Relative queue
                 ZAPGRL
      *        Message ID
                 ZAMSID
      *        Message file
                 ZAMSGF
      *        Message data
                 ZAMSDA
      *        Message type
                 ZAMSTP
                 ZAILE
               END-CALL
           END-IF
      *    Clear all fields for default mechanism next time
      *    Program queue
           MOVE SPACES TO ZAPGMQ
      *    Relative queue
           MOVE SPACES TO ZAPGRL
      *    Message ID
           MOVE SPACES TO ZAMSID
      *    Message file
           MOVE SPACES TO ZAMSGF
      *    Message data
           MOVE SPACES TO ZAMSDA
      *    Message type
           MOVE SPACES TO ZAMSTP
      *==============================================================
           CONTINUE.
       ZAEXIT.
           EXIT.
      /EJECT
       ZCATWK SECTION.
      *==============================================================
      *    Process *CONCAT request
      *==============================================================
           MOVE YRSW07 TO YRSW00
           MOVE ZEROS TO YRSW01
           IF (YRSW08 = SPACES) THEN
               ADD YRSW03 TO YRSW01
               ADD YRSW04 TO YRSW01
               ADD  1 TO YRSW01
               IF (YRSW01 < YRSW07) THEN
                   MOVE X'FF' TO YRSW05X(YRSW01)
               ELSE
                   MOVE X'FF' TO YRSW05X(YRSW07)
               END-IF
           END-IF
           IF (YRSW08 = 'T') THEN
               PERFORM UNTIL NOT (YRSW01 = 0)
                   SUBTRACT 1 FROM YRSW00
                   IF (YRSW00 = 0) THEN
                       MOVE X'FF' TO YRSW05X(YRSW07)
                       ADD  1  TO YRSW01
                   ELSE
                       IF (YRSW05X(YRSW00) NOT = SPACES) THEN
                           MOVE YRSW00 TO YRSW01
                           ADD   1 TO YRSW01
                           ADD  YRSW04 TO YRSW01
                           MOVE X'FF' TO YRSW05X(YRSW01)
                       END-IF
                   END-IF
               END-PERFORM
           END-IF
      *==============================================================
           CONTINUE.
       ZCEXIT.
           EXIT.
      /EJECT
       ZXEXPG SECTION.
      *==============================================================
      *    Exit program: Normal
      *==============================================================
           PERFORM ZYEXPG
      *==============================================================
           CONTINUE.
       ZXEXIT.
           EXIT.
      /EJECT
       ZYEXPG SECTION.
      *==============================================================
      *    Exit program: Direct
      *==============================================================
           CLOSE VAMDLVERL1
           CLOSE COORDDTAL1
           CLOSE RAOBEXTRL2
           CLOSE DIDLRDTAL2
           CLOSE RIC00SALL1
           CLOSE RIC00DELL1
           CLOSE RAV55EMFL1
           CLOSE RIC00MOVL0
           CLOSE VAMDLDTAL1
           CLOSE RIC00VEHL0
           CLOSE RIC00MOVL1
      *    Reset entry parameters as appropriate
           PERFORM ZZEXPM.
      *    Exit program
           CONTINUE.
       ZYEXPG-EXIT.
           GOBACK.
      *==============================================================
           CONTINUE.
       ZYEXIT.
           EXIT.
      /EJECT
       ZZEXPM SECTION.
      *==============================================================
      *    Return parameters from work fields
      *==============================================================
      *==============================================================
           CONTINUE.
       ZZPEXT.
           EXIT.
      /EJECT
       ZZINIT SECTION.
      *==============================================================
      *    Initialisation
      *==============================================================
           IF (W0ICL = SPACES) THEN
      *        *Initial call
               MOVE 'Y' TO W0ICL
           ELSE
               MOVE 'N' TO W0ICL
           END-IF
           MOVE SPACES TO P0RTN
           MOVE SPACES TO W0RTN
           MOVE ZEROS  TO W0RTW
           MOVE SPACES TO W0RSF
           MOVE '400' TO W0ENV
           MOVE ALL B'0' TO INDICS
           MOVE SPACES TO ZZPGM OF JOB-CONTEXT
      *    Retrieve job attributes
           CALL 'Y2RTJCR' USING
             JOB-CONTEXT
           END-CALL
      *    Setup job date/time
           MOVE ZZSD7 OF JOB-CONTEXT TO ZZJDT
           ACCEPT ZZTIME FROM TIME
           MOVE ZZHNS TO ZZJTM OF JOB-CONTEXT
           MOVE 'RIC000121S' TO ZZPGM OF JOB-CONTEXT
      *    Define work field U:Number (2.0)
           MOVE ZERO TO WUNBR2 OF WORK-CONTEXT
      *    Define work field U:Number (6.0)
           MOVE ZERO TO WUNUM6 OF WORK-CONTEXT
      *    Define work field U:Date
           MOVE ZERO TO WUDATE OF WORK-CONTEXT
      *    Define work field U:Days 2
           MOVE ZERO TO WUUDAYS2 OF WORK-CONTEXT
      *    Define work field U:Days 3
           MOVE ZERO TO WUUDAYS3 OF WORK-CONTEXT
      *    Define work field U:Code (5)
           MOVE SPACES TO WUUCODE5 OF WORK-CONTEXT
      *    Define work field Planned Arrival UK DATE
           MOVE SPACES TO WUARDATE OF WORK-CONTEXT
      *    Define work field Planned Arrival in UK 2
           MOVE ZERO TO WUPLADATE2 OF WORK-CONTEXT
      *    Define work field Order Business Day
           MOVE ZERO TO WUORBUSDAY OF WORK-CONTEXT
      *    Define work field FON
           MOVE SPACES TO WUFON OF WORK-CONTEXT
      *    Obtain default message file
           MOVE 'RAMGFLA' TO DATA-AREA-NAME
           CALL 'Y2RTDAC' USING
             DATA-AREA-NAME
             ZADFMF
           END-CALL
      *    Signal first error message outstanding
           MOVE 'Y' TO ZAFSMS
      *    Open files
           OPEN INPUT VAMDLVERL1
           ACCEPT VAMDLVERL1-OPEN FROM OPEN-FEEDBACK-AREA FOR VAMDLVERL1
      *    Move main file information to JOB context
           MOVE CORRESPONDING OPENFA OF VAMDLVERL1-OPEN TO JOB-CONTEXT
           CALL 'Y2QLVNR' USING
             ZZFFL OF JOB-CONTEXT
             ZZFLB OF JOB-CONTEXT
             ZZFQL OF JOB-CONTEXT
           END-CALL
           OPEN INPUT COORDDTAL1
           ACCEPT COORDDTAL1-OPEN FROM OPEN-FEEDBACK-AREA FOR COORDDTAL1
           OPEN INPUT RAOBEXTRL2
           ACCEPT RAOBEXTRL2-OPEN FROM OPEN-FEEDBACK-AREA FOR RAOBEXTRL2
           OPEN INPUT DIDLRDTAL2
           ACCEPT DIDLRDTAL2-OPEN FROM OPEN-FEEDBACK-AREA FOR DIDLRDTAL2
           OPEN INPUT RIC00SALL1
           ACCEPT RIC00SALL1-OPEN FROM OPEN-FEEDBACK-AREA FOR RIC00SALL1
           OPEN INPUT RIC00DELL1
           ACCEPT RIC00DELL1-OPEN FROM OPEN-FEEDBACK-AREA FOR RIC00DELL1
           OPEN INPUT RAV55EMFL1
           ACCEPT RAV55EMFL1-OPEN FROM OPEN-FEEDBACK-AREA FOR RAV55EMFL1
           OPEN INPUT RIC00MOVL0
           ACCEPT RIC00MOVL0-OPEN FROM OPEN-FEEDBACK-AREA FOR RIC00MOVL0
           OPEN INPUT VAMDLDTAL1
           ACCEPT VAMDLDTAL1-OPEN FROM OPEN-FEEDBACK-AREA FOR VAMDLDTAL1
           OPEN I-O RIC00VEHL0
           ACCEPT RIC00VEHL0-OPEN FROM OPEN-FEEDBACK-AREA FOR RIC00VEHL0
           OPEN I-O RIC00MOVL1
           ACCEPT RIC00MOVL1-OPEN FROM OPEN-FEEDBACK-AREA FOR RIC00MOVL1
           MOVE 'Y' TO W0OPN
           MOVE 'N' TO W0PMT
      *    Define local work field Build Week
           MOVE SPACES TO YL0001 OF WORK-CONTEXT
      *    Define local work field Build Year (A)
           MOVE SPACES TO YL0002 OF WORK-CONTEXT
      *    Define local work field Customer Order Date(char)
           MOVE SPACES TO YL0003 OF WORK-CONTEXT
      *    Define local work field U:Job Date DTX
           MOVE ZERO TO YL0004 OF WORK-CONTEXT
      *    Define local work field Extract date  (8)
           MOVE SPACES TO YL0005 OF WORK-CONTEXT
      *    Define local work field De-Reg Date
           MOVE ZERO TO YL0006 OF WORK-CONTEXT
      *    Define local work field U:Date CDE(8)
           MOVE SPACES TO YL0007 OF WORK-CONTEXT
      *    Define local work field Deliverable Period YYYYMM
           MOVE SPACES TO YL0008 OF WORK-CONTEXT
      *    Define local work field Order Period YYYYMM
           MOVE SPACES TO YL0009 OF WORK-CONTEXT
      *    Define local work field Order Month
           MOVE SPACES TO YL0010 OF WORK-CONTEXT
      *    Define local work field Cancelled Period YYYYMM
           MOVE SPACES TO YL0011 OF WORK-CONTEXT
      *    Define local work field Extraction Type
           MOVE SPACES TO YL0012 OF WORK-CONTEXT
      *    Define local work field Reg Count
           MOVE SPACES TO YL0013 OF WORK-CONTEXT
      *    Define local work field Order Count
           MOVE SPACES TO YL0014 OF WORK-CONTEXT
      *    Define local work field Cancellation count
           MOVE SPACES TO YL0015 OF WORK-CONTEXT
      *    Define local work field Car/Van text
           MOVE SPACES TO YL0016 OF WORK-CONTEXT
      *    Define local work field Version Marketing Desc
           MOVE SPACES TO YN0001 OF WORK-CONTEXT
      *    Define local work field V55 Model Version Desc
           MOVE SPACES TO YN0002 OF WORK-CONTEXT
      *    Define local work field Manufacturer Code
           MOVE SPACES TO YN0003 OF WORK-CONTEXT
      *    Define local work field SMMT MVRIS Make Code
           MOVE SPACES TO YN0004 OF WORK-CONTEXT
      *    Define local work field SMMT MVRIS Model Code
           MOVE SPACES TO YN0005 OF WORK-CONTEXT
      *    Define local work field SMMT DVLA Make Code
           MOVE SPACES TO YN0006 OF WORK-CONTEXT
      *    Define local work field SMMT DVLA Model Code
           MOVE SPACES TO YN0007 OF WORK-CONTEXT
      *    Define local work field Vehicle Body Class Code
           MOVE SPACES TO YL0017 OF WORK-CONTEXT
      *    Define local work field Vehicle Body Code
           MOVE SPACES TO YN0008 OF WORK-CONTEXT
      *    Define local work field Vehicle Body Name
           MOVE SPACES TO YN0009 OF WORK-CONTEXT
      *    Define local work field DVLA Type Approval Categ
           MOVE SPACES TO YN0010 OF WORK-CONTEXT
      *    Define local work field Vehicle Fuel Code
           MOVE SPACES TO YN0011 OF WORK-CONTEXT
      *    Define local work field Model Engine Capacity
           MOVE ZERO TO YN0012 OF WORK-CONTEXT
      *    Define local work field Gross Weight
           MOVE ZERO TO YN0013 OF WORK-CONTEXT
      *    Define local work field Net Weight
           MOVE ZERO TO YN0014 OF WORK-CONTEXT
      *    Define local work field Typemines
           MOVE SPACES TO YN0015 OF WORK-CONTEXT
      *    Define local work field High Performance (Y/N)
           MOVE SPACES TO YN0016 OF WORK-CONTEXT
      *    Define local work field Special Edition  (Y/N)
           MOVE SPACES TO YN0017 OF WORK-CONTEXT
      *    Define local work field Gearbox Type
           MOVE SPACES TO YN0018 OF WORK-CONTEXT
      *    Define local work field Number of doors
           MOVE ZERO TO YN0019 OF WORK-CONTEXT
      *    Define local work field Seating Capacity V55
           MOVE ZERO TO YN0020 OF WORK-CONTEXT
      *    Define local work field Tax Class Code
           MOVE ZERO TO YN0021 OF WORK-CONTEXT
      *    Define local work field Vehicle Database Rec Sts
           MOVE SPACES TO YN0022 OF WORK-CONTEXT
      *    Define local work field On Block
           MOVE SPACES TO YL0018 OF WORK-CONTEXT
      *    Define local work field Chassis Situation
           MOVE SPACES TO YL0019 OF WORK-CONTEXT
      *    Define local work field Customer Order Date #
           MOVE ZERO TO YN0023 OF WORK-CONTEXT
      *    Define local work field Secondary Network Account
           MOVE SPACES TO YL0020 OF WORK-CONTEXT
      *    Define local work field Owning Account Maille
           MOVE SPACES TO YN0024 OF WORK-CONTEXT
      *    Define local work field Owning Account Category
           MOVE SPACES TO YN0025 OF WORK-CONTEXT
      *    Define local work field Order Type code
           MOVE SPACES TO YN0026 OF WORK-CONTEXT
      *    Define local work field Order Type(Local)
           MOVE SPACES TO YN0027 OF WORK-CONTEXT
      *    Define local work field Order Type(Central)
           MOVE SPACES TO YN0028 OF WORK-CONTEXT
      *    Define local work field SD Sales Channel Code
           MOVE SPACES TO YL0021 OF WORK-CONTEXT
      *    Define local work field SEDRE Customer Type
           MOVE SPACES TO YL0022 OF WORK-CONTEXT
      *    Define local work field CO cust type P/S-derived
           MOVE SPACES TO YN0029 OF WORK-CONTEXT
      *    Define local work field Cust OLD DVLA Flag
           MOVE SPACES TO YN0030 OF WORK-CONTEXT
      *    Define local work field SD Order Status Code
           MOVE SPACES TO YN0031 OF WORK-CONTEXT
      *    Define local work field SEDRE last message update
           MOVE SPACES TO YN0032 OF WORK-CONTEXT
      *    Define local work field Last Msg Sending Code
           MOVE SPACES TO YN0033 OF WORK-CONTEXT
      *    Define local work field APL Code
           MOVE SPACES TO YN0034 OF WORK-CONTEXT
      *    Define local work field SCP Model Code
           MOVE SPACES TO YN0035 OF WORK-CONTEXT
      *    Define local work field Model Phase
           MOVE SPACES TO YN0036 OF WORK-CONTEXT
      *    Define local work field SCP Model Version Code
           MOVE SPACES TO YN0037 OF WORK-CONTEXT
      *    Define local work field Colour Code
           MOVE SPACES TO YN0038 OF WORK-CONTEXT
      *    Define local work field Colour Short Description
           MOVE SPACES TO YN0039 OF WORK-CONTEXT
      *    Define local work field SCP Options
           MOVE SPACES TO YN0040 OF WORK-CONTEXT
      *    Define local work field SCP Trim Type
           MOVE SPACES TO YN0041 OF WORK-CONTEXT
      *    Define local work field SCP Trim Colour
           MOVE SPACES TO YN0042 OF WORK-CONTEXT
      *    Define local work field Cust Desired Delivery Dte
           MOVE ZERO TO YL0023 OF WORK-CONTEXT
      *    Define local work field Type VP/VU
           MOVE SPACES TO YN0043 OF WORK-CONTEXT
      *    Define local work field Order Changed Date
           MOVE ZERO TO YN0044 OF WORK-CONTEXT
      *    Define local work field Order Cancelled Date
           MOVE ZERO TO YN0045 OF WORK-CONTEXT
      *    Define local work field Order Cancellation Reason
           MOVE SPACES TO YL0024 OF WORK-CONTEXT
      *    Define local work field Salesperson Code
           MOVE SPACES TO YL0025 OF WORK-CONTEXT
      *    Define local work field Fleet Operator Number
           MOVE SPACES TO YN0046 OF WORK-CONTEXT
      *    Define local work field SEDRE Customer Code
           MOVE SPACES TO YN0047 OF WORK-CONTEXT
      *    Define local work field Surname/Company name
           MOVE SPACES TO YL0026 OF WORK-CONTEXT
      *    Define local work field Customer Forename
           MOVE SPACES TO YN0048 OF WORK-CONTEXT
      *    Define local work field Initials
           MOVE SPACES TO YN0049 OF WORK-CONTEXT
      *    Define local work field Title Code
           MOVE SPACES TO YN0050 OF WORK-CONTEXT
      *    Define local work field Address L1
           MOVE SPACES TO YN0051 OF WORK-CONTEXT
      *    Define local work field Address L2
           MOVE SPACES TO YN0052 OF WORK-CONTEXT
      *    Define local work field Address L3
           MOVE SPACES TO YN0053 OF WORK-CONTEXT
      *    Define local work field Address Town (40)
           MOVE SPACES TO YN0054 OF WORK-CONTEXT
      *    Define local work field Postcode
           MOVE SPACES TO YN0055 OF WORK-CONTEXT
      *    Define local work field Gender
           MOVE SPACES TO YN0056 OF WORK-CONTEXT
      *    Define local work field Customer Date of Birth
           MOVE ZERO TO YN0057 OF WORK-CONTEXT
      *    Define local work field Cust. daytime phone code
           MOVE SPACES TO YN0058 OF WORK-CONTEXT
      *    Define local work field Cust. daytime phone nbr
           MOVE SPACES TO YN0059 OF WORK-CONTEXT
      *    Define local work field Cust. evening phone code
           MOVE SPACES TO YN0060 OF WORK-CONTEXT
      *    Define local work field Cust. evening phone nbr
           MOVE SPACES TO YN0061 OF WORK-CONTEXT
      *    Define local work field Cust. mobile phone code
           MOVE SPACES TO YN0062 OF WORK-CONTEXT
      *    Define local work field Cust. mobile phone nbr
           MOVE SPACES TO YN0063 OF WORK-CONTEXT
      *    Define local work field Cust. fax phone code
           MOVE SPACES TO YN0064 OF WORK-CONTEXT
      *    Define local work field Cust. fax phone nbr
           MOVE SPACES TO YN0065 OF WORK-CONTEXT
      *    Define local work field Cust. Email Address
           MOVE SPACES TO YN0066 OF WORK-CONTEXT
      *    Define local work field Annual Mileage
           MOVE ZERO TO YN0067 OF WORK-CONTEXT
      *    Define local work field OK to mail?
           MOVE SPACES TO YN0068 OF WORK-CONTEXT
      *    Define local work field OK to phone?
           MOVE SPACES TO YN0069 OF WORK-CONTEXT
      *    Define local work field OK to email?
           MOVE SPACES TO YN0070 OF WORK-CONTEXT
      *    Define local work field OK to text?
           MOVE SPACES TO YN0071 OF WORK-CONTEXT
      *    Define local work field OK to fax?
           MOVE SPACES TO YN0072 OF WORK-CONTEXT
      *    Define local work field Share mail data?
           MOVE SPACES TO YN0073 OF WORK-CONTEXT
      *    Define local work field Share email data?
           MOVE SPACES TO YN0074 OF WORK-CONTEXT
      *    Define local work field Profession
           MOVE SPACES TO YN0075 OF WORK-CONTEXT
      *    Define local work field Job Function
           MOVE SPACES TO YN0076 OF WORK-CONTEXT
      *    Define local work field Customer Business Type
           MOVE SPACES TO YN0077 OF WORK-CONTEXT
      *    Define local work field Customer VAT Number
           MOVE SPACES TO YN0078 OF WORK-CONTEXT
      *    Define local work field VED Exempt Certificate
           MOVE SPACES TO YN0079 OF WORK-CONTEXT
      *    Define local work field VED Exempt Expiry Date
           MOVE ZERO TO YN0080 OF WORK-CONTEXT
      *    Define local work field Social Security Number
           MOVE SPACES TO YN0081 OF WORK-CONTEXT
      *    Define local work field DVLA Fleet Number
           MOVE SPACES TO YN0082 OF WORK-CONTEXT
      *    Define local work field Part Ex-change Flag
           MOVE SPACES TO YN0083 OF WORK-CONTEXT
      *    Define local work field Current Vehicle Model
           MOVE SPACES TO YN0084 OF WORK-CONTEXT
      *    Define local work field Current Vehicle Reg Nbr
           MOVE SPACES TO YN0085 OF WORK-CONTEXT
      *    Define local work field Part-Ex Veh Mileage
           MOVE ZERO TO YN0086 OF WORK-CONTEXT
      *    Define local work field Finance Period (Months)
           MOVE ZERO TO YN0087 OF WORK-CONTEXT
      *    Define local work field No. Renaults Owned
           MOVE ZERO TO YN0088 OF WORK-CONTEXT
      *    Define local work field No. Vehs in Household
           MOVE ZERO TO YN0089 OF WORK-CONTEXT
      *    Define local work field Planned Retention Period
           MOVE ZERO TO YN0090 OF WORK-CONTEXT
      *    Define local work field Insurance Renewal Date #
           MOVE ZERO TO YN0091 OF WORK-CONTEXT
      *    Define local work field Payment/Finance Type
           MOVE SPACES TO YN0092 OF WORK-CONTEXT
      *    Define local work field V55 Requested?
           MOVE SPACES TO YN0093 OF WORK-CONTEXT
      *    Define local work field Offer Code 1
           MOVE SPACES TO YN0094 OF WORK-CONTEXT
      *    Define local work field Offer Code 2
           MOVE SPACES TO YN0095 OF WORK-CONTEXT
      *    Define local work field Prospect Lead Id
           MOVE SPACES TO YN0096 OF WORK-CONTEXT
      *    Define local work field Customer Order Comments
           MOVE SPACES TO YN0097 OF WORK-CONTEXT
      *    Define local work field Customer Ref/P.O. Number
           MOVE SPACES TO YN0098 OF WORK-CONTEXT
      *    Define local work field Special Deal Id
           MOVE SPACES TO YN0099 OF WORK-CONTEXT
      *    Define local work field Fleet PCN
           MOVE SPACES TO YN0100 OF WORK-CONTEXT
      *    Define local work field Date of first allocation
           MOVE ZERO TO YN0101 OF WORK-CONTEXT
      *    Define local work field Date of last deallocation
           MOVE ZERO TO YN0102 OF WORK-CONTEXT
      *    Define local work field CO Buy/Lease Flag
           MOVE SPACES TO YN0103 OF WORK-CONTEXT
      *    Define local work field CO Spare Status 2
           MOVE SPACES TO YN0104 OF WORK-CONTEXT
      *    Define local work field CO Spare Status 3
           MOVE SPACES TO YN0105 OF WORK-CONTEXT
      *    Define local work field CO MR contract date
           MOVE ZERO TO YN0106 OF WORK-CONTEXT
      *    Define local work field CO Spare Date 2
           MOVE ZERO TO YN0107 OF WORK-CONTEXT
      *    Define local work field CO MR Contract number
           MOVE SPACES TO YN0108 OF WORK-CONTEXT
      *    Define local work field CO Spare Code 2
           MOVE SPACES TO YN0109 OF WORK-CONTEXT
      *    Define local work field CO Spare Code 3
           MOVE SPACES TO YN0110 OF WORK-CONTEXT
      *    Define local work field Agreement (DEFIPRO) Num
           MOVE SPACES TO YN0111 OF WORK-CONTEXT
      *    Define local work field CO Spare Text 2
           MOVE SPACES TO YN0112 OF WORK-CONTEXT
      *    Define local work field CO Spare Status 4
           MOVE SPACES TO YN0113 OF WORK-CONTEXT
      *    Define local work field FM Fleet Account Code
           MOVE SPACES TO YN0114 OF WORK-CONTEXT
      *    Define local work field FM Agreement Number (FON)
           MOVE SPACES TO YL0027 OF WORK-CONTEXT
      *    Define local work field FM Agreement Version Nbr
           MOVE SPACES TO YL0028 OF WORK-CONTEXT
      *    Define local work field Cust Ord Exists
           MOVE SPACES TO YN0115 OF WORK-CONTEXT
      *    Define local work field Order Cancellation desti
           MOVE SPACES TO YL0029 OF WORK-CONTEXT
      *    Define local work field Customer Delivery Date(a)
           MOVE SPACES TO YL0030 OF WORK-CONTEXT
      *    Define local work field CDD Period YYYYMM
           MOVE SPACES TO YL0031 OF WORK-CONTEXT
      *    Define local work field U:Date YYYYMM (CDE)
           MOVE SPACES TO YL0032 OF WORK-CONTEXT
      *    Define local work field U:Job Date DTX
           MOVE ZERO TO YL0033 OF WORK-CONTEXT
      *    Define local work field U:Date CDE(8)
           MOVE SPACES TO YL0034 OF WORK-CONTEXT
      *    Define local work field U:Month Current
           MOVE SPACES TO YL0035 OF WORK-CONTEXT
      *    Define local work field U:Date YYYYMM a
           MOVE SPACES TO YL0036 OF WORK-CONTEXT
      *    Define local work field U:Month YYYYMM
           MOVE ZERO TO YL0037 OF WORK-CONTEXT
      *    Define local work field U:Number (3.0)
           MOVE ZERO TO YL0038 OF WORK-CONTEXT
      *    Define local work field Date change (YYYYMM)
           MOVE SPACES TO YL0039 OF WORK-CONTEXT
      *    Define local work field U:Month Ref
           MOVE SPACES TO YL0040 OF WORK-CONTEXT
      *    Define local work field U:Month 2
           MOVE ZERO TO YL0041 OF WORK-CONTEXT
      *    Define local work field U:Date YYYYMM b
           MOVE SPACES TO YL0042 OF WORK-CONTEXT
      *    Define local work field U:Date YYYYMM c
           MOVE SPACES TO YL0043 OF WORK-CONTEXT
      *    Define local work field CDD M Ind
           MOVE SPACES TO YL0044 OF WORK-CONTEXT
      *    Define local work field Arrival Date
           MOVE ZERO TO YL0045 OF WORK-CONTEXT
      *    Define local work field U:Date
           MOVE ZERO TO YL0046 OF WORK-CONTEXT
      *    Define local work field U:Date From
           MOVE ZERO TO YL0047 OF WORK-CONTEXT
      *    Define local work field U:Date YYYYMMDD
           MOVE ZERO TO YL0048 OF WORK-CONTEXT
      *    Define local work field Arrival Period YYYYMM
           MOVE SPACES TO YL0049 OF WORK-CONTEXT
      *    Define local work field Fleet Channel
           MOVE SPACES TO YL0050 OF WORK-CONTEXT
      *    Define local work field VEH-RETCODE
           MOVE SPACES TO YL0051 OF WORK-CONTEXT
      *    Define local work field VEH-RECORD-AVEHBR2CB
           MOVE SPACES TO YL0052 OF WORK-CONTEXT
      *    Define local work field U:Text (7) b
           MOVE SPACES TO YL0053 OF WORK-CONTEXT
      *    Define local work field SEDRE hdr APL code
           MOVE SPACES TO YL0054 OF WORK-CONTEXT
      *    Define local work field Brand Name Display
           MOVE SPACES TO YL0055 OF WORK-CONTEXT
      *    Define local work field Dealer number (Num key)
           MOVE ZERO TO YL0056 OF WORK-CONTEXT
      *    Define local work field BDC Order Date YYYYMM
           MOVE SPACES TO YN0116 OF WORK-CONTEXT
      *    Define local work field Zone Code
           MOVE SPACES TO YN0117 OF WORK-CONTEXT
      *    Define local work field Network/Non Network Ind
           MOVE SPACES TO YL0057 OF WORK-CONTEXT
      *    Define local work field BDC Order Cnl Dte YYYYMM
           MOVE SPACES TO YN0118 OF WORK-CONTEXT
      *    Define local work field BDC Model Version
           MOVE SPACES TO YN0119 OF WORK-CONTEXT
      *    Define local work field Chassis number
           MOVE SPACES TO YN0120 OF WORK-CONTEXT
      *    Define local work field BDC Order Crt Date
           MOVE ZERO TO YN0121 OF WORK-CONTEXT
      *    Define local work field BDC Order Cnl Date
           MOVE ZERO TO YN0122 OF WORK-CONTEXT
      *    Define local work field TYPE CLIENT SEDRE
           MOVE SPACES TO YN0123 OF WORK-CONTEXT
      *    Define local work field TYPE DR CENTRAL
           MOVE SPACES TO YN0124 OF WORK-CONTEXT
      *    Define local work field SD Sales Channel Code
           MOVE SPACES TO YN0125 OF WORK-CONTEXT
      *    Define local work field Fleet Report Group Code
           MOVE SPACES TO YL0058 OF WORK-CONTEXT
      *    Define local work field Fleet Report Group Plan
           MOVE SPACES TO YL0059 OF WORK-CONTEXT
      *    Define local work field Sell Price
           MOVE ZERO TO YN0126 OF WORK-CONTEXT
      *    Define local work field BDC Payment Method
           MOVE SPACES TO YL0060 OF WORK-CONTEXT
      *    Define local work field BDC Payment Term
           MOVE SPACES TO YL0061 OF WORK-CONTEXT
      *    Define local work field Report Group Description
           MOVE SPACES TO YN0127 OF WORK-CONTEXT
      *    Define local work field OBT Count Target Status
           MOVE SPACES TO YL0062 OF WORK-CONTEXT
      *    Define local work field Registration Date 58
           MOVE ZERO TO YN0128 OF WORK-CONTEXT
      *    Define local work field De-registration Date #
           MOVE ZERO TO YN0129 OF WORK-CONTEXT
      *    Define local work field SD Order Type Assoc w FON
           MOVE SPACES TO YN0130 OF WORK-CONTEXT
      *    Define local work field Fleet Programmes Code
           MOVE SPACES TO YL0063 OF WORK-CONTEXT
      *    Define local work field Fleet Programmes Desc
           MOVE SPACES TO YL0064 OF WORK-CONTEXT
      *    Define local work field FM Agreement Number (FON)
           MOVE SPACES TO YN0131 OF WORK-CONTEXT
      *    Define local work field FM Agreement Version Nbr
           MOVE SPACES TO YN0132 OF WORK-CONTEXT
      *    Define local work field Target Market
           MOVE SPACES TO YL0065 OF WORK-CONTEXT
      *    Define local work field Dealer Number
           MOVE SPACES TO YL0066 OF WORK-CONTEXT
      *    Define local work field Delivery Account
           MOVE SPACES TO YL0067 OF WORK-CONTEXT
      *    Define local work field Dealer Number Suffix
           MOVE SPACES TO YL0068 OF WORK-CONTEXT
      *    Define local work field Dealer Network Type
           MOVE SPACES TO YL0069 OF WORK-CONTEXT
      *    Define local work field Name Number
           MOVE SPACES TO YN0133 OF WORK-CONTEXT
      *    Define local work field Address Number
           MOVE SPACES TO YN0134 OF WORK-CONTEXT
      *    Define local work field Dealer Region Code
           MOVE SPACES TO YN0135 OF WORK-CONTEXT
      *    Define local work field Dealer Zone Code
           MOVE SPACES TO YN0136 OF WORK-CONTEXT
      *    Define local work field Dealer Trading Name
           MOVE SPACES TO YN0137 OF WORK-CONTEXT
      *    Define local work field Dealer Known by Name
           MOVE SPACES TO YN0138 OF WORK-CONTEXT
      *    Define local work field Dealer short name
           MOVE SPACES TO YN0139 OF WORK-CONTEXT
      *    Define local work field Dealer Activity Start Dte
           MOVE ZERO TO YN0140 OF WORK-CONTEXT
      *    Define local work field Dealer Servicing End Date
           MOVE ZERO TO YN0141 OF WORK-CONTEXT
      *    Define local work field Dealer Cancel Final Date
           MOVE ZERO TO YN0142 OF WORK-CONTEXT
      *    Define local work field Dealer Set-Up Date
           MOVE ZERO TO YN0143 OF WORK-CONTEXT
      *    Define local work field Dealer Change Date
           MOVE ZERO TO YN0144 OF WORK-CONTEXT
      *    Define local work field Dealer Cancel Date
           MOVE ZERO TO YN0145 OF WORK-CONTEXT
      *    Define local work field Dealer Financial Status
           MOVE SPACES TO YN0146 OF WORK-CONTEXT
      *    Define local work field Dealer Record Status
           MOVE SPACES TO YN0147 OF WORK-CONTEXT
      *    Define local work field BIR Address Identifier
           MOVE SPACES TO YN0148 OF WORK-CONTEXT
      *    Define local work field Dealer Address Line#1
           MOVE SPACES TO YN0149 OF WORK-CONTEXT
      *    Define local work field Dealer Address Line#2
           MOVE SPACES TO YN0150 OF WORK-CONTEXT
      *    Define local work field Dealer Address Line#3
           MOVE SPACES TO YN0151 OF WORK-CONTEXT
      *    Define local work field Dealer Address Line#4 ?
           MOVE SPACES TO YN0152 OF WORK-CONTEXT
      *    Define local work field Dealer Postal Code
           MOVE SPACES TO YN0153 OF WORK-CONTEXT
      *    Define local work field Dealer Town
           MOVE SPACES TO YN0154 OF WORK-CONTEXT
      *    Define local work field Dealer Telephone Number
           MOVE SPACES TO YN0155 OF WORK-CONTEXT
      *    Define local work field Dealer Fax Number
           MOVE SPACES TO YN0156 OF WORK-CONTEXT
      *    Define local work field Dealer Country Identifier
           MOVE SPACES TO YN0157 OF WORK-CONTEXT
      *    Define local work field Network/Non Network Ind
           MOVE SPACES TO YN0158 OF WORK-CONTEXT
      *    Define local work field Dealer Number (Numeric)
           MOVE ZERO TO YN0159 OF WORK-CONTEXT
      *    Define local work field Lead Dealer Number
           MOVE SPACES TO YN0160 OF WORK-CONTEXT
      *    Define local work field Lead Dealer Number Suffix
           MOVE SPACES TO YN0161 OF WORK-CONTEXT
      *    Define local work field Lead Dealer Nbr (Numeric)
           MOVE ZERO TO YN0162 OF WORK-CONTEXT
      *    Define local work field Lead Country Identifier
           MOVE SPACES TO YN0163 OF WORK-CONTEXT
      *    Define local work field Dealer AFRL/V55 flag
           MOVE SPACES TO YN0164 OF WORK-CONTEXT
      *    Define local work field Dealer Spare Flag 2
           MOVE SPACES TO YN0165 OF WORK-CONTEXT
      *    Define local work field Dealer Spare Flag 3
           MOVE SPACES TO YN0166 OF WORK-CONTEXT
      *    Define local work field Dealer Spare Code 1
           MOVE SPACES TO YN0167 OF WORK-CONTEXT
      *    Define local work field Dealer Spare Code 2
           MOVE SPACES TO YN0168 OF WORK-CONTEXT
      *    Define local work field Dealer Percentage 1
           MOVE ZERO TO YN0169 OF WORK-CONTEXT
      *    Define local work field Dealer Percentage 2
           MOVE ZERO TO YN0170 OF WORK-CONTEXT
      *    Define local work field Dealer Percentage 3
           MOVE ZERO TO YN0171 OF WORK-CONTEXT
      *    Define local work field Dealer Percentage 4
           MOVE ZERO TO YN0172 OF WORK-CONTEXT
      *    Define local work field Conversion Count
           MOVE SPACES TO YL0070 OF WORK-CONTEXT
      *    Define local work field U:Start date DTX
           MOVE ZERO TO YN0173 OF WORK-CONTEXT
      *    Define local work field U:date last of M
           MOVE ZERO TO YL0071 OF WORK-CONTEXT
      *    Define local work field U:date last of M+1
           MOVE ZERO TO YL0072 OF WORK-CONTEXT
      *    Define local work field U:date last of M+2
           MOVE ZERO TO YL0073 OF WORK-CONTEXT
      *    Define local work field U:date last of M+3
           MOVE ZERO TO YL0074 OF WORK-CONTEXT
      *    Define local work field Pull Forward M+1
           MOVE SPACES TO YL0075 OF WORK-CONTEXT
      *    Define local work field Pull Forward M+2
           MOVE SPACES TO YL0076 OF WORK-CONTEXT
      *    Define local work field Pull Forward M+3
           MOVE SPACES TO YL0077 OF WORK-CONTEXT
      *    Define local work field Pull Forward M+4
           MOVE SPACES TO YL0078 OF WORK-CONTEXT
      *    Define local work field Available Count
           MOVE SPACES TO YL0079 OF WORK-CONTEXT
      *    Define local work field Sales Channel Desc
           MOVE SPACES TO YL0080 OF WORK-CONTEXT
      *    Define local work field SMMT / Market Channel
           MOVE SPACES TO YN0174 OF WORK-CONTEXT
      *    Define local work field MVRIS Channel
           MOVE SPACES TO YL0081 OF WORK-CONTEXT
      *    Define local work field PM Channel
           MOVE SPACES TO YL0082 OF WORK-CONTEXT
      *    Define local work field Target Channel
           MOVE SPACES TO YL0083 OF WORK-CONTEXT
      *    Define local work field Dealer Number Code (5)
           MOVE SPACES TO YL0084 OF WORK-CONTEXT
      *    Define local work field AMF Code
           MOVE SPACES TO YL0085 OF WORK-CONTEXT
      *    Define local work field Dealer Status
           MOVE SPACES TO YL0086 OF WORK-CONTEXT
      *    Define local work field Effective Date (/)
           MOVE SPACES TO YL0087 OF WORK-CONTEXT
      *    Define local work field Effective Date
           MOVE ZERO TO YN0175 OF WORK-CONTEXT
      *    Define local work field Variant
           MOVE SPACES TO YN0176 OF WORK-CONTEXT
      *    Define local work field Category
           MOVE SPACES TO YN0177 OF WORK-CONTEXT
      *    Define local work field Length
           MOVE ZERO TO YN0178 OF WORK-CONTEXT
      *    Define local work field Width
           MOVE ZERO TO YN0179 OF WORK-CONTEXT
      *    Define local work field Mass (kg)
           MOVE ZERO TO YN0180 OF WORK-CONTEXT
      *    Define local work field COC EURO code
           MOVE SPACES TO YN0181 OF WORK-CONTEXT
      *    Define local work field Exhaust Emissions
           MOVE SPACES TO YN0182 OF WORK-CONTEXT
      *    Define local work field CO g/km
           MOVE ZERO TO YN0183 OF WORK-CONTEXT
      *    Define local work field HC / THC
           MOVE ZERO TO YN0184 OF WORK-CONTEXT
      *    Define local work field NOx
           MOVE ZERO TO YN0185 OF WORK-CONTEXT
      *    Define local work field HC+NOx
           MOVE ZERO TO YN0186 OF WORK-CONTEXT
      *    Define local work field Non-Methane Hydrocarbons
           MOVE ZERO TO YN0187 OF WORK-CONTEXT
      *    Define local work field Particulates (pm)
           MOVE ZERO TO YN0188 OF WORK-CONTEXT
      *    Define local work field CO2 g/km
           MOVE ZERO TO YL0088 OF WORK-CONTEXT
      *    Define local work field Max Permissible Mass
           MOVE ZERO TO YN0189 OF WORK-CONTEXT
      *    Define local work field Max Net Power
           MOVE ZERO TO YN0190 OF WORK-CONTEXT
      *    Define local work field Max Towable Mass-braked
           MOVE ZERO TO YN0191 OF WORK-CONTEXT
      *    Define local work field Max Towable Mass-Unbraked
           MOVE ZERO TO YN0192 OF WORK-CONTEXT
      *    Define local work field Sound Level - stationary
           MOVE ZERO TO YN0193 OF WORK-CONTEXT
      *    Define local work field Sound Level - engine spd
           MOVE ZERO TO YN0194 OF WORK-CONTEXT
      *    Define local work field Sound level - Drive-By
           MOVE ZERO TO YN0195 OF WORK-CONTEXT
      *    Define local work field Fuel Consumption LT Urban
           MOVE ZERO TO YN0196 OF WORK-CONTEXT
      *    Define local work field Fuel Consumption LT ExUb
           MOVE ZERO TO YN0197 OF WORK-CONTEXT
      *    Define local work field Fuel Consumption LT Comb
           MOVE ZERO TO YN0198 OF WORK-CONTEXT
      *    Define local work field AFRL Manufacturer Code
           MOVE SPACES TO YN0199 OF WORK-CONTEXT
      *    Define local work field Type Approval category
           MOVE SPACES TO YN0200 OF WORK-CONTEXT
      *    Define local work field Manufacturer Vehicle Type
           MOVE SPACES TO YN0201 OF WORK-CONTEXT
      *    Define local work field Wheelbase
           MOVE SPACES TO YN0202 OF WORK-CONTEXT
      *    Define local work field Track width #1 minimum
           MOVE SPACES TO YN0203 OF WORK-CONTEXT
      *    Define local work field Track width #1 maximum
           MOVE SPACES TO YN0204 OF WORK-CONTEXT
      *    Define local work field Track width #2 minimum
           MOVE SPACES TO YN0205 OF WORK-CONTEXT
      *    Define local work field Track width #2 maximum
           MOVE SPACES TO YN0206 OF WORK-CONTEXT
      *    Define local work field Track width #3 minimum
           MOVE SPACES TO YN0207 OF WORK-CONTEXT
      *    Define local work field Track width #3 maximum
           MOVE SPACES TO YN0208 OF WORK-CONTEXT
      *    Define local work field Elect. energy consumption
           MOVE ZERO TO YN0209 OF WORK-CONTEXT
      *    Define local work field Electric range
           MOVE ZERO TO YN0210 OF WORK-CONTEXT
      *    Define local work field Power/Weight ratio
           MOVE ZERO TO YN0211 OF WORK-CONTEXT
      *    Define local work field U:Effective date
           MOVE ZERO TO YL0089 OF WORK-CONTEXT
      *    Define local work field U:Number (2.0)
           MOVE ZERO TO YL0090 OF WORK-CONTEXT
      *    Define local work field Core Fleet Dealer Ind
           MOVE SPACES TO YL0091 OF WORK-CONTEXT
      *    Define local work field Version Marketing Desc
           MOVE SPACES TO YN0212 OF WORK-CONTEXT
      *    Define local work field V55 Model Version Desc
           MOVE SPACES TO YN0213 OF WORK-CONTEXT
      *    Define local work field Manufacturer Code
           MOVE SPACES TO YN0214 OF WORK-CONTEXT
      *    Define local work field SMMT MVRIS Make Code
           MOVE SPACES TO YN0215 OF WORK-CONTEXT
      *    Define local work field SMMT MVRIS Model Code
           MOVE SPACES TO YN0216 OF WORK-CONTEXT
      *    Define local work field SMMT DVLA Make Code
           MOVE SPACES TO YN0217 OF WORK-CONTEXT
      *    Define local work field SMMT DVLA Model Code
           MOVE SPACES TO YN0218 OF WORK-CONTEXT
      *    Define local work field Vehicle Body Class Code
           MOVE SPACES TO YL0092 OF WORK-CONTEXT
      *    Define local work field Vehicle Body Code
           MOVE SPACES TO YL0093 OF WORK-CONTEXT
      *    Define local work field Vehicle Body Name
           MOVE SPACES TO YL0094 OF WORK-CONTEXT
      *    Define local work field DVLA Type Approval Categ
           MOVE SPACES TO YN0219 OF WORK-CONTEXT
      *    Define local work field Vehicle Fuel Code
           MOVE SPACES TO YL0095 OF WORK-CONTEXT
      *    Define local work field Model Engine Capacity
           MOVE ZERO TO YN0220 OF WORK-CONTEXT
      *    Define local work field Gross Weight
           MOVE ZERO TO YN0221 OF WORK-CONTEXT
      *    Define local work field Net Weight
           MOVE ZERO TO YN0222 OF WORK-CONTEXT
      *    Define local work field Typemines
           MOVE SPACES TO YN0223 OF WORK-CONTEXT
      *    Define local work field High Performance (Y/N)
           MOVE SPACES TO YN0224 OF WORK-CONTEXT
      *    Define local work field Special Edition  (Y/N)
           MOVE SPACES TO YN0225 OF WORK-CONTEXT
      *    Define local work field Gearbox Type
           MOVE SPACES TO YN0226 OF WORK-CONTEXT
      *    Define local work field Number of doors
           MOVE ZERO TO YN0227 OF WORK-CONTEXT
      *    Define local work field Seating Capacity V55
           MOVE ZERO TO YN0228 OF WORK-CONTEXT
      *    Define local work field Tax Class Code
           MOVE ZERO TO YN0229 OF WORK-CONTEXT
      *    Define local work field Vehicle Database Rec Sts
           MOVE SPACES TO YN0230 OF WORK-CONTEXT
      *    Define local work field Model Marketing Desc
           MOVE SPACES TO YL0096 OF WORK-CONTEXT
      *    Define local work field SC Model Year (Millesme)
           MOVE SPACES TO YN0231 OF WORK-CONTEXT
      *    Define local work field Vehicle Fuel Desc
           MOVE SPACES TO YL0097 OF WORK-CONTEXT
      *    Define local work field SCP Model Version Code
           MOVE SPACES TO YL0098 OF WORK-CONTEXT
      *    Define local work field U:Number (2.0)
           MOVE ZERO TO YL0099 OF WORK-CONTEXT
      *    Define local work field STEPWAY Ind
           MOVE SPACES TO YL0100 OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       ZZEXIT.
           EXIT.
