       PROCESS APOST GRAPHIC.
      ***************************************************************
       IDENTIFICATION DIVISION.
     H/TITLE Exc 2017o401 - Payments   Execute external functio
     Z* CRTBNDCBL
     Z* OPTION(*SRCDBG) CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Execute external function  Version:  8.7
     H* Object type   : *PGM
      *
     H* Company    : Renault (UK) Applications
     H* System     : Renault (UK) Applications
     H* User name  : PRAGTSK
     H* Date       : 18/01/18 time: 11:11:57
     H* Copyright  : Renault (UK) Applications
      *
      *==============================================================
     M* MAINTENANCE   :
      *==============================================================
       PROGRAM-ID.  SBA17O401S.
      /EJECT
      ***************************************************************
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       SOURCE-COMPUTER.  IBM-AS400.
       OBJECT-COMPUTER.  IBM-AS400.
       SPECIAL-NAMES.  OPEN-FEEDBACK IS OPEN-FEEDBACK-AREA,
           I-O-FEEDBACK IS I-O-FEEDBACK-AREA.
      /EJECT
      ***************************************************************
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
      *
           SELECT SBBNSSGWL4
             ASSIGN TO DATABASE-SBBNSSGWL4
             ORGANIZATION IS INDEXED
             ACCESS MODE IS DYNAMIC
             RECORD KEY IS EXTERNALLY-DESCRIBED-KEY
             FILE STATUS IS FILE-STATUS.
      *    RSQ : Bonus Sls-Suggest Work    Scheme,Run,Reg Dte,MdlVe
      *
           SELECT SBSCMPRML1
             ASSIGN TO DATABASE-SBSCMPRML1
             ORGANIZATION IS INDEXED
             ACCESS MODE IS DYNAMIC
             RECORD KEY IS EXTERNALLY-DESCRIBED-KEY
             FILE STATUS IS FILE-STATUS.
      *    RTV : Bonus Sls-Scheme Parms    Retrieval index
      *
           SELECT SBSCMRU2L1
             ASSIGN TO DATABASE-SBSCMRU2L1
             ORGANIZATION IS INDEXED
             ACCESS MODE IS DYNAMIC
             RECORD KEY IS EXTERNALLY-DESCRIBED-KEY
             FILE STATUS IS FILE-STATUS.
      *    RTV : Bonus Sls-Scheme Run Parm Retrieval index
      *
           SELECT SBDLRPRML1
             ASSIGN TO DATABASE-SBDLRPRML1
             ORGANIZATION IS INDEXED
             ACCESS MODE IS DYNAMIC
             RECORD KEY IS EXTERNALLY-DESCRIBED-KEY
             FILE STATUS IS FILE-STATUS.
      *    RTV : Bonus Sls-Dealer Parms    Retrieval index
      *
           SELECT DIDLRDTAL2
             ASSIGN TO DATABASE-DIDLRDTAL2
             ORGANIZATION IS INDEXED
             ACCESS MODE IS DYNAMIC
             RECORD KEY IS EXTERNALLY-DESCRIBED-KEY
             FILE STATUS IS FILE-STATUS.
      *    RTV : Dealer                    Retrieval (No Virtuals)
      *
           SELECT AMTGTDTAL7
             ASSIGN TO DATABASE-AMTGTDTAL7
             ORGANIZATION IS INDEXED
             ACCESS MODE IS DYNAMIC
             RECORD KEY IS EXTERNALLY-DESCRIBED-KEY
             FILE STATUS IS FILE-STATUS.
      *    RSQ : Target Information        Lvl/Dlr/Per/Obj
      *
           SELECT SBDOTEXTL7
             ASSIGN TO DATABASE-SBDOTEXTL7
             ORGANIZATION IS INDEXED
             ACCESS MODE IS DYNAMIC
             RECORD KEY IS EXTERNALLY-DESCRIBED-KEY
             FILE STATUS IS FILE-STATUS.
      *    RSQ : BDC.-.SEDRE DOT Extract   Dlr/Reg Date/Order No
      *
           SELECT VAMDLBNSL1
             ASSIGN TO DATABASE-VAMDLBNSL1
             ORGANIZATION IS INDEXED
             ACCESS MODE IS DYNAMIC
             RECORD KEY IS EXTERNALLY-DESCRIBED-KEY
             FILE STATUS IS FILE-STATUS.
      *    RTV : Vehicle Model Bonus Atr   Retrieval index
      *
           SELECT SBRICDSQL4
             ASSIGN TO DATABASE-SBRICDSQL4
             ORGANIZATION IS INDEXED
             ACCESS MODE IS DYNAMIC
             RECORD KEY IS EXTERNALLY-DESCRIBED-KEY
             FILE STATUS IS FILE-STATUS.
      *    RSQ : Bonus Sls-RIC Mdl Dsp Seq By Mdl, Year(D), Seq
      *
           SELECT RAOBEXTRL2
             ASSIGN TO DATABASE-RAOBEXTRL2
             ORGANIZATION IS INDEXED
             ACCESS MODE IS DYNAMIC
             RECORD KEY IS EXTERNALLY-DESCRIBED-KEY
             FILE STATUS IS FILE-STATUS.
      *    RSQ : OBT Extract               By Dlr/Mdl/ON
      *
           SELECT SBDOTEXTL8
             ASSIGN TO DATABASE-SBDOTEXTL8
             ORGANIZATION IS INDEXED
             ACCESS MODE IS DYNAMIC
             RECORD KEY IS EXTERNALLY-DESCRIBED-KEY
             FILE STATUS IS FILE-STATUS.
      *    RSQ : BDC.-.SEDRE DOT Extract   De-Registrations Only
      *
           SELECT RAOBEXTRL4
             ASSIGN TO DATABASE-RAOBEXTRL4
             ORGANIZATION IS INDEXED
             ACCESS MODE IS DYNAMIC
             RECORD KEY IS EXTERNALLY-DESCRIBED-KEY
             FILE STATUS IS FILE-STATUS.
      *    RSQ : OBT Extract               By Chassis
      *
           SELECT COORDDTAL8
             ASSIGN TO DATABASE-COORDDTAL8
             ORGANIZATION IS INDEXED
             ACCESS MODE IS DYNAMIC
             RECORD KEY IS EXTERNALLY-DESCRIBED-KEY
             FILE STATUS IS FILE-STATUS.
      *    RSQ : Customer Order            By Dlr/CusOrd Date/Ord N
      *
           SELECT COORDDEDL1
             ASSIGN TO DATABASE-COORDDEDL1
             ORGANIZATION IS INDEXED
             ACCESS MODE IS DYNAMIC
             RECORD KEY IS EXTERNALLY-DESCRIBED-KEY
             FILE STATUS IS FILE-STATUS.
      *    RTV : Customer Order Deduct VB  Retrieval index
      *
           SELECT COORDDEDL2
             ASSIGN TO DATABASE-COORDDEDL2
             ORGANIZATION IS INDEXED
             ACCESS MODE IS DYNAMIC
             RECORD KEY IS EXTERNALLY-DESCRIBED-KEY
             FILE STATUS IS FILE-STATUS.
      *    RSQ : Customer Order Deduct VB  Own Acc/Eff Date
      *
           SELECT SBDLROV2L1
             ASSIGN TO DATABASE-SBDLROV2L1
             ORGANIZATION IS INDEXED
             ACCESS MODE IS DYNAMIC
             RECORD KEY IS EXTERNALLY-DESCRIBED-KEY
             FILE STATUS IS FILE-STATUS.
      *    RTV : BonusSls-DlrPrm Override2 Retrieval index
      *
           SELECT SBBNSSGWL0
             ASSIGN TO DATABASE-SBBNSSGWL0
             ORGANIZATION IS INDEXED
             ACCESS MODE IS DYNAMIC
             RECORD KEY IS EXTERNALLY-DESCRIBED-KEY
             FILE STATUS IS FILE-STATUS.
      *    UPD : Bonus Sls-Suggest Work    Update index
      *
       I-O-CONTROL.
      *
      /EJECT
      ***************************************************************
       DATA DIVISION.
       FILE SECTION.
      *
      *
       FD  SBBNSSGWL4
           LABEL RECORDS ARE STANDARD.
       01  SBBNSSGWL4-R.
           COPY DDS-ALL-FORMATS OF SBBNSSGWL4.
      *
       FD  SBSCMPRML1
           LABEL RECORDS ARE STANDARD.
       01  SBSCMPRML1-R.
           COPY DDS-ALL-FORMATS OF SBSCMPRML1.
      *
       FD  SBSCMRU2L1
           LABEL RECORDS ARE STANDARD.
       01  SBSCMRU2L1-R.
           COPY DDS-ALL-FORMATS OF SBSCMRU2L1.
      *
       FD  SBDLRPRML1
           LABEL RECORDS ARE STANDARD.
       01  SBDLRPRML1-R.
           COPY DDS-ALL-FORMATS OF SBDLRPRML1.
      *
       FD  DIDLRDTAL2
           LABEL RECORDS ARE STANDARD.
       01  DIDLRDTAL2-R.
           COPY DDS-ALL-FORMATS OF DIDLRDTAL2.
      *
       FD  AMTGTDTAL7
           LABEL RECORDS ARE STANDARD.
       01  AMTGTDTAL7-R.
           COPY DDS-ALL-FORMATS OF AMTGTDTAL7.
      *
       FD  SBDOTEXTL7
           LABEL RECORDS ARE STANDARD.
       01  SBDOTEXTL7-R.
           COPY DDS-ALL-FORMATS OF SBDOTEXTL7.
      *
       FD  VAMDLBNSL1
           LABEL RECORDS ARE STANDARD.
       01  VAMDLBNSL1-R.
           COPY DDS-ALL-FORMATS OF VAMDLBNSL1.
      *
       FD  SBRICDSQL4
           LABEL RECORDS ARE STANDARD.
       01  SBRICDSQL4-R.
           COPY DDS-ALL-FORMATS OF SBRICDSQL4.
      *
       FD  RAOBEXTRL2
           LABEL RECORDS ARE STANDARD.
       01  RAOBEXTRL2-R.
           COPY DDS-ALL-FORMATS OF RAOBEXTRL2.
      *
       FD  SBDOTEXTL8
           LABEL RECORDS ARE STANDARD.
       01  SBDOTEXTL8-R.
           COPY DDS-ALL-FORMATS OF SBDOTEXTL8.
      *
       FD  RAOBEXTRL4
           LABEL RECORDS ARE STANDARD.
       01  RAOBEXTRL4-R.
           COPY DDS-ALL-FORMATS OF RAOBEXTRL4.
      *
       FD  COORDDTAL8
           LABEL RECORDS ARE STANDARD.
       01  COORDDTAL8-R.
           COPY DDS-ALL-FORMATS OF COORDDTAL8.
      *
       FD  COORDDEDL1
           LABEL RECORDS ARE STANDARD.
       01  COORDDEDL1-R.
           COPY DDS-ALL-FORMATS OF COORDDEDL1.
      *
       FD  COORDDEDL2
           LABEL RECORDS ARE STANDARD.
       01  COORDDEDL2-R.
           COPY DDS-ALL-FORMATS OF COORDDEDL2.
      *
       FD  SBDLROV2L1
           LABEL RECORDS ARE STANDARD.
       01  SBDLROV2L1-R.
           COPY DDS-ALL-FORMATS OF SBDLROV2L1.
      *
       FD  SBBNSSGWL0
           LABEL RECORDS ARE STANDARD.
       01  SBBNSSGWL0-R.
           COPY DDS-ALL-FORMATS OF SBBNSSGWL0.
      /EJECT
      ***************************************************************
       WORKING-STORAGE SECTION.
      *
      *    Job context
       01  JOB-CONTEXT.
           COPY DDS-ALL-FORMATS OF Y2PGDSPK.
      *    Job date/time
           03  IJBDTTM.
           05  ZZJDT PIC S9(7).
           05  ZZJDTE REDEFINES ZZJDT.
           07  ZZJCC PIC S9(1).
           07  ZZJYY PIC S9(2).
           07  ZZJMM PIC S9(2).
           07  ZZJDD PIC S9(2).
           05  ZZJTM PIC S9(6).
           05  ZZJTME REDEFINES ZZJTM.
           07  ZZJHH PIC S9(2).
           07  ZZJNN PIC S9(2).
           07  ZZJSS PIC S9(2).
           03  ZZFQL PIC X(21).
           03  ZZFLB PIC X(10).
           03  ZZFFL PIC X(10).
           03  ZZFMB PIC X(10).
           03  ZZCDB PIC X(18).
           03  ZZLDB PIC X(18).
           03  ZZTMS PIC X(26).
       01  ZZTIME.
           03  ZZHNS PIC S9(6).
           03  ZZHH PIC S9(2).
      *
       77  C-IND-OFF PIC 1(1) VALUE B'0'.
       77  C-IND-ON PIC 1(1) VALUE B'1'.
       77  W0STRNG PIC X(32766).
      *
       01  FILE-STATUS PIC X(2).
           88  C-IO-OK VALUE '00'.
           88  C-EOF VALUE '10' '46'.
           88  C-NO-MOD-SFLRCDS VALUE '12'.
           88  C-IO-ERR VALUE '21' '22' '24' '30' '34' '90' '91' '92' '9
      -     '4' '95' '9A' '9H' '9I' '9K' '9M' '9N' '9P'.
           88  C-NO-RECORD VALUE '23'.
           88  C-RECORD-LOCKED VALUE '9D'.
      *
       01  UNTIL-CONDITION PIC 1(1).
           88  C-UNTIL-FALSE VALUE B'0'.
           88  C-UNTIL-TRUE VALUE B'1'.
      *
       01  FOREVER PIC 1(1) VALUE B'1'.
           88  C-FOREVER VALUE B'1'.
      *
       01  WRK-IO-TRASH-AREA PIC X(1).
      *
       01  W0RTN PIC X(7).
       01  W0RSF PIC X(1).
       01  W0ENV PIC X(3).
       01  W0RTW PIC S9(9) COMP-4.
       01  W0ICL PIC X(1).
      *    Define keylist
       01  KRSSA2.
      *    Bonus Scheme (8)
           03  O7BNSSCM PIC X(8).
      *    Define keylist
       01  KRSSA2-TMP.
      *    Bonus Scheme (8)
           03  O7BNSSCM PIC X(8).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSA2.
      *    Bonus Scheme (8)
           03  O7BNSSCM PIC X(8).
      *..............................................................
      *    Outward parameters
       01  PARC.
      *    RCD : Target Period             Retrieval index
      *    I : RST Target Period Code
      *    Target Period Code
           03  PAPERCDE PIC X(6).
      *    O : MAP From Date
      *    From Date
           03  PAPRDFM PIC S9(8) COMP-3.
      *    O : MAP To Date
      *    To Date
           03  PAPRDTO PIC S9(8) COMP-3.
      *    O : MAP Target Period Short Desc
      *    Target Period Short Desc
           03  PAPERSDS PIC X(10).
      *    O : MAP Target Period Full Desc
      *    Target Period Full Desc
           03  PAPERFDS PIC X(25).
      *
       01  W0CLPG PIC X(10).
      *    Define keylist
       01  KRSSA1.
      *    Bonus Scheme (8)
           03  QCBNSSCM PIC X(8).
      *    Suggest Run Number
           03  QCSUGRNO PIC S9(3).
      *    Define keylist
       01  KRSSA1-TMP.
      *    Bonus Scheme (8)
           03  QCBNSSCM PIC X(8).
      *    Suggest Run Number
           03  QCSUGRNO PIC S9(3).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSA1.
      *    Bonus Scheme (8)
           03  QCBNSSCM PIC X(8).
      *    Suggest Run Number
           03  QCSUGRNO PIC S9(3).
      *    Dealer to pay Number (Num
           03  QCEDNB PIC S9(5).
      *    SMMT Reg.Date (Original)
           03  QCSMMTRD PIC S9(8) COMP-3.
      *    BDC Customer Order Number
           03  QCBDCCON PIC X(6).
      *    Chassis number
           03  QCASXX PIC X(14).
      *..............................................................
      *    Define keylist
       01  KRSSA3.
      *    Bonus Scheme (8)
           03  BEBNSSCM PIC X(8).
      *    Dealer number (Num key)
           03  BEDLRNOKEY PIC S9(5) COMP-3.
      *    Define keylist
       01  KRSSA3-TMP.
      *    Bonus Scheme (8)
           03  BEBNSSCM PIC X(8).
      *    Dealer number (Num key)
           03  BEDLRNOKEY PIC S9(5) COMP-3.
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSA3.
      *    Bonus Scheme (8)
           03  BEBNSSCM PIC X(8).
      *    Dealer number (Num key)
           03  BEDLRNOKEY PIC S9(5) COMP-3.
      *..............................................................
      *    Define keylist
       01  KRSSA4.
      *    Bonus Scheme (8)
           03  BEBNSSCM PIC X(8).
      *    Dealer number (Num key)
           03  BEDLRNOKEY PIC S9(5) COMP-3.
      *    Define keylist
       01  KRSSA4-TMP.
      *    Bonus Scheme (8)
           03  BEBNSSCM PIC X(8).
      *    Dealer number (Num key)
           03  BEDLRNOKEY PIC S9(5) COMP-3.
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSA4.
      *    Bonus Scheme (8)
           03  BEBNSSCM PIC X(8).
      *    Dealer number (Num key)
           03  BEDLRNOKEY PIC S9(5) COMP-3.
      *..............................................................
      *    Outward parameters
       01  PBRC.
      *    KEY : Bonus Sls-Suggest DlrAch2 Rtv seq des
      *    I : RST Bonus Scheme (8)
      *    Bonus Scheme (8)
           03  PBBNSSCM PIC X(8).
      *    I : RST Dealer number (Num key)
      *    Dealer number (Num key)
           03  PBDLRNOKEY PIC S9(5) COMP-3.
      *
      *    Run Number
       01  WQ0001 PIC S9(3) COMP-3.
      *    Scheme Sequence
       01  WQ0002 PIC X(1).
      *    Achievement Band
       01  WQ0003 PIC X(10).
      *    No of Registrations
       01  WQ0004 PIC S9(7) COMP-3.
      *    No of Order
       01  WQ0005 PIC S9(7) COMP-3.
      *    No of Registrations cancl
       01  WQ0006 PIC S9(7) COMP-3.
      *    No of Order Canceled
       01  WQ0007 PIC S9(7) COMP-3.
      *    Target Value Registration
       01  WQ0008 PIC S9(5) COMP-3.
      *    Target Value Order
       01  WQ0009 PIC S9(5) COMP-3.
      *    Total Count Registration
       01  WQ0010 PIC S9(5) COMP-3.
      *    Total Count Order
       01  WQ0011 PIC S9(5) COMP-3.
      *    Achieved Pre-Qualifier
       01  WQ0012 PIC X(1).
      *    Achieved Pre-Qualifier 2
       01  WQ0013 PIC X(1).
      *    PreQual Reg/Ord 1
       01  WQ0014 PIC S9(7) COMP-3.
      *    PreQual Reg/Ord 2
       01  WQ0015 PIC S9(7) COMP-3.
      *    PreQual Reg/Ord 3
       01  WQ0016 PIC S9(7) COMP-3.
      *    PreQual Reg/Ord 4
       01  WQ0017 PIC S9(7) COMP-3.
      *    PreQual Reg/Ord 5
       01  WQ0018 PIC S9(7) COMP-3.
      *    PreQual Reg/Ord 6
       01  WQ0019 PIC S9(7) COMP-3.
      *    PreQual Reg/Ord 7
       01  WQ0020 PIC S9(7) COMP-3.
      *    PreQual Reg/Ord 8
       01  WQ0021 PIC S9(7) COMP-3.
      *    PreQual Reg/Ord 9
       01  WQ0022 PIC S9(7) COMP-3.
      *    PreQual Reg/Ord 10
       01  WQ0023 PIC S9(7) COMP-3.
      *    PreQual Reg/Ord 11
       01  WQ0024 PIC S9(7) COMP-3.
      *    PreQual Reg/Ord 12
       01  WQ0025 PIC S9(7) COMP-3.
      *    PreQual Reg/Ord 13
       01  WQ0026 PIC S9(7) COMP-3.
      *    PreQual Reg/Ord 14
       01  WQ0027 PIC S9(7) COMP-3.
      *    PreQual Reg/Ord 15
       01  WQ0028 PIC S9(7) COMP-3.
      *    PreQual Reg/Ord 16
       01  WQ0029 PIC S9(7) COMP-3.
      *    PreQual Reg/Ord 17
       01  WQ0030 PIC S9(7) COMP-3.
      *    PreQual Reg/Ord 18
       01  WQ0031 PIC S9(7) COMP-3.
      *    PreQual Reg/Ord 19
       01  WQ0032 PIC S9(7) COMP-3.
      *    PreQual Reg/Ord 20
       01  WQ0033 PIC S9(7) COMP-3.
      *    PreQual De-Reg/Ord 1
       01  WQ0034 PIC S9(7) COMP-3.
      *    PreQual De-Reg/Ord 2
       01  WQ0035 PIC S9(7) COMP-3.
      *    PreQual De-Reg/Ord 3
       01  WQ0036 PIC S9(7) COMP-3.
      *    PreQual De-Reg/Ord 4
       01  WQ0037 PIC S9(7) COMP-3.
      *    PreQual De-Reg/Ord 5
       01  WQ0038 PIC S9(7) COMP-3.
      *    PreQual De-Reg/Ord 6
       01  WQ0039 PIC S9(7) COMP-3.
      *    PreQual De-Reg/Ord 7
       01  WQ0040 PIC S9(7) COMP-3.
      *    PreQual De-Reg/Ord 8
       01  WQ0041 PIC S9(7) COMP-3.
      *    PreQual De-Reg/Ord 9
       01  WQ0042 PIC S9(7) COMP-3.
      *    PreQual De-Reg/Ord 10
       01  WQ0043 PIC S9(7) COMP-3.
      *    PreQual De-Reg/Ord 11
       01  WQ0044 PIC S9(7) COMP-3.
      *    PreQual De-Reg/Ord 12
       01  WQ0045 PIC S9(7) COMP-3.
      *    PreQual De-Reg/Ord 13
       01  WQ0046 PIC S9(7) COMP-3.
      *    PreQual De-Reg/Ord 14
       01  WQ0047 PIC S9(7) COMP-3.
      *    PreQual De-Reg/Ord 15
       01  WQ0048 PIC S9(7) COMP-3.
      *    PreQual De-Reg/Ord 16
       01  WQ0049 PIC S9(7) COMP-3.
      *    PreQual De-Reg/Ord 17
       01  WQ0050 PIC S9(7) COMP-3.
      *    PreQual De-Reg/Ord 18
       01  WQ0051 PIC S9(7) COMP-3.
      *    PreQual De-Reg/Ord 19
       01  WQ0052 PIC S9(7) COMP-3.
      *    PreQual De-Reg/Ord 20
       01  WQ0053 PIC S9(7) COMP-3.
      *    PreQual Target Reg/Ord 1
       01  WQ0054 PIC S9(5) COMP-3.
      *    PreQual Target Reg/Ord 2
       01  WQ0055 PIC S9(5) COMP-3.
      *    PreQual Target Reg/Ord 3
       01  WQ0056 PIC S9(5) COMP-3.
      *    PreQual Target Reg/Ord 4
       01  WQ0057 PIC S9(5) COMP-3.
      *    PreQual Target Reg/Ord 5
       01  WQ0058 PIC S9(5) COMP-3.
      *    PreQual Target Reg/Ord 6
       01  WQ0059 PIC S9(5) COMP-3.
      *    PreQual Target Reg/Ord 7
       01  WQ0060 PIC S9(5) COMP-3.
      *    PreQual Target Reg/Ord 8
       01  WQ0061 PIC S9(5) COMP-3.
      *    PreQual Target Reg/Ord 9
       01  WQ0062 PIC S9(5) COMP-3.
      *    PreQual Target Reg/Ord 10
       01  WQ0063 PIC S9(5) COMP-3.
      *    PreQual Target Reg/Ord 11
       01  WQ0064 PIC S9(5) COMP-3.
      *    PreQual Target Reg/Ord 12
       01  WQ0065 PIC S9(5) COMP-3.
      *    PreQual Target Reg/Ord 13
       01  WQ0066 PIC S9(5) COMP-3.
      *    PreQual Target Reg/Ord 14
       01  WQ0067 PIC S9(5) COMP-3.
      *    PreQual Target Reg/Ord 15
       01  WQ0068 PIC S9(5) COMP-3.
      *    PreQual Target Reg/Ord 16
       01  WQ0069 PIC S9(5) COMP-3.
      *    PreQual Target Reg/Ord 17
       01  WQ0070 PIC S9(5) COMP-3.
      *    PreQual Target Reg/Ord 18
       01  WQ0071 PIC S9(5) COMP-3.
      *    PreQual Target Reg/Ord 19
       01  WQ0072 PIC S9(5) COMP-3.
      *    PreQual Target Reg/Ord 20
       01  WQ0073 PIC S9(5) COMP-3.
      *    Run Mode
       01  WQ0074 PIC X(1).
      *    Order Band Achieved
       01  WQ0075 PIC S9(3) COMP-3.
      *    Registration Band Ach
       01  WQ0076 PIC S9(3) COMP-3.
      *    Manual Override Band
       01  WQ0077 PIC S9(3) COMP-3.
      *    Overall Combined Ach Band
       01  WQ0078 PIC S9(3) COMP-3.
      *    Manual Override Penalty
       01  WQ0079 PIC S9(3).
      *    Overall Penalty
       01  WQ0080 PIC S9(3).
      *    *Synon (5,0) work field
       01  YRSW00 PIC S9(5) COMP-3.
      *    *Synon (5,0) work field
       01  YRSW01 PIC S9(5) COMP-3.
      *    *Synon (5,0) work field
       01  YRSW02 PIC S9(5) COMP-3.
      *    *Synon (5,0) work field
       01  YRSW03 PIC S9(5) COMP-3.
      *    *Synon (5,0) work field
       01  YRSW04 PIC S9(5) COMP-3.
      *    *String work field
       01  YRSW05 PIC X(1).
       01  YRSW06.
           03  YRSW06X PIC X(1) OCCURS 10000.
      *    U:Return Code Id
       01  WQ0081 PIC X(7).
      *    SD Relates to Dealer
       01  WQ0082 PIC X(6).
      *    SD Dealer Number
       01  WQ0083 PIC X(6).
      *    Owning Account
       01  WQ0084 PIC X(6).
      *    Define keylist
       01  KRSSA5.
      *    Bonus Scheme (8)
           03  O8BNSSCM PIC X(8).
      *    Dealer number (Num key)
           03  O8DLRNOKEY PIC S9(5) COMP-3.
      *    Define keylist
       01  KRSSA5-TMP.
      *    Bonus Scheme (8)
           03  O8BNSSCM PIC X(8).
      *    Dealer number (Num key)
           03  O8DLRNOKEY PIC S9(5) COMP-3.
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSA5.
      *    Bonus Scheme (8)
           03  O8BNSSCM PIC X(8).
      *    Dealer number (Num key)
           03  O8DLRNOKEY PIC S9(5) COMP-3.
      *..............................................................
      *    Define keylist
       01  KRSSA6.
      *    Dealer Number
           03  ABDLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  ABDLRSFX PIC X(2).
      *    Define keylist
       01  KRSSA6-TMP.
      *    Dealer Number
           03  ABDLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  ABDLRSFX PIC X(2).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSA6.
      *    Dealer Number
           03  ABDLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  ABDLRSFX PIC X(2).
      *..............................................................
      *    Define keylist
       01  KRSSA7.
      *    Level Code
           03  S9LVLCDE PIC S9(5) COMP-3.
      *    Dealer Number
           03  S9DLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  S9DLRSFX PIC X(2).
      *    Target Period Code
           03  S9PERCDE PIC X(6).
      *    Object Code
           03  S9OBJCDE PIC X(6).
      *    Define keylist
       01  KRSSA7-TMP.
      *    Level Code
           03  S9LVLCDE PIC S9(5) COMP-3.
      *    Dealer Number
           03  S9DLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  S9DLRSFX PIC X(2).
      *    Target Period Code
           03  S9PERCDE PIC X(6).
      *    Object Code
           03  S9OBJCDE PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSA7.
      *    Level Code
           03  S9LVLCDE PIC S9(5) COMP-3.
      *    Dealer Number
           03  S9DLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  S9DLRSFX PIC X(2).
      *    Target Period Code
           03  S9PERCDE PIC X(6).
      *    Object Code
           03  S9OBJCDE PIC X(6).
      *..............................................................
      *    Define keylist
       01  KRSSA8.
      *    Level Code
           03  S9LVLCDE PIC S9(5) COMP-3.
      *    Dealer Number
           03  S9DLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  S9DLRSFX PIC X(2).
      *    Target Period Code
           03  S9PERCDE PIC X(6).
      *    Object Code
           03  S9OBJCDE PIC X(6).
      *    Define keylist
       01  KRSSA8-TMP.
      *    Level Code
           03  S9LVLCDE PIC S9(5) COMP-3.
      *    Dealer Number
           03  S9DLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  S9DLRSFX PIC X(2).
      *    Target Period Code
           03  S9PERCDE PIC X(6).
      *    Object Code
           03  S9OBJCDE PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSA8.
      *    Level Code
           03  S9LVLCDE PIC S9(5) COMP-3.
      *    Dealer Number
           03  S9DLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  S9DLRSFX PIC X(2).
      *    Target Period Code
           03  S9PERCDE PIC X(6).
      *    Object Code
           03  S9OBJCDE PIC X(6).
      *..............................................................
      *    Define keylist
       01  KRSSA9.
      *    Level Code
           03  S9LVLCDE PIC S9(5) COMP-3.
      *    Dealer Number
           03  S9DLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  S9DLRSFX PIC X(2).
      *    Target Period Code
           03  S9PERCDE PIC X(6).
      *    Object Code
           03  S9OBJCDE PIC X(6).
      *    Define keylist
       01  KRSSA9-TMP.
      *    Level Code
           03  S9LVLCDE PIC S9(5) COMP-3.
      *    Dealer Number
           03  S9DLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  S9DLRSFX PIC X(2).
      *    Target Period Code
           03  S9PERCDE PIC X(6).
      *    Object Code
           03  S9OBJCDE PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSA9.
      *    Level Code
           03  S9LVLCDE PIC S9(5) COMP-3.
      *    Dealer Number
           03  S9DLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  S9DLRSFX PIC X(2).
      *    Target Period Code
           03  S9PERCDE PIC X(6).
      *    Object Code
           03  S9OBJCDE PIC X(6).
      *..............................................................
      *    Define keylist
       01  KRSSB1.
      *    Level Code
           03  S9LVLCDE PIC S9(5) COMP-3.
      *    Dealer Number
           03  S9DLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  S9DLRSFX PIC X(2).
      *    Target Period Code
           03  S9PERCDE PIC X(6).
      *    Object Code
           03  S9OBJCDE PIC X(6).
      *    Define keylist
       01  KRSSB1-TMP.
      *    Level Code
           03  S9LVLCDE PIC S9(5) COMP-3.
      *    Dealer Number
           03  S9DLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  S9DLRSFX PIC X(2).
      *    Target Period Code
           03  S9PERCDE PIC X(6).
      *    Object Code
           03  S9OBJCDE PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSB1.
      *    Level Code
           03  S9LVLCDE PIC S9(5) COMP-3.
      *    Dealer Number
           03  S9DLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  S9DLRSFX PIC X(2).
      *    Target Period Code
           03  S9PERCDE PIC X(6).
      *    Object Code
           03  S9OBJCDE PIC X(6).
      *..............................................................
      *    *Synon (5,0) work field
       01  YRSW07 PIC S9(5) COMP-3.
       01  YRSW08.
           03  YRSW08X PIC X(1) OCCURS 10000.
      *    Define keylist
       01  KPSSB2.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    DATE 58 IMMATRICULATION
           03  OSW0NB PIC S9(8).
      *    Define keylist
       01  KPSSB2-TMP.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    DATE 58 IMMATRICULATION
           03  OSW0NB PIC S9(8).
      *    Define keylist
       01  KRSSB2.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    Define keylist
       01  KRSSB2-TMP.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSB2.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    DATE 58 IMMATRICULATION
           03  OSW0NB PIC S9(8).
      *    COMMANDE CLIENT
           03  OSNUCO PIC X(6).
      *..............................................................
      *    Define keylist
       01  KRSSB3.
      *    Model Application Code
           03  LLMDLAPPCD PIC X(6).
      *    SCP Model Code
           03  LLSCMDLCDE PIC X(3).
      *    Define keylist
       01  KRSSB3-TMP.
      *    Model Application Code
           03  LLMDLAPPCD PIC X(6).
      *    SCP Model Code
           03  LLSCMDLCDE PIC X(3).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSB3.
      *    Model Application Code
           03  LLMDLAPPCD PIC X(6).
      *    SCP Model Code
           03  LLSCMDLCDE PIC X(3).
      *..............................................................
      *    Define keylist
       01  KRSSB4.
      *    SCP Model Code
           03  O9SCMDLCDE PIC X(3).
      *    Define keylist
       01  KRSSB4-TMP.
      *    SCP Model Code
           03  O9SCMDLCDE PIC X(3).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSB4.
      *    SCP Model Code
           03  O9SCMDLCDE PIC X(3).
      *    Bns RIC Config Year
           03  O9BNSRICYR PIC S9(4).
      *    Bns RIC Display Sequence
           03  O9BNSRICSQ PIC S9(3).
      *..............................................................
      *    Define keylist
       01  KRSSB5.
      *    Dealer number (Num key)
           03  Q2DLRNOKEY PIC S9(5) COMP-3.
      *    BDC Model
           03  Q2BDCM PIC X(3).
      *    BDC Customer Order Number
           03  Q2BDCCON PIC X(6).
      *    Define keylist
       01  KRSSB5-TMP.
      *    Dealer number (Num key)
           03  Q2DLRNOKEY PIC S9(5) COMP-3.
      *    BDC Model
           03  Q2BDCM PIC X(3).
      *    BDC Customer Order Number
           03  Q2BDCCON PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSB5.
      *    Dealer number (Num key)
           03  Q2DLRNOKEY PIC S9(5) COMP-3.
      *    BDC Model
           03  Q2BDCM PIC X(3).
      *    BDC Customer Order Number
           03  Q2BDCCON PIC X(6).
      *..............................................................
      *    Define keylist
       01  KPSSB6.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    De-reg Date NBR
           03  OSZXNU PIC S9(8).
      *    Define keylist
       01  KPSSB6-TMP.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    De-reg Date NBR
           03  OSZXNU PIC S9(8).
      *    Define keylist
       01  KRSSB6.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    Define keylist
       01  KRSSB6-TMP.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSB6.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    De-reg Date NBR
           03  OSZXNU PIC S9(8).
      *..............................................................
      *    Define keylist
       01  KRSSB7.
      *    Model Application Code
           03  LLMDLAPPCD PIC X(6).
      *    SCP Model Code
           03  LLSCMDLCDE PIC X(3).
      *    Define keylist
       01  KRSSB7-TMP.
      *    Model Application Code
           03  LLMDLAPPCD PIC X(6).
      *    SCP Model Code
           03  LLSCMDLCDE PIC X(3).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSB7.
      *    Model Application Code
           03  LLMDLAPPCD PIC X(6).
      *    SCP Model Code
           03  LLSCMDLCDE PIC X(3).
      *..............................................................
      *    Define keylist
       01  KRSSB8.
      *    SCP Model Code
           03  O9SCMDLCDE PIC X(3).
      *    Define keylist
       01  KRSSB8-TMP.
      *    SCP Model Code
           03  O9SCMDLCDE PIC X(3).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSB8.
      *    SCP Model Code
           03  O9SCMDLCDE PIC X(3).
      *    Bns RIC Config Year
           03  O9BNSRICYR PIC S9(4).
      *    Bns RIC Display Sequence
           03  O9BNSRICSQ PIC S9(3).
      *..............................................................
      *    Define keylist
       01  KRSSB9.
      *    Chassis number
           03  Q2ASXX PIC X(14).
      *    Define keylist
       01  KRSSB9-TMP.
      *    Chassis number
           03  Q2ASXX PIC X(14).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSB9.
      *    Chassis number
           03  Q2ASXX PIC X(14).
      *..............................................................
      *    *Synon (17,7) work field
       01  W0WD04 PIC S9(10)V9(7) COMP-3.
      *    *Synon (17,7) work field
       01  W0WD03 PIC S9(10)V9(7) COMP-3.
      *    *Synon (17,7) work field
       01  W0WD02 PIC S9(10)V9(7) COMP-3.
      *    *Synon (17,7) work field
       01  W0WD01 PIC S9(10)V9(7) COMP-3.
      *    *Synon (17,7) work field
       01  W0WD00 PIC S9(10)V9(7) COMP-3.
      *    Define keylist
       01  KPSSC1.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    DATE 58 IMMATRICULATION
           03  OSW0NB PIC S9(8).
      *    Define keylist
       01  KPSSC1-TMP.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    DATE 58 IMMATRICULATION
           03  OSW0NB PIC S9(8).
      *    Define keylist
       01  KRSSC1.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    Define keylist
       01  KRSSC1-TMP.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSC1.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    DATE 58 IMMATRICULATION
           03  OSW0NB PIC S9(8).
      *    COMMANDE CLIENT
           03  OSNUCO PIC X(6).
      *..............................................................
      *    Define keylist
       01  KRSSC2.
      *    Model Application Code
           03  LLMDLAPPCD PIC X(6).
      *    SCP Model Code
           03  LLSCMDLCDE PIC X(3).
      *    Define keylist
       01  KRSSC2-TMP.
      *    Model Application Code
           03  LLMDLAPPCD PIC X(6).
      *    SCP Model Code
           03  LLSCMDLCDE PIC X(3).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSC2.
      *    Model Application Code
           03  LLMDLAPPCD PIC X(6).
      *    SCP Model Code
           03  LLSCMDLCDE PIC X(3).
      *..............................................................
      *    Define keylist
       01  KRSSC3.
      *    SCP Model Code
           03  O9SCMDLCDE PIC X(3).
      *    Define keylist
       01  KRSSC3-TMP.
      *    SCP Model Code
           03  O9SCMDLCDE PIC X(3).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSC3.
      *    SCP Model Code
           03  O9SCMDLCDE PIC X(3).
      *    Bns RIC Config Year
           03  O9BNSRICYR PIC S9(4).
      *    Bns RIC Display Sequence
           03  O9BNSRICSQ PIC S9(3).
      *..............................................................
      *    Define keylist
       01  KRSSC4.
      *    Dealer number (Num key)
           03  Q2DLRNOKEY PIC S9(5) COMP-3.
      *    BDC Model
           03  Q2BDCM PIC X(3).
      *    BDC Customer Order Number
           03  Q2BDCCON PIC X(6).
      *    Define keylist
       01  KRSSC4-TMP.
      *    Dealer number (Num key)
           03  Q2DLRNOKEY PIC S9(5) COMP-3.
      *    BDC Model
           03  Q2BDCM PIC X(3).
      *    BDC Customer Order Number
           03  Q2BDCCON PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSC4.
      *    Dealer number (Num key)
           03  Q2DLRNOKEY PIC S9(5) COMP-3.
      *    BDC Model
           03  Q2BDCM PIC X(3).
      *    BDC Customer Order Number
           03  Q2BDCCON PIC X(6).
      *..............................................................
      *    Define keylist
       01  KPSSC5.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    De-reg Date NBR
           03  OSZXNU PIC S9(8).
      *    Define keylist
       01  KPSSC5-TMP.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    De-reg Date NBR
           03  OSZXNU PIC S9(8).
      *    Define keylist
       01  KRSSC5.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    Define keylist
       01  KRSSC5-TMP.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSC5.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    De-reg Date NBR
           03  OSZXNU PIC S9(8).
      *..............................................................
      *    Define keylist
       01  KRSSC6.
      *    Model Application Code
           03  LLMDLAPPCD PIC X(6).
      *    SCP Model Code
           03  LLSCMDLCDE PIC X(3).
      *    Define keylist
       01  KRSSC6-TMP.
      *    Model Application Code
           03  LLMDLAPPCD PIC X(6).
      *    SCP Model Code
           03  LLSCMDLCDE PIC X(3).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSC6.
      *    Model Application Code
           03  LLMDLAPPCD PIC X(6).
      *    SCP Model Code
           03  LLSCMDLCDE PIC X(3).
      *..............................................................
      *    Define keylist
       01  KRSSC7.
      *    SCP Model Code
           03  O9SCMDLCDE PIC X(3).
      *    Define keylist
       01  KRSSC7-TMP.
      *    SCP Model Code
           03  O9SCMDLCDE PIC X(3).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSC7.
      *    SCP Model Code
           03  O9SCMDLCDE PIC X(3).
      *    Bns RIC Config Year
           03  O9BNSRICYR PIC S9(4).
      *    Bns RIC Display Sequence
           03  O9BNSRICSQ PIC S9(3).
      *..............................................................
      *    Define keylist
       01  KRSSC8.
      *    Chassis number
           03  Q2ASXX PIC X(14).
      *    Define keylist
       01  KRSSC8-TMP.
      *    Chassis number
           03  Q2ASXX PIC X(14).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSC8.
      *    Chassis number
           03  Q2ASXX PIC X(14).
      *..............................................................
      *    *Synon (17,7) work field
       01  W0WD05 PIC S9(10)V9(7) COMP-3.
      *    Define keylist
       01  KRSSC9.
      *    Level Code
           03  S9LVLCDE PIC S9(5) COMP-3.
      *    Dealer Number
           03  S9DLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  S9DLRSFX PIC X(2).
      *    Target Period Code
           03  S9PERCDE PIC X(6).
      *    Object Code
           03  S9OBJCDE PIC X(6).
      *    Define keylist
       01  KRSSC9-TMP.
      *    Level Code
           03  S9LVLCDE PIC S9(5) COMP-3.
      *    Dealer Number
           03  S9DLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  S9DLRSFX PIC X(2).
      *    Target Period Code
           03  S9PERCDE PIC X(6).
      *    Object Code
           03  S9OBJCDE PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSC9.
      *    Level Code
           03  S9LVLCDE PIC S9(5) COMP-3.
      *    Dealer Number
           03  S9DLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  S9DLRSFX PIC X(2).
      *    Target Period Code
           03  S9PERCDE PIC X(6).
      *    Object Code
           03  S9OBJCDE PIC X(6).
      *..............................................................
      *    Define keylist
       01  KRSSD1.
      *    Level Code
           03  S9LVLCDE PIC S9(5) COMP-3.
      *    Dealer Number
           03  S9DLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  S9DLRSFX PIC X(2).
      *    Target Period Code
           03  S9PERCDE PIC X(6).
      *    Object Code
           03  S9OBJCDE PIC X(6).
      *    Define keylist
       01  KRSSD1-TMP.
      *    Level Code
           03  S9LVLCDE PIC S9(5) COMP-3.
      *    Dealer Number
           03  S9DLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  S9DLRSFX PIC X(2).
      *    Target Period Code
           03  S9PERCDE PIC X(6).
      *    Object Code
           03  S9OBJCDE PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSD1.
      *    Level Code
           03  S9LVLCDE PIC S9(5) COMP-3.
      *    Dealer Number
           03  S9DLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  S9DLRSFX PIC X(2).
      *    Target Period Code
           03  S9PERCDE PIC X(6).
      *    Object Code
           03  S9OBJCDE PIC X(6).
      *..............................................................
      *    Define keylist
       01  KRSSD2.
      *    Level Code
           03  S9LVLCDE PIC S9(5) COMP-3.
      *    Dealer Number
           03  S9DLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  S9DLRSFX PIC X(2).
      *    Target Period Code
           03  S9PERCDE PIC X(6).
      *    Object Code
           03  S9OBJCDE PIC X(6).
      *    Define keylist
       01  KRSSD2-TMP.
      *    Level Code
           03  S9LVLCDE PIC S9(5) COMP-3.
      *    Dealer Number
           03  S9DLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  S9DLRSFX PIC X(2).
      *    Target Period Code
           03  S9PERCDE PIC X(6).
      *    Object Code
           03  S9OBJCDE PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSD2.
      *    Level Code
           03  S9LVLCDE PIC S9(5) COMP-3.
      *    Dealer Number
           03  S9DLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  S9DLRSFX PIC X(2).
      *    Target Period Code
           03  S9PERCDE PIC X(6).
      *    Object Code
           03  S9OBJCDE PIC X(6).
      *..............................................................
      *    Define keylist
       01  KRSSD3.
      *    Level Code
           03  S9LVLCDE PIC S9(5) COMP-3.
      *    Dealer Number
           03  S9DLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  S9DLRSFX PIC X(2).
      *    Target Period Code
           03  S9PERCDE PIC X(6).
      *    Object Code
           03  S9OBJCDE PIC X(6).
      *    Define keylist
       01  KRSSD3-TMP.
      *    Level Code
           03  S9LVLCDE PIC S9(5) COMP-3.
      *    Dealer Number
           03  S9DLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  S9DLRSFX PIC X(2).
      *    Target Period Code
           03  S9PERCDE PIC X(6).
      *    Object Code
           03  S9OBJCDE PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSD3.
      *    Level Code
           03  S9LVLCDE PIC S9(5) COMP-3.
      *    Dealer Number
           03  S9DLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  S9DLRSFX PIC X(2).
      *    Target Period Code
           03  S9PERCDE PIC X(6).
      *    Object Code
           03  S9OBJCDE PIC X(6).
      *..............................................................
      *    Define keylist
       01  KPSSD4.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    DATE 58 IMMATRICULATION
           03  OSW0NB PIC S9(8).
      *    Define keylist
       01  KPSSD4-TMP.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    DATE 58 IMMATRICULATION
           03  OSW0NB PIC S9(8).
      *    Define keylist
       01  KRSSD4.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    Define keylist
       01  KRSSD4-TMP.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSD4.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    DATE 58 IMMATRICULATION
           03  OSW0NB PIC S9(8).
      *    COMMANDE CLIENT
           03  OSNUCO PIC X(6).
      *..............................................................
      *    Define keylist
       01  KRSSD5.
      *    Model Application Code
           03  LLMDLAPPCD PIC X(6).
      *    SCP Model Code
           03  LLSCMDLCDE PIC X(3).
      *    Define keylist
       01  KRSSD5-TMP.
      *    Model Application Code
           03  LLMDLAPPCD PIC X(6).
      *    SCP Model Code
           03  LLSCMDLCDE PIC X(3).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSD5.
      *    Model Application Code
           03  LLMDLAPPCD PIC X(6).
      *    SCP Model Code
           03  LLSCMDLCDE PIC X(3).
      *..............................................................
      *    Define keylist
       01  KRSSD6.
      *    SCP Model Code
           03  O9SCMDLCDE PIC X(3).
      *    Define keylist
       01  KRSSD6-TMP.
      *    SCP Model Code
           03  O9SCMDLCDE PIC X(3).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSD6.
      *    SCP Model Code
           03  O9SCMDLCDE PIC X(3).
      *    Bns RIC Config Year
           03  O9BNSRICYR PIC S9(4).
      *    Bns RIC Display Sequence
           03  O9BNSRICSQ PIC S9(3).
      *..............................................................
      *    Define keylist
       01  KRSSD7.
      *    Dealer number (Num key)
           03  Q2DLRNOKEY PIC S9(5) COMP-3.
      *    BDC Model
           03  Q2BDCM PIC X(3).
      *    BDC Customer Order Number
           03  Q2BDCCON PIC X(6).
      *    Define keylist
       01  KRSSD7-TMP.
      *    Dealer number (Num key)
           03  Q2DLRNOKEY PIC S9(5) COMP-3.
      *    BDC Model
           03  Q2BDCM PIC X(3).
      *    BDC Customer Order Number
           03  Q2BDCCON PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSD7.
      *    Dealer number (Num key)
           03  Q2DLRNOKEY PIC S9(5) COMP-3.
      *    BDC Model
           03  Q2BDCM PIC X(3).
      *    BDC Customer Order Number
           03  Q2BDCCON PIC X(6).
      *..............................................................
      *    Define keylist
       01  KPSSD8.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    De-reg Date NBR
           03  OSZXNU PIC S9(8).
      *    Define keylist
       01  KPSSD8-TMP.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    De-reg Date NBR
           03  OSZXNU PIC S9(8).
      *    Define keylist
       01  KRSSD8.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    Define keylist
       01  KRSSD8-TMP.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSD8.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    De-reg Date NBR
           03  OSZXNU PIC S9(8).
      *..............................................................
      *    Define keylist
       01  KRSSD9.
      *    Model Application Code
           03  LLMDLAPPCD PIC X(6).
      *    SCP Model Code
           03  LLSCMDLCDE PIC X(3).
      *    Define keylist
       01  KRSSD9-TMP.
      *    Model Application Code
           03  LLMDLAPPCD PIC X(6).
      *    SCP Model Code
           03  LLSCMDLCDE PIC X(3).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSD9.
      *    Model Application Code
           03  LLMDLAPPCD PIC X(6).
      *    SCP Model Code
           03  LLSCMDLCDE PIC X(3).
      *..............................................................
      *    Define keylist
       01  KRSSE1.
      *    SCP Model Code
           03  O9SCMDLCDE PIC X(3).
      *    Define keylist
       01  KRSSE1-TMP.
      *    SCP Model Code
           03  O9SCMDLCDE PIC X(3).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSE1.
      *    SCP Model Code
           03  O9SCMDLCDE PIC X(3).
      *    Bns RIC Config Year
           03  O9BNSRICYR PIC S9(4).
      *    Bns RIC Display Sequence
           03  O9BNSRICSQ PIC S9(3).
      *..............................................................
      *    Define keylist
       01  KRSSE2.
      *    Chassis number
           03  Q2ASXX PIC X(14).
      *    Define keylist
       01  KRSSE2-TMP.
      *    Chassis number
           03  Q2ASXX PIC X(14).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSE2.
      *    Chassis number
           03  Q2ASXX PIC X(14).
      *..............................................................
      *    Define keylist
       01  KPSSE3.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    DATE 58 IMMATRICULATION
           03  OSW0NB PIC S9(8).
      *    Define keylist
       01  KPSSE3-TMP.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    DATE 58 IMMATRICULATION
           03  OSW0NB PIC S9(8).
      *    Define keylist
       01  KRSSE3.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    Define keylist
       01  KRSSE3-TMP.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSE3.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    DATE 58 IMMATRICULATION
           03  OSW0NB PIC S9(8).
      *    COMMANDE CLIENT
           03  OSNUCO PIC X(6).
      *..............................................................
      *    Define keylist
       01  KRSSE4.
      *    Model Application Code
           03  LLMDLAPPCD PIC X(6).
      *    SCP Model Code
           03  LLSCMDLCDE PIC X(3).
      *    Define keylist
       01  KRSSE4-TMP.
      *    Model Application Code
           03  LLMDLAPPCD PIC X(6).
      *    SCP Model Code
           03  LLSCMDLCDE PIC X(3).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSE4.
      *    Model Application Code
           03  LLMDLAPPCD PIC X(6).
      *    SCP Model Code
           03  LLSCMDLCDE PIC X(3).
      *..............................................................
      *    Define keylist
       01  KRSSE5.
      *    SCP Model Code
           03  O9SCMDLCDE PIC X(3).
      *    Define keylist
       01  KRSSE5-TMP.
      *    SCP Model Code
           03  O9SCMDLCDE PIC X(3).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSE5.
      *    SCP Model Code
           03  O9SCMDLCDE PIC X(3).
      *    Bns RIC Config Year
           03  O9BNSRICYR PIC S9(4).
      *    Bns RIC Display Sequence
           03  O9BNSRICSQ PIC S9(3).
      *..............................................................
      *    Define keylist
       01  KRSSE6.
      *    Dealer number (Num key)
           03  Q2DLRNOKEY PIC S9(5) COMP-3.
      *    BDC Model
           03  Q2BDCM PIC X(3).
      *    BDC Customer Order Number
           03  Q2BDCCON PIC X(6).
      *    Define keylist
       01  KRSSE6-TMP.
      *    Dealer number (Num key)
           03  Q2DLRNOKEY PIC S9(5) COMP-3.
      *    BDC Model
           03  Q2BDCM PIC X(3).
      *    BDC Customer Order Number
           03  Q2BDCCON PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSE6.
      *    Dealer number (Num key)
           03  Q2DLRNOKEY PIC S9(5) COMP-3.
      *    BDC Model
           03  Q2BDCM PIC X(3).
      *    BDC Customer Order Number
           03  Q2BDCCON PIC X(6).
      *..............................................................
      *    Define keylist
       01  KPSSE7.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    De-reg Date NBR
           03  OSZXNU PIC S9(8).
      *    Define keylist
       01  KPSSE7-TMP.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    De-reg Date NBR
           03  OSZXNU PIC S9(8).
      *    Define keylist
       01  KRSSE7.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    Define keylist
       01  KRSSE7-TMP.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSE7.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    De-reg Date NBR
           03  OSZXNU PIC S9(8).
      *..............................................................
      *    Define keylist
       01  KRSSE8.
      *    Model Application Code
           03  LLMDLAPPCD PIC X(6).
      *    SCP Model Code
           03  LLSCMDLCDE PIC X(3).
      *    Define keylist
       01  KRSSE8-TMP.
      *    Model Application Code
           03  LLMDLAPPCD PIC X(6).
      *    SCP Model Code
           03  LLSCMDLCDE PIC X(3).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSE8.
      *    Model Application Code
           03  LLMDLAPPCD PIC X(6).
      *    SCP Model Code
           03  LLSCMDLCDE PIC X(3).
      *..............................................................
      *    Define keylist
       01  KRSSE9.
      *    SCP Model Code
           03  O9SCMDLCDE PIC X(3).
      *    Define keylist
       01  KRSSE9-TMP.
      *    SCP Model Code
           03  O9SCMDLCDE PIC X(3).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSE9.
      *    SCP Model Code
           03  O9SCMDLCDE PIC X(3).
      *    Bns RIC Config Year
           03  O9BNSRICYR PIC S9(4).
      *    Bns RIC Display Sequence
           03  O9BNSRICSQ PIC S9(3).
      *..............................................................
      *    Define keylist
       01  KRSSF1.
      *    Chassis number
           03  Q2ASXX PIC X(14).
      *    Define keylist
       01  KRSSF1-TMP.
      *    Chassis number
           03  Q2ASXX PIC X(14).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSF1.
      *    Chassis number
           03  Q2ASXX PIC X(14).
      *..............................................................
      *    Define keylist
       01  KRSSF2.
      *    Level Code
           03  S9LVLCDE PIC S9(5) COMP-3.
      *    Dealer Number
           03  S9DLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  S9DLRSFX PIC X(2).
      *    Target Period Code
           03  S9PERCDE PIC X(6).
      *    Object Code
           03  S9OBJCDE PIC X(6).
      *    Define keylist
       01  KRSSF2-TMP.
      *    Level Code
           03  S9LVLCDE PIC S9(5) COMP-3.
      *    Dealer Number
           03  S9DLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  S9DLRSFX PIC X(2).
      *    Target Period Code
           03  S9PERCDE PIC X(6).
      *    Object Code
           03  S9OBJCDE PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSF2.
      *    Level Code
           03  S9LVLCDE PIC S9(5) COMP-3.
      *    Dealer Number
           03  S9DLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  S9DLRSFX PIC X(2).
      *    Target Period Code
           03  S9PERCDE PIC X(6).
      *    Object Code
           03  S9OBJCDE PIC X(6).
      *..............................................................
      *    Define keylist
       01  KRSSF3.
      *    Level Code
           03  S9LVLCDE PIC S9(5) COMP-3.
      *    Dealer Number
           03  S9DLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  S9DLRSFX PIC X(2).
      *    Target Period Code
           03  S9PERCDE PIC X(6).
      *    Object Code
           03  S9OBJCDE PIC X(6).
      *    Define keylist
       01  KRSSF3-TMP.
      *    Level Code
           03  S9LVLCDE PIC S9(5) COMP-3.
      *    Dealer Number
           03  S9DLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  S9DLRSFX PIC X(2).
      *    Target Period Code
           03  S9PERCDE PIC X(6).
      *    Object Code
           03  S9OBJCDE PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSF3.
      *    Level Code
           03  S9LVLCDE PIC S9(5) COMP-3.
      *    Dealer Number
           03  S9DLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  S9DLRSFX PIC X(2).
      *    Target Period Code
           03  S9PERCDE PIC X(6).
      *    Object Code
           03  S9OBJCDE PIC X(6).
      *..............................................................
      *    Define keylist
       01  KRSSF4.
      *    Level Code
           03  S9LVLCDE PIC S9(5) COMP-3.
      *    Dealer Number
           03  S9DLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  S9DLRSFX PIC X(2).
      *    Target Period Code
           03  S9PERCDE PIC X(6).
      *    Object Code
           03  S9OBJCDE PIC X(6).
      *    Define keylist
       01  KRSSF4-TMP.
      *    Level Code
           03  S9LVLCDE PIC S9(5) COMP-3.
      *    Dealer Number
           03  S9DLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  S9DLRSFX PIC X(2).
      *    Target Period Code
           03  S9PERCDE PIC X(6).
      *    Object Code
           03  S9OBJCDE PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSF4.
      *    Level Code
           03  S9LVLCDE PIC S9(5) COMP-3.
      *    Dealer Number
           03  S9DLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  S9DLRSFX PIC X(2).
      *    Target Period Code
           03  S9PERCDE PIC X(6).
      *    Object Code
           03  S9OBJCDE PIC X(6).
      *..............................................................
      *    Define keylist
       01  KRSSF5.
      *    Level Code
           03  S9LVLCDE PIC S9(5) COMP-3.
      *    Dealer Number
           03  S9DLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  S9DLRSFX PIC X(2).
      *    Target Period Code
           03  S9PERCDE PIC X(6).
      *    Object Code
           03  S9OBJCDE PIC X(6).
      *    Define keylist
       01  KRSSF5-TMP.
      *    Level Code
           03  S9LVLCDE PIC S9(5) COMP-3.
      *    Dealer Number
           03  S9DLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  S9DLRSFX PIC X(2).
      *    Target Period Code
           03  S9PERCDE PIC X(6).
      *    Object Code
           03  S9OBJCDE PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSF5.
      *    Level Code
           03  S9LVLCDE PIC S9(5) COMP-3.
      *    Dealer Number
           03  S9DLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  S9DLRSFX PIC X(2).
      *    Target Period Code
           03  S9PERCDE PIC X(6).
      *    Object Code
           03  S9OBJCDE PIC X(6).
      *..............................................................
      *    Define keylist
       01  KPSSF6.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    DATE 58 IMMATRICULATION
           03  OSW0NB PIC S9(8).
      *    Define keylist
       01  KPSSF6-TMP.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    DATE 58 IMMATRICULATION
           03  OSW0NB PIC S9(8).
      *    Define keylist
       01  KRSSF6.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    Define keylist
       01  KRSSF6-TMP.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSF6.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    DATE 58 IMMATRICULATION
           03  OSW0NB PIC S9(8).
      *    COMMANDE CLIENT
           03  OSNUCO PIC X(6).
      *..............................................................
      *    Define keylist
       01  KRSSF7.
      *    Model Application Code
           03  LLMDLAPPCD PIC X(6).
      *    SCP Model Code
           03  LLSCMDLCDE PIC X(3).
      *    Define keylist
       01  KRSSF7-TMP.
      *    Model Application Code
           03  LLMDLAPPCD PIC X(6).
      *    SCP Model Code
           03  LLSCMDLCDE PIC X(3).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSF7.
      *    Model Application Code
           03  LLMDLAPPCD PIC X(6).
      *    SCP Model Code
           03  LLSCMDLCDE PIC X(3).
      *..............................................................
      *    Define keylist
       01  KRSSF8.
      *    SCP Model Code
           03  O9SCMDLCDE PIC X(3).
      *    Define keylist
       01  KRSSF8-TMP.
      *    SCP Model Code
           03  O9SCMDLCDE PIC X(3).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSF8.
      *    SCP Model Code
           03  O9SCMDLCDE PIC X(3).
      *    Bns RIC Config Year
           03  O9BNSRICYR PIC S9(4).
      *    Bns RIC Display Sequence
           03  O9BNSRICSQ PIC S9(3).
      *..............................................................
      *    Define keylist
       01  KRSSF9.
      *    Dealer number (Num key)
           03  Q2DLRNOKEY PIC S9(5) COMP-3.
      *    BDC Model
           03  Q2BDCM PIC X(3).
      *    BDC Customer Order Number
           03  Q2BDCCON PIC X(6).
      *    Define keylist
       01  KRSSF9-TMP.
      *    Dealer number (Num key)
           03  Q2DLRNOKEY PIC S9(5) COMP-3.
      *    BDC Model
           03  Q2BDCM PIC X(3).
      *    BDC Customer Order Number
           03  Q2BDCCON PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSF9.
      *    Dealer number (Num key)
           03  Q2DLRNOKEY PIC S9(5) COMP-3.
      *    BDC Model
           03  Q2BDCM PIC X(3).
      *    BDC Customer Order Number
           03  Q2BDCCON PIC X(6).
      *..............................................................
      *    Define keylist
       01  KPSSG1.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    De-reg Date NBR
           03  OSZXNU PIC S9(8).
      *    Define keylist
       01  KPSSG1-TMP.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    De-reg Date NBR
           03  OSZXNU PIC S9(8).
      *    Define keylist
       01  KRSSG1.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    Define keylist
       01  KRSSG1-TMP.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSG1.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    De-reg Date NBR
           03  OSZXNU PIC S9(8).
      *..............................................................
      *    Define keylist
       01  KRSSG2.
      *    Model Application Code
           03  LLMDLAPPCD PIC X(6).
      *    SCP Model Code
           03  LLSCMDLCDE PIC X(3).
      *    Define keylist
       01  KRSSG2-TMP.
      *    Model Application Code
           03  LLMDLAPPCD PIC X(6).
      *    SCP Model Code
           03  LLSCMDLCDE PIC X(3).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSG2.
      *    Model Application Code
           03  LLMDLAPPCD PIC X(6).
      *    SCP Model Code
           03  LLSCMDLCDE PIC X(3).
      *..............................................................
      *    Define keylist
       01  KRSSG3.
      *    SCP Model Code
           03  O9SCMDLCDE PIC X(3).
      *    Define keylist
       01  KRSSG3-TMP.
      *    SCP Model Code
           03  O9SCMDLCDE PIC X(3).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSG3.
      *    SCP Model Code
           03  O9SCMDLCDE PIC X(3).
      *    Bns RIC Config Year
           03  O9BNSRICYR PIC S9(4).
      *    Bns RIC Display Sequence
           03  O9BNSRICSQ PIC S9(3).
      *..............................................................
      *    Define keylist
       01  KRSSG4.
      *    Chassis number
           03  Q2ASXX PIC X(14).
      *    Define keylist
       01  KRSSG4-TMP.
      *    Chassis number
           03  Q2ASXX PIC X(14).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSG4.
      *    Chassis number
           03  Q2ASXX PIC X(14).
      *..............................................................
      *    Define keylist
       01  KPSSG5.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    DATE 58 IMMATRICULATION
           03  OSW0NB PIC S9(8).
      *    Define keylist
       01  KPSSG5-TMP.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    DATE 58 IMMATRICULATION
           03  OSW0NB PIC S9(8).
      *    Define keylist
       01  KRSSG5.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    Define keylist
       01  KRSSG5-TMP.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSG5.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    DATE 58 IMMATRICULATION
           03  OSW0NB PIC S9(8).
      *    COMMANDE CLIENT
           03  OSNUCO PIC X(6).
      *..............................................................
      *    Define keylist
       01  KRSSG6.
      *    Model Application Code
           03  LLMDLAPPCD PIC X(6).
      *    SCP Model Code
           03  LLSCMDLCDE PIC X(3).
      *    Define keylist
       01  KRSSG6-TMP.
      *    Model Application Code
           03  LLMDLAPPCD PIC X(6).
      *    SCP Model Code
           03  LLSCMDLCDE PIC X(3).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSG6.
      *    Model Application Code
           03  LLMDLAPPCD PIC X(6).
      *    SCP Model Code
           03  LLSCMDLCDE PIC X(3).
      *..............................................................
      *    Define keylist
       01  KRSSG7.
      *    SCP Model Code
           03  O9SCMDLCDE PIC X(3).
      *    Define keylist
       01  KRSSG7-TMP.
      *    SCP Model Code
           03  O9SCMDLCDE PIC X(3).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSG7.
      *    SCP Model Code
           03  O9SCMDLCDE PIC X(3).
      *    Bns RIC Config Year
           03  O9BNSRICYR PIC S9(4).
      *    Bns RIC Display Sequence
           03  O9BNSRICSQ PIC S9(3).
      *..............................................................
      *    Define keylist
       01  KRSSG8.
      *    Dealer number (Num key)
           03  Q2DLRNOKEY PIC S9(5) COMP-3.
      *    BDC Model
           03  Q2BDCM PIC X(3).
      *    BDC Customer Order Number
           03  Q2BDCCON PIC X(6).
      *    Define keylist
       01  KRSSG8-TMP.
      *    Dealer number (Num key)
           03  Q2DLRNOKEY PIC S9(5) COMP-3.
      *    BDC Model
           03  Q2BDCM PIC X(3).
      *    BDC Customer Order Number
           03  Q2BDCCON PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSG8.
      *    Dealer number (Num key)
           03  Q2DLRNOKEY PIC S9(5) COMP-3.
      *    BDC Model
           03  Q2BDCM PIC X(3).
      *    BDC Customer Order Number
           03  Q2BDCCON PIC X(6).
      *..............................................................
      *    Define keylist
       01  KPSSG9.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    De-reg Date NBR
           03  OSZXNU PIC S9(8).
      *    Define keylist
       01  KPSSG9-TMP.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    De-reg Date NBR
           03  OSZXNU PIC S9(8).
      *    Define keylist
       01  KRSSG9.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    Define keylist
       01  KRSSG9-TMP.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSG9.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    De-reg Date NBR
           03  OSZXNU PIC S9(8).
      *..............................................................
      *    Define keylist
       01  KRSSH1.
      *    Model Application Code
           03  LLMDLAPPCD PIC X(6).
      *    SCP Model Code
           03  LLSCMDLCDE PIC X(3).
      *    Define keylist
       01  KRSSH1-TMP.
      *    Model Application Code
           03  LLMDLAPPCD PIC X(6).
      *    SCP Model Code
           03  LLSCMDLCDE PIC X(3).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSH1.
      *    Model Application Code
           03  LLMDLAPPCD PIC X(6).
      *    SCP Model Code
           03  LLSCMDLCDE PIC X(3).
      *..............................................................
      *    Define keylist
       01  KRSSH2.
      *    SCP Model Code
           03  O9SCMDLCDE PIC X(3).
      *    Define keylist
       01  KRSSH2-TMP.
      *    SCP Model Code
           03  O9SCMDLCDE PIC X(3).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSH2.
      *    SCP Model Code
           03  O9SCMDLCDE PIC X(3).
      *    Bns RIC Config Year
           03  O9BNSRICYR PIC S9(4).
      *    Bns RIC Display Sequence
           03  O9BNSRICSQ PIC S9(3).
      *..............................................................
      *    Define keylist
       01  KRSSH3.
      *    Chassis number
           03  Q2ASXX PIC X(14).
      *    Define keylist
       01  KRSSH3-TMP.
      *    Chassis number
           03  Q2ASXX PIC X(14).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSH3.
      *    Chassis number
           03  Q2ASXX PIC X(14).
      *..............................................................
      *    Define keylist
       01  KRSSH4.
      *    Level Code
           03  S9LVLCDE PIC S9(5) COMP-3.
      *    Dealer Number
           03  S9DLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  S9DLRSFX PIC X(2).
      *    Target Period Code
           03  S9PERCDE PIC X(6).
      *    Object Code
           03  S9OBJCDE PIC X(6).
      *    Define keylist
       01  KRSSH4-TMP.
      *    Level Code
           03  S9LVLCDE PIC S9(5) COMP-3.
      *    Dealer Number
           03  S9DLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  S9DLRSFX PIC X(2).
      *    Target Period Code
           03  S9PERCDE PIC X(6).
      *    Object Code
           03  S9OBJCDE PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSH4.
      *    Level Code
           03  S9LVLCDE PIC S9(5) COMP-3.
      *    Dealer Number
           03  S9DLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  S9DLRSFX PIC X(2).
      *    Target Period Code
           03  S9PERCDE PIC X(6).
      *    Object Code
           03  S9OBJCDE PIC X(6).
      *..............................................................
      *    Define keylist
       01  KRSSH5.
      *    Level Code
           03  S9LVLCDE PIC S9(5) COMP-3.
      *    Dealer Number
           03  S9DLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  S9DLRSFX PIC X(2).
      *    Target Period Code
           03  S9PERCDE PIC X(6).
      *    Object Code
           03  S9OBJCDE PIC X(6).
      *    Define keylist
       01  KRSSH5-TMP.
      *    Level Code
           03  S9LVLCDE PIC S9(5) COMP-3.
      *    Dealer Number
           03  S9DLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  S9DLRSFX PIC X(2).
      *    Target Period Code
           03  S9PERCDE PIC X(6).
      *    Object Code
           03  S9OBJCDE PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSH5.
      *    Level Code
           03  S9LVLCDE PIC S9(5) COMP-3.
      *    Dealer Number
           03  S9DLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  S9DLRSFX PIC X(2).
      *    Target Period Code
           03  S9PERCDE PIC X(6).
      *    Object Code
           03  S9OBJCDE PIC X(6).
      *..............................................................
      *    Define keylist
       01  KRSSH6.
      *    Level Code
           03  S9LVLCDE PIC S9(5) COMP-3.
      *    Dealer Number
           03  S9DLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  S9DLRSFX PIC X(2).
      *    Target Period Code
           03  S9PERCDE PIC X(6).
      *    Object Code
           03  S9OBJCDE PIC X(6).
      *    Define keylist
       01  KRSSH6-TMP.
      *    Level Code
           03  S9LVLCDE PIC S9(5) COMP-3.
      *    Dealer Number
           03  S9DLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  S9DLRSFX PIC X(2).
      *    Target Period Code
           03  S9PERCDE PIC X(6).
      *    Object Code
           03  S9OBJCDE PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSH6.
      *    Level Code
           03  S9LVLCDE PIC S9(5) COMP-3.
      *    Dealer Number
           03  S9DLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  S9DLRSFX PIC X(2).
      *    Target Period Code
           03  S9PERCDE PIC X(6).
      *    Object Code
           03  S9OBJCDE PIC X(6).
      *..............................................................
      *    Define keylist
       01  KRSSH7.
      *    Level Code
           03  S9LVLCDE PIC S9(5) COMP-3.
      *    Dealer Number
           03  S9DLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  S9DLRSFX PIC X(2).
      *    Target Period Code
           03  S9PERCDE PIC X(6).
      *    Object Code
           03  S9OBJCDE PIC X(6).
      *    Define keylist
       01  KRSSH7-TMP.
      *    Level Code
           03  S9LVLCDE PIC S9(5) COMP-3.
      *    Dealer Number
           03  S9DLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  S9DLRSFX PIC X(2).
      *    Target Period Code
           03  S9PERCDE PIC X(6).
      *    Object Code
           03  S9OBJCDE PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSH7.
      *    Level Code
           03  S9LVLCDE PIC S9(5) COMP-3.
      *    Dealer Number
           03  S9DLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  S9DLRSFX PIC X(2).
      *    Target Period Code
           03  S9PERCDE PIC X(6).
      *    Object Code
           03  S9OBJCDE PIC X(6).
      *..............................................................
      *    Define keylist
       01  KPSSH8.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    DATE 58 IMMATRICULATION
           03  OSW0NB PIC S9(8).
      *    Define keylist
       01  KPSSH8-TMP.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    DATE 58 IMMATRICULATION
           03  OSW0NB PIC S9(8).
      *    Define keylist
       01  KRSSH8.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    Define keylist
       01  KRSSH8-TMP.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSH8.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    DATE 58 IMMATRICULATION
           03  OSW0NB PIC S9(8).
      *    COMMANDE CLIENT
           03  OSNUCO PIC X(6).
      *..............................................................
      *    Define keylist
       01  KRSSH9.
      *    Model Application Code
           03  LLMDLAPPCD PIC X(6).
      *    SCP Model Code
           03  LLSCMDLCDE PIC X(3).
      *    Define keylist
       01  KRSSH9-TMP.
      *    Model Application Code
           03  LLMDLAPPCD PIC X(6).
      *    SCP Model Code
           03  LLSCMDLCDE PIC X(3).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSH9.
      *    Model Application Code
           03  LLMDLAPPCD PIC X(6).
      *    SCP Model Code
           03  LLSCMDLCDE PIC X(3).
      *..............................................................
      *    Define keylist
       01  KRSSI1.
      *    SCP Model Code
           03  O9SCMDLCDE PIC X(3).
      *    Define keylist
       01  KRSSI1-TMP.
      *    SCP Model Code
           03  O9SCMDLCDE PIC X(3).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSI1.
      *    SCP Model Code
           03  O9SCMDLCDE PIC X(3).
      *    Bns RIC Config Year
           03  O9BNSRICYR PIC S9(4).
      *    Bns RIC Display Sequence
           03  O9BNSRICSQ PIC S9(3).
      *..............................................................
      *    Define keylist
       01  KRSSI2.
      *    Dealer number (Num key)
           03  Q2DLRNOKEY PIC S9(5) COMP-3.
      *    BDC Model
           03  Q2BDCM PIC X(3).
      *    BDC Customer Order Number
           03  Q2BDCCON PIC X(6).
      *    Define keylist
       01  KRSSI2-TMP.
      *    Dealer number (Num key)
           03  Q2DLRNOKEY PIC S9(5) COMP-3.
      *    BDC Model
           03  Q2BDCM PIC X(3).
      *    BDC Customer Order Number
           03  Q2BDCCON PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSI2.
      *    Dealer number (Num key)
           03  Q2DLRNOKEY PIC S9(5) COMP-3.
      *    BDC Model
           03  Q2BDCM PIC X(3).
      *    BDC Customer Order Number
           03  Q2BDCCON PIC X(6).
      *..............................................................
      *    Define keylist
       01  KPSSI3.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    De-reg Date NBR
           03  OSZXNU PIC S9(8).
      *    Define keylist
       01  KPSSI3-TMP.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    De-reg Date NBR
           03  OSZXNU PIC S9(8).
      *    Define keylist
       01  KRSSI3.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    Define keylist
       01  KRSSI3-TMP.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSI3.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    De-reg Date NBR
           03  OSZXNU PIC S9(8).
      *..............................................................
      *    Define keylist
       01  KRSSI4.
      *    Model Application Code
           03  LLMDLAPPCD PIC X(6).
      *    SCP Model Code
           03  LLSCMDLCDE PIC X(3).
      *    Define keylist
       01  KRSSI4-TMP.
      *    Model Application Code
           03  LLMDLAPPCD PIC X(6).
      *    SCP Model Code
           03  LLSCMDLCDE PIC X(3).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSI4.
      *    Model Application Code
           03  LLMDLAPPCD PIC X(6).
      *    SCP Model Code
           03  LLSCMDLCDE PIC X(3).
      *..............................................................
      *    Define keylist
       01  KRSSI5.
      *    SCP Model Code
           03  O9SCMDLCDE PIC X(3).
      *    Define keylist
       01  KRSSI5-TMP.
      *    SCP Model Code
           03  O9SCMDLCDE PIC X(3).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSI5.
      *    SCP Model Code
           03  O9SCMDLCDE PIC X(3).
      *    Bns RIC Config Year
           03  O9BNSRICYR PIC S9(4).
      *    Bns RIC Display Sequence
           03  O9BNSRICSQ PIC S9(3).
      *..............................................................
      *    Define keylist
       01  KRSSI6.
      *    Chassis number
           03  Q2ASXX PIC X(14).
      *    Define keylist
       01  KRSSI6-TMP.
      *    Chassis number
           03  Q2ASXX PIC X(14).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSI6.
      *    Chassis number
           03  Q2ASXX PIC X(14).
      *..............................................................
      *    Define keylist
       01  KPSSI7.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    DATE 58 IMMATRICULATION
           03  OSW0NB PIC S9(8).
      *    Define keylist
       01  KPSSI7-TMP.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    DATE 58 IMMATRICULATION
           03  OSW0NB PIC S9(8).
      *    Define keylist
       01  KRSSI7.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    Define keylist
       01  KRSSI7-TMP.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSI7.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    DATE 58 IMMATRICULATION
           03  OSW0NB PIC S9(8).
      *    COMMANDE CLIENT
           03  OSNUCO PIC X(6).
      *..............................................................
      *    Define keylist
       01  KRSSI8.
      *    Model Application Code
           03  LLMDLAPPCD PIC X(6).
      *    SCP Model Code
           03  LLSCMDLCDE PIC X(3).
      *    Define keylist
       01  KRSSI8-TMP.
      *    Model Application Code
           03  LLMDLAPPCD PIC X(6).
      *    SCP Model Code
           03  LLSCMDLCDE PIC X(3).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSI8.
      *    Model Application Code
           03  LLMDLAPPCD PIC X(6).
      *    SCP Model Code
           03  LLSCMDLCDE PIC X(3).
      *..............................................................
      *    Define keylist
       01  KRSSI9.
      *    SCP Model Code
           03  O9SCMDLCDE PIC X(3).
      *    Define keylist
       01  KRSSI9-TMP.
      *    SCP Model Code
           03  O9SCMDLCDE PIC X(3).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSI9.
      *    SCP Model Code
           03  O9SCMDLCDE PIC X(3).
      *    Bns RIC Config Year
           03  O9BNSRICYR PIC S9(4).
      *    Bns RIC Display Sequence
           03  O9BNSRICSQ PIC S9(3).
      *..............................................................
      *    Define keylist
       01  KRSSJ1.
      *    Dealer number (Num key)
           03  Q2DLRNOKEY PIC S9(5) COMP-3.
      *    BDC Model
           03  Q2BDCM PIC X(3).
      *    BDC Customer Order Number
           03  Q2BDCCON PIC X(6).
      *    Define keylist
       01  KRSSJ1-TMP.
      *    Dealer number (Num key)
           03  Q2DLRNOKEY PIC S9(5) COMP-3.
      *    BDC Model
           03  Q2BDCM PIC X(3).
      *    BDC Customer Order Number
           03  Q2BDCCON PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSJ1.
      *    Dealer number (Num key)
           03  Q2DLRNOKEY PIC S9(5) COMP-3.
      *    BDC Model
           03  Q2BDCM PIC X(3).
      *    BDC Customer Order Number
           03  Q2BDCCON PIC X(6).
      *..............................................................
      *    Define keylist
       01  KPSSJ2.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    De-reg Date NBR
           03  OSZXNU PIC S9(8).
      *    Define keylist
       01  KPSSJ2-TMP.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    De-reg Date NBR
           03  OSZXNU PIC S9(8).
      *    Define keylist
       01  KRSSJ2.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    Define keylist
       01  KRSSJ2-TMP.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSJ2.
      *    CONCES PROPRIETAIRE
           03  OSNECO PIC X(6).
      *    De-reg Date NBR
           03  OSZXNU PIC S9(8).
      *..............................................................
      *    Define keylist
       01  KRSSJ3.
      *    Model Application Code
           03  LLMDLAPPCD PIC X(6).
      *    SCP Model Code
           03  LLSCMDLCDE PIC X(3).
      *    Define keylist
       01  KRSSJ3-TMP.
      *    Model Application Code
           03  LLMDLAPPCD PIC X(6).
      *    SCP Model Code
           03  LLSCMDLCDE PIC X(3).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSJ3.
      *    Model Application Code
           03  LLMDLAPPCD PIC X(6).
      *    SCP Model Code
           03  LLSCMDLCDE PIC X(3).
      *..............................................................
      *    Define keylist
       01  KRSSJ4.
      *    SCP Model Code
           03  O9SCMDLCDE PIC X(3).
      *    Define keylist
       01  KRSSJ4-TMP.
      *    SCP Model Code
           03  O9SCMDLCDE PIC X(3).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSJ4.
      *    SCP Model Code
           03  O9SCMDLCDE PIC X(3).
      *    Bns RIC Config Year
           03  O9BNSRICYR PIC S9(4).
      *    Bns RIC Display Sequence
           03  O9BNSRICSQ PIC S9(3).
      *..............................................................
      *    Define keylist
       01  KRSSJ5.
      *    Chassis number
           03  Q2ASXX PIC X(14).
      *    Define keylist
       01  KRSSJ5-TMP.
      *    Chassis number
           03  Q2ASXX PIC X(14).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSJ5.
      *    Chassis number
           03  Q2ASXX PIC X(14).
      *..............................................................
      *    Define keylist
       01  KRSSJ6.
      *    Level Code
           03  S9LVLCDE PIC S9(5) COMP-3.
      *    Dealer Number
           03  S9DLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  S9DLRSFX PIC X(2).
      *    Target Period Code
           03  S9PERCDE PIC X(6).
      *    Object Code
           03  S9OBJCDE PIC X(6).
      *    Define keylist
       01  KRSSJ6-TMP.
      *    Level Code
           03  S9LVLCDE PIC S9(5) COMP-3.
      *    Dealer Number
           03  S9DLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  S9DLRSFX PIC X(2).
      *    Target Period Code
           03  S9PERCDE PIC X(6).
      *    Object Code
           03  S9OBJCDE PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSJ6.
      *    Level Code
           03  S9LVLCDE PIC S9(5) COMP-3.
      *    Dealer Number
           03  S9DLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  S9DLRSFX PIC X(2).
      *    Target Period Code
           03  S9PERCDE PIC X(6).
      *    Object Code
           03  S9OBJCDE PIC X(6).
      *..............................................................
      *    Define keylist
       01  KRSSJ7.
      *    Level Code
           03  S9LVLCDE PIC S9(5) COMP-3.
      *    Dealer Number
           03  S9DLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  S9DLRSFX PIC X(2).
      *    Target Period Code
           03  S9PERCDE PIC X(6).
      *    Object Code
           03  S9OBJCDE PIC X(6).
      *    Define keylist
       01  KRSSJ7-TMP.
      *    Level Code
           03  S9LVLCDE PIC S9(5) COMP-3.
      *    Dealer Number
           03  S9DLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  S9DLRSFX PIC X(2).
      *    Target Period Code
           03  S9PERCDE PIC X(6).
      *    Object Code
           03  S9OBJCDE PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSJ7.
      *    Level Code
           03  S9LVLCDE PIC S9(5) COMP-3.
      *    Dealer Number
           03  S9DLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  S9DLRSFX PIC X(2).
      *    Target Period Code
           03  S9PERCDE PIC X(6).
      *    Object Code
           03  S9OBJCDE PIC X(6).
      *..............................................................
      *    Define keylist
       01  KRSSJ8.
      *    Level Code
           03  S9LVLCDE PIC S9(5) COMP-3.
      *    Dealer Number
           03  S9DLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  S9DLRSFX PIC X(2).
      *    Target Period Code
           03  S9PERCDE PIC X(6).
      *    Object Code
           03  S9OBJCDE PIC X(6).
      *    Define keylist
       01  KRSSJ8-TMP.
      *    Level Code
           03  S9LVLCDE PIC S9(5) COMP-3.
      *    Dealer Number
           03  S9DLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  S9DLRSFX PIC X(2).
      *    Target Period Code
           03  S9PERCDE PIC X(6).
      *    Object Code
           03  S9OBJCDE PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSJ8.
      *    Level Code
           03  S9LVLCDE PIC S9(5) COMP-3.
      *    Dealer Number
           03  S9DLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  S9DLRSFX PIC X(2).
      *    Target Period Code
           03  S9PERCDE PIC X(6).
      *    Object Code
           03  S9OBJCDE PIC X(6).
      *..............................................................
      *    Define keylist
       01  KRSSJ9.
      *    Level Code
           03  S9LVLCDE PIC S9(5) COMP-3.
      *    Dealer Number
           03  S9DLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  S9DLRSFX PIC X(2).
      *    Target Period Code
           03  S9PERCDE PIC X(6).
      *    Object Code
           03  S9OBJCDE PIC X(6).
      *    Define keylist
       01  KRSSJ9-TMP.
      *    Level Code
           03  S9LVLCDE PIC S9(5) COMP-3.
      *    Dealer Number
           03  S9DLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  S9DLRSFX PIC X(2).
      *    Target Period Code
           03  S9PERCDE PIC X(6).
      *    Object Code
           03  S9OBJCDE PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSJ9.
      *    Level Code
           03  S9LVLCDE PIC S9(5) COMP-3.
      *    Dealer Number
           03  S9DLRNBR PIC X(4).
      *    Dealer Number Suffix
           03  S9DLRSFX PIC X(2).
      *    Target Period Code
           03  S9PERCDE PIC X(6).
      *    Object Code
           03  S9OBJCDE PIC X(6).
      *..............................................................
      *    Define keylist
       01  KPSSK1.
      *    Owning Account
           03  C5OWNACC PIC X(6).
      *    Customer Order Date #
           03  C5CUSORDD8 PIC S9(8) COMP-3.
      *    Define keylist
       01  KPSSK1-TMP.
      *    Owning Account
           03  C5OWNACC PIC X(6).
      *    Customer Order Date #
           03  C5CUSORDD8 PIC S9(8) COMP-3.
      *    Define keylist
       01  KRSSK1.
      *    Owning Account
           03  C5OWNACC PIC X(6).
      *    Define keylist
       01  KRSSK1-TMP.
      *    Owning Account
           03  C5OWNACC PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSK1.
      *    Owning Account
           03  C5OWNACC PIC X(6).
      *    Customer Order Date #
           03  C5CUSORDD8 PIC S9(8) COMP-3.
      *    Customer Ord Number
           03  C5CUSORDNB PIC X(6).
      *..............................................................
      *    Define keylist
       01  KRSSK2.
      *    Model Application Code
           03  LLMDLAPPCD PIC X(6).
      *    SCP Model Code
           03  LLSCMDLCDE PIC X(3).
      *    Define keylist
       01  KRSSK2-TMP.
      *    Model Application Code
           03  LLMDLAPPCD PIC X(6).
      *    SCP Model Code
           03  LLSCMDLCDE PIC X(3).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSK2.
      *    Model Application Code
           03  LLMDLAPPCD PIC X(6).
      *    SCP Model Code
           03  LLSCMDLCDE PIC X(3).
      *..............................................................
      *    Define keylist
       01  KRSSK3.
      *    SCP Model Code
           03  O9SCMDLCDE PIC X(3).
      *    Define keylist
       01  KRSSK3-TMP.
      *    SCP Model Code
           03  O9SCMDLCDE PIC X(3).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSK3.
      *    SCP Model Code
           03  O9SCMDLCDE PIC X(3).
      *    Bns RIC Config Year
           03  O9BNSRICYR PIC S9(4).
      *    Bns RIC Display Sequence
           03  O9BNSRICSQ PIC S9(3).
      *..............................................................
      *    Define keylist
       01  KRSSK4.
      *    Dealer number (Num key)
           03  Q2DLRNOKEY PIC S9(5) COMP-3.
      *    BDC Model
           03  Q2BDCM PIC X(3).
      *    BDC Customer Order Number
           03  Q2BDCCON PIC X(6).
      *    Define keylist
       01  KRSSK4-TMP.
      *    Dealer number (Num key)
           03  Q2DLRNOKEY PIC S9(5) COMP-3.
      *    BDC Model
           03  Q2BDCM PIC X(3).
      *    BDC Customer Order Number
           03  Q2BDCCON PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSK4.
      *    Dealer number (Num key)
           03  Q2DLRNOKEY PIC S9(5) COMP-3.
      *    BDC Model
           03  Q2BDCM PIC X(3).
      *    BDC Customer Order Number
           03  Q2BDCCON PIC X(6).
      *..............................................................
      *    Define keylist
       01  KRSSK5.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *    Customer Ord Number
           03  BBCUSORDNB PIC X(6).
      *    Customer Order Deduct Typ
           03  BBCODEDTYP PIC X(1).
      *    Invariant BCV
           03  BBINVBCV PIC X(15).
      *    Order Deduct Sequence Nbr
           03  BBCODEDSEQ PIC S9(3) COMP-3.
      *    Define keylist
       01  KRSSK5-TMP.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *    Customer Ord Number
           03  BBCUSORDNB PIC X(6).
      *    Customer Order Deduct Typ
           03  BBCODEDTYP PIC X(1).
      *    Invariant BCV
           03  BBINVBCV PIC X(15).
      *    Order Deduct Sequence Nbr
           03  BBCODEDSEQ PIC S9(3) COMP-3.
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSK5.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *    Customer Ord Number
           03  BBCUSORDNB PIC X(6).
      *    Customer Order Deduct Typ
           03  BBCODEDTYP PIC X(1).
      *    Invariant BCV
           03  BBINVBCV PIC X(15).
      *    Order Deduct Sequence Nbr
           03  BBCODEDSEQ PIC S9(3) COMP-3.
      *..............................................................
      *    Owning Account
       01  WQ0085 PIC X(6).
      *    Customer Ord Number
       01  WQ0086 PIC X(6).
      *    Customer Order Date #
       01  WQ0087 PIC S9(8) COMP-3.
      *    Order Type(Central)
       01  WQ0088 PIC X(2).
      *    SD Sales Channel Code
       01  WQ0089 PIC X(2).
      *    SEDRE Customer Type
       01  WQ0090 PIC X(1).
      *    SCP Model Code
       01  WQ0091 PIC X(3).
      *    Model Phase
       01  WQ0092 PIC X(1).
      *    SCP Model Version Code
       01  WQ0093 PIC X(12).
      *    Order Cancelled Date
       01  WQ0094 PIC S9(8) COMP-3.
      *    Order Cancellation Reason
       01  WQ0095 PIC X(4).
      *    Fleet Operator Number
       01  WQ0096 PIC X(5).
      *    BDC Payment Term
       01  WQ0097 PIC X(4).
      *    OBT Count Target Status
       01  WQ0098 PIC X(1).
      *    Fleet Programmes Code
       01  WQ0099 PIC X(3).
      *    Target Market
       01  WQ0100 PIC X(1).
      *    U:Date Type
       01  WQ0101 PIC X(1).
      *    Define keylist
       01  KPSSK6.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *    Order Deduct Date Effect
           03  BBCUSDEDEF PIC S9(8) COMP-3.
      *    Define keylist
       01  KPSSK6-TMP.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *    Order Deduct Date Effect
           03  BBCUSDEDEF PIC S9(8) COMP-3.
      *    Define keylist
       01  KRSSK6.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *    Define keylist
       01  KRSSK6-TMP.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSK6.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *    Order Deduct Date Effect
           03  BBCUSDEDEF PIC S9(8) COMP-3.
      *    SCP Model Code
           03  BBSCMDLCDE PIC X(3).
      *    Count to Deduction Status
           03  BBCNTDEDUC PIC S9(1).
      *..............................................................
      *    Define keylist
       01  KPSSK7.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *    Order Deduct Date Effect
           03  BBCUSDEDEF PIC S9(8) COMP-3.
      *    Define keylist
       01  KPSSK7-TMP.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *    Order Deduct Date Effect
           03  BBCUSDEDEF PIC S9(8) COMP-3.
      *    Define keylist
       01  KRSSK7.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *    Define keylist
       01  KRSSK7-TMP.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSK7.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *    Order Deduct Date Effect
           03  BBCUSDEDEF PIC S9(8) COMP-3.
      *    SCP Model Code
           03  BBSCMDLCDE PIC X(3).
      *    Count to Deduction Status
           03  BBCNTDEDUC PIC S9(1).
      *..............................................................
      *    Define keylist
       01  KPSSK8.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *    Order Deduct Date Effect
           03  BBCUSDEDEF PIC S9(8) COMP-3.
      *    Define keylist
       01  KPSSK8-TMP.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *    Order Deduct Date Effect
           03  BBCUSDEDEF PIC S9(8) COMP-3.
      *    Define keylist
       01  KRSSK8.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *    Define keylist
       01  KRSSK8-TMP.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSK8.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *    Order Deduct Date Effect
           03  BBCUSDEDEF PIC S9(8) COMP-3.
      *    SCP Model Code
           03  BBSCMDLCDE PIC X(3).
      *    Count to Deduction Status
           03  BBCNTDEDUC PIC S9(1).
      *..............................................................
      *    Define keylist
       01  KPSSK9.
      *    Owning Account
           03  C5OWNACC PIC X(6).
      *    Customer Order Date #
           03  C5CUSORDD8 PIC S9(8) COMP-3.
      *    Define keylist
       01  KPSSK9-TMP.
      *    Owning Account
           03  C5OWNACC PIC X(6).
      *    Customer Order Date #
           03  C5CUSORDD8 PIC S9(8) COMP-3.
      *    Define keylist
       01  KRSSK9.
      *    Owning Account
           03  C5OWNACC PIC X(6).
      *    Define keylist
       01  KRSSK9-TMP.
      *    Owning Account
           03  C5OWNACC PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSK9.
      *    Owning Account
           03  C5OWNACC PIC X(6).
      *    Customer Order Date #
           03  C5CUSORDD8 PIC S9(8) COMP-3.
      *    Customer Ord Number
           03  C5CUSORDNB PIC X(6).
      *..............................................................
      *    Define keylist
       01  KRSSL1.
      *    Model Application Code
           03  LLMDLAPPCD PIC X(6).
      *    SCP Model Code
           03  LLSCMDLCDE PIC X(3).
      *    Define keylist
       01  KRSSL1-TMP.
      *    Model Application Code
           03  LLMDLAPPCD PIC X(6).
      *    SCP Model Code
           03  LLSCMDLCDE PIC X(3).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSL1.
      *    Model Application Code
           03  LLMDLAPPCD PIC X(6).
      *    SCP Model Code
           03  LLSCMDLCDE PIC X(3).
      *..............................................................
      *    Define keylist
       01  KRSSL2.
      *    SCP Model Code
           03  O9SCMDLCDE PIC X(3).
      *    Define keylist
       01  KRSSL2-TMP.
      *    SCP Model Code
           03  O9SCMDLCDE PIC X(3).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSL2.
      *    SCP Model Code
           03  O9SCMDLCDE PIC X(3).
      *    Bns RIC Config Year
           03  O9BNSRICYR PIC S9(4).
      *    Bns RIC Display Sequence
           03  O9BNSRICSQ PIC S9(3).
      *..............................................................
      *    Define keylist
       01  KRSSL3.
      *    Dealer number (Num key)
           03  Q2DLRNOKEY PIC S9(5) COMP-3.
      *    BDC Model
           03  Q2BDCM PIC X(3).
      *    BDC Customer Order Number
           03  Q2BDCCON PIC X(6).
      *    Define keylist
       01  KRSSL3-TMP.
      *    Dealer number (Num key)
           03  Q2DLRNOKEY PIC S9(5) COMP-3.
      *    BDC Model
           03  Q2BDCM PIC X(3).
      *    BDC Customer Order Number
           03  Q2BDCCON PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSL3.
      *    Dealer number (Num key)
           03  Q2DLRNOKEY PIC S9(5) COMP-3.
      *    BDC Model
           03  Q2BDCM PIC X(3).
      *    BDC Customer Order Number
           03  Q2BDCCON PIC X(6).
      *..............................................................
      *    Define keylist
       01  KRSSL4.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *    Customer Ord Number
           03  BBCUSORDNB PIC X(6).
      *    Customer Order Deduct Typ
           03  BBCODEDTYP PIC X(1).
      *    Invariant BCV
           03  BBINVBCV PIC X(15).
      *    Order Deduct Sequence Nbr
           03  BBCODEDSEQ PIC S9(3) COMP-3.
      *    Define keylist
       01  KRSSL4-TMP.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *    Customer Ord Number
           03  BBCUSORDNB PIC X(6).
      *    Customer Order Deduct Typ
           03  BBCODEDTYP PIC X(1).
      *    Invariant BCV
           03  BBINVBCV PIC X(15).
      *    Order Deduct Sequence Nbr
           03  BBCODEDSEQ PIC S9(3) COMP-3.
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSL4.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *    Customer Ord Number
           03  BBCUSORDNB PIC X(6).
      *    Customer Order Deduct Typ
           03  BBCODEDTYP PIC X(1).
      *    Invariant BCV
           03  BBINVBCV PIC X(15).
      *    Order Deduct Sequence Nbr
           03  BBCODEDSEQ PIC S9(3) COMP-3.
      *..............................................................
      *    Owning Account
       01  WQ0102 PIC X(6).
      *    Customer Ord Number
       01  WQ0103 PIC X(6).
      *    Customer Order Date #
       01  WQ0104 PIC S9(8) COMP-3.
      *    Order Type(Central)
       01  WQ0105 PIC X(2).
      *    SD Sales Channel Code
       01  WQ0106 PIC X(2).
      *    SEDRE Customer Type
       01  WQ0107 PIC X(1).
      *    SCP Model Code
       01  WQ0108 PIC X(3).
      *    Model Phase
       01  WQ0109 PIC X(1).
      *    SCP Model Version Code
       01  WQ0110 PIC X(12).
      *    Order Cancelled Date
       01  WQ0111 PIC S9(8) COMP-3.
      *    Order Cancellation Reason
       01  WQ0112 PIC X(4).
      *    Fleet Operator Number
       01  WQ0113 PIC X(5).
      *    BDC Payment Term
       01  WQ0114 PIC X(4).
      *    OBT Count Target Status
       01  WQ0115 PIC X(1).
      *    Fleet Programmes Code
       01  WQ0116 PIC X(3).
      *    Target Market
       01  WQ0117 PIC X(1).
      *    U:Date Type
       01  WQ0118 PIC X(1).
      *    Define keylist
       01  KPSSL5.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *    Order Deduct Date Effect
           03  BBCUSDEDEF PIC S9(8) COMP-3.
      *    Define keylist
       01  KPSSL5-TMP.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *    Order Deduct Date Effect
           03  BBCUSDEDEF PIC S9(8) COMP-3.
      *    Define keylist
       01  KRSSL5.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *    Define keylist
       01  KRSSL5-TMP.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSL5.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *    Order Deduct Date Effect
           03  BBCUSDEDEF PIC S9(8) COMP-3.
      *    SCP Model Code
           03  BBSCMDLCDE PIC X(3).
      *    Count to Deduction Status
           03  BBCNTDEDUC PIC S9(1).
      *..............................................................
      *    Define keylist
       01  KPSSL6.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *    Order Deduct Date Effect
           03  BBCUSDEDEF PIC S9(8) COMP-3.
      *    Define keylist
       01  KPSSL6-TMP.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *    Order Deduct Date Effect
           03  BBCUSDEDEF PIC S9(8) COMP-3.
      *    Define keylist
       01  KRSSL6.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *    Define keylist
       01  KRSSL6-TMP.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSL6.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *    Order Deduct Date Effect
           03  BBCUSDEDEF PIC S9(8) COMP-3.
      *    SCP Model Code
           03  BBSCMDLCDE PIC X(3).
      *    Count to Deduction Status
           03  BBCNTDEDUC PIC S9(1).
      *..............................................................
      *    Define keylist
       01  KPSSL7.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *    Order Deduct Date Effect
           03  BBCUSDEDEF PIC S9(8) COMP-3.
      *    Define keylist
       01  KPSSL7-TMP.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *    Order Deduct Date Effect
           03  BBCUSDEDEF PIC S9(8) COMP-3.
      *    Define keylist
       01  KRSSL7.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *    Define keylist
       01  KRSSL7-TMP.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSL7.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *    Order Deduct Date Effect
           03  BBCUSDEDEF PIC S9(8) COMP-3.
      *    SCP Model Code
           03  BBSCMDLCDE PIC X(3).
      *    Count to Deduction Status
           03  BBCNTDEDUC PIC S9(1).
      *..............................................................
      *    Define keylist
       01  KPSSL8.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *    Order Deduct Date Effect
           03  BBCUSDEDEF PIC S9(8) COMP-3.
      *    Define keylist
       01  KPSSL8-TMP.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *    Order Deduct Date Effect
           03  BBCUSDEDEF PIC S9(8) COMP-3.
      *    Define keylist
       01  KRSSL8.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *    Define keylist
       01  KRSSL8-TMP.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSL8.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *    Order Deduct Date Effect
           03  BBCUSDEDEF PIC S9(8) COMP-3.
      *    SCP Model Code
           03  BBSCMDLCDE PIC X(3).
      *    Count to Deduction Status
           03  BBCNTDEDUC PIC S9(1).
      *..............................................................
      *    Define keylist
       01  KPSSL9.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *    Order Deduct Date Effect
           03  BBCUSDEDEF PIC S9(8) COMP-3.
      *    Define keylist
       01  KPSSL9-TMP.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *    Order Deduct Date Effect
           03  BBCUSDEDEF PIC S9(8) COMP-3.
      *    Define keylist
       01  KRSSL9.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *    Define keylist
       01  KRSSL9-TMP.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSL9.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *    Order Deduct Date Effect
           03  BBCUSDEDEF PIC S9(8) COMP-3.
      *    SCP Model Code
           03  BBSCMDLCDE PIC X(3).
      *    Count to Deduction Status
           03  BBCNTDEDUC PIC S9(1).
      *..............................................................
      *    Define keylist
       01  KPSSM1.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *    Order Deduct Date Effect
           03  BBCUSDEDEF PIC S9(8) COMP-3.
      *    Define keylist
       01  KPSSM1-TMP.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *    Order Deduct Date Effect
           03  BBCUSDEDEF PIC S9(8) COMP-3.
      *    Define keylist
       01  KRSSM1.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *    Define keylist
       01  KRSSM1-TMP.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSM1.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *    Order Deduct Date Effect
           03  BBCUSDEDEF PIC S9(8) COMP-3.
      *    SCP Model Code
           03  BBSCMDLCDE PIC X(3).
      *    Count to Deduction Status
           03  BBCNTDEDUC PIC S9(1).
      *..............................................................
      *    Define keylist
       01  KPSSM2.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *    Order Deduct Date Effect
           03  BBCUSDEDEF PIC S9(8) COMP-3.
      *    Define keylist
       01  KPSSM2-TMP.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *    Order Deduct Date Effect
           03  BBCUSDEDEF PIC S9(8) COMP-3.
      *    Define keylist
       01  KRSSM2.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *    Define keylist
       01  KRSSM2-TMP.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSM2.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *    Order Deduct Date Effect
           03  BBCUSDEDEF PIC S9(8) COMP-3.
      *    SCP Model Code
           03  BBSCMDLCDE PIC X(3).
      *    Count to Deduction Status
           03  BBCNTDEDUC PIC S9(1).
      *..............................................................
      *    Define keylist
       01  KPSSM3.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *    Order Deduct Date Effect
           03  BBCUSDEDEF PIC S9(8) COMP-3.
      *    Define keylist
       01  KPSSM3-TMP.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *    Order Deduct Date Effect
           03  BBCUSDEDEF PIC S9(8) COMP-3.
      *    Define keylist
       01  KRSSM3.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *    Define keylist
       01  KRSSM3-TMP.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSM3.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *    Order Deduct Date Effect
           03  BBCUSDEDEF PIC S9(8) COMP-3.
      *    SCP Model Code
           03  BBSCMDLCDE PIC X(3).
      *    Count to Deduction Status
           03  BBCNTDEDUC PIC S9(1).
      *..............................................................
      *    Define keylist
       01  KPSSM4.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *    Order Deduct Date Effect
           03  BBCUSDEDEF PIC S9(8) COMP-3.
      *    Define keylist
       01  KPSSM4-TMP.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *    Order Deduct Date Effect
           03  BBCUSDEDEF PIC S9(8) COMP-3.
      *    Define keylist
       01  KRSSM4.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *    Define keylist
       01  KRSSM4-TMP.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSM4.
      *    Owning Account
           03  BBOWNACC PIC X(6).
      *    Order Deduct Date Effect
           03  BBCUSDEDEF PIC S9(8) COMP-3.
      *    SCP Model Code
           03  BBSCMDLCDE PIC X(3).
      *    Count to Deduction Status
           03  BBCNTDEDUC PIC S9(1).
      *..............................................................
      *    Define keylist
       01  KRSSM5.
      *    Bonus Scheme (8)
           03  A7BNSSCM PIC X(8).
      *    Dealer to pay Number (Num
           03  A7EDNB PIC S9(5).
      *    Define keylist
       01  KRSSM5-TMP.
      *    Bonus Scheme (8)
           03  A7BNSSCM PIC X(8).
      *    Dealer to pay Number (Num
           03  A7EDNB PIC S9(5).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSM5.
      *    Bonus Scheme (8)
           03  A7BNSSCM PIC X(8).
      *    Dealer to pay Number (Num
           03  A7EDNB PIC S9(5).
      *..............................................................
      *    Outward parameters
       01  PCRC.
      *    RCD : Bonus Sls-Suggest DlrAch2 Update index
      *    I : RST Bonus Scheme (8)
      *    Bonus Scheme (8)
           03  PCBNSSCM PIC X(8).
      *    I : RST Dealer number (Num key)
      *    Dealer number (Num key)
           03  PCDLRNOKEY PIC S9(5) COMP-3.
      *    I : RST Run Number
      *    Run Number
           03  PCRUNNO PIC S9(3) COMP-3.
      *    I : MAP Scheme Sequence
      *    Scheme Sequence
           03  PCSCMSTS PIC X(1).
      *    I : MAP Achievement Band
      *    Achievement Band
           03  PCACHBND PIC X(10).
      *    I : MAP No of Registrations
      *    No of Registrations
           03  PCNOREG PIC S9(7) COMP-3.
      *    I : MAP No of Order
      *    No of Order
           03  PCKENU PIC S9(7) COMP-3.
      *    I : MAP No of Registrations cancl
      *    No of Registrations cancl
           03  PCEONU PIC S9(7) COMP-3.
      *    I : MAP No of Order Canceled
      *    No of Order Canceled
           03  PCKFNU PIC S9(7) COMP-3.
      *    I : MAP Target Value Registration
      *    Target Value Registration
           03  PCOEVB PIC S9(5) COMP-3.
      *    I : MAP Target Value Order
      *    Target Value Order
           03  PCOFVB PIC S9(5) COMP-3.
      *    I : MAP Total Count Registration
      *    Total Count Registration
           03  PCKGNU PIC S9(5) COMP-3.
      *    I : MAP Total Count Order
      *    Total Count Order
           03  PCKHNU PIC S9(5) COMP-3.
      *    I : MAP Achieved Pre-Qualifier
      *    Achieved Pre-Qualifier
           03  PCACPRQ PIC X(1).
      *    I : MAP Achieved Pre-Qualifier 2
      *    Achieved Pre-Qualifier 2
           03  PCACPRQ2 PIC X(1).
      *    I : MAP PreQual Reg/Ord 1
      *    PreQual Reg/Ord 1
           03  PCFNNU PIC S9(7) COMP-3.
      *    I : MAP PreQual Reg/Ord 2
      *    PreQual Reg/Ord 2
           03  PCFONU PIC S9(7) COMP-3.
      *    I : MAP PreQual Reg/Ord 3
      *    PreQual Reg/Ord 3
           03  PCFPNU PIC S9(7) COMP-3.
      *    I : MAP PreQual Reg/Ord 4
      *    PreQual Reg/Ord 4
           03  PCFQNU PIC S9(7) COMP-3.
      *    I : MAP PreQual Reg/Ord 5
      *    PreQual Reg/Ord 5
           03  PCFRNU PIC S9(7) COMP-3.
      *    I : MAP PreQual Reg/Ord 6
      *    PreQual Reg/Ord 6
           03  PCE9NU PIC S9(7) COMP-3.
      *    I : MAP PreQual Reg/Ord 7
      *    PreQual Reg/Ord 7
           03  PCFANU PIC S9(7) COMP-3.
      *    I : MAP PreQual Reg/Ord 8
      *    PreQual Reg/Ord 8
           03  PCE0NU PIC S9(7) COMP-3.
      *    I : MAP PreQual Reg/Ord 9
      *    PreQual Reg/Ord 9
           03  PCE1NU PIC S9(7) COMP-3.
      *    I : MAP PreQual Reg/Ord 10
      *    PreQual Reg/Ord 10
           03  PCE2NU PIC S9(7) COMP-3.
      *    I : MAP PreQual Reg/Ord 11
      *    PreQual Reg/Ord 11
           03  PCE3NU PIC S9(7) COMP-3.
      *    I : MAP PreQual Reg/Ord 12
      *    PreQual Reg/Ord 12
           03  PCE6NU PIC S9(7) COMP-3.
      *    I : MAP PreQual Reg/Ord 13
      *    PreQual Reg/Ord 13
           03  PCJQNU PIC S9(7) COMP-3.
      *    I : MAP PreQual Reg/Ord 14
      *    PreQual Reg/Ord 14
           03  PCJRNU PIC S9(7) COMP-3.
      *    I : MAP PreQual Reg/Ord 15
      *    PreQual Reg/Ord 15
           03  PCJSNU PIC S9(7) COMP-3.
      *    I : MAP PreQual Reg/Ord 16
      *    PreQual Reg/Ord 16
           03  PCJTNU PIC S9(7) COMP-3.
      *    I : MAP PreQual Reg/Ord 17
      *    PreQual Reg/Ord 17
           03  PCJUNU PIC S9(7) COMP-3.
      *    I : MAP PreQual Reg/Ord 18
      *    PreQual Reg/Ord 18
           03  PCJVNU PIC S9(7) COMP-3.
      *    I : MAP PreQual Reg/Ord 19
      *    PreQual Reg/Ord 19
           03  PCJWNU PIC S9(7) COMP-3.
      *    I : MAP PreQual Reg/Ord 20
      *    PreQual Reg/Ord 20
           03  PCJXNU PIC S9(7) COMP-3.
      *    I : MAP PreQual De-Reg/Ord 1
      *    PreQual De-Reg/Ord 1
           03  PCH6NU PIC S9(7) COMP-3.
      *    I : MAP PreQual De-Reg/Ord 2
      *    PreQual De-Reg/Ord 2
           03  PCH7NU PIC S9(7) COMP-3.
      *    I : MAP PreQual De-Reg/Ord 3
      *    PreQual De-Reg/Ord 3
           03  PCH8NU PIC S9(7) COMP-3.
      *    I : MAP PreQual De-Reg/Ord 4
      *    PreQual De-Reg/Ord 4
           03  PCH9NU PIC S9(7) COMP-3.
      *    I : MAP PreQual De-Reg/Ord 5
      *    PreQual De-Reg/Ord 5
           03  PCIANU PIC S9(7) COMP-3.
      *    I : MAP PreQual De-Reg/Ord 6
      *    PreQual De-Reg/Ord 6
           03  PCIBNU PIC S9(7) COMP-3.
      *    I : MAP PreQual De-Reg/Ord 7
      *    PreQual De-Reg/Ord 7
           03  PCICNU PIC S9(7) COMP-3.
      *    I : MAP PreQual De-Reg/Ord 8
      *    PreQual De-Reg/Ord 8
           03  PCIDNU PIC S9(7) COMP-3.
      *    I : MAP PreQual De-Reg/Ord 9
      *    PreQual De-Reg/Ord 9
           03  PCIENU PIC S9(7) COMP-3.
      *    I : MAP PreQual De-Reg/Ord 10
      *    PreQual De-Reg/Ord 10
           03  PCFFNU PIC S9(7) COMP-3.
      *    I : MAP PreQual De-Reg/Ord 11
      *    PreQual De-Reg/Ord 11
           03  PCFJNU PIC S9(7) COMP-3.
      *    I : MAP PreQual De-Reg/Ord 12
      *    PreQual De-Reg/Ord 12
           03  PCFKNU PIC S9(7) COMP-3.
      *    I : MAP PreQual De-Reg/Ord 13
      *    PreQual De-Reg/Ord 13
           03  PCJYNU PIC S9(7) COMP-3.
      *    I : MAP PreQual De-Reg/Ord 14
      *    PreQual De-Reg/Ord 14
           03  PCJZNU PIC S9(7) COMP-3.
      *    I : MAP PreQual De-Reg/Ord 15
      *    PreQual De-Reg/Ord 15
           03  PCJ0NU PIC S9(7) COMP-3.
      *    I : MAP PreQual De-Reg/Ord 16
      *    PreQual De-Reg/Ord 16
           03  PCJ1NU PIC S9(7) COMP-3.
      *    I : MAP PreQual De-Reg/Ord 17
      *    PreQual De-Reg/Ord 17
           03  PCJ2NU PIC S9(7) COMP-3.
      *    I : MAP PreQual De-Reg/Ord 18
      *    PreQual De-Reg/Ord 18
           03  PCJ3NU PIC S9(7) COMP-3.
      *    I : MAP PreQual De-Reg/Ord 19
      *    PreQual De-Reg/Ord 19
           03  PCJ4NU PIC S9(7) COMP-3.
      *    I : MAP PreQual De-Reg/Ord 20
      *    PreQual De-Reg/Ord 20
           03  PCJ5NU PIC S9(7) COMP-3.
      *    I : MAP PreQual Target Reg/Ord 1
      *    PreQual Target Reg/Ord 1
           03  PCNWVB PIC S9(5) COMP-3.
      *    I : MAP PreQual Target Reg/Ord 2
      *    PreQual Target Reg/Ord 2
           03  PCNXVB PIC S9(5) COMP-3.
      *    I : MAP PreQual Target Reg/Ord 3
      *    PreQual Target Reg/Ord 3
           03  PCNYVB PIC S9(5) COMP-3.
      *    I : MAP PreQual Target Reg/Ord 4
      *    PreQual Target Reg/Ord 4
           03  PCNZVB PIC S9(5) COMP-3.
      *    I : MAP PreQual Target Reg/Ord 5
      *    PreQual Target Reg/Ord 5
           03  PCN0VB PIC S9(5) COMP-3.
      *    I : MAP PreQual Target Reg/Ord 6
      *    PreQual Target Reg/Ord 6
           03  PCN1VB PIC S9(5) COMP-3.
      *    I : MAP PreQual Target Reg/Ord 7
      *    PreQual Target Reg/Ord 7
           03  PCN2VB PIC S9(5) COMP-3.
      *    I : MAP PreQual Target Reg/Ord 8
      *    PreQual Target Reg/Ord 8
           03  PCN3VB PIC S9(5) COMP-3.
      *    I : MAP PreQual Target Reg/Ord 9
      *    PreQual Target Reg/Ord 9
           03  PCN4VB PIC S9(5) COMP-3.
      *    I : MAP PreQual Target Reg/Ord 10
      *    PreQual Target Reg/Ord 10
           03  PCFLNU PIC S9(5) COMP-3.
      *    I : MAP PreQual Target Reg/Ord 11
      *    PreQual Target Reg/Ord 11
           03  PCFMNU PIC S9(5) COMP-3.
      *    I : MAP PreQual Target Reg/Ord 12
      *    PreQual Target Reg/Ord 12
           03  PCNVVB PIC S9(5) COMP-3.
      *    I : MAP PreQual Target Reg/Ord 13
      *    PreQual Target Reg/Ord 13
           03  PCN6VB PIC S9(5) COMP-3.
      *    I : MAP PreQual Target Reg/Ord 14
      *    PreQual Target Reg/Ord 14
           03  PCN7VB PIC S9(5) COMP-3.
      *    I : MAP PreQual Target Reg/Ord 15
      *    PreQual Target Reg/Ord 15
           03  PCN8VB PIC S9(5) COMP-3.
      *    I : MAP PreQual Target Reg/Ord 16
      *    PreQual Target Reg/Ord 16
           03  PCN9VB PIC S9(5) COMP-3.
      *    I : MAP PreQual Target Reg/Ord 17
      *    PreQual Target Reg/Ord 17
           03  PCOAVB PIC S9(5) COMP-3.
      *    I : MAP PreQual Target Reg/Ord 18
      *    PreQual Target Reg/Ord 18
           03  PCOBVB PIC S9(5) COMP-3.
      *    I : MAP PreQual Target Reg/Ord 19
      *    PreQual Target Reg/Ord 19
           03  PCOCVB PIC S9(5) COMP-3.
      *    I : MAP PreQual Target Reg/Ord 20
      *    PreQual Target Reg/Ord 20
           03  PCODVB PIC S9(5) COMP-3.
      *    I : MAP Dealer total bonus amount
      *    Dealer total bonus amount
           03  PCDLBNAMTT PIC S9(9)V9(2) COMP-3.
      *    I : MAP Run Mode
      *    Run Mode
           03  PCZKCF PIC X(1).
      *    I : MAP Order Band Achieved
      *    Order Band Achieved
           03  PCZLCF PIC S9(3) COMP-3.
      *    I : MAP Registration Band Ach
      *    Registration Band Ach
           03  PCZMCF PIC S9(3) COMP-3.
      *    I : MAP Manual Override Band
      *    Manual Override Band
           03  PCZRCF PIC S9(3) COMP-3.
      *    I : MAP Overall Combined Ach Band
      *    Overall Combined Ach Band
           03  PCZNCF PIC S9(3) COMP-3.
      *    I : MAP Manual Override Penalty
      *    Manual Override Penalty
           03  PCHSNU PIC S9(3).
      *    I : MAP Overall Penalty
      *    Overall Penalty
           03  PCI0NU PIC S9(3).
      *    I : MAP *USER
      *    *USER
           03  PCUSR PIC X(10).
      *    I : MAP *PROGRAM
      *    *PROGRAM
           03  PCPGM PIC X(10).
      *    I : MAP *JOB
      *    *JOB
           03  PCJOB PIC X(10).
      *    I : MAP Job Date (8)
      *    Job Date (8)
           03  PCJOBDTE8 PIC S9(8) COMP-3.
      *    I : MAP *Job time
      *    *Job time
           03  PCJTM PIC S9(6) COMP-3.
      *
      *    Define keylist
       01  KRSSM6.
      *    Dealer number (Num key)
           03  Q2DLRNOKEY PIC S9(5) COMP-3.
      *    BDC Model
           03  Q2BDCM PIC X(3).
      *    BDC Customer Order Number
           03  Q2BDCCON PIC X(6).
      *    Define keylist
       01  KRSSM6-TMP.
      *    Dealer number (Num key)
           03  Q2DLRNOKEY PIC S9(5) COMP-3.
      *    BDC Model
           03  Q2BDCM PIC X(3).
      *    BDC Customer Order Number
           03  Q2BDCCON PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSM6.
      *    Dealer number (Num key)
           03  Q2DLRNOKEY PIC S9(5) COMP-3.
      *    BDC Model
           03  Q2BDCM PIC X(3).
      *    BDC Customer Order Number
           03  Q2BDCCON PIC X(6).
      *..............................................................
      *    Define keylist
       01  KRSSM7.
      *    Model Application Code
           03  LLMDLAPPCD PIC X(6).
      *    SCP Model Code
           03  LLSCMDLCDE PIC X(3).
      *    Define keylist
       01  KRSSM7-TMP.
      *    Model Application Code
           03  LLMDLAPPCD PIC X(6).
      *    SCP Model Code
           03  LLSCMDLCDE PIC X(3).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSM7.
      *    Model Application Code
           03  LLMDLAPPCD PIC X(6).
      *    SCP Model Code
           03  LLSCMDLCDE PIC X(3).
      *..............................................................
      *    Outward parameters
       01  PDRC.
      *    RCD : Bonus Sls-Scm Version Val Retrieval index
      *    I : MAP Bonus Scheme (8)
      *    Bonus Scheme (8)
           03  PDBNSSCM PIC X(8).
      *    I : MAP SCP Model Code
      *    SCP Model Code
           03  PDSCMDLCDE PIC X(3).
      *    I : MAP SCP Model Version Code
      *    SCP Model Version Code
           03  PDSCVERCDE PIC X(12).
      *    I : MAP Sequence Number
      *    Sequence Number
           03  PDSEQNBR PIC S9(3) COMP-3.
      *    O : MAP Payable Value
      *    Payable Value
           03  PDVALPAY PIC S9(5)V9(2).
      *
      *    Message data for message Y2U0009.
       01  MD0009.
           03  MDPGM PIC X(10).
           03  MDACP PIC X(10).
           03  MDFMT PIC X(10).
           03  MDACT PIC X(4).
           03  MDLBL PIC X(6).
       01  ZAPGMQ PIC X(10).
       01  ZAPGRL PIC X(5).
       01  ZAMSID PIC X(7).
       01  ZAMSGF PIC X(10).
       01  ZAMSDA PIC X(132).
       01  ZAMSTP PIC X(7).
       01  ZAILE PIC X(1).
       01  ZAFSMS PIC X(1).
       01  SBBNSSGWL4-OPEN.
           COPY DDS-ALL-FORMATS OF Y2IOPEN.
      *    Open feedback area
      *
       01  SBSCMPRML1-OPEN.
           COPY DDS-ALL-FORMATS OF Y2IOPEN.
      *    Open feedback area
      *
       01  SBSCMRU2L1-OPEN.
           COPY DDS-ALL-FORMATS OF Y2IOPEN.
      *    Open feedback area
      *
       01  SBDLRPRML1-OPEN.
           COPY DDS-ALL-FORMATS OF Y2IOPEN.
      *    Open feedback area
      *
       01  DIDLRDTAL2-OPEN.
           COPY DDS-ALL-FORMATS OF Y2IOPEN.
      *    Open feedback area
      *
       01  AMTGTDTAL7-OPEN.
           COPY DDS-ALL-FORMATS OF Y2IOPEN.
      *    Open feedback area
      *
       01  SBDOTEXTL7-OPEN.
           COPY DDS-ALL-FORMATS OF Y2IOPEN.
      *    Open feedback area
      *
       01  VAMDLBNSL1-OPEN.
           COPY DDS-ALL-FORMATS OF Y2IOPEN.
      *    Open feedback area
      *
       01  SBRICDSQL4-OPEN.
           COPY DDS-ALL-FORMATS OF Y2IOPEN.
      *    Open feedback area
      *
       01  RAOBEXTRL2-OPEN.
           COPY DDS-ALL-FORMATS OF Y2IOPEN.
      *    Open feedback area
      *
       01  SBDOTEXTL8-OPEN.
           COPY DDS-ALL-FORMATS OF Y2IOPEN.
      *    Open feedback area
      *
       01  RAOBEXTRL4-OPEN.
           COPY DDS-ALL-FORMATS OF Y2IOPEN.
      *    Open feedback area
      *
       01  COORDDTAL8-OPEN.
           COPY DDS-ALL-FORMATS OF Y2IOPEN.
      *    Open feedback area
      *
       01  COORDDEDL1-OPEN.
           COPY DDS-ALL-FORMATS OF Y2IOPEN.
      *    Open feedback area
      *
       01  COORDDEDL2-OPEN.
           COPY DDS-ALL-FORMATS OF Y2IOPEN.
      *    Open feedback area
      *
       01  SBDLROV2L1-OPEN.
           COPY DDS-ALL-FORMATS OF Y2IOPEN.
      *    Open feedback area
      *
       01  SBBNSSGWL0-OPEN.
           COPY DDS-ALL-FORMATS OF Y2IOPEN.
      *    Open feedback area
      *
       01  W0OPN PIC X(1).
       01  W0PMT PIC X(1).
      *    Job Date (8)
       01  WORK-CONTEXT.
           03  WUJOBDTE8 PIC S9(8) COMP-3.
      *    Run Number
           03  YN0001 PIC S9(3) COMP-3.
      *    Period text 1
           03  YN0002 PIC X(20).
      *    Period text 2
           03  YN0003 PIC X(20).
      *    Object Code
           03  WUOBJCDE PIC X(6).
      *    Target Period Code
           03  YN0004 PIC X(6).
      *    Accounting Date
           03  YN0005 PIC S9(8) COMP-3.
      *    Price Date From
           03  YN0006 PIC S9(8) COMP-3.
      *    Price Date To
           03  YN0007 PIC S9(8) COMP-3.
      *    U:Target Period Code a
           03  WUUTGTPRDA PIC X(6).
      *    U:From Date (8) a
           03  WUUFRMDTXA PIC S9(8) COMP-3.
      *    U:To Date (8) a
           03  WUUTODTXA PIC S9(8) COMP-3.
      *    Target Period Short Desc
           03  YN0008 PIC X(10).
      *    Target Period Full Desc
           03  YN0009 PIC X(25).
      *    U:Target Period Code b
           03  WUUTGTPRDB PIC X(6).
      *    U:From Date (8) b
           03  WUUFRMDTXB PIC S9(8) COMP-3.
      *    U:To Date (8) b
           03  WUUTODTXB PIC S9(8) COMP-3.
      *    U:Target Period Code c
           03  WUUTGTPRDC PIC X(6).
      *    U:From Date (8) c
           03  WUUFRMDTXC PIC S9(8) COMP-3.
      *    U:To Date (8) c
           03  WUUTODTXC PIC S9(8) COMP-3.
      *    U:Target Period Code e
           03  WUUTGTPRDE PIC X(6).
      *    U:From Date (8) e
           03  WUXBDX PIC S9(8) COMP-3.
      *    U:To Date (8) e
           03  WUXCDX PIC S9(8) COMP-3.
      *    U:Target Period Code d
           03  WUUTGTPRDD PIC X(6).
      *    U:From Date (8) d
           03  WUUFRMDTXD PIC S9(8) COMP-3.
      *    U:To Date (8) d
           03  WUUTODTXD PIC S9(8) COMP-3.
      *    Customer Order Date #
           03  WUCUSORDD8 PIC S9(8) COMP-3.
      *    Dealer to pay Number (Num
           03  WUEDNB PIC S9(5).
      *    Percentage Penalty
           03  YL0001 PIC S9(3).
      *    Achievement Band Reg
           03  YL0002 PIC X(10).
      *    U:Achieved Target 1
           03  YL0003 PIC X(1).
      *    U:Achieved Target 2
           03  YL0004 PIC X(1).
      *    Achieved Pre-Qualifier R
           03  YL0005 PIC X(1).
      *    PreQual Net 1 OCTOBER
           03  YL0006 PIC S9(7) COMP-3.
      *    PreQual Net 1 NOVEMBER
           03  YL0007 PIC S9(7) COMP-3.
      *    PreQual Net A
           03  YL0008 PIC S9(7) COMP-3.
      *    PreQual Reg/Ord 7
           03  YL0009 PIC S9(7) COMP-3.
      *    PreQual De-Reg/Ord 7
           03  YL0010 PIC S9(7) COMP-3.
      *    PreQual Net Reg/Ord 7
           03  YL0011 PIC S9(7) COMP-3.
      *    PreQual Target Reg/Ord 7
           03  YL0012 PIC S9(5) COMP-3.
      *    PreQual Reg/Ord 8
           03  YL0013 PIC S9(7) COMP-3.
      *    PreQual De-Reg/Ord 8
           03  YL0014 PIC S9(7) COMP-3.
      *    PreQual Net Reg/Ord 8
           03  YL0015 PIC S9(7) COMP-3.
      *    PreQual Target Reg/Ord 8
           03  YL0016 PIC S9(5) COMP-3.
      *    PreQual Reg/Ord 9
           03  YL0017 PIC S9(7) COMP-3.
      *    PreQual De-Reg/Ord 9
           03  YL0018 PIC S9(7) COMP-3.
      *    PreQual Net Reg/Ord 9
           03  YL0019 PIC S9(7) COMP-3.
      *    PreQual Target Reg/Ord 9
           03  YL0020 PIC S9(5) COMP-3.
      *    PreQual Reg/Ord 10
           03  YL0021 PIC S9(7) COMP-3.
      *    PreQual De-Reg/Ord 10
           03  YL0022 PIC S9(7) COMP-3.
      *    PreQual Net Reg/Ord 10
           03  YL0023 PIC S9(7) COMP-3.
      *    PreQual Target Reg/Ord 10
           03  YL0024 PIC S9(5) COMP-3.
      *    PreQual Reg/Ord 11
           03  YL0025 PIC S9(7) COMP-3.
      *    PreQual De-Reg/Ord 11
           03  YL0026 PIC S9(7) COMP-3.
      *    PreQual Net Reg/Ord 11
           03  YL0027 PIC S9(7) COMP-3.
      *    PreQual Target Reg/Ord 11
           03  YL0028 PIC S9(5) COMP-3.
      *    PreQual Reg/Ord 12
           03  YL0029 PIC S9(7) COMP-3.
      *    PreQual De-Reg/Ord 12
           03  YL0030 PIC S9(7) COMP-3.
      *    PreQual Net Reg/Ord 12
           03  YL0031 PIC S9(7) COMP-3.
      *    PreQual Target Reg/Ord 12
           03  YL0032 PIC S9(5) COMP-3.
      *    PreQual Reg/Ord 13
           03  YL0033 PIC S9(7) COMP-3.
      *    PreQual De-Reg/Ord 13
           03  YL0034 PIC S9(7) COMP-3.
      *    PreQual Net Reg/Ord 13
           03  YL0035 PIC S9(7) COMP-3.
      *    PreQual Target Reg/Ord 13
           03  YL0036 PIC S9(5) COMP-3.
      *    PreQual Reg/Ord 16
           03  YL0037 PIC S9(7) COMP-3.
      *    PreQual De-Reg/Ord 16
           03  YL0038 PIC S9(7) COMP-3.
      *    PreQual Net Reg/Ord 16
           03  YL0039 PIC S9(7) COMP-3.
      *    PreQual Target Reg/Ord 16
           03  YL0040 PIC S9(5) COMP-3.
      *    PreQual Reg/Ord 17
           03  YL0041 PIC S9(7) COMP-3.
      *    PreQual De-Reg/Ord 17
           03  YL0042 PIC S9(7) COMP-3.
      *    PreQual Net Reg/Ord 17
           03  YL0043 PIC S9(7) COMP-3.
      *    PreQual Target Reg/Ord 17
           03  YL0044 PIC S9(5) COMP-3.
      *    PreQual Reg/Ord 18
           03  YL0045 PIC S9(7) COMP-3.
      *    PreQual De-Reg/Ord 18
           03  YL0046 PIC S9(7) COMP-3.
      *    PreQual Net Reg/Ord 18
           03  YL0047 PIC S9(7) COMP-3.
      *    PreQual Target Reg/Ord 18
           03  YL0048 PIC S9(5) COMP-3.
      *    PreQual Reg/Ord 19
           03  YL0049 PIC S9(7) COMP-3.
      *    PreQual De-Reg/Ord 19
           03  YL0050 PIC S9(7) COMP-3.
      *    PreQual Net Reg/Ord 19
           03  YL0051 PIC S9(7) COMP-3.
      *    PreQual Target Reg/Ord 19
           03  YL0052 PIC S9(5) COMP-3.
      *    PreQual Reg/Ord 20
           03  YL0053 PIC S9(7) COMP-3.
      *    PreQual De-Reg/Ord 20
           03  YL0054 PIC S9(7) COMP-3.
      *    PreQual Net Reg/Ord 20
           03  YL0055 PIC S9(7) COMP-3.
      *    PreQual Target Reg/Ord 20
           03  YL0056 PIC S9(5) COMP-3.
      *    U:Payment Band
           03  WUWCNU PIC S9(3) COMP-3.
      *    U:Payment Band 3
           03  WUUPAYBN3 PIC S9(3) COMP-3.
      *    U:90% of target -decimal
           03  WUU90TD PIC S9(5)V9(1) COMP-3.
      *    U:80% of Target -Decimal
           03  WUU80TD PIC S9(5)V9(1) COMP-3.
      *    U:100% of Target -decimal
           03  WUU100PCTD PIC S9(5)V9(1) COMP-3.
      *    U:105% of target -decimal
           03  WUU105PCTD PIC S9(5)V9(1) COMP-3.
      *    U:110% of target -decimal
           03  WUU110PCTD PIC S9(5)V9(1) COMP-3.
      *    U:120% of target -decimal
           03  WUU120PCTD PIC S9(5)V9(1) COMP-3.
      *    U:Target Total
           03  WUTGTTOT PIC S9(5) COMP-3.
      *    U:Clawinging back
           03  YL0057 PIC X(1).
      *    PreQual Net Previous
           03  YL0058 PIC S9(7) COMP-3.
      *    PreQual Net Actual
           03  YL0059 PIC S9(7) COMP-3.
      *    U:Number (8.0)
           03  YL0060 PIC S9(8) COMP-3.
      *    PreQual Net 5%
           03  YL0061 PIC S9(7) COMP-3.
      *    PreQual Order 1
           03  YL0062 PIC S9(7) COMP-3.
      *    PreQual Cancel 1
           03  YL0063 PIC S9(7) COMP-3.
      *    PreQual Target 1
           03  YL0064 PIC S9(5) COMP-3.
      *    PreQual Order 2
           03  YL0065 PIC S9(7) COMP-3.
      *    PreQual Cancel 2
           03  YL0066 PIC S9(7) COMP-3.
      *    PreQual Target 2
           03  YL0067 PIC S9(5) COMP-3.
      *    PreQual Order 3
           03  YL0068 PIC S9(7) COMP-3.
      *    PreQual Cancel 3
           03  YL0069 PIC S9(7) COMP-3.
      *    PreQual Target 3
           03  YL0070 PIC S9(5) COMP-3.
      *    PreQual Order 4
           03  YL0071 PIC S9(7) COMP-3.
      *    PreQual Cancel 4
           03  YL0072 PIC S9(7) COMP-3.
      *    PreQual Target 4
           03  YL0073 PIC S9(5) COMP-3.
      *    PreQual Order 5
           03  YL0074 PIC S9(7) COMP-3.
      *    PreQual Cancel 5
           03  YL0075 PIC S9(7) COMP-3.
      *    PreQual Target 5
           03  YL0076 PIC S9(5) COMP-3.
      *    PreQual Order 6
           03  YL0077 PIC S9(7) COMP-3.
      *    PreQual Cancel 6
           03  YL0078 PIC S9(7) COMP-3.
      *    PreQual Target 6
           03  YL0079 PIC S9(5) COMP-3.
      *    Sequence Number
           03  YL0080 PIC S9(3) COMP-3.
      *    Use Extended Achievement
           03  YN0010 PIC X(1).
      *    Include Cancelled Orders
           03  YL0081 PIC X(1).
      *    Include Unmatched Orders
           03  YL0082 PIC X(1).
      *    Recalculate Order Ach Brn
           03  YL0083 PIC X(1).
      *    Recalculate Reg Ach Brnd
           03  YL0084 PIC X(1).
      *    U:Run Mode
           03  YL0085 PIC X(1).
      *    Record Status
           03  YL0086 PIC X(1).
      *    Scheme Sequence
           03  YN0011 PIC X(1).
      *    Achievement Band
           03  YN0012 PIC X(10).
      *    No of Registrations
           03  YN0013 PIC S9(7) COMP-3.
      *    No of Order
           03  YN0014 PIC S9(7) COMP-3.
      *    No of Registrations cancl
           03  YN0015 PIC S9(7) COMP-3.
      *    No of Order Canceled
           03  YN0016 PIC S9(7) COMP-3.
      *    Target Value Registration
           03  YN0017 PIC S9(5) COMP-3.
      *    Target Value Order
           03  YN0018 PIC S9(5) COMP-3.
      *    Total Count Registration
           03  YN0019 PIC S9(5) COMP-3.
      *    Total Count Order
           03  YN0020 PIC S9(5) COMP-3.
      *    Achieved Pre-Qualifier
           03  YN0021 PIC X(1).
      *    Achieved Pre-Qualifier 2
           03  YN0022 PIC X(1).
      *    PreQual Reg/Ord 7
           03  YN0023 PIC S9(7) COMP-3.
      *    PreQual Reg/Ord 8
           03  YN0024 PIC S9(7) COMP-3.
      *    PreQual Reg/Ord 9
           03  YN0025 PIC S9(7) COMP-3.
      *    PreQual Reg/Ord 10
           03  YN0026 PIC S9(7) COMP-3.
      *    PreQual Reg/Ord 11
           03  YN0027 PIC S9(7) COMP-3.
      *    PreQual Reg/Ord 12
           03  YN0028 PIC S9(7) COMP-3.
      *    PreQual Reg/Ord 13
           03  YN0029 PIC S9(7) COMP-3.
      *    PreQual Reg/Ord 14
           03  YN0030 PIC S9(7) COMP-3.
      *    PreQual Reg/Ord 15
           03  YN0031 PIC S9(7) COMP-3.
      *    PreQual Reg/Ord 16
           03  YN0032 PIC S9(7) COMP-3.
      *    PreQual Reg/Ord 17
           03  YN0033 PIC S9(7) COMP-3.
      *    PreQual Reg/Ord 18
           03  YN0034 PIC S9(7) COMP-3.
      *    PreQual Reg/Ord 19
           03  YN0035 PIC S9(7) COMP-3.
      *    PreQual Reg/Ord 20
           03  YN0036 PIC S9(7) COMP-3.
      *    PreQual De-Reg/Ord 7
           03  YN0037 PIC S9(7) COMP-3.
      *    PreQual De-Reg/Ord 8
           03  YN0038 PIC S9(7) COMP-3.
      *    PreQual De-Reg/Ord 9
           03  YN0039 PIC S9(7) COMP-3.
      *    PreQual De-Reg/Ord 10
           03  YN0040 PIC S9(7) COMP-3.
      *    PreQual De-Reg/Ord 11
           03  YN0041 PIC S9(7) COMP-3.
      *    PreQual De-Reg/Ord 12
           03  YN0042 PIC S9(7) COMP-3.
      *    PreQual De-Reg/Ord 13
           03  YN0043 PIC S9(7) COMP-3.
      *    PreQual De-Reg/Ord 14
           03  YN0044 PIC S9(7) COMP-3.
      *    PreQual De-Reg/Ord 15
           03  YN0045 PIC S9(7) COMP-3.
      *    PreQual De-Reg/Ord 16
           03  YN0046 PIC S9(7) COMP-3.
      *    PreQual De-Reg/Ord 17
           03  YN0047 PIC S9(7) COMP-3.
      *    PreQual De-Reg/Ord 18
           03  YN0048 PIC S9(7) COMP-3.
      *    PreQual De-Reg/Ord 19
           03  YN0049 PIC S9(7) COMP-3.
      *    PreQual De-Reg/Ord 20
           03  YN0050 PIC S9(7) COMP-3.
      *    PreQual Target Reg/Ord 7
           03  YN0051 PIC S9(5) COMP-3.
      *    PreQual Target Reg/Ord 8
           03  YN0052 PIC S9(5) COMP-3.
      *    PreQual Target Reg/Ord 9
           03  YN0053 PIC S9(5) COMP-3.
      *    PreQual Target Reg/Ord 10
           03  YN0054 PIC S9(5) COMP-3.
      *    PreQual Target Reg/Ord 11
           03  YN0055 PIC S9(5) COMP-3.
      *    PreQual Target Reg/Ord 12
           03  YN0056 PIC S9(5) COMP-3.
      *    PreQual Target Reg/Ord 13
           03  YN0057 PIC S9(5) COMP-3.
      *    PreQual Target Reg/Ord 14
           03  YN0058 PIC S9(5) COMP-3.
      *    PreQual Target Reg/Ord 15
           03  YN0059 PIC S9(5) COMP-3.
      *    PreQual Target Reg/Ord 16
           03  YN0060 PIC S9(5) COMP-3.
      *    PreQual Target Reg/Ord 17
           03  YN0061 PIC S9(5) COMP-3.
      *    PreQual Target Reg/Ord 18
           03  YN0062 PIC S9(5) COMP-3.
      *    PreQual Target Reg/Ord 19
           03  YN0063 PIC S9(5) COMP-3.
      *    PreQual Target Reg/Ord 20
           03  YN0064 PIC S9(5) COMP-3.
      *    Run Mode
           03  YN0065 PIC X(1).
      *    U:Number (3.0) D
           03  YL0087 PIC S9(3) COMP-3.
      *    U:Number (3.0) E
           03  YL0088 PIC S9(3) COMP-3.
      *    Manual Override Band
           03  YN0066 PIC S9(3) COMP-3.
      *    U:Number (3.0) F
           03  YL0089 PIC S9(3) COMP-3.
      *    Manual Override Penalty
           03  YN0067 PIC S9(3).
      *    U:Number (3.0) G
           03  YL0090 PIC S9(3) COMP-3.
      *    Initial Run
           03  YL0091 PIC X(1).
      *    U:Dealer Nbr
           03  WUDLRNO PIC X(4).
      *    U:Dealer Nbr Sfx
           03  WUUDLRSFX PIC X(2).
      *    CONCES PROPRIETAIRE
           03  WUNECO PIC X(6).
      *    U:Return Code Id
           03  YL0092 PIC X(7).
      *    SD Dealer Number
           03  YL0093 PIC X(6).
      *    Owning Account
           03  YL0094 PIC X(6).
      *    U:Dealer Number Numeric 2
           03  YL0095 PIC S9(5).
      *    U:Dealer Nbr Dacia
           03  WUWECF PIC X(4).
      *    U:Dealer Nbr Sfx Dacia
           03  WUWFCF PIC X(2).
      *    CONCES PROPRIETAIRE DACIA
           03  WUTOCF PIC X(6).
      *    Region Code
           03  WURGNCDE PIC X(2).
      *    Zone Code
           03  WUZONCOD PIC X(2).
      *    Dealer Network Type
           03  YL0096 PIC X(1).
      *    Network/Non Network Ind
           03  YN0068 PIC X(1).
      *    Dealer Number (Numeric)
           03  YN0069 PIC S9(5).
      *    U:Target Total a
           03  YL0097 PIC S9(5) COMP-3.
      *    U:Target Total a
           03  WUTGTTOTA PIC S9(5) COMP-3.
      *    U:Target Dacia
           03  WULTVB PIC S9(5) COMP-3.
      *    U:Target Dacia
           03  YL0098 PIC S9(5) COMP-3.
      *    U:Target Total DACIA
           03  WUNHVB PIC S9(5) COMP-3.
      *    U:Dealer Nbr Sfx Dacia
           03  YL0099 PIC X(2).
      *    U:Pay Cat 1 Regs
           03  YL0100 PIC S9(5) COMP-3.
      *    U:Pay Cat 2 Regs
           03  YL0101 PIC S9(5) COMP-3.
      *    U:Pay Cat 3 Regs
           03  YL0102 PIC S9(5) COMP-3.
      *    U:Pay Cat 4 Regs
           03  YL0103 PIC S9(5) COMP-3.
      *    U:Pay Cat 5 Regs
           03  YL0104 PIC S9(5) COMP-3.
      *    U:Pay Cat N Regs
           03  YL0105 PIC S9(5) COMP-3.
      *    U:Pay Cat O Regs
           03  YL0106 PIC S9(5) COMP-3.
      *    U:Job Date DTX
           03  YL0107 PIC S9(8) COMP-3.
      *    Dealer number (Num key)
           03  YL0108 PIC S9(5) COMP-3.
      *    U:Code (5)
           03  WUUCODE5 PIC X(5).
      *    U:Pay Cat 1 Regs
           03  YL0109 PIC S9(5) COMP-3.
      *    U:Pay Cat 2 Regs
           03  YL0110 PIC S9(5) COMP-3.
      *    U:Pay Cat 3 Regs
           03  YL0111 PIC S9(5) COMP-3.
      *    U:Pay Cat 4 Regs
           03  YL0112 PIC S9(5) COMP-3.
      *    U:Pay Cat 5 Regs
           03  YL0113 PIC S9(5) COMP-3.
      *    U:Pay Cat N Regs
           03  YL0114 PIC S9(5) COMP-3.
      *    U:Pay Cat O Regs
           03  YL0115 PIC S9(5) COMP-3.
      *    Car/Van Indicator
           03  YL0116 PIC X(1).
      *    OBT Count Target Status
           03  YL0117 PIC X(1).
      *    Bns RIC Config Year
           03  YN0070 PIC S9(4).
      *    Bns RIC Display Sequence
           03  YN0071 PIC S9(3).
      *    Bns Brand Name
           03  YL0118 PIC X(10).
      *    Bns RIC Mdl Dsp Rec Sts
           03  YN0072 PIC X(1).
      *    Fleet Programmes Code
           03  YL0119 PIC X(3).
      *    U:Continue
           03  YL0120 PIC X(1).
      *    BDC Order Date YYYYMM
           03  YN0073 PIC X(6).
      *    Zone Code
           03  YN0074 PIC X(2).
      *    Network/Non Network Ind
           03  YN0075 PIC X(1).
      *    BDC Order Cnl Dte YYYYMM
           03  YN0076 PIC X(6).
      *    BDC Model Version
           03  YN0077 PIC X(12).
      *    Chassis number
           03  YN0078 PIC X(14).
      *    BDC Order Crt Date
           03  YN0079 PIC S9(8) COMP-3.
      *    BDC Order Cnl Date
           03  YN0080 PIC S9(8) COMP-3.
      *    TYPE CLIENT SEDRE
           03  YN0081 PIC X(1).
      *    TYPE DR CENTRAL
           03  YN0082 PIC X(2).
      *    SD Sales Channel Code
           03  YN0083 PIC X(2).
      *    Fleet Operator Number
           03  YL0121 PIC X(5).
      *    Fleet Report Group Code
           03  YN0084 PIC X(2).
      *    Fleet Report Group Plan
           03  YN0085 PIC X(1).
      *    Sell Price
           03  YN0086 PIC S9(5)V9(2) COMP-3.
      *    BDC Payment Method
           03  YN0087 PIC X(3).
      *    BDC Payment Term
           03  YL0122 PIC X(4).
      *    Report Group Description
           03  YN0088 PIC X(35).
      *    Registration Date 58
           03  YN0089 PIC S9(8) COMP-3.
      *    De-registration Date #
           03  YN0090 PIC S9(8) COMP-3.
      *    SD Order Type Assoc w FON
           03  YN0091 PIC X(2).
      *    Fleet Programmes Desc
           03  YN0092 PIC X(25).
      *    FM Agreement Number (FON)
           03  YN0093 PIC X(10).
      *    FM Agreement Version Nbr
           03  YN0094 PIC X(2).
      *    Target Market
           03  YL0123 PIC X(1).
      *    U:Pay Cat 1 De-Regs
           03  YL0124 PIC S9(5) COMP-3.
      *    U:Pay Cat 2 De-Regs
           03  YL0125 PIC S9(5) COMP-3.
      *    U:Pay Cat 3 De-Regs
           03  YL0126 PIC S9(5) COMP-3.
      *    U:Pay Cat 4 De-Regs
           03  YL0127 PIC S9(5) COMP-3.
      *    U:Pay Cat 5 De-Regs
           03  YL0128 PIC S9(5) COMP-3.
      *    U:Pay Cat N De-Regs
           03  YL0129 PIC S9(5) COMP-3.
      *    U:Pay Cat O De-Regs
           03  YL0130 PIC S9(5) COMP-3.
      *    U:Job Date DTX
           03  YL0131 PIC S9(8) COMP-3.
      *    Dealer number (Num key)
           03  YL0132 PIC S9(5) COMP-3.
      *    U:Pay Cat 1 De-Regs
           03  YL0133 PIC S9(5) COMP-3.
      *    U:Pay Cat 2 De-Regs
           03  YL0134 PIC S9(5) COMP-3.
      *    U:Pay Cat 3 De-Regs
           03  YL0135 PIC S9(5) COMP-3.
      *    U:Pay Cat 4 De-Regs
           03  YL0136 PIC S9(5) COMP-3.
      *    U:Pay Cat 5 De-Regs
           03  YL0137 PIC S9(5) COMP-3.
      *    U:Pay Cat N De-Regs
           03  YL0138 PIC S9(5) COMP-3.
      *    U:Pay Cat O De-Regs
           03  YL0139 PIC S9(5) COMP-3.
      *    Car/Van Indicator
           03  YL0140 PIC X(1).
      *    OBT Count Target Status
           03  YL0141 PIC X(1).
      *    Bns RIC Config Year
           03  YN0095 PIC S9(4).
      *    Bns RIC Display Sequence
           03  YN0096 PIC S9(3).
      *    Bns Brand Name
           03  YL0142 PIC X(10).
      *    Bns RIC Mdl Dsp Rec Sts
           03  YN0097 PIC X(1).
      *    Fleet Programmes Code
           03  YL0143 PIC X(3).
      *    U:Continue
           03  YL0144 PIC X(1).
      *    BDC Order Date YYYYMM
           03  YN0098 PIC X(6).
      *    Zone Code
           03  YN0099 PIC X(2).
      *    Network/Non Network Ind
           03  YN0100 PIC X(1).
      *    Dealer number (Num key)
           03  YN0101 PIC S9(5) COMP-3.
      *    BDC Model
           03  YN0102 PIC X(3).
      *    BDC Customer Order Number
           03  YN0103 PIC X(6).
      *    BDC Order Cnl Dte YYYYMM
           03  YN0104 PIC X(6).
      *    BDC Model Version
           03  YN0105 PIC X(12).
      *    BDC Order Crt Date
           03  YN0106 PIC S9(8) COMP-3.
      *    BDC Order Cnl Date
           03  YN0107 PIC S9(8) COMP-3.
      *    TYPE CLIENT SEDRE
           03  YN0108 PIC X(1).
      *    TYPE DR CENTRAL
           03  YN0109 PIC X(2).
      *    SD Sales Channel Code
           03  YN0110 PIC X(2).
      *    Fleet Operator Number
           03  YL0145 PIC X(5).
      *    Fleet Report Group Code
           03  YN0111 PIC X(2).
      *    Fleet Report Group Plan
           03  YN0112 PIC X(1).
      *    Sell Price
           03  YN0113 PIC S9(5)V9(2) COMP-3.
      *    BDC Payment Method
           03  YN0114 PIC X(3).
      *    BDC Payment Term
           03  YL0146 PIC X(4).
      *    Report Group Description
           03  YN0115 PIC X(35).
      *    Registration Date 58
           03  YN0116 PIC S9(8) COMP-3.
      *    De-registration Date #
           03  YN0117 PIC S9(8) COMP-3.
      *    SD Order Type Assoc w FON
           03  YN0118 PIC X(2).
      *    Fleet Programmes Desc
           03  YN0119 PIC X(25).
      *    FM Agreement Number (FON)
           03  YN0120 PIC X(10).
      *    FM Agreement Version Nbr
           03  YN0121 PIC X(2).
      *    Target Market
           03  YL0147 PIC X(1).
      *    U:Pay Cat 1 Regs DACIA
           03  YL0148 PIC S9(5) COMP-3.
      *    U:Pay Cat 2 Regs DACIA
           03  YL0149 PIC S9(5) COMP-3.
      *    U:Pay Cat 3 Regs DACIA
           03  YL0150 PIC S9(5) COMP-3.
      *    U:Pay Cat 4 Regs DACIA
           03  YL0151 PIC S9(5) COMP-3.
      *    U:Pay Cat 5 Regs DACIA
           03  YL0152 PIC S9(5) COMP-3.
      *    U:Pay Cat N Regs DACIA
           03  YL0153 PIC S9(5) COMP-3.
      *    U:Pay Cat O Regs DACIA
           03  YL0154 PIC S9(5) COMP-3.
      *    U:Pay Cat 1 De-Regs DACIA
           03  YL0155 PIC S9(5) COMP-3.
      *    U:Pay Cat 2 De-Regs DACIA
           03  YL0156 PIC S9(5) COMP-3.
      *    U:Pay Cat 3 De-Regs DACIA
           03  YL0157 PIC S9(5) COMP-3.
      *    U:Pay Cat 4 De-Regs DACIA
           03  YL0158 PIC S9(5) COMP-3.
      *    U:Pay Cat 5 De-Regs DACIA
           03  YL0159 PIC S9(5) COMP-3.
      *    U:Pay Cat N De-Regs DACIA
           03  YL0160 PIC S9(5) COMP-3.
      *    U:Pay Cat O De-Regs DACIA
           03  YL0161 PIC S9(5) COMP-3.
      *    PreQual Target Reg/Ord 6
           03  YL0162 PIC S9(5) COMP-3.
      *    PreQual Target Reg/Ord 15
           03  YL0163 PIC S9(5) COMP-3.
      *    PreQual Reg/Ord 15
           03  YL0164 PIC S9(7) COMP-3.
      *    PreQual De-Reg/Ord 15
           03  YL0165 PIC S9(7) COMP-3.
      *    PreQual Net Reg/Ord 15
           03  YL0166 PIC S9(7) COMP-3.
      *    PreQual Combine Reg Net
           03  YL0167 PIC S9(7) COMP-3.
      *    PreQual Combine Target AP
           03  YL0168 PIC S9(5) COMP-3.
      *    U:80%  of target Reg
           03  WUHTNU PIC S9(5) COMP-3.
      *    U:90%  of target Reg
           03  WUHUNU PIC S9(5) COMP-3.
      *    U:100% of target Reg
           03  WUHVNU PIC S9(5) COMP-3.
      *    U:105% of target Reg
           03  WUHZNU PIC S9(5) COMP-3.
      *    U:110% of target Reg
           03  WUHXNU PIC S9(5) COMP-3.
      *    U:120% of target Reg
           03  WUHYNU PIC S9(5) COMP-3.
      *    U:Payment Band 2
           03  WUZZNU PIC S9(3) COMP-3.
      *    Achievement Band
           03  YL0169 PIC X(10).
      *    Achieved Pre-Qualifier
           03  YL0170 PIC X(1).
      *    PreQual Cancel Ren Prev
           03  YL0171 PIC S9(7) COMP-3.
      *    PreQual Cancel Dac Prev
           03  YL0172 PIC S9(7) COMP-3.
      *    PreQual Net 1
           03  YL0173 PIC S9(7) COMP-3.
      *    PreQual Net 1 Dacia
           03  YL0174 PIC S9(7) COMP-3.
      *    PreQual Net 2
           03  YL0175 PIC S9(7) COMP-3.
      *    PreQual Net 3
           03  YL0176 PIC S9(7) COMP-3.
      *    PreQual Net 4
           03  YL0177 PIC S9(7) COMP-3.
      *    PreQual Net 5
           03  YL0178 PIC S9(7) COMP-3.
      *    PreQual Net 6
           03  YL0179 PIC S9(7) COMP-3.
      *    PreQual Net 7
           03  YL0180 PIC S9(7) COMP-3.
      *    PreQual Target 1 DACIA
           03  YL0181 PIC S9(5) COMP-3.
      *    PreQual Order 1 Dacia
           03  YL0182 PIC S9(7) COMP-3.
      *    PreQual Cancel 1 Dacia
           03  YL0183 PIC S9(7) COMP-3.
      *    PreQual Net 1 Renault
           03  YL0184 PIC S9(7) COMP-3.
      *    PreQual Target 1 Renault
           03  YL0185 PIC S9(5) COMP-3.
      *    PreQual Order 1 Renault
           03  YL0186 PIC S9(7) COMP-3.
      *    PreQual Cancel 1 Renault
           03  YL0187 PIC S9(7) COMP-3.
      *    PreQual Order A
           03  YL0188 PIC S9(7) COMP-3.
      *    PreQual Order 7
           03  YL0189 PIC S9(7) COMP-3.
      *    PreQual Cancel 7
           03  YL0190 PIC S9(7) COMP-3.
      *    PreQual Target 7
           03  YL0191 PIC S9(5) COMP-3.
      *    PreQual Combine Net
           03  YL0192 PIC S9(7) COMP-3.
      *    PreQual Combine Target
           03  YL0193 PIC S9(5) COMP-3.
      *    PreQual Cancel A
           03  YL0194 PIC S9(7) COMP-3.
      *    U:Pay Cat 1 Order
           03  YL0195 PIC S9(5) COMP-3.
      *    U:Pay Cat 2 Order
           03  YL0196 PIC S9(5) COMP-3.
      *    U:Pay Cat 3 Order
           03  YL0197 PIC S9(5) COMP-3.
      *    U:Pay Cat 4 Order
           03  YL0198 PIC S9(5) COMP-3.
      *    U:Pay Cat 5 Order
           03  YL0199 PIC S9(5) COMP-3.
      *    U:Pay Cat N Order
           03  YL0200 PIC S9(5) COMP-3.
      *    U:Pay Cat O Order
           03  YL0201 PIC S9(5) COMP-3.
      *    U:Job Date DTX
           03  YL0202 PIC S9(8) COMP-3.
      *    Dealer number (Num key)
           03  YL0203 PIC S9(5) COMP-3.
      *    U:Pay Cat 1 Order
           03  YL0204 PIC S9(5) COMP-3.
      *    U:Pay Cat 2 Order
           03  YL0205 PIC S9(5) COMP-3.
      *    U:Pay Cat 3 Order
           03  YL0206 PIC S9(5) COMP-3.
      *    U:Pay Cat 4 Order
           03  YL0207 PIC S9(5) COMP-3.
      *    U:Pay Cat 5 Order
           03  YL0208 PIC S9(5) COMP-3.
      *    U:Pay Cat N Order
           03  YL0209 PIC S9(5) COMP-3.
      *    U:Pay Cat O Order
           03  YL0210 PIC S9(5) COMP-3.
      *    Car/Van Indicator
           03  YL0211 PIC X(1).
      *    OBT Count Target Status
           03  YL0212 PIC X(1).
      *    Bns RIC Config Year
           03  YN0122 PIC S9(4).
      *    Bns RIC Display Sequence
           03  YN0123 PIC S9(3).
      *    Bns Brand Name
           03  YL0213 PIC X(10).
      *    Bns RIC Mdl Dsp Rec Sts
           03  YN0124 PIC X(1).
      *    Fleet Programmes Code
           03  YL0214 PIC X(3).
      *    U:Continue
           03  YL0215 PIC X(1).
      *    BDC Order Date YYYYMM
           03  YN0125 PIC X(6).
      *    Zone Code
           03  YN0126 PIC X(2).
      *    Network/Non Network Ind
           03  YN0127 PIC X(1).
      *    BDC Order Cnl Dte YYYYMM
           03  YN0128 PIC X(6).
      *    BDC Model Version
           03  YN0129 PIC X(12).
      *    Chassis number
           03  YN0130 PIC X(14).
      *    BDC Order Crt Date
           03  YN0131 PIC S9(8) COMP-3.
      *    BDC Order Cnl Date
           03  YN0132 PIC S9(8) COMP-3.
      *    TYPE CLIENT SEDRE
           03  YN0133 PIC X(1).
      *    TYPE DR CENTRAL
           03  YN0134 PIC X(2).
      *    SD Sales Channel Code
           03  YN0135 PIC X(2).
      *    Fleet Operator Number
           03  YL0216 PIC X(5).
      *    Fleet Report Group Code
           03  YN0136 PIC X(2).
      *    Fleet Report Group Plan
           03  YN0137 PIC X(1).
      *    Sell Price
           03  YN0138 PIC S9(5)V9(2) COMP-3.
      *    BDC Payment Method
           03  YN0139 PIC X(3).
      *    BDC Payment Term
           03  YL0217 PIC X(4).
      *    Report Group Description
           03  YN0140 PIC X(35).
      *    Registration Date 58
           03  YN0141 PIC S9(8) COMP-3.
      *    De-registration Date #
           03  YN0142 PIC S9(8) COMP-3.
      *    SD Order Type Assoc w FON
           03  YN0143 PIC X(2).
      *    Fleet Programmes Desc
           03  YN0144 PIC X(25).
      *    FM Agreement Number (FON)
           03  YN0145 PIC X(10).
      *    FM Agreement Version Nbr
           03  YN0146 PIC X(2).
      *    Target Market
           03  YL0218 PIC X(1).
      *    Order Deduct Date Action
           03  YL0219 PIC S9(8) COMP-3.
      *    Order Deduct Date Effect
           03  YN0147 PIC S9(8) COMP-3.
      *    VIN
           03  YN0148 PIC X(17).
      *    Customer Order Date #
           03  YN0149 PIC S9(8) COMP-3.
      *    Order Cancelled Date
           03  YN0150 PIC S9(8) COMP-3.
      *    Order Cancellation Reason
           03  YN0151 PIC X(4).
      *    Cus Ord Allocation Dte
           03  YN0152 PIC S9(8) COMP-3.
      *    Cus Ord Deallocation Dte
           03  YN0153 PIC S9(8) COMP-3.
      *    Order Type code
           03  YN0154 PIC X(1).
      *    SD Order Type DR
           03  YN0155 PIC X(2).
      *    SEDRE Customer Type
           03  YN0156 PIC X(1).
      *    APL Code
           03  YN0157 PIC X(6).
      *    SCP Model Code
           03  YN0158 PIC X(3).
      *    Model Phase
           03  YN0159 PIC X(1).
      *    SCP Model Version Code
           03  YN0160 PIC X(12).
      *    Fleet Programmes Code
           03  YN0161 PIC X(3).
      *    U:Pay Cat 1 De-Order
           03  YL0220 PIC S9(5) COMP-3.
      *    U:Pay Cat 2 De-Order
           03  YL0221 PIC S9(5) COMP-3.
      *    U:Pay Cat 3 De-Order
           03  YL0222 PIC S9(5) COMP-3.
      *    U:Pay Cat 4 De-Order
           03  YL0223 PIC S9(5) COMP-3.
      *    U:Pay Cat 5 De-Order
           03  YL0224 PIC S9(5) COMP-3.
      *    U:Pay Cat O De-Order
           03  YL0225 PIC S9(5) COMP-3.
      *    U:Pay Cat N De-Order
           03  YL0226 PIC S9(5) COMP-3.
      *    U:Job Date DTX
           03  YL0227 PIC S9(8) COMP-3.
      *    U:Pay Cat 1 De-Order
           03  YL0228 PIC S9(5) COMP-3.
      *    U:Pay Cat 2 De-Order
           03  YL0229 PIC S9(5) COMP-3.
      *    U:Pay Cat 3 De-Order
           03  YL0230 PIC S9(5) COMP-3.
      *    U:Pay Cat 4 De-Order
           03  YL0231 PIC S9(5) COMP-3.
      *    U:Pay Cat 5 De-Order
           03  YL0232 PIC S9(5) COMP-3.
      *    U:Pay Cat N De-Order
           03  YL0233 PIC S9(5) COMP-3.
      *    U:Pay Cat O De-Order
           03  YL0234 PIC S9(5) COMP-3.
      *    U:Continue
           03  YL0235 PIC X(1).
      *    U:Job Date DTX
           03  YL0236 PIC S9(8) COMP-3.
      *    U:Pay Cat 1 De-Order
           03  YL0237 PIC S9(5) COMP-3.
      *    U:Pay Cat 2 De-Order
           03  YL0238 PIC S9(5) COMP-3.
      *    U:Pay Cat 3 De-Order
           03  YL0239 PIC S9(5) COMP-3.
      *    U:Pay Cat 4 De-Order
           03  YL0240 PIC S9(5) COMP-3.
      *    U:Pay Cat 5 De-Order
           03  YL0241 PIC S9(5) COMP-3.
      *    U:Pay Cat N De-Order
           03  YL0242 PIC S9(5) COMP-3.
      *    U:Pay Cat O De-Order
           03  YL0243 PIC S9(5) COMP-3.
      *    U:Continue
           03  YL0244 PIC X(1).
      *    Order claw back
           03  YL0245 PIC S9(7) COMP-3.
      *    U:80%  of target Ord
           03  WUH0NU PIC S9(5) COMP-3.
      *    U:90%  of target Ord
           03  WUH1NU PIC S9(5) COMP-3.
      *    U:100% of target Ord
           03  WUH2NU PIC S9(5) COMP-3.
      *    U:105% of target Ord
           03  WUH5NU PIC S9(5) COMP-3.
      *    U:110% of target Ord
           03  WUH3NU PIC S9(5) COMP-3.
      *    U:120% of target Ord
           03  WUH4NU PIC S9(5) COMP-3.
      *    Order Band Achieved
           03  YL0246 PIC S9(3) COMP-3.
      *    Registration Band Ach
           03  YL0247 PIC S9(3) COMP-3.
      *    U:Text (3) c
           03  YL0248 PIC X(3).
      *    U:Text (3) d
           03  YL0249 PIC X(3).
      *    U:Text (1) f
           03  YL0250 PIC X(1).
      *    U:Text (1) e
           03  YL0251 PIC X(1).
      *    U:Text (2) c
           03  YL0252 PIC X(2).
      *    Manual Override Band
           03  YL0253 PIC S9(3) COMP-3.
      *    Payment Band Changes
           03  YL0254 PIC X(2).
      *    Manual Override Penalty
           03  YL0255 PIC S9(3).
      *    Apply Penalty
           03  YL0256 PIC X(1).
      *    Overall Combined Ach Band
           03  YL0257 PIC S9(3) COMP-3.
      *    PreQual Reg/Ord 3
           03  YL0258 PIC S9(7) COMP-3.
      *    PreQual De-Reg/Ord 3
           03  YL0259 PIC S9(7) COMP-3.
      *    Car/Van Indicator
           03  YL0260 PIC X(1).
      *    Bonus Amount (This)
           03  WUBNSAMTT PIC S9(5)V9(2) COMP-3.
      *    Bonus Amount (This)
           03  YL0261 PIC S9(5)V9(2) COMP-3.
      *    BDC Salesman PIN
           03  WUSLSMNP PIC X(13).
      *    TYPE CLIENT SEDRE
           03  WUYCST PIC X(1).
      *    TYPE DR CENTRAL
           03  WUL5CO PIC X(2).
      *    Number of Ord TBC
           03  YL0262 PIC S9(5).
      *    Number of Ord Car Retail
           03  YL0263 PIC S9(5).
      *    Number of Ord Car LFlt
           03  YL0264 PIC S9(5).
      *    Number of Ord Van LFlt
           03  YL0265 PIC S9(5).
      *    Number of Ord Motab
           03  YL0266 PIC S9(5).
      *    Number of Ord Major Flt
           03  YL0267 PIC S9(5).
      *    U:Yes/No (2)
           03  YL0268 PIC X(1).
      *    BDC Order Date YYYYMM
           03  YN0162 PIC X(6).
      *    Zone Code
           03  YN0163 PIC X(2).
      *    BDC Order Cnl Dte YYYYMM
           03  YN0164 PIC X(6).
      *    BDC Model Version
           03  YN0165 PIC X(12).
      *    Chassis number
           03  YN0166 PIC X(14).
      *    BDC Order Crt Date
           03  YL0269 PIC S9(8) COMP-3.
      *    BDC Order Cnl Date
           03  YN0167 PIC S9(8) COMP-3.
      *    TYPE CLIENT SEDRE
           03  YN0168 PIC X(1).
      *    TYPE DR CENTRAL
           03  YN0169 PIC X(2).
      *    SD Sales Channel Code
           03  YL0270 PIC X(2).
      *    Fleet Operator Number
           03  YN0170 PIC X(5).
      *    Fleet Report Group Code
           03  YL0271 PIC X(2).
      *    Fleet Report Group Plan
           03  YN0171 PIC X(1).
      *    Sell Price
           03  YN0172 PIC S9(5)V9(2) COMP-3.
      *    BDC Payment Method
           03  YN0173 PIC X(3).
      *    BDC Payment Term
           03  YL0272 PIC X(4).
      *    Report Group Description
           03  YN0174 PIC X(35).
      *    OBT Count Target Status
           03  YL0273 PIC X(1).
      *    Registration Date 58
           03  YL0274 PIC S9(8) COMP-3.
      *    De-registration Date #
           03  YN0175 PIC S9(8) COMP-3.
      *    SD Order Type Assoc w FON
           03  YN0176 PIC X(2).
      *    Fleet Programmes Code
           03  YL0275 PIC X(3).
      *    Fleet Programmes Desc
           03  YN0177 PIC X(25).
      *    FM Agreement Number (FON)
           03  YN0178 PIC X(10).
      *    FM Agreement Version Nbr
           03  YN0179 PIC X(2).
      *    Target Market
           03  YL0276 PIC X(1).
      *    U:Number (3.0)
           03  YL0277 PIC S9(3) COMP-3.
      *    Vehicle Rejection Flag
           03  YL0278 PIC X(1).
      *
      *    Indicators
       01  INDICS.
           03  IND PIC 1(1) OCCURS 99 INDICATOR 1.
           88  C-INDICATOR-ON VALUE B'1'.
           88  C-INDICATOR-OFF VALUE B'0'.
      *
      /EJECT
      *    Parameter declarations
      /EJECT
      ***************************************************************
       LINKAGE SECTION.
      *    Return code
       01  P0RTN PIC X(7).
       01  P1PARM.
      *    Bonus Scheme (8)
           03  P1BNSSCM PIC X(8).
      *    Suggest Run Number
           03  P1SUGRNO PIC S9(3).
      ***************************************************************
       PROCEDURE DIVISION USING
             P0RTN
      *    KEY: Bonus Sls-Suggest Work    Scheme,Run,Reg Dte,MdlVe
      *    I : RST Bonus Scheme (8)
      *    I : RST Suggest Run Number
      *    KEY : Bonus Sls-Suggest Work
             P1PARM
           .
      ***************************************************************
           CONTINUE.
       MAINLINE SECTION.
      *    Initialize
           PERFORM ZZINIT
      *
      *    Exc 2017o401 - Payments
      *    !Program need COBOL ILE  because here is many parameter in
      *      call program
      *    Rtv 2017o401 - Payments - Bonus Sls-Suggest Work  *
           PERFORM SA1RVGN
      *--------------------------------------------------------------
      *    Exit program
           CONTINUE.
       AAEXIT.
           MOVE SPACES TO P0RTN
           PERFORM ZYEXPG
      *==============================================================
      /EJECT
       SA1RVGN SECTION.
      *==============================================================
      *    Rtv 2017o401 - Payments - Bonus Sls-Suggest Work  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    USER: Initialize routine
      *    Description note this cheme
           PERFORM UA1SUBR
      *    Convert Job date to an 8.0 date
      *    Cvt DTE to DTX Format
      *    CASE: PAR.U:Date is < 01/01/40
      *    *IF
           IF (ZZJDT OF JOB-CONTEXT < 400101) THEN
      *        CASE: PAR.U:Date is *Zero
      *        *IF
               IF (ZZJDT OF JOB-CONTEXT = 0) THEN
      *            U:Date YYYYMMDD
                   MOVE ZEROS TO WUJOBDTE8 OF WORK-CONTEXT
               ELSE
      *            CASE: *OTHERWISE
      *            U:Date YYYYMMDD
                   ADD ZZJDT OF JOB-CONTEXT, 20000000 GIVING WUJOBDTE8
                     OF WORK-CONTEXT
               END-IF
           ELSE
      *        CASE: *OTHERWISE
      *        U:Date YYYYMMDD
               ADD ZZJDT OF JOB-CONTEXT, 19000000 GIVING WUJOBDTE8 OF
                 WORK-CONTEXT
           END-IF
      *    Retrieve Target Period Code (screen parameter)
      *    Rtv Scheme Parameters - Bonus Sls-Scheme Parms  *
           PERFORM SA2RVGN
      *    Retrieve Target For Registration
           PERFORM UA2SUBR
      *    Retrieve Target For Registration Milestone Penalty  M1
      *      (1.month)
           PERFORM UA3SUBR
      *    Retrieve Target For Registration Milestone Penalty  M2
      *      (2.month)
           PERFORM UA4SUBR
      *    Retrieve Target For Registration Milestone Penalty
      *      Overachievement
           PERFORM UA5SUBR
      *    Retrieve Target For Orders
           PERFORM UA6SUBR
      *    Dealer to pay Number (Num
           MOVE ZEROS TO WUEDNB OF WORK-CONTEXT
      *    Percentage Penalty
           MOVE ZEROS TO YL0001 OF WORK-CONTEXT
      *    Setup key
      *    Bonus Scheme (8)
           MOVE P1BNSSCM TO QCBNSSCM OF KRSSA1
      *    Suggest Run Number
           MOVE P1SUGRNO TO QCSUGRNO OF KRSSA1
      *    Initialise Full Externally Described Keylist
      *    Bonus Scheme (8)
           MOVE LOW-VALUES TO QCBNSSCM OF EXTSA1
      *    Suggest Run Number
           MOVE -999 TO QCSUGRNO OF EXTSA1
      *    Dealer to pay Number (Num
           MOVE -99999 TO QCEDNB OF EXTSA1
      *    SMMT Reg.Date (Original)
           MOVE -99999999 TO QCSMMTRD OF EXTSA1
      *    BDC Customer Order Number
           MOVE LOW-VALUES TO QCBDCCON OF EXTSA1
      *    Chassis number
           MOVE LOW-VALUES TO QCASXX OF EXTSA1
           MOVE CORRESPONDING
             EXTSA1 TO
             FBNSSX9 OF SBBNSSGWL4-R
           MOVE CORRESPONDING
             KRSSA1 TO
             FBNSSX9 OF SBBNSSGWL4-R
           START SBBNSSGWL4 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'FBNSSX9'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ SBBNSSGWL4 NEXT
             FORMAT IS 'FBNSSX9'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     FBNSSX9 OF SBBNSSGWL4-R TO
                     EXTSA1
                   MOVE EXTSA1 TO KRSSA1-TMP
                   IF (KRSSA1 NOT = KRSSA1-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    Bonus Scheme (8)
           MOVE LOW-VALUES TO QCBNSSCM OF EXTSA1
      *    Suggest Run Number
           MOVE -999 TO QCSUGRNO OF EXTSA1
      *    Dealer to pay Number (Num
           MOVE -99999 TO QCEDNB OF EXTSA1
      *    SMMT Reg.Date (Original)
           MOVE -99999999 TO QCSMMTRD OF EXTSA1
      *    BDC Customer Order Number
           MOVE LOW-VALUES TO QCBDCCON OF EXTSA1
      *    Chassis number
           MOVE LOW-VALUES TO QCASXX OF EXTSA1
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR4555' TO W0RTN
           END-IF
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        CASE: DB1.Vehicle Rejection Flag is *Blank
      *        *IF
               IF (QCVEHREJF OF FBNSSX9 OF SBBNSSGWL4-R = ' ') THEN
      *            Change of dealer code?
      *            CASE: DB1.Dealer to pay Number (Num NE WRK.Dealer
      *              to pay Number (Num
      *            *IF
                   IF (QCEDNB OF FBNSSX9 OF SBBNSSGWL4-R NOT = WUEDNB
                     OF WORK-CONTEXT) THEN
      *                Initialization
                       PERFORM UA7SUBR
      *                Get Run Mode and Parameter setting an previous
      *                  run
                       PERFORM UA8SUBR
      *                Convert dealer to 4+2, get region code etc, get
      *                  Dacia dealer
                       PERFORM UB1SUBR
      *                Registration
                       PERFORM UB2SUBR
      *                Initialization for order
                       PERFORM UF7SUBR
      *                Orders
                       PERFORM UF8SUBR
      *                Payment Band Registration + Order
                       PERFORM UI5SUBR
      *                override Band and Percent for pay
                       PERFORM UI6SUBR
      *                Dealer Archievent save
                       PERFORM UI7SUBR
      *                Dealer to pay Number (Num
                       MOVE QCEDNB OF FBNSSX9 OF SBBNSSGWL4-R TO WUEDNB
                         OF WORK-CONTEXT
                   END-IF
      *            Allocate payment to vehicle
                   PERFORM UI8SUBR
               END-IF
               SET C-INDICATOR-OFF(90) TO TRUE
               READ SBBNSSGWL4 NEXT
                 FORMAT IS 'FBNSSX9'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         FBNSSX9 OF SBBNSSGWL4-R TO
                         EXTSA1
                       MOVE EXTSA1 TO KRSSA1-TMP
                       IF (KRSSA1 NOT = KRSSA1-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        Bonus Scheme (8)
               MOVE LOW-VALUES TO QCBNSSCM OF EXTSA1
      *        Suggest Run Number
               MOVE -999 TO QCSUGRNO OF EXTSA1
      *        Dealer to pay Number (Num
               MOVE -99999 TO QCEDNB OF EXTSA1
      *        SMMT Reg.Date (Original)
               MOVE -99999999 TO QCSMMTRD OF EXTSA1
      *        BDC Customer Order Number
               MOVE LOW-VALUES TO QCBDCCON OF EXTSA1
      *        Chassis number
               MOVE LOW-VALUES TO QCASXX OF EXTSA1
           END-PERFORM
      *==============================================================
           CONTINUE.
       SA1EXIT.
           EXIT.
      /EJECT
       SA2RVGN SECTION.
      *==============================================================
      *    Rtv Scheme Parameters - Bonus Sls-Scheme Parms  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    Bonus Scheme (8)
           MOVE P1BNSSCM TO O7BNSSCM OF KRSSA2
      *    Initialise Full Externally Described Keylist
      *    Bonus Scheme (8)
           MOVE LOW-VALUES TO O7BNSSCM OF EXTSA2
           MOVE CORRESPONDING
             KRSSA2 TO
             FSCMPT6 OF SBSCMPRML1-R
           SET C-INDICATOR-OFF(90) TO TRUE
           READ SBSCMPRML1
             FORMAT IS 'FSCMPT6'
           END-READ
           IF (C-NO-RECORD) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               END-IF
           END-IF
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR4544' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Object Code
               MOVE SPACES TO WUOBJCDE OF WORK-CONTEXT
               GO SA2EXIT
           END-IF
      *
           IF (C-INDICATOR-OFF(90)) THEN
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Object Code
               MOVE O7OBJCDE OF FSCMPT6 OF SBSCMPRML1-R TO WUOBJCDE OF
                 WORK-CONTEXT
           END-IF
      *==============================================================
           CONTINUE.
       SA2EXIT.
           EXIT.
      /EJECT
       SA3RVGN SECTION.
      *==============================================================
      *    Rtv parameter by default - Bonus Sls-Scheme Run Parm  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    Bonus Scheme (8)
           MOVE P1BNSSCM TO BEBNSSCM OF KRSSA3
      *    Dealer number (Num key)
           MOVE QCDLRNOKEY OF FBNSSX9 OF SBBNSSGWL4-R TO BEDLRNOKEY OF
             KRSSA3
      *    Initialise Full Externally Described Keylist
      *    Bonus Scheme (8)
           MOVE LOW-VALUES TO BEBNSSCM OF EXTSA3
      *    Dealer number (Num key)
           MOVE -99999 TO BEDLRNOKEY OF EXTSA3
           MOVE CORRESPONDING
             KRSSA3 TO
             FSCMRL1 OF SBSCMRU2L1-R
           SET C-INDICATOR-OFF(90) TO TRUE
           READ SBSCMRU2L1
             FORMAT IS 'FSCMRL1'
           END-READ
           IF (C-NO-RECORD) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               END-IF
           END-IF
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR7853' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Include Cancelled Orders
               MOVE SPACES TO YL0081 OF WORK-CONTEXT
      *        Include Unmatched Orders
               MOVE SPACES TO YL0082 OF WORK-CONTEXT
      *        Recalculate Order Ach Brn
               MOVE SPACES TO YL0083 OF WORK-CONTEXT
      *        Recalculate Reg Ach Brnd
               MOVE SPACES TO YL0084 OF WORK-CONTEXT
      *        Run Mode
               MOVE SPACES TO YL0085 OF WORK-CONTEXT
      *        Record Status
               MOVE SPACES TO YL0086 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SA3EXIT
           END-IF
      *
           IF (C-INDICATOR-OFF(90)) THEN
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Include Cancelled Orders
               MOVE BEQZSU OF FSCMRL1 OF SBSCMRU2L1-R TO YL0081 OF
                 WORK-CONTEXT
      *        Include Unmatched Orders
               MOVE BEQ0SU OF FSCMRL1 OF SBSCMRU2L1-R TO YL0082 OF
                 WORK-CONTEXT
      *        Recalculate Order Ach Brn
               MOVE BEQ1SU OF FSCMRL1 OF SBSCMRU2L1-R TO YL0083 OF
                 WORK-CONTEXT
      *        Recalculate Reg Ach Brnd
               MOVE BEQ2SU OF FSCMRL1 OF SBSCMRU2L1-R TO YL0084 OF
                 WORK-CONTEXT
      *        Run Mode
               MOVE BEZKCF OF FSCMRL1 OF SBSCMRU2L1-R TO YL0085 OF
                 WORK-CONTEXT
      *        Record Status
               MOVE BESTATUS OF FSCMRL1 OF SBSCMRU2L1-R TO YL0086 OF
                 WORK-CONTEXT
           END-IF
      *==============================================================
           CONTINUE.
       SA3EXIT.
           EXIT.
      /EJECT
       SA4RVGN SECTION.
      *==============================================================
      *    Rtv parameter by default - Bonus Sls-Scheme Run Parm  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    Bonus Scheme (8)
           MOVE P1BNSSCM TO BEBNSSCM OF KRSSA4
      *    Dealer number (Num key)
           MOVE 99999 TO BEDLRNOKEY OF KRSSA4
      *    Initialise Full Externally Described Keylist
      *    Bonus Scheme (8)
           MOVE LOW-VALUES TO BEBNSSCM OF EXTSA4
      *    Dealer number (Num key)
           MOVE -99999 TO BEDLRNOKEY OF EXTSA4
           MOVE CORRESPONDING
             KRSSA4 TO
             FSCMRL1 OF SBSCMRU2L1-R
           SET C-INDICATOR-OFF(90) TO TRUE
           READ SBSCMRU2L1
             FORMAT IS 'FSCMRL1'
           END-READ
           IF (C-NO-RECORD) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               END-IF
           END-IF
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR7853' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Include Cancelled Orders
               MOVE SPACES TO YL0081 OF WORK-CONTEXT
      *        Include Unmatched Orders
               MOVE SPACES TO YL0082 OF WORK-CONTEXT
      *        Recalculate Order Ach Brn
               MOVE SPACES TO YL0083 OF WORK-CONTEXT
      *        Recalculate Reg Ach Brnd
               MOVE SPACES TO YL0084 OF WORK-CONTEXT
      *        Run Mode
               MOVE SPACES TO YL0085 OF WORK-CONTEXT
      *        Record Status
               MOVE SPACES TO YL0086 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SA4EXIT
           END-IF
      *
           IF (C-INDICATOR-OFF(90)) THEN
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Include Cancelled Orders
               MOVE BEQZSU OF FSCMRL1 OF SBSCMRU2L1-R TO YL0081 OF
                 WORK-CONTEXT
      *        Include Unmatched Orders
               MOVE BEQ0SU OF FSCMRL1 OF SBSCMRU2L1-R TO YL0082 OF
                 WORK-CONTEXT
      *        Recalculate Order Ach Brn
               MOVE BEQ1SU OF FSCMRL1 OF SBSCMRU2L1-R TO YL0083 OF
                 WORK-CONTEXT
      *        Recalculate Reg Ach Brnd
               MOVE BEQ2SU OF FSCMRL1 OF SBSCMRU2L1-R TO YL0084 OF
                 WORK-CONTEXT
      *        Run Mode
               MOVE BEZKCF OF FSCMRL1 OF SBSCMRU2L1-R TO YL0085 OF
                 WORK-CONTEXT
      *        Record Status
               MOVE BESTATUS OF FSCMRL1 OF SBSCMRU2L1-R TO YL0086 OF
                 WORK-CONTEXT
           END-IF
      *==============================================================
           CONTINUE.
       SA4EXIT.
           EXIT.
      /EJECT
       SA5RVGN SECTION.
      *==============================================================
      *    Rtv Dealer Regn & Zone - Bonus Sls-Dealer Parms  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    Bonus Scheme (8)
           MOVE QCBNSSCM OF FBNSSX9 OF SBBNSSGWL4-R TO O8BNSSCM OF
             KRSSA5
      *    Dealer number (Num key)
           MOVE QCEDNB OF FBNSSX9 OF SBBNSSGWL4-R TO O8DLRNOKEY OF
             KRSSA5
      *    Initialise Full Externally Described Keylist
      *    Bonus Scheme (8)
           MOVE LOW-VALUES TO O8BNSSCM OF EXTSA5
      *    Dealer number (Num key)
           MOVE -99999 TO O8DLRNOKEY OF EXTSA5
           MOVE CORRESPONDING
             KRSSA5 TO
             FDLRPTX OF SBDLRPRML1-R
           SET C-INDICATOR-OFF(90) TO TRUE
           READ SBDLRPRML1
             FORMAT IS 'FDLRPTX'
           END-READ
           IF (C-NO-RECORD) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               END-IF
           END-IF
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR4547' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Region Code
               MOVE SPACES TO WURGNCDE OF WORK-CONTEXT
      *        Zone Code
               MOVE SPACES TO WUZONCOD OF WORK-CONTEXT
               GO SA5EXIT
           END-IF
      *
           IF (C-INDICATOR-OFF(90)) THEN
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Region Code
               MOVE O8RGNCDE OF FDLRPTX OF SBDLRPRML1-R TO WURGNCDE OF
                 WORK-CONTEXT
      *        Zone Code
               MOVE O8ZONCOD OF FDLRPTX OF SBDLRPRML1-R TO WUZONCOD OF
                 WORK-CONTEXT
           END-IF
      *==============================================================
           CONTINUE.
       SA5EXIT.
           EXIT.
      /EJECT
       SA6RVGN SECTION.
      *==============================================================
      *    Rtv Dlr Network Type - Dealer  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    Dealer Number
           MOVE WUDLRNO OF WORK-CONTEXT TO ABDLRNBR OF KRSSA6
      *    Dealer Number Suffix
           MOVE WUUDLRSFX OF WORK-CONTEXT TO ABDLRSFX OF KRSSA6
      *    Initialise Full Externally Described Keylist
      *    Dealer Number
           MOVE LOW-VALUES TO ABDLRNBR OF EXTSA6
      *    Dealer Number Suffix
           MOVE LOW-VALUES TO ABDLRSFX OF EXTSA6
           MOVE CORRESPONDING
             KRSSA6 TO
             FABCPAX OF DIDLRDTAL2-R
           SET C-INDICATOR-OFF(90) TO TRUE
           READ DIDLRDTAL2
             FORMAT IS 'FABCPAX'
           END-READ
           IF (C-NO-RECORD) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               END-IF
           END-IF
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR0003' TO W0RTN
      *        USER: Processing if Data record not found
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SA6EXIT
           END-IF
      *
           IF (C-INDICATOR-OFF(90)) THEN
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Dealer Network Type
               MOVE ABDLRNET OF FABCPAX OF DIDLRDTAL2-R TO YL0096 OF
                 WORK-CONTEXT
           END-IF
      *==============================================================
           CONTINUE.
       SA6EXIT.
           EXIT.
      /EJECT
       SA7RVGN SECTION.
      *==============================================================
      *    Rtv Target Value (Single) - Target Information  * Car
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    Level Code
           MOVE 00030 TO S9LVLCDE OF KRSSA7
      *    Dealer Number
           MOVE WUDLRNO OF WORK-CONTEXT TO S9DLRNBR OF KRSSA7
      *    Dealer Number Suffix
           MOVE WUUDLRSFX OF WORK-CONTEXT TO S9DLRSFX OF KRSSA7
      *    Target Period Code
           MOVE WUUTGTPRDB OF WORK-CONTEXT TO S9PERCDE OF KRSSA7
      *    Object Code
           MOVE 'CAR' TO S9OBJCDE OF KRSSA7
      *    Initialise Full Externally Described Keylist
      *    Level Code
           MOVE -99999 TO S9LVLCDE OF EXTSA7
      *    Dealer Number
           MOVE LOW-VALUES TO S9DLRNBR OF EXTSA7
      *    Dealer Number Suffix
           MOVE LOW-VALUES TO S9DLRSFX OF EXTSA7
      *    Target Period Code
           MOVE LOW-VALUES TO S9PERCDE OF EXTSA7
      *    Object Code
           MOVE LOW-VALUES TO S9OBJCDE OF EXTSA7
           MOVE CORRESPONDING
             EXTSA7 TO
             FTGTDSK OF AMTGTDTAL7-R
           MOVE CORRESPONDING
             KRSSA7 TO
             FTGTDSK OF AMTGTDTAL7-R
           START AMTGTDTAL7 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'FTGTDSK'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ AMTGTDTAL7 NEXT
             FORMAT IS 'FTGTDSK'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     FTGTDSK OF AMTGTDTAL7-R TO
                     EXTSA7
                   MOVE EXTSA7 TO KRSSA7-TMP
                   IF (KRSSA7 NOT = KRSSA7-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    Level Code
           MOVE -99999 TO S9LVLCDE OF EXTSA7
      *    Dealer Number
           MOVE LOW-VALUES TO S9DLRNBR OF EXTSA7
      *    Dealer Number Suffix
           MOVE LOW-VALUES TO S9DLRSFX OF EXTSA7
      *    Target Period Code
           MOVE LOW-VALUES TO S9PERCDE OF EXTSA7
      *    Object Code
           MOVE LOW-VALUES TO S9OBJCDE OF EXTSA7
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR2873' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Target Value
               MOVE ZEROS TO YL0097 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SA7EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Target Value
               MOVE S9TGOVAL OF FTGTDSK OF AMTGTDTAL7-R TO YL0097 OF
                 WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
               SET C-INDICATOR-OFF(90) TO TRUE
               READ AMTGTDTAL7 NEXT
                 FORMAT IS 'FTGTDSK'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         FTGTDSK OF AMTGTDTAL7-R TO
                         EXTSA7
                       MOVE EXTSA7 TO KRSSA7-TMP
                       IF (KRSSA7 NOT = KRSSA7-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        Level Code
               MOVE -99999 TO S9LVLCDE OF EXTSA7
      *        Dealer Number
               MOVE LOW-VALUES TO S9DLRNBR OF EXTSA7
      *        Dealer Number Suffix
               MOVE LOW-VALUES TO S9DLRSFX OF EXTSA7
      *        Target Period Code
               MOVE LOW-VALUES TO S9PERCDE OF EXTSA7
      *        Object Code
               MOVE LOW-VALUES TO S9OBJCDE OF EXTSA7
           END-PERFORM
      *==============================================================
           CONTINUE.
       SA7EXIT.
           EXIT.
      /EJECT
       SA8RVGN SECTION.
      *==============================================================
      *    Rtv Target Value (Single) - Target Information  * Van
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    Level Code
           MOVE 00030 TO S9LVLCDE OF KRSSA8
      *    Dealer Number
           MOVE WUDLRNO OF WORK-CONTEXT TO S9DLRNBR OF KRSSA8
      *    Dealer Number Suffix
           MOVE WUUDLRSFX OF WORK-CONTEXT TO S9DLRSFX OF KRSSA8
      *    Target Period Code
           MOVE WUUTGTPRDB OF WORK-CONTEXT TO S9PERCDE OF KRSSA8
      *    Object Code
           MOVE 'VAN' TO S9OBJCDE OF KRSSA8
      *    Initialise Full Externally Described Keylist
      *    Level Code
           MOVE -99999 TO S9LVLCDE OF EXTSA8
      *    Dealer Number
           MOVE LOW-VALUES TO S9DLRNBR OF EXTSA8
      *    Dealer Number Suffix
           MOVE LOW-VALUES TO S9DLRSFX OF EXTSA8
      *    Target Period Code
           MOVE LOW-VALUES TO S9PERCDE OF EXTSA8
      *    Object Code
           MOVE LOW-VALUES TO S9OBJCDE OF EXTSA8
           MOVE CORRESPONDING
             EXTSA8 TO
             FTGTDSK OF AMTGTDTAL7-R
           MOVE CORRESPONDING
             KRSSA8 TO
             FTGTDSK OF AMTGTDTAL7-R
           START AMTGTDTAL7 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'FTGTDSK'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ AMTGTDTAL7 NEXT
             FORMAT IS 'FTGTDSK'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     FTGTDSK OF AMTGTDTAL7-R TO
                     EXTSA8
                   MOVE EXTSA8 TO KRSSA8-TMP
                   IF (KRSSA8 NOT = KRSSA8-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    Level Code
           MOVE -99999 TO S9LVLCDE OF EXTSA8
      *    Dealer Number
           MOVE LOW-VALUES TO S9DLRNBR OF EXTSA8
      *    Dealer Number Suffix
           MOVE LOW-VALUES TO S9DLRSFX OF EXTSA8
      *    Target Period Code
           MOVE LOW-VALUES TO S9PERCDE OF EXTSA8
      *    Object Code
           MOVE LOW-VALUES TO S9OBJCDE OF EXTSA8
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR2873' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Target Value
               MOVE ZEROS TO YL0097 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SA8EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Target Value
               MOVE S9TGOVAL OF FTGTDSK OF AMTGTDTAL7-R TO YL0097 OF
                 WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
               SET C-INDICATOR-OFF(90) TO TRUE
               READ AMTGTDTAL7 NEXT
                 FORMAT IS 'FTGTDSK'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         FTGTDSK OF AMTGTDTAL7-R TO
                         EXTSA8
                       MOVE EXTSA8 TO KRSSA8-TMP
                       IF (KRSSA8 NOT = KRSSA8-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        Level Code
               MOVE -99999 TO S9LVLCDE OF EXTSA8
      *        Dealer Number
               MOVE LOW-VALUES TO S9DLRNBR OF EXTSA8
      *        Dealer Number Suffix
               MOVE LOW-VALUES TO S9DLRSFX OF EXTSA8
      *        Target Period Code
               MOVE LOW-VALUES TO S9PERCDE OF EXTSA8
      *        Object Code
               MOVE LOW-VALUES TO S9OBJCDE OF EXTSA8
           END-PERFORM
      *==============================================================
           CONTINUE.
       SA8EXIT.
           EXIT.
      /EJECT
       SA9RVGN SECTION.
      *==============================================================
      *    Rtv Target Value (Single) - Target Information  * Dacia car
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    Level Code
           MOVE 00030 TO S9LVLCDE OF KRSSA9
      *    Dealer Number
           MOVE WUWECF OF WORK-CONTEXT TO S9DLRNBR OF KRSSA9
      *    Dealer Number Suffix
           MOVE WUWFCF OF WORK-CONTEXT TO S9DLRSFX OF KRSSA9
      *    Target Period Code
           MOVE WUUTGTPRDB OF WORK-CONTEXT TO S9PERCDE OF KRSSA9
      *    Object Code
           MOVE 'CAR' TO S9OBJCDE OF KRSSA9
      *    Initialise Full Externally Described Keylist
      *    Level Code
           MOVE -99999 TO S9LVLCDE OF EXTSA9
      *    Dealer Number
           MOVE LOW-VALUES TO S9DLRNBR OF EXTSA9
      *    Dealer Number Suffix
           MOVE LOW-VALUES TO S9DLRSFX OF EXTSA9
      *    Target Period Code
           MOVE LOW-VALUES TO S9PERCDE OF EXTSA9
      *    Object Code
           MOVE LOW-VALUES TO S9OBJCDE OF EXTSA9
           MOVE CORRESPONDING
             EXTSA9 TO
             FTGTDSK OF AMTGTDTAL7-R
           MOVE CORRESPONDING
             KRSSA9 TO
             FTGTDSK OF AMTGTDTAL7-R
           START AMTGTDTAL7 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'FTGTDSK'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ AMTGTDTAL7 NEXT
             FORMAT IS 'FTGTDSK'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     FTGTDSK OF AMTGTDTAL7-R TO
                     EXTSA9
                   MOVE EXTSA9 TO KRSSA9-TMP
                   IF (KRSSA9 NOT = KRSSA9-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    Level Code
           MOVE -99999 TO S9LVLCDE OF EXTSA9
      *    Dealer Number
           MOVE LOW-VALUES TO S9DLRNBR OF EXTSA9
      *    Dealer Number Suffix
           MOVE LOW-VALUES TO S9DLRSFX OF EXTSA9
      *    Target Period Code
           MOVE LOW-VALUES TO S9PERCDE OF EXTSA9
      *    Object Code
           MOVE LOW-VALUES TO S9OBJCDE OF EXTSA9
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR2873' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Target Value
               MOVE ZEROS TO YL0098 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SA9EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Target Value
               MOVE S9TGOVAL OF FTGTDSK OF AMTGTDTAL7-R TO YL0098 OF
                 WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
               SET C-INDICATOR-OFF(90) TO TRUE
               READ AMTGTDTAL7 NEXT
                 FORMAT IS 'FTGTDSK'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         FTGTDSK OF AMTGTDTAL7-R TO
                         EXTSA9
                       MOVE EXTSA9 TO KRSSA9-TMP
                       IF (KRSSA9 NOT = KRSSA9-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        Level Code
               MOVE -99999 TO S9LVLCDE OF EXTSA9
      *        Dealer Number
               MOVE LOW-VALUES TO S9DLRNBR OF EXTSA9
      *        Dealer Number Suffix
               MOVE LOW-VALUES TO S9DLRSFX OF EXTSA9
      *        Target Period Code
               MOVE LOW-VALUES TO S9PERCDE OF EXTSA9
      *        Object Code
               MOVE LOW-VALUES TO S9OBJCDE OF EXTSA9
           END-PERFORM
      *==============================================================
           CONTINUE.
       SA9EXIT.
           EXIT.
      /EJECT
       SB1RVGN SECTION.
      *==============================================================
      *    Rtv Target Value (Single) - Target Information  * Van
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    Level Code
           MOVE 00030 TO S9LVLCDE OF KRSSB1
      *    Dealer Number
           MOVE WUWECF OF WORK-CONTEXT TO S9DLRNBR OF KRSSB1
      *    Dealer Number Suffix
           MOVE YL0099 OF WORK-CONTEXT TO S9DLRSFX OF KRSSB1
      *    Target Period Code
           MOVE WUUTGTPRDB OF WORK-CONTEXT TO S9PERCDE OF KRSSB1
      *    Object Code
           MOVE 'VAN' TO S9OBJCDE OF KRSSB1
      *    Initialise Full Externally Described Keylist
      *    Level Code
           MOVE -99999 TO S9LVLCDE OF EXTSB1
      *    Dealer Number
           MOVE LOW-VALUES TO S9DLRNBR OF EXTSB1
      *    Dealer Number Suffix
           MOVE LOW-VALUES TO S9DLRSFX OF EXTSB1
      *    Target Period Code
           MOVE LOW-VALUES TO S9PERCDE OF EXTSB1
      *    Object Code
           MOVE LOW-VALUES TO S9OBJCDE OF EXTSB1
           MOVE CORRESPONDING
             EXTSB1 TO
             FTGTDSK OF AMTGTDTAL7-R
           MOVE CORRESPONDING
             KRSSB1 TO
             FTGTDSK OF AMTGTDTAL7-R
           START AMTGTDTAL7 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'FTGTDSK'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ AMTGTDTAL7 NEXT
             FORMAT IS 'FTGTDSK'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     FTGTDSK OF AMTGTDTAL7-R TO
                     EXTSB1
                   MOVE EXTSB1 TO KRSSB1-TMP
                   IF (KRSSB1 NOT = KRSSB1-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    Level Code
           MOVE -99999 TO S9LVLCDE OF EXTSB1
      *    Dealer Number
           MOVE LOW-VALUES TO S9DLRNBR OF EXTSB1
      *    Dealer Number Suffix
           MOVE LOW-VALUES TO S9DLRSFX OF EXTSB1
      *    Target Period Code
           MOVE LOW-VALUES TO S9PERCDE OF EXTSB1
      *    Object Code
           MOVE LOW-VALUES TO S9OBJCDE OF EXTSB1
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR2873' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Target Value
               MOVE ZEROS TO YL0098 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SB1EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Target Value
               MOVE S9TGOVAL OF FTGTDSK OF AMTGTDTAL7-R TO YL0098 OF
                 WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
               SET C-INDICATOR-OFF(90) TO TRUE
               READ AMTGTDTAL7 NEXT
                 FORMAT IS 'FTGTDSK'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         FTGTDSK OF AMTGTDTAL7-R TO
                         EXTSB1
                       MOVE EXTSB1 TO KRSSB1-TMP
                       IF (KRSSB1 NOT = KRSSB1-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        Level Code
               MOVE -99999 TO S9LVLCDE OF EXTSB1
      *        Dealer Number
               MOVE LOW-VALUES TO S9DLRNBR OF EXTSB1
      *        Dealer Number Suffix
               MOVE LOW-VALUES TO S9DLRSFX OF EXTSB1
      *        Target Period Code
               MOVE LOW-VALUES TO S9PERCDE OF EXTSB1
      *        Object Code
               MOVE LOW-VALUES TO S9OBJCDE OF EXTSB1
           END-PERFORM
      *==============================================================
           CONTINUE.
       SB1EXIT.
           EXIT.
      /EJECT
       SB2RVGN SECTION.
      *==============================================================
      *    Rtv No of Regs TCTT - BDC.-.SEDRE DOT Extract  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    USER: Initialize routine
      *    Cvt *Job date to DTX
      *    * Job date contains a leading 1 when the year is 2000 or
      *      greater
      *    U:Job Date DTX
           ADD ZZJDT OF JOB-CONTEXT, 19000000 GIVING YL0107 OF
             WORK-CONTEXT
      *    Utl Cvt Dealer 6 to 5N
           MOVE 5 TO YRSW03
           MOVE 2 TO YRSW02
           IF (YRSW02 NOT > 0 OR
               YRSW03 NOT > 0 OR
               YRSW02 > 00006 OR
               YRSW03 > 00006) THEN
               MOVE 'Y2U0510' TO W0RTN
           ELSE
               MOVE WUNECO OF WORK-CONTEXT TO W0STRNG
               MOVE W0STRNG(YRSW02:YRSW03) TO WUUCODE5 OF WORK-CONTEXT
           END-IF
           IF (WUUCODE5 OF WORK-CONTEXT = SPACES) THEN
               MOVE ZERO TO YL0108 OF WORK-CONTEXT
           ELSE
               MOVE WUUCODE5 OF WORK-CONTEXT TO YL0108 OF WORK-CONTEXT
           END-IF
      *    U:Pay Cat 1 Regs
           MOVE ZEROS TO YL0100 OF WORK-CONTEXT
      *    U:Pay Cat 1 Regs
           MOVE ZEROS TO YL0109 OF WORK-CONTEXT
      *    U:Pay Cat 2 Regs
           MOVE ZEROS TO YL0101 OF WORK-CONTEXT
      *    U:Pay Cat 2 Regs
           MOVE ZEROS TO YL0110 OF WORK-CONTEXT
      *    U:Pay Cat 3 Regs
           MOVE ZEROS TO YL0102 OF WORK-CONTEXT
      *    U:Pay Cat 3 Regs
           MOVE ZEROS TO YL0111 OF WORK-CONTEXT
      *    U:Pay Cat 4 Regs
           MOVE ZEROS TO YL0103 OF WORK-CONTEXT
      *    U:Pay Cat 4 Regs
           MOVE ZEROS TO YL0112 OF WORK-CONTEXT
      *    U:Pay Cat 5 Regs
           MOVE ZEROS TO YL0104 OF WORK-CONTEXT
      *    U:Pay Cat 5 Regs
           MOVE ZEROS TO YL0113 OF WORK-CONTEXT
      *    U:Pay Cat N Regs
           MOVE ZEROS TO YL0105 OF WORK-CONTEXT
      *    U:Pay Cat N Regs
           MOVE ZEROS TO YL0114 OF WORK-CONTEXT
      *    U:Pay Cat O Regs
           MOVE ZEROS TO YL0106 OF WORK-CONTEXT
      *    U:Pay Cat O Regs
           MOVE ZEROS TO YL0115 OF WORK-CONTEXT
      *    Setup key
      *    CONCES PROPRIETAIRE
           MOVE WUNECO OF WORK-CONTEXT TO OSNECO OF KPSSB2
      *    DATE 58 IMMATRICULATION
           MOVE WUUFRMDTXB OF WORK-CONTEXT TO OSW0NB OF KPSSB2
           MOVE CORRESPONDING KPSSB2 TO KRSSB2
      *    Initialise Full Externally Described Keylist
      *    CONCES PROPRIETAIRE
           MOVE LOW-VALUES TO OSNECO OF EXTSB2
      *    DATE 58 IMMATRICULATION
           MOVE -99999999 TO OSW0NB OF EXTSB2
      *    COMMANDE CLIENT
           MOVE LOW-VALUES TO OSNUCO OF EXTSB2
           MOVE CORRESPONDING
             EXTSB2 TO
             FDOTEGL OF SBDOTEXTL7-R
           MOVE CORRESPONDING
             KPSSB2 TO
             FDOTEGL OF SBDOTEXTL7-R
           START SBDOTEXTL7 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'FDOTEGL'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ SBDOTEXTL7 NEXT
             FORMAT IS 'FDOTEGL'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     FDOTEGL OF SBDOTEXTL7-R TO
                     EXTSB2
                   MOVE EXTSB2 TO KRSSB2-TMP
                   IF (KRSSB2 NOT = KRSSB2-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    CONCES PROPRIETAIRE
           MOVE LOW-VALUES TO OSNECO OF EXTSB2
      *    DATE 58 IMMATRICULATION
           MOVE -99999999 TO OSW0NB OF EXTSB2
      *    COMMANDE CLIENT
           MOVE LOW-VALUES TO OSNUCO OF EXTSB2
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR5554' TO W0RTN
           END-IF
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        Count number of registrations for the Model
      *        CASE: DB1.DATE 58 IMMATRICULATION LE PAR.U:Number (8.0)
      *        *IF
               IF (OSW0NB OF FDOTEGL OF SBDOTEXTL7-R NOT > WUUTODTXB OF
                 WORK-CONTEXT) THEN
      *            Include this one?
      *            CASE: DB1.DATE 58 IMMATRICULATION is NE Zero
      *            *IF
                   IF (OSW0NB OF FDOTEGL OF SBDOTEXTL7-R NOT = 0) THEN
      *                Car/Van Indicator
                       MOVE ' ' TO YL0116 OF WORK-CONTEXT
      *                OBT Count Target Status
                       MOVE ' ' TO YL0117 OF WORK-CONTEXT
      *                Rtv Car or Van SCP Mdl - Vehicle Model Bonus
      *                  Atr  *
                       PERFORM SB3RVGN
      *                Rtv Rtn Latest Brand Mdl - Bonus Sls-RIC Mdl
      *                  Dsp Seq  *
                       PERFORM SB4RVGN
      *                Fleet Programmes Code
                       MOVE SPACES TO YL0119 OF WORK-CONTEXT
                       MOVE ' ' TO YL0119 OF WORK-CONTEXT
      *                U:Continue
                       MOVE 'Y' TO YL0120 OF WORK-CONTEXT
      *                Rtv All Dtl by Dlr/Mdl/ON - OBT Extract  *
                       PERFORM SB5RVGN
      *                Check Target Type Deselection
      *                CASE: PAR.U:Target Prefix is Target total
      *                *IF
                       IF ('TT' = 'TT') THEN
                           CONTINUE
                       ELSE
      *                    CASE: PAR.U:Target Prefix is Target Local
      *                      Market
      *                    *IF
                           IF ('TT' = 'TL') THEN
      *                        CASE: LCL.Target Market is Local Market
      *                          Target List
      *                        *IF
                               IF (YL0123 OF WORK-CONTEXT = 'L' OR
                                   YL0123 OF WORK-CONTEXT = 'W' OR
                                   YL0123 OF WORK-CONTEXT = 'R') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0120 OF WORK-CONTEXT
                               END-IF
                           ELSE
      *                        CASE: PAR.U:Target Prefix is Target
      *                          Major Fleet
      *                        *IF
                               IF ('TT' = 'TM') THEN
      *                        CASE: LCL.Target Market is Major Fleet
      *                          Target
      *                        *IF
                               IF (YL0123 OF WORK-CONTEXT = 'M') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0120 OF WORK-CONTEXT
                               END-IF
                               ELSE
      *                        CASE: PAR.U:Target Prefix is Target not
      *                          fleet
      *                        *IF
                               IF ('TT' = 'TN') THEN
      *                        CASE:
      *                        - c1 OR c2
      *                        |- c1    : LCL.Fleet Programmes Code is
      *                          *Blank
      *                        |- c2    : LCL.Fleet Programmes Code is
      *                          UNS - Unsupported (30286)
      *                        '-
      *                        *IF
                               IF (YL0119 OF WORK-CONTEXT = ' ' OR
                                   YL0119 OF WORK-CONTEXT = 'UNS') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0120 OF WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
      *                If O.K. to Continue - Following Record
      *                  Deselection
      *                CASE: LCL.U:Continue is Yes
      *                *IF
                       IF (YL0120 OF WORK-CONTEXT = 'Y') THEN
      *                    CASE: DB1.De-reg Date NBR is NE Zero
      *                    *IF
                           IF (OSZXNU OF FDOTEGL OF SBDOTEXTL7-R NOT =
                             0) THEN
      *                        For De-Regs
      *                        CASE:
      *                        - c1 OR c2
      *                        |- c1    : LCL.OBT Count Target Status
      *                          is In Target List
      *                        |- c2    : LCL.Bns Brand Name is RENAULT
      *                        '-
      *                        *IF
                               IF ((YL0117 OF WORK-CONTEXT = 'I' OR
                                    YL0117 OF WORK-CONTEXT = '1' OR
                                    YL0117 OF WORK-CONTEXT = '2' OR
                                    YL0117 OF WORK-CONTEXT = '3' OR
                                    YL0117 OF WORK-CONTEXT = '4' OR
                                    YL0117 OF WORK-CONTEXT = '5' OR
                                    YL0117 OF WORK-CONTEXT = 'N') OR
                                   YL0118 OF WORK-CONTEXT = 'RENAULT')
                                 THEN
      *                        U:Pay Cat 5 Regs
                               ADD YL0113 OF WORK-CONTEXT, 1 GIVING
                                 YL0113 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Pay Cat O Regs
                               ADD YL0115 OF WORK-CONTEXT, 1 GIVING
                                 YL0115 OF WORK-CONTEXT
                               END-IF
                           ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 1
      *                        *IF
                               IF (YL0117 OF WORK-CONTEXT = '1') THEN
      *                        U:Pay Cat 1 Regs
                               ADD YL0109 OF WORK-CONTEXT, 1 GIVING
                                 YL0109 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 2
      *                        *IF
                               IF (YL0117 OF WORK-CONTEXT = '2') THEN
      *                        U:Pay Cat 2 Regs
                               ADD YL0110 OF WORK-CONTEXT, 1 GIVING
                                 YL0110 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 3
      *                        *IF
                               IF (YL0117 OF WORK-CONTEXT = '3') THEN
      *                        U:Pay Cat 3 Regs
                               ADD YL0111 OF WORK-CONTEXT, 1 GIVING
                                 YL0111 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 4
      *                        *IF
                               IF (YL0117 OF WORK-CONTEXT = '4') THEN
      *                        U:Pay Cat 4 Regs
                               ADD YL0112 OF WORK-CONTEXT, 1 GIVING
                                 YL0112 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 5
      *                        *IF
                               IF (YL0117 OF WORK-CONTEXT = '5') THEN
      *                        U:Pay Cat 5 Regs
                               ADD YL0113 OF WORK-CONTEXT, 1 GIVING
                                 YL0113 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category N - New
      *                        *IF
                               IF (YL0117 OF WORK-CONTEXT = 'N') THEN
      *                        U:Pay Cat N Regs
                               ADD YL0114 OF WORK-CONTEXT, 1 GIVING
                                 YL0114 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Pay Cat O Regs
                               ADD YL0115 OF WORK-CONTEXT, 1 GIVING
                                 YL0115 OF WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
                   END-IF
               END-IF
               SET C-INDICATOR-OFF(90) TO TRUE
               READ SBDOTEXTL7 NEXT
                 FORMAT IS 'FDOTEGL'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         FDOTEGL OF SBDOTEXTL7-R TO
                         EXTSB2
                       MOVE EXTSB2 TO KRSSB2-TMP
                       IF (KRSSB2 NOT = KRSSB2-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        CONCES PROPRIETAIRE
               MOVE LOW-VALUES TO OSNECO OF EXTSB2
      *        DATE 58 IMMATRICULATION
               MOVE -99999999 TO OSW0NB OF EXTSB2
      *        COMMANDE CLIENT
               MOVE LOW-VALUES TO OSNUCO OF EXTSB2
           END-PERFORM
      *    USER: Exit processing
      *    U:Pay Cat 1 Regs
           MOVE YL0109 OF WORK-CONTEXT TO YL0100 OF WORK-CONTEXT
      *    U:Pay Cat 2 Regs
           MOVE YL0110 OF WORK-CONTEXT TO YL0101 OF WORK-CONTEXT
      *    U:Pay Cat 3 Regs
           MOVE YL0111 OF WORK-CONTEXT TO YL0102 OF WORK-CONTEXT
      *    U:Pay Cat 4 Regs
           MOVE YL0112 OF WORK-CONTEXT TO YL0103 OF WORK-CONTEXT
      *    U:Pay Cat 5 Regs
           MOVE YL0113 OF WORK-CONTEXT TO YL0104 OF WORK-CONTEXT
      *    U:Pay Cat N Regs
           MOVE YL0114 OF WORK-CONTEXT TO YL0105 OF WORK-CONTEXT
      *    U:Pay Cat O Regs
           MOVE YL0115 OF WORK-CONTEXT TO YL0106 OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       SB2EXIT.
           EXIT.
      /EJECT
       SB3RVGN SECTION.
      *==============================================================
      *    Rtv Car or Van SCP Mdl - Vehicle Model Bonus Atr  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    USER: Initialize routine
      *    Car/Van Indicator
           MOVE 'C' TO YL0116 OF WORK-CONTEXT
      *    Setup key
      *    Model Application Code
           MOVE 'RIC' TO LLMDLAPPCD OF KRSSB3
      *    SCP Model Code
           MOVE OSSTMDLSCP OF FDOTEGL OF SBDOTEXTL7-R TO LLSCMDLCDE OF
             KRSSB3
      *    Initialise Full Externally Described Keylist
      *    Model Application Code
           MOVE LOW-VALUES TO LLMDLAPPCD OF EXTSB3
      *    SCP Model Code
           MOVE LOW-VALUES TO LLSCMDLCDE OF EXTSB3
           MOVE CORRESPONDING
             KRSSB3 TO
             VAMDLBNSF1 OF VAMDLBNSL1-R
           SET C-INDICATOR-OFF(90) TO TRUE
           READ VAMDLBNSL1
             FORMAT IS 'VAMDLBNSF1'
           END-READ
           IF (C-NO-RECORD) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               END-IF
           END-IF
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR7127' TO W0RTN
      *        USER: Processing if Data record not found
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SB3EXIT
           END-IF
      *
           IF (C-INDICATOR-OFF(90)) THEN
      *        USER: Process Data record
      *        Car/Van Indicator
               MOVE LLCORV OF VAMDLBNSF1 OF VAMDLBNSL1-R TO YL0116 OF
                 WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
           END-IF
      *==============================================================
           CONTINUE.
       SB3EXIT.
           EXIT.
      /EJECT
       SB4RVGN SECTION.
      *==============================================================
      *    Rtv Rtn Latest Brand Mdl - Bonus Sls-RIC Mdl Dsp Seq  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    SCP Model Code
           MOVE OSSTMDLSCP OF FDOTEGL OF SBDOTEXTL7-R TO O9SCMDLCDE OF
             KRSSB4
      *    Initialise Full Externally Described Keylist
      *    SCP Model Code
           MOVE LOW-VALUES TO O9SCMDLCDE OF EXTSB4
      *    Bns RIC Config Year
           MOVE 9999 TO O9BNSRICYR OF EXTSB4
      *    Bns RIC Display Sequence
           MOVE -999 TO O9BNSRICSQ OF EXTSB4
           MOVE CORRESPONDING
             EXTSB4 TO
             SBRICDSQF4 OF SBRICDSQL4-R
           MOVE CORRESPONDING
             KRSSB4 TO
             SBRICDSQF4 OF SBRICDSQL4-R
           START SBRICDSQL4 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'SBRICDSQF4'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ SBRICDSQL4 NEXT
             FORMAT IS 'SBRICDSQF4'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     SBRICDSQF4 OF SBRICDSQL4-R TO
                     EXTSB4
                   MOVE EXTSB4 TO KRSSB4-TMP
                   IF (KRSSB4 NOT = KRSSB4-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    SCP Model Code
           MOVE LOW-VALUES TO O9SCMDLCDE OF EXTSB4
      *    Bns RIC Config Year
           MOVE 9999 TO O9BNSRICYR OF EXTSB4
      *    Bns RIC Display Sequence
           MOVE -999 TO O9BNSRICSQ OF EXTSB4
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR7404' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Bns Brand Name
               MOVE SPACES TO YL0118 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SB4EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Bns Brand Name
               MOVE O9BNSBRNDD OF SBRICDSQF4 OF SBRICDSQL4-R TO YL0118
                 OF WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
      *        *QUIT
               GO SB4EXIT
               SET C-INDICATOR-OFF(90) TO TRUE
               READ SBRICDSQL4 NEXT
                 FORMAT IS 'SBRICDSQF4'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         SBRICDSQF4 OF SBRICDSQL4-R TO
                         EXTSB4
                       MOVE EXTSB4 TO KRSSB4-TMP
                       IF (KRSSB4 NOT = KRSSB4-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        SCP Model Code
               MOVE LOW-VALUES TO O9SCMDLCDE OF EXTSB4
      *        Bns RIC Config Year
               MOVE 9999 TO O9BNSRICYR OF EXTSB4
      *        Bns RIC Display Sequence
               MOVE -999 TO O9BNSRICSQ OF EXTSB4
           END-PERFORM
      *==============================================================
           CONTINUE.
       SB4EXIT.
           EXIT.
      /EJECT
       SB5RVGN SECTION.
      *==============================================================
      *    Rtv All Dtl by Dlr/Mdl/ON - OBT Extract  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    Dealer number (Num key)
           MOVE YL0108 OF WORK-CONTEXT TO Q2DLRNOKEY OF KRSSB5
      *    BDC Model
           MOVE OSSTMDLSCP OF FDOTEGL OF SBDOTEXTL7-R TO Q2BDCM OF
             KRSSB5
      *    BDC Customer Order Number
           MOVE OSNUCO OF FDOTEGL OF SBDOTEXTL7-R TO Q2BDCCON OF KRSSB5
      *    Initialise Full Externally Described Keylist
      *    Dealer number (Num key)
           MOVE -99999 TO Q2DLRNOKEY OF EXTSB5
      *    BDC Model
           MOVE LOW-VALUES TO Q2BDCM OF EXTSB5
      *    BDC Customer Order Number
           MOVE LOW-VALUES TO Q2BDCCON OF EXTSB5
           MOVE CORRESPONDING
             EXTSB5 TO
             FOBEXCB OF RAOBEXTRL2-R
           MOVE CORRESPONDING
             KRSSB5 TO
             FOBEXCB OF RAOBEXTRL2-R
           START RAOBEXTRL2 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'FOBEXCB'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ RAOBEXTRL2 NEXT
             FORMAT IS 'FOBEXCB'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     FOBEXCB OF RAOBEXTRL2-R TO
                     EXTSB5
                   MOVE EXTSB5 TO KRSSB5-TMP
                   IF (KRSSB5 NOT = KRSSB5-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    Dealer number (Num key)
           MOVE -99999 TO Q2DLRNOKEY OF EXTSB5
      *    BDC Model
           MOVE LOW-VALUES TO Q2BDCM OF EXTSB5
      *    BDC Customer Order Number
           MOVE LOW-VALUES TO Q2BDCCON OF EXTSB5
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR5706' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Fleet Operator Number
               MOVE SPACES TO YL0121 OF WORK-CONTEXT
      *        BDC Payment Term
               MOVE SPACES TO YL0122 OF WORK-CONTEXT
      *        OBT Count Target Status
               MOVE SPACES TO YL0117 OF WORK-CONTEXT
      *        Fleet Programmes Code
               MOVE SPACES TO YL0119 OF WORK-CONTEXT
      *        Target Market
               MOVE SPACES TO YL0123 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SB5EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Fleet Operator Number
               MOVE Q2FLOPNO OF FOBEXCB OF RAOBEXTRL2-R TO YL0121 OF
                 WORK-CONTEXT
      *        BDC Payment Term
               MOVE Q2BDCPTRM OF FOBEXCB OF RAOBEXTRL2-R TO YL0122 OF
                 WORK-CONTEXT
      *        OBT Count Target Status
               MOVE Q2CNTTARG OF FOBEXCB OF RAOBEXTRL2-R TO YL0117 OF
                 WORK-CONTEXT
      *        Fleet Programmes Code
               MOVE Q2FLPGMCDE OF FOBEXCB OF RAOBEXTRL2-R TO YL0119 OF
                 WORK-CONTEXT
      *        Target Market
               MOVE Q2TGTMRKET OF FOBEXCB OF RAOBEXTRL2-R TO YL0123 OF
                 WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
      *        *QUIT
               GO SB5EXIT
               SET C-INDICATOR-OFF(90) TO TRUE
               READ RAOBEXTRL2 NEXT
                 FORMAT IS 'FOBEXCB'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         FOBEXCB OF RAOBEXTRL2-R TO
                         EXTSB5
                       MOVE EXTSB5 TO KRSSB5-TMP
                       IF (KRSSB5 NOT = KRSSB5-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        Dealer number (Num key)
               MOVE -99999 TO Q2DLRNOKEY OF EXTSB5
      *        BDC Model
               MOVE LOW-VALUES TO Q2BDCM OF EXTSB5
      *        BDC Customer Order Number
               MOVE LOW-VALUES TO Q2BDCCON OF EXTSB5
           END-PERFORM
      *==============================================================
           CONTINUE.
       SB5EXIT.
           EXIT.
      /EJECT
       SB6RVGN SECTION.
      *==============================================================
      *    Rtv No of Regs Derg TCTT - BDC.-.SEDRE DOT Extract  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    USER: Initialize routine
      *    Cvt *Job date to DTX
      *    * Job date contains a leading 1 when the year is 2000 or
      *      greater
      *    U:Job Date DTX
           ADD ZZJDT OF JOB-CONTEXT, 19000000 GIVING YL0131 OF
             WORK-CONTEXT
      *    Utl Cvt Dealer 6 to 5N
           MOVE 5 TO YRSW03
           MOVE 2 TO YRSW02
           IF (YRSW02 NOT > 0 OR
               YRSW03 NOT > 0 OR
               YRSW02 > 00006 OR
               YRSW03 > 00006) THEN
               MOVE 'Y2U0510' TO W0RTN
           ELSE
               MOVE WUNECO OF WORK-CONTEXT TO W0STRNG
               MOVE W0STRNG(YRSW02:YRSW03) TO WUUCODE5 OF WORK-CONTEXT
           END-IF
           IF (WUUCODE5 OF WORK-CONTEXT = SPACES) THEN
               MOVE ZERO TO YL0132 OF WORK-CONTEXT
           ELSE
               MOVE WUUCODE5 OF WORK-CONTEXT TO YL0132 OF WORK-CONTEXT
           END-IF
      *    U:Pay Cat 1 De-Regs
           MOVE ZEROS TO YL0124 OF WORK-CONTEXT
      *    U:Pay Cat 1 De-Regs
           MOVE ZEROS TO YL0133 OF WORK-CONTEXT
      *    U:Pay Cat 2 De-Regs
           MOVE ZEROS TO YL0125 OF WORK-CONTEXT
      *    U:Pay Cat 2 De-Regs
           MOVE ZEROS TO YL0134 OF WORK-CONTEXT
      *    U:Pay Cat 3 De-Regs
           MOVE ZEROS TO YL0126 OF WORK-CONTEXT
      *    U:Pay Cat 3 De-Regs
           MOVE ZEROS TO YL0135 OF WORK-CONTEXT
      *    U:Pay Cat 4 De-Regs
           MOVE ZEROS TO YL0127 OF WORK-CONTEXT
      *    U:Pay Cat 4 De-Regs
           MOVE ZEROS TO YL0136 OF WORK-CONTEXT
      *    U:Pay Cat 5 De-Regs
           MOVE ZEROS TO YL0128 OF WORK-CONTEXT
      *    U:Pay Cat 5 De-Regs
           MOVE ZEROS TO YL0137 OF WORK-CONTEXT
      *    U:Pay Cat N De-Regs
           MOVE ZEROS TO YL0129 OF WORK-CONTEXT
      *    U:Pay Cat N De-Regs
           MOVE ZEROS TO YL0138 OF WORK-CONTEXT
      *    U:Pay Cat O De-Regs
           MOVE ZEROS TO YL0130 OF WORK-CONTEXT
      *    U:Pay Cat O De-Regs
           MOVE ZEROS TO YL0139 OF WORK-CONTEXT
      *    Setup key
      *    CONCES PROPRIETAIRE
           MOVE WUNECO OF WORK-CONTEXT TO OSNECO OF KPSSB6
      *    De-reg Date NBR
           MOVE WUUFRMDTXB OF WORK-CONTEXT TO OSZXNU OF KPSSB6
           MOVE CORRESPONDING KPSSB6 TO KRSSB6
      *    Initialise Full Externally Described Keylist
      *    CONCES PROPRIETAIRE
           MOVE LOW-VALUES TO OSNECO OF EXTSB6
      *    De-reg Date NBR
           MOVE -99999999 TO OSZXNU OF EXTSB6
           MOVE CORRESPONDING
             EXTSB6 TO
             FDOTEGM OF SBDOTEXTL8-R
           MOVE CORRESPONDING
             KPSSB6 TO
             FDOTEGM OF SBDOTEXTL8-R
           START SBDOTEXTL8 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'FDOTEGM'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ SBDOTEXTL8 NEXT
             FORMAT IS 'FDOTEGM'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     FDOTEGM OF SBDOTEXTL8-R TO
                     EXTSB6
                   MOVE EXTSB6 TO KRSSB6-TMP
                   IF (KRSSB6 NOT = KRSSB6-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    CONCES PROPRIETAIRE
           MOVE LOW-VALUES TO OSNECO OF EXTSB6
      *    De-reg Date NBR
           MOVE -99999999 TO OSZXNU OF EXTSB6
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR5554' TO W0RTN
           END-IF
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        Count number of de-regs for the Model
      *        CASE: DB1.De-reg Date NBR LE PAR.U:Number (8.0)
      *        *IF
               IF (OSZXNU OF FDOTEGM OF SBDOTEXTL8-R NOT > WUUTODTXB OF
                 WORK-CONTEXT) THEN
      *            Include this one?
      *            CASE: DB1.De-reg Date NBR is NE Zero
      *            *IF
                   IF (OSZXNU OF FDOTEGM OF SBDOTEXTL8-R NOT = 0) THEN
      *                Car/Van Indicator
                       MOVE ' ' TO YL0140 OF WORK-CONTEXT
      *                OBT Count Target Status
                       MOVE ' ' TO YL0141 OF WORK-CONTEXT
      *                Rtv Car or Van SCP Mdl - Vehicle Model Bonus
      *                  Atr  *
                       PERFORM SB7RVGN
      *                Rtv Rtn Latest Brand Mdl - Bonus Sls-RIC Mdl
      *                  Dsp Seq  *
                       PERFORM SB8RVGN
      *                Fleet Programmes Code
                       MOVE SPACES TO YL0143 OF WORK-CONTEXT
                       MOVE ' ' TO YL0143 OF WORK-CONTEXT
      *                U:Continue
                       MOVE 'Y' TO YL0144 OF WORK-CONTEXT
      *                Rtv First Dtls for Chass - OBT Extract  *
                       PERFORM SB9RVGN
      *                Check Target Type Deselection
      *                CASE: PAR.U:Target Prefix is Target total
      *                *IF
                       IF ('TT' = 'TT') THEN
                           CONTINUE
                       ELSE
      *                    CASE: PAR.U:Target Prefix is Target Local
      *                      Market
      *                    *IF
                           IF ('TT' = 'TL') THEN
      *                        CASE: LCL.Target Market is Local Market
      *                          Target List
      *                        *IF
                               IF (YL0147 OF WORK-CONTEXT = 'L' OR
                                   YL0147 OF WORK-CONTEXT = 'W' OR
                                   YL0147 OF WORK-CONTEXT = 'R') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0144 OF WORK-CONTEXT
                               END-IF
                           ELSE
      *                        CASE: PAR.U:Target Prefix is Target
      *                          Major Fleet
      *                        *IF
                               IF ('TT' = 'TM') THEN
      *                        CASE: LCL.Target Market is Major Fleet
      *                          Target
      *                        *IF
                               IF (YL0147 OF WORK-CONTEXT = 'M') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0144 OF WORK-CONTEXT
                               END-IF
                               ELSE
      *                        CASE: PAR.U:Target Prefix is Target not
      *                          fleet
      *                        *IF
                               IF ('TT' = 'TN') THEN
      *                        CASE:
      *                        - c1 OR c2
      *                        |- c1    : LCL.Fleet Programmes Code is
      *                          *Blank
      *                        |- c2    : LCL.Fleet Programmes Code is
      *                          UNS - Unsupported (30286)
      *                        '-
      *                        *IF
                               IF (YL0143 OF WORK-CONTEXT = ' ' OR
                                   YL0143 OF WORK-CONTEXT = 'UNS') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0144 OF WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
      *                If O.K. to Continue - Following Record
      *                  Deselection
      *                CASE: LCL.U:Continue is Yes
      *                *IF
                       IF (YL0144 OF WORK-CONTEXT = 'Y') THEN
      *                    CASE: LCL.OBT Count Target Status is
      *                      Payment Category 1
      *                    *IF
                           IF (YL0141 OF WORK-CONTEXT = '1') THEN
      *                        U:Pay Cat 1 De-Regs
                               ADD YL0133 OF WORK-CONTEXT, 1 GIVING
                                 YL0133 OF WORK-CONTEXT
                           ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 2
      *                        *IF
                               IF (YL0141 OF WORK-CONTEXT = '2') THEN
      *                        U:Pay Cat 2 De-Regs
                               ADD YL0134 OF WORK-CONTEXT, 1 GIVING
                                 YL0134 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 3
      *                        *IF
                               IF (YL0141 OF WORK-CONTEXT = '3') THEN
      *                        U:Pay Cat 3 De-Regs
                               ADD YL0135 OF WORK-CONTEXT, 1 GIVING
                                 YL0135 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 4
      *                        *IF
                               IF (YL0141 OF WORK-CONTEXT = '4') THEN
      *                        U:Pay Cat 4 De-Regs
                               ADD YL0136 OF WORK-CONTEXT, 1 GIVING
                                 YL0136 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 5
      *                        *IF
                               IF (YL0141 OF WORK-CONTEXT = '5') THEN
      *                        U:Pay Cat 5 De-Regs
                               ADD YL0137 OF WORK-CONTEXT, 1 GIVING
                                 YL0137 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category N - New
      *                        *IF
                               IF (YL0141 OF WORK-CONTEXT = 'N') THEN
      *                        U:Pay Cat N De-Regs
                               ADD YL0138 OF WORK-CONTEXT, 1 GIVING
                                 YL0138 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
      *                        CASE: LCL.Bns Brand Name is RENAULT
      *                        *IF
                               IF (YL0142 OF WORK-CONTEXT = 'RENAULT')
                                 THEN
      *                        U:Pay Cat 5 De-Regs
                               ADD YL0137 OF WORK-CONTEXT, 1 GIVING
                                 YL0137 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Pay Cat O De-Regs
                               ADD YL0139 OF WORK-CONTEXT, 1 GIVING
                                 YL0139 OF WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
                   END-IF
               END-IF
               SET C-INDICATOR-OFF(90) TO TRUE
               READ SBDOTEXTL8 NEXT
                 FORMAT IS 'FDOTEGM'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         FDOTEGM OF SBDOTEXTL8-R TO
                         EXTSB6
                       MOVE EXTSB6 TO KRSSB6-TMP
                       IF (KRSSB6 NOT = KRSSB6-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        CONCES PROPRIETAIRE
               MOVE LOW-VALUES TO OSNECO OF EXTSB6
      *        De-reg Date NBR
               MOVE -99999999 TO OSZXNU OF EXTSB6
           END-PERFORM
      *    USER: Exit processing
      *    U:Pay Cat 1 De-Regs
           MOVE YL0133 OF WORK-CONTEXT TO YL0124 OF WORK-CONTEXT
      *    U:Pay Cat 2 De-Regs
           MOVE YL0134 OF WORK-CONTEXT TO YL0125 OF WORK-CONTEXT
      *    U:Pay Cat 3 De-Regs
           MOVE YL0135 OF WORK-CONTEXT TO YL0126 OF WORK-CONTEXT
      *    U:Pay Cat 4 De-Regs
           MOVE YL0136 OF WORK-CONTEXT TO YL0127 OF WORK-CONTEXT
      *    U:Pay Cat 5 De-Regs
           MOVE YL0137 OF WORK-CONTEXT TO YL0128 OF WORK-CONTEXT
      *    U:Pay Cat N De-Regs
           MOVE YL0138 OF WORK-CONTEXT TO YL0129 OF WORK-CONTEXT
      *    U:Pay Cat O De-Regs
           MOVE YL0139 OF WORK-CONTEXT TO YL0130 OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       SB6EXIT.
           EXIT.
      /EJECT
       SB7RVGN SECTION.
      *==============================================================
      *    Rtv Car or Van SCP Mdl - Vehicle Model Bonus Atr  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    USER: Initialize routine
      *    Car/Van Indicator
           MOVE 'C' TO YL0140 OF WORK-CONTEXT
      *    Setup key
      *    Model Application Code
           MOVE 'RIC' TO LLMDLAPPCD OF KRSSB7
      *    SCP Model Code
           MOVE OSSTMDLSCP OF FDOTEGM OF SBDOTEXTL8-R TO LLSCMDLCDE OF
             KRSSB7
      *    Initialise Full Externally Described Keylist
      *    Model Application Code
           MOVE LOW-VALUES TO LLMDLAPPCD OF EXTSB7
      *    SCP Model Code
           MOVE LOW-VALUES TO LLSCMDLCDE OF EXTSB7
           MOVE CORRESPONDING
             KRSSB7 TO
             VAMDLBNSF1 OF VAMDLBNSL1-R
           SET C-INDICATOR-OFF(90) TO TRUE
           READ VAMDLBNSL1
             FORMAT IS 'VAMDLBNSF1'
           END-READ
           IF (C-NO-RECORD) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               END-IF
           END-IF
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR7127' TO W0RTN
      *        USER: Processing if Data record not found
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SB7EXIT
           END-IF
      *
           IF (C-INDICATOR-OFF(90)) THEN
      *        USER: Process Data record
      *        Car/Van Indicator
               MOVE LLCORV OF VAMDLBNSF1 OF VAMDLBNSL1-R TO YL0140 OF
                 WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
           END-IF
      *==============================================================
           CONTINUE.
       SB7EXIT.
           EXIT.
      /EJECT
       SB8RVGN SECTION.
      *==============================================================
      *    Rtv Rtn Latest Brand Mdl - Bonus Sls-RIC Mdl Dsp Seq  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    SCP Model Code
           MOVE OSSTMDLSCP OF FDOTEGM OF SBDOTEXTL8-R TO O9SCMDLCDE OF
             KRSSB8
      *    Initialise Full Externally Described Keylist
      *    SCP Model Code
           MOVE LOW-VALUES TO O9SCMDLCDE OF EXTSB8
      *    Bns RIC Config Year
           MOVE 9999 TO O9BNSRICYR OF EXTSB8
      *    Bns RIC Display Sequence
           MOVE -999 TO O9BNSRICSQ OF EXTSB8
           MOVE CORRESPONDING
             EXTSB8 TO
             SBRICDSQF4 OF SBRICDSQL4-R
           MOVE CORRESPONDING
             KRSSB8 TO
             SBRICDSQF4 OF SBRICDSQL4-R
           START SBRICDSQL4 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'SBRICDSQF4'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ SBRICDSQL4 NEXT
             FORMAT IS 'SBRICDSQF4'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     SBRICDSQF4 OF SBRICDSQL4-R TO
                     EXTSB8
                   MOVE EXTSB8 TO KRSSB8-TMP
                   IF (KRSSB8 NOT = KRSSB8-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    SCP Model Code
           MOVE LOW-VALUES TO O9SCMDLCDE OF EXTSB8
      *    Bns RIC Config Year
           MOVE 9999 TO O9BNSRICYR OF EXTSB8
      *    Bns RIC Display Sequence
           MOVE -999 TO O9BNSRICSQ OF EXTSB8
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR7404' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Bns Brand Name
               MOVE SPACES TO YL0142 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SB8EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Bns Brand Name
               MOVE O9BNSBRNDD OF SBRICDSQF4 OF SBRICDSQL4-R TO YL0142
                 OF WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
      *        *QUIT
               GO SB8EXIT
               SET C-INDICATOR-OFF(90) TO TRUE
               READ SBRICDSQL4 NEXT
                 FORMAT IS 'SBRICDSQF4'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         SBRICDSQF4 OF SBRICDSQL4-R TO
                         EXTSB8
                       MOVE EXTSB8 TO KRSSB8-TMP
                       IF (KRSSB8 NOT = KRSSB8-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        SCP Model Code
               MOVE LOW-VALUES TO O9SCMDLCDE OF EXTSB8
      *        Bns RIC Config Year
               MOVE 9999 TO O9BNSRICYR OF EXTSB8
      *        Bns RIC Display Sequence
               MOVE -999 TO O9BNSRICSQ OF EXTSB8
           END-PERFORM
      *==============================================================
           CONTINUE.
       SB8EXIT.
           EXIT.
      /EJECT
       SB9RVGN SECTION.
      *==============================================================
      *    Rtv First Dtls for Chass - OBT Extract  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    Chassis number
           MOVE OSYPTX OF FDOTEGM OF SBDOTEXTL8-R TO Q2ASXX OF KRSSB9
      *    Initialise Full Externally Described Keylist
      *    Chassis number
           MOVE LOW-VALUES TO Q2ASXX OF EXTSB9
           MOVE CORRESPONDING
             EXTSB9 TO
             RAOBEXTRF4 OF RAOBEXTRL4-R
           MOVE CORRESPONDING
             KRSSB9 TO
             RAOBEXTRF4 OF RAOBEXTRL4-R
           START RAOBEXTRL4 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'RAOBEXTRF4'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ RAOBEXTRL4 NEXT
             FORMAT IS 'RAOBEXTRF4'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     RAOBEXTRF4 OF RAOBEXTRL4-R TO
                     EXTSB9
                   MOVE EXTSB9 TO KRSSB9-TMP
                   IF (KRSSB9 NOT = KRSSB9-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    Chassis number
           MOVE LOW-VALUES TO Q2ASXX OF EXTSB9
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR5706' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Fleet Operator Number
               MOVE SPACES TO YL0145 OF WORK-CONTEXT
      *        BDC Payment Term
               MOVE SPACES TO YL0146 OF WORK-CONTEXT
      *        OBT Count Target Status
               MOVE SPACES TO YL0141 OF WORK-CONTEXT
      *        Fleet Programmes Code
               MOVE SPACES TO YL0143 OF WORK-CONTEXT
      *        Target Market
               MOVE SPACES TO YL0147 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SB9EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Fleet Operator Number
               MOVE Q2FLOPNO OF RAOBEXTRF4 OF RAOBEXTRL4-R TO YL0145 OF
                 WORK-CONTEXT
      *        BDC Payment Term
               MOVE Q2BDCPTRM OF RAOBEXTRF4 OF RAOBEXTRL4-R TO YL0146
                 OF WORK-CONTEXT
      *        OBT Count Target Status
               MOVE Q2CNTTARG OF RAOBEXTRF4 OF RAOBEXTRL4-R TO YL0141
                 OF WORK-CONTEXT
      *        Fleet Programmes Code
               MOVE Q2FLPGMCDE OF RAOBEXTRF4 OF RAOBEXTRL4-R TO YL0143
                 OF WORK-CONTEXT
      *        Target Market
               MOVE Q2TGTMRKET OF RAOBEXTRF4 OF RAOBEXTRL4-R TO YL0147
                 OF WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
      *        *QUIT
               GO SB9EXIT
               SET C-INDICATOR-OFF(90) TO TRUE
               READ RAOBEXTRL4 NEXT
                 FORMAT IS 'RAOBEXTRF4'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         RAOBEXTRF4 OF RAOBEXTRL4-R TO
                         EXTSB9
                       MOVE EXTSB9 TO KRSSB9-TMP
                       IF (KRSSB9 NOT = KRSSB9-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        Chassis number
               MOVE LOW-VALUES TO Q2ASXX OF EXTSB9
           END-PERFORM
      *==============================================================
           CONTINUE.
       SB9EXIT.
           EXIT.
      /EJECT
       SC1RVGN SECTION.
      *==============================================================
      *    Rtv No of Regs TCTT - BDC.-.SEDRE DOT Extract  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    USER: Initialize routine
      *    Cvt *Job date to DTX
      *    * Job date contains a leading 1 when the year is 2000 or
      *      greater
      *    U:Job Date DTX
           ADD ZZJDT OF JOB-CONTEXT, 19000000 GIVING YL0107 OF
             WORK-CONTEXT
      *    Utl Cvt Dealer 6 to 5N
           MOVE 5 TO YRSW03
           MOVE 2 TO YRSW02
           IF (YRSW02 NOT > 0 OR
               YRSW03 NOT > 0 OR
               YRSW02 > 00006 OR
               YRSW03 > 00006) THEN
               MOVE 'Y2U0510' TO W0RTN
           ELSE
               MOVE WUTOCF OF WORK-CONTEXT TO W0STRNG
               MOVE W0STRNG(YRSW02:YRSW03) TO WUUCODE5 OF WORK-CONTEXT
           END-IF
           IF (WUUCODE5 OF WORK-CONTEXT = SPACES) THEN
               MOVE ZERO TO YL0108 OF WORK-CONTEXT
           ELSE
               MOVE WUUCODE5 OF WORK-CONTEXT TO YL0108 OF WORK-CONTEXT
           END-IF
      *    U:Pay Cat 1 Regs
           MOVE ZEROS TO YL0148 OF WORK-CONTEXT
      *    U:Pay Cat 1 Regs
           MOVE ZEROS TO YL0109 OF WORK-CONTEXT
      *    U:Pay Cat 2 Regs
           MOVE ZEROS TO YL0149 OF WORK-CONTEXT
      *    U:Pay Cat 2 Regs
           MOVE ZEROS TO YL0110 OF WORK-CONTEXT
      *    U:Pay Cat 3 Regs
           MOVE ZEROS TO YL0150 OF WORK-CONTEXT
      *    U:Pay Cat 3 Regs
           MOVE ZEROS TO YL0111 OF WORK-CONTEXT
      *    U:Pay Cat 4 Regs
           MOVE ZEROS TO YL0151 OF WORK-CONTEXT
      *    U:Pay Cat 4 Regs
           MOVE ZEROS TO YL0112 OF WORK-CONTEXT
      *    U:Pay Cat 5 Regs
           MOVE ZEROS TO YL0152 OF WORK-CONTEXT
      *    U:Pay Cat 5 Regs
           MOVE ZEROS TO YL0113 OF WORK-CONTEXT
      *    U:Pay Cat N Regs
           MOVE ZEROS TO YL0153 OF WORK-CONTEXT
      *    U:Pay Cat N Regs
           MOVE ZEROS TO YL0114 OF WORK-CONTEXT
      *    U:Pay Cat O Regs
           MOVE ZEROS TO YL0154 OF WORK-CONTEXT
      *    U:Pay Cat O Regs
           MOVE ZEROS TO YL0115 OF WORK-CONTEXT
      *    Setup key
      *    CONCES PROPRIETAIRE
           MOVE WUTOCF OF WORK-CONTEXT TO OSNECO OF KPSSC1
      *    DATE 58 IMMATRICULATION
           MOVE WUUFRMDTXB OF WORK-CONTEXT TO OSW0NB OF KPSSC1
           MOVE CORRESPONDING KPSSC1 TO KRSSC1
      *    Initialise Full Externally Described Keylist
      *    CONCES PROPRIETAIRE
           MOVE LOW-VALUES TO OSNECO OF EXTSC1
      *    DATE 58 IMMATRICULATION
           MOVE -99999999 TO OSW0NB OF EXTSC1
      *    COMMANDE CLIENT
           MOVE LOW-VALUES TO OSNUCO OF EXTSC1
           MOVE CORRESPONDING
             EXTSC1 TO
             FDOTEGL OF SBDOTEXTL7-R
           MOVE CORRESPONDING
             KPSSC1 TO
             FDOTEGL OF SBDOTEXTL7-R
           START SBDOTEXTL7 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'FDOTEGL'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ SBDOTEXTL7 NEXT
             FORMAT IS 'FDOTEGL'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     FDOTEGL OF SBDOTEXTL7-R TO
                     EXTSC1
                   MOVE EXTSC1 TO KRSSC1-TMP
                   IF (KRSSC1 NOT = KRSSC1-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    CONCES PROPRIETAIRE
           MOVE LOW-VALUES TO OSNECO OF EXTSC1
      *    DATE 58 IMMATRICULATION
           MOVE -99999999 TO OSW0NB OF EXTSC1
      *    COMMANDE CLIENT
           MOVE LOW-VALUES TO OSNUCO OF EXTSC1
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR5554' TO W0RTN
           END-IF
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        Count number of registrations for the Model
      *        CASE: DB1.DATE 58 IMMATRICULATION LE PAR.U:Number (8.0)
      *        *IF
               IF (OSW0NB OF FDOTEGL OF SBDOTEXTL7-R NOT > WUUTODTXB OF
                 WORK-CONTEXT) THEN
      *            Include this one?
      *            CASE: DB1.DATE 58 IMMATRICULATION is NE Zero
      *            *IF
                   IF (OSW0NB OF FDOTEGL OF SBDOTEXTL7-R NOT = 0) THEN
      *                Car/Van Indicator
                       MOVE ' ' TO YL0116 OF WORK-CONTEXT
      *                OBT Count Target Status
                       MOVE ' ' TO YL0117 OF WORK-CONTEXT
      *                Rtv Car or Van SCP Mdl - Vehicle Model Bonus
      *                  Atr  *
                       PERFORM SC2RVGN
      *                Rtv Rtn Latest Brand Mdl - Bonus Sls-RIC Mdl
      *                  Dsp Seq  *
                       PERFORM SC3RVGN
      *                Fleet Programmes Code
                       MOVE SPACES TO YL0119 OF WORK-CONTEXT
                       MOVE ' ' TO YL0119 OF WORK-CONTEXT
      *                U:Continue
                       MOVE 'Y' TO YL0120 OF WORK-CONTEXT
      *                Rtv All Dtl by Dlr/Mdl/ON - OBT Extract  *
                       PERFORM SC4RVGN
      *                Check Target Type Deselection
      *                CASE: PAR.U:Target Prefix is Target total
      *                *IF
                       IF ('TT' = 'TT') THEN
                           CONTINUE
                       ELSE
      *                    CASE: PAR.U:Target Prefix is Target Local
      *                      Market
      *                    *IF
                           IF ('TT' = 'TL') THEN
      *                        CASE: LCL.Target Market is Local Market
      *                          Target List
      *                        *IF
                               IF (YL0123 OF WORK-CONTEXT = 'L' OR
                                   YL0123 OF WORK-CONTEXT = 'W' OR
                                   YL0123 OF WORK-CONTEXT = 'R') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0120 OF WORK-CONTEXT
                               END-IF
                           ELSE
      *                        CASE: PAR.U:Target Prefix is Target
      *                          Major Fleet
      *                        *IF
                               IF ('TT' = 'TM') THEN
      *                        CASE: LCL.Target Market is Major Fleet
      *                          Target
      *                        *IF
                               IF (YL0123 OF WORK-CONTEXT = 'M') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0120 OF WORK-CONTEXT
                               END-IF
                               ELSE
      *                        CASE: PAR.U:Target Prefix is Target not
      *                          fleet
      *                        *IF
                               IF ('TT' = 'TN') THEN
      *                        CASE:
      *                        - c1 OR c2
      *                        |- c1    : LCL.Fleet Programmes Code is
      *                          *Blank
      *                        |- c2    : LCL.Fleet Programmes Code is
      *                          UNS - Unsupported (30286)
      *                        '-
      *                        *IF
                               IF (YL0119 OF WORK-CONTEXT = ' ' OR
                                   YL0119 OF WORK-CONTEXT = 'UNS') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0120 OF WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
      *                If O.K. to Continue - Following Record
      *                  Deselection
      *                CASE: LCL.U:Continue is Yes
      *                *IF
                       IF (YL0120 OF WORK-CONTEXT = 'Y') THEN
      *                    CASE: DB1.De-reg Date NBR is NE Zero
      *                    *IF
                           IF (OSZXNU OF FDOTEGL OF SBDOTEXTL7-R NOT =
                             0) THEN
      *                        For De-Regs
      *                        CASE:
      *                        - c1 OR c2
      *                        |- c1    : LCL.OBT Count Target Status
      *                          is In Target List
      *                        |- c2    : LCL.Bns Brand Name is RENAULT
      *                        '-
      *                        *IF
                               IF ((YL0117 OF WORK-CONTEXT = 'I' OR
                                    YL0117 OF WORK-CONTEXT = '1' OR
                                    YL0117 OF WORK-CONTEXT = '2' OR
                                    YL0117 OF WORK-CONTEXT = '3' OR
                                    YL0117 OF WORK-CONTEXT = '4' OR
                                    YL0117 OF WORK-CONTEXT = '5' OR
                                    YL0117 OF WORK-CONTEXT = 'N') OR
                                   YL0118 OF WORK-CONTEXT = 'RENAULT')
                                 THEN
      *                        U:Pay Cat 5 Regs
                               ADD YL0113 OF WORK-CONTEXT, 1 GIVING
                                 YL0113 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Pay Cat O Regs
                               ADD YL0115 OF WORK-CONTEXT, 1 GIVING
                                 YL0115 OF WORK-CONTEXT
                               END-IF
                           ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 1
      *                        *IF
                               IF (YL0117 OF WORK-CONTEXT = '1') THEN
      *                        U:Pay Cat 1 Regs
                               ADD YL0109 OF WORK-CONTEXT, 1 GIVING
                                 YL0109 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 2
      *                        *IF
                               IF (YL0117 OF WORK-CONTEXT = '2') THEN
      *                        U:Pay Cat 2 Regs
                               ADD YL0110 OF WORK-CONTEXT, 1 GIVING
                                 YL0110 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 3
      *                        *IF
                               IF (YL0117 OF WORK-CONTEXT = '3') THEN
      *                        U:Pay Cat 3 Regs
                               ADD YL0111 OF WORK-CONTEXT, 1 GIVING
                                 YL0111 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 4
      *                        *IF
                               IF (YL0117 OF WORK-CONTEXT = '4') THEN
      *                        U:Pay Cat 4 Regs
                               ADD YL0112 OF WORK-CONTEXT, 1 GIVING
                                 YL0112 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 5
      *                        *IF
                               IF (YL0117 OF WORK-CONTEXT = '5') THEN
      *                        U:Pay Cat 5 Regs
                               ADD YL0113 OF WORK-CONTEXT, 1 GIVING
                                 YL0113 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category N - New
      *                        *IF
                               IF (YL0117 OF WORK-CONTEXT = 'N') THEN
      *                        U:Pay Cat N Regs
                               ADD YL0114 OF WORK-CONTEXT, 1 GIVING
                                 YL0114 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Pay Cat O Regs
                               ADD YL0115 OF WORK-CONTEXT, 1 GIVING
                                 YL0115 OF WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
                   END-IF
               END-IF
               SET C-INDICATOR-OFF(90) TO TRUE
               READ SBDOTEXTL7 NEXT
                 FORMAT IS 'FDOTEGL'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         FDOTEGL OF SBDOTEXTL7-R TO
                         EXTSC1
                       MOVE EXTSC1 TO KRSSC1-TMP
                       IF (KRSSC1 NOT = KRSSC1-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        CONCES PROPRIETAIRE
               MOVE LOW-VALUES TO OSNECO OF EXTSC1
      *        DATE 58 IMMATRICULATION
               MOVE -99999999 TO OSW0NB OF EXTSC1
      *        COMMANDE CLIENT
               MOVE LOW-VALUES TO OSNUCO OF EXTSC1
           END-PERFORM
      *    USER: Exit processing
      *    U:Pay Cat 1 Regs
           MOVE YL0109 OF WORK-CONTEXT TO YL0148 OF WORK-CONTEXT
      *    U:Pay Cat 2 Regs
           MOVE YL0110 OF WORK-CONTEXT TO YL0149 OF WORK-CONTEXT
      *    U:Pay Cat 3 Regs
           MOVE YL0111 OF WORK-CONTEXT TO YL0150 OF WORK-CONTEXT
      *    U:Pay Cat 4 Regs
           MOVE YL0112 OF WORK-CONTEXT TO YL0151 OF WORK-CONTEXT
      *    U:Pay Cat 5 Regs
           MOVE YL0113 OF WORK-CONTEXT TO YL0152 OF WORK-CONTEXT
      *    U:Pay Cat N Regs
           MOVE YL0114 OF WORK-CONTEXT TO YL0153 OF WORK-CONTEXT
      *    U:Pay Cat O Regs
           MOVE YL0115 OF WORK-CONTEXT TO YL0154 OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       SC1EXIT.
           EXIT.
      /EJECT
       SC2RVGN SECTION.
      *==============================================================
      *    Rtv Car or Van SCP Mdl - Vehicle Model Bonus Atr  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    USER: Initialize routine
      *    Car/Van Indicator
           MOVE 'C' TO YL0116 OF WORK-CONTEXT
      *    Setup key
      *    Model Application Code
           MOVE 'RIC' TO LLMDLAPPCD OF KRSSC2
      *    SCP Model Code
           MOVE OSSTMDLSCP OF FDOTEGL OF SBDOTEXTL7-R TO LLSCMDLCDE OF
             KRSSC2
      *    Initialise Full Externally Described Keylist
      *    Model Application Code
           MOVE LOW-VALUES TO LLMDLAPPCD OF EXTSC2
      *    SCP Model Code
           MOVE LOW-VALUES TO LLSCMDLCDE OF EXTSC2
           MOVE CORRESPONDING
             KRSSC2 TO
             VAMDLBNSF1 OF VAMDLBNSL1-R
           SET C-INDICATOR-OFF(90) TO TRUE
           READ VAMDLBNSL1
             FORMAT IS 'VAMDLBNSF1'
           END-READ
           IF (C-NO-RECORD) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               END-IF
           END-IF
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR7127' TO W0RTN
      *        USER: Processing if Data record not found
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SC2EXIT
           END-IF
      *
           IF (C-INDICATOR-OFF(90)) THEN
      *        USER: Process Data record
      *        Car/Van Indicator
               MOVE LLCORV OF VAMDLBNSF1 OF VAMDLBNSL1-R TO YL0116 OF
                 WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
           END-IF
      *==============================================================
           CONTINUE.
       SC2EXIT.
           EXIT.
      /EJECT
       SC3RVGN SECTION.
      *==============================================================
      *    Rtv Rtn Latest Brand Mdl - Bonus Sls-RIC Mdl Dsp Seq  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    SCP Model Code
           MOVE OSSTMDLSCP OF FDOTEGL OF SBDOTEXTL7-R TO O9SCMDLCDE OF
             KRSSC3
      *    Initialise Full Externally Described Keylist
      *    SCP Model Code
           MOVE LOW-VALUES TO O9SCMDLCDE OF EXTSC3
      *    Bns RIC Config Year
           MOVE 9999 TO O9BNSRICYR OF EXTSC3
      *    Bns RIC Display Sequence
           MOVE -999 TO O9BNSRICSQ OF EXTSC3
           MOVE CORRESPONDING
             EXTSC3 TO
             SBRICDSQF4 OF SBRICDSQL4-R
           MOVE CORRESPONDING
             KRSSC3 TO
             SBRICDSQF4 OF SBRICDSQL4-R
           START SBRICDSQL4 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'SBRICDSQF4'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ SBRICDSQL4 NEXT
             FORMAT IS 'SBRICDSQF4'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     SBRICDSQF4 OF SBRICDSQL4-R TO
                     EXTSC3
                   MOVE EXTSC3 TO KRSSC3-TMP
                   IF (KRSSC3 NOT = KRSSC3-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    SCP Model Code
           MOVE LOW-VALUES TO O9SCMDLCDE OF EXTSC3
      *    Bns RIC Config Year
           MOVE 9999 TO O9BNSRICYR OF EXTSC3
      *    Bns RIC Display Sequence
           MOVE -999 TO O9BNSRICSQ OF EXTSC3
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR7404' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Bns Brand Name
               MOVE SPACES TO YL0118 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SC3EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Bns Brand Name
               MOVE O9BNSBRNDD OF SBRICDSQF4 OF SBRICDSQL4-R TO YL0118
                 OF WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
      *        *QUIT
               GO SC3EXIT
               SET C-INDICATOR-OFF(90) TO TRUE
               READ SBRICDSQL4 NEXT
                 FORMAT IS 'SBRICDSQF4'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         SBRICDSQF4 OF SBRICDSQL4-R TO
                         EXTSC3
                       MOVE EXTSC3 TO KRSSC3-TMP
                       IF (KRSSC3 NOT = KRSSC3-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        SCP Model Code
               MOVE LOW-VALUES TO O9SCMDLCDE OF EXTSC3
      *        Bns RIC Config Year
               MOVE 9999 TO O9BNSRICYR OF EXTSC3
      *        Bns RIC Display Sequence
               MOVE -999 TO O9BNSRICSQ OF EXTSC3
           END-PERFORM
      *==============================================================
           CONTINUE.
       SC3EXIT.
           EXIT.
      /EJECT
       SC4RVGN SECTION.
      *==============================================================
      *    Rtv All Dtl by Dlr/Mdl/ON - OBT Extract  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    Dealer number (Num key)
           MOVE YL0108 OF WORK-CONTEXT TO Q2DLRNOKEY OF KRSSC4
      *    BDC Model
           MOVE OSSTMDLSCP OF FDOTEGL OF SBDOTEXTL7-R TO Q2BDCM OF
             KRSSC4
      *    BDC Customer Order Number
           MOVE OSNUCO OF FDOTEGL OF SBDOTEXTL7-R TO Q2BDCCON OF KRSSC4
      *    Initialise Full Externally Described Keylist
      *    Dealer number (Num key)
           MOVE -99999 TO Q2DLRNOKEY OF EXTSC4
      *    BDC Model
           MOVE LOW-VALUES TO Q2BDCM OF EXTSC4
      *    BDC Customer Order Number
           MOVE LOW-VALUES TO Q2BDCCON OF EXTSC4
           MOVE CORRESPONDING
             EXTSC4 TO
             FOBEXCB OF RAOBEXTRL2-R
           MOVE CORRESPONDING
             KRSSC4 TO
             FOBEXCB OF RAOBEXTRL2-R
           START RAOBEXTRL2 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'FOBEXCB'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ RAOBEXTRL2 NEXT
             FORMAT IS 'FOBEXCB'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     FOBEXCB OF RAOBEXTRL2-R TO
                     EXTSC4
                   MOVE EXTSC4 TO KRSSC4-TMP
                   IF (KRSSC4 NOT = KRSSC4-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    Dealer number (Num key)
           MOVE -99999 TO Q2DLRNOKEY OF EXTSC4
      *    BDC Model
           MOVE LOW-VALUES TO Q2BDCM OF EXTSC4
      *    BDC Customer Order Number
           MOVE LOW-VALUES TO Q2BDCCON OF EXTSC4
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR5706' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Fleet Operator Number
               MOVE SPACES TO YL0121 OF WORK-CONTEXT
      *        BDC Payment Term
               MOVE SPACES TO YL0122 OF WORK-CONTEXT
      *        OBT Count Target Status
               MOVE SPACES TO YL0117 OF WORK-CONTEXT
      *        Fleet Programmes Code
               MOVE SPACES TO YL0119 OF WORK-CONTEXT
      *        Target Market
               MOVE SPACES TO YL0123 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SC4EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Fleet Operator Number
               MOVE Q2FLOPNO OF FOBEXCB OF RAOBEXTRL2-R TO YL0121 OF
                 WORK-CONTEXT
      *        BDC Payment Term
               MOVE Q2BDCPTRM OF FOBEXCB OF RAOBEXTRL2-R TO YL0122 OF
                 WORK-CONTEXT
      *        OBT Count Target Status
               MOVE Q2CNTTARG OF FOBEXCB OF RAOBEXTRL2-R TO YL0117 OF
                 WORK-CONTEXT
      *        Fleet Programmes Code
               MOVE Q2FLPGMCDE OF FOBEXCB OF RAOBEXTRL2-R TO YL0119 OF
                 WORK-CONTEXT
      *        Target Market
               MOVE Q2TGTMRKET OF FOBEXCB OF RAOBEXTRL2-R TO YL0123 OF
                 WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
      *        *QUIT
               GO SC4EXIT
               SET C-INDICATOR-OFF(90) TO TRUE
               READ RAOBEXTRL2 NEXT
                 FORMAT IS 'FOBEXCB'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         FOBEXCB OF RAOBEXTRL2-R TO
                         EXTSC4
                       MOVE EXTSC4 TO KRSSC4-TMP
                       IF (KRSSC4 NOT = KRSSC4-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        Dealer number (Num key)
               MOVE -99999 TO Q2DLRNOKEY OF EXTSC4
      *        BDC Model
               MOVE LOW-VALUES TO Q2BDCM OF EXTSC4
      *        BDC Customer Order Number
               MOVE LOW-VALUES TO Q2BDCCON OF EXTSC4
           END-PERFORM
      *==============================================================
           CONTINUE.
       SC4EXIT.
           EXIT.
      /EJECT
       SC5RVGN SECTION.
      *==============================================================
      *    Rtv No of Regs Derg TCTT - BDC.-.SEDRE DOT Extract  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    USER: Initialize routine
      *    Cvt *Job date to DTX
      *    * Job date contains a leading 1 when the year is 2000 or
      *      greater
      *    U:Job Date DTX
           ADD ZZJDT OF JOB-CONTEXT, 19000000 GIVING YL0131 OF
             WORK-CONTEXT
      *    Utl Cvt Dealer 6 to 5N
           MOVE 5 TO YRSW03
           MOVE 2 TO YRSW02
           IF (YRSW02 NOT > 0 OR
               YRSW03 NOT > 0 OR
               YRSW02 > 00006 OR
               YRSW03 > 00006) THEN
               MOVE 'Y2U0510' TO W0RTN
           ELSE
               MOVE WUTOCF OF WORK-CONTEXT TO W0STRNG
               MOVE W0STRNG(YRSW02:YRSW03) TO WUUCODE5 OF WORK-CONTEXT
           END-IF
           IF (WUUCODE5 OF WORK-CONTEXT = SPACES) THEN
               MOVE ZERO TO YL0132 OF WORK-CONTEXT
           ELSE
               MOVE WUUCODE5 OF WORK-CONTEXT TO YL0132 OF WORK-CONTEXT
           END-IF
      *    U:Pay Cat 1 De-Regs
           MOVE ZEROS TO YL0155 OF WORK-CONTEXT
      *    U:Pay Cat 1 De-Regs
           MOVE ZEROS TO YL0133 OF WORK-CONTEXT
      *    U:Pay Cat 2 De-Regs
           MOVE ZEROS TO YL0156 OF WORK-CONTEXT
      *    U:Pay Cat 2 De-Regs
           MOVE ZEROS TO YL0134 OF WORK-CONTEXT
      *    U:Pay Cat 3 De-Regs
           MOVE ZEROS TO YL0157 OF WORK-CONTEXT
      *    U:Pay Cat 3 De-Regs
           MOVE ZEROS TO YL0135 OF WORK-CONTEXT
      *    U:Pay Cat 4 De-Regs
           MOVE ZEROS TO YL0158 OF WORK-CONTEXT
      *    U:Pay Cat 4 De-Regs
           MOVE ZEROS TO YL0136 OF WORK-CONTEXT
      *    U:Pay Cat 5 De-Regs
           MOVE ZEROS TO YL0159 OF WORK-CONTEXT
      *    U:Pay Cat 5 De-Regs
           MOVE ZEROS TO YL0137 OF WORK-CONTEXT
      *    U:Pay Cat N De-Regs
           MOVE ZEROS TO YL0160 OF WORK-CONTEXT
      *    U:Pay Cat N De-Regs
           MOVE ZEROS TO YL0138 OF WORK-CONTEXT
      *    U:Pay Cat O De-Regs
           MOVE ZEROS TO YL0161 OF WORK-CONTEXT
      *    U:Pay Cat O De-Regs
           MOVE ZEROS TO YL0139 OF WORK-CONTEXT
      *    Setup key
      *    CONCES PROPRIETAIRE
           MOVE WUTOCF OF WORK-CONTEXT TO OSNECO OF KPSSC5
      *    De-reg Date NBR
           MOVE WUUFRMDTXB OF WORK-CONTEXT TO OSZXNU OF KPSSC5
           MOVE CORRESPONDING KPSSC5 TO KRSSC5
      *    Initialise Full Externally Described Keylist
      *    CONCES PROPRIETAIRE
           MOVE LOW-VALUES TO OSNECO OF EXTSC5
      *    De-reg Date NBR
           MOVE -99999999 TO OSZXNU OF EXTSC5
           MOVE CORRESPONDING
             EXTSC5 TO
             FDOTEGM OF SBDOTEXTL8-R
           MOVE CORRESPONDING
             KPSSC5 TO
             FDOTEGM OF SBDOTEXTL8-R
           START SBDOTEXTL8 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'FDOTEGM'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ SBDOTEXTL8 NEXT
             FORMAT IS 'FDOTEGM'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     FDOTEGM OF SBDOTEXTL8-R TO
                     EXTSC5
                   MOVE EXTSC5 TO KRSSC5-TMP
                   IF (KRSSC5 NOT = KRSSC5-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    CONCES PROPRIETAIRE
           MOVE LOW-VALUES TO OSNECO OF EXTSC5
      *    De-reg Date NBR
           MOVE -99999999 TO OSZXNU OF EXTSC5
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR5554' TO W0RTN
           END-IF
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        Count number of de-regs for the Model
      *        CASE: DB1.De-reg Date NBR LE PAR.U:Number (8.0)
      *        *IF
               IF (OSZXNU OF FDOTEGM OF SBDOTEXTL8-R NOT > WUUTODTXB OF
                 WORK-CONTEXT) THEN
      *            Include this one?
      *            CASE: DB1.De-reg Date NBR is NE Zero
      *            *IF
                   IF (OSZXNU OF FDOTEGM OF SBDOTEXTL8-R NOT = 0) THEN
      *                Car/Van Indicator
                       MOVE ' ' TO YL0140 OF WORK-CONTEXT
      *                OBT Count Target Status
                       MOVE ' ' TO YL0141 OF WORK-CONTEXT
      *                Rtv Car or Van SCP Mdl - Vehicle Model Bonus
      *                  Atr  *
                       PERFORM SC6RVGN
      *                Rtv Rtn Latest Brand Mdl - Bonus Sls-RIC Mdl
      *                  Dsp Seq  *
                       PERFORM SC7RVGN
      *                Fleet Programmes Code
                       MOVE SPACES TO YL0143 OF WORK-CONTEXT
                       MOVE ' ' TO YL0143 OF WORK-CONTEXT
      *                U:Continue
                       MOVE 'Y' TO YL0144 OF WORK-CONTEXT
      *                Rtv First Dtls for Chass - OBT Extract  *
                       PERFORM SC8RVGN
      *                Check Target Type Deselection
      *                CASE: PAR.U:Target Prefix is Target total
      *                *IF
                       IF ('TT' = 'TT') THEN
                           CONTINUE
                       ELSE
      *                    CASE: PAR.U:Target Prefix is Target Local
      *                      Market
      *                    *IF
                           IF ('TT' = 'TL') THEN
      *                        CASE: LCL.Target Market is Local Market
      *                          Target List
      *                        *IF
                               IF (YL0147 OF WORK-CONTEXT = 'L' OR
                                   YL0147 OF WORK-CONTEXT = 'W' OR
                                   YL0147 OF WORK-CONTEXT = 'R') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0144 OF WORK-CONTEXT
                               END-IF
                           ELSE
      *                        CASE: PAR.U:Target Prefix is Target
      *                          Major Fleet
      *                        *IF
                               IF ('TT' = 'TM') THEN
      *                        CASE: LCL.Target Market is Major Fleet
      *                          Target
      *                        *IF
                               IF (YL0147 OF WORK-CONTEXT = 'M') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0144 OF WORK-CONTEXT
                               END-IF
                               ELSE
      *                        CASE: PAR.U:Target Prefix is Target not
      *                          fleet
      *                        *IF
                               IF ('TT' = 'TN') THEN
      *                        CASE:
      *                        - c1 OR c2
      *                        |- c1    : LCL.Fleet Programmes Code is
      *                          *Blank
      *                        |- c2    : LCL.Fleet Programmes Code is
      *                          UNS - Unsupported (30286)
      *                        '-
      *                        *IF
                               IF (YL0143 OF WORK-CONTEXT = ' ' OR
                                   YL0143 OF WORK-CONTEXT = 'UNS') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0144 OF WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
      *                If O.K. to Continue - Following Record
      *                  Deselection
      *                CASE: LCL.U:Continue is Yes
      *                *IF
                       IF (YL0144 OF WORK-CONTEXT = 'Y') THEN
      *                    CASE: LCL.OBT Count Target Status is
      *                      Payment Category 1
      *                    *IF
                           IF (YL0141 OF WORK-CONTEXT = '1') THEN
      *                        U:Pay Cat 1 De-Regs
                               ADD YL0133 OF WORK-CONTEXT, 1 GIVING
                                 YL0133 OF WORK-CONTEXT
                           ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 2
      *                        *IF
                               IF (YL0141 OF WORK-CONTEXT = '2') THEN
      *                        U:Pay Cat 2 De-Regs
                               ADD YL0134 OF WORK-CONTEXT, 1 GIVING
                                 YL0134 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 3
      *                        *IF
                               IF (YL0141 OF WORK-CONTEXT = '3') THEN
      *                        U:Pay Cat 3 De-Regs
                               ADD YL0135 OF WORK-CONTEXT, 1 GIVING
                                 YL0135 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 4
      *                        *IF
                               IF (YL0141 OF WORK-CONTEXT = '4') THEN
      *                        U:Pay Cat 4 De-Regs
                               ADD YL0136 OF WORK-CONTEXT, 1 GIVING
                                 YL0136 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 5
      *                        *IF
                               IF (YL0141 OF WORK-CONTEXT = '5') THEN
      *                        U:Pay Cat 5 De-Regs
                               ADD YL0137 OF WORK-CONTEXT, 1 GIVING
                                 YL0137 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category N - New
      *                        *IF
                               IF (YL0141 OF WORK-CONTEXT = 'N') THEN
      *                        U:Pay Cat N De-Regs
                               ADD YL0138 OF WORK-CONTEXT, 1 GIVING
                                 YL0138 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
      *                        CASE: LCL.Bns Brand Name is RENAULT
      *                        *IF
                               IF (YL0142 OF WORK-CONTEXT = 'RENAULT')
                                 THEN
      *                        U:Pay Cat 5 De-Regs
                               ADD YL0137 OF WORK-CONTEXT, 1 GIVING
                                 YL0137 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Pay Cat O De-Regs
                               ADD YL0139 OF WORK-CONTEXT, 1 GIVING
                                 YL0139 OF WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
                   END-IF
               END-IF
               SET C-INDICATOR-OFF(90) TO TRUE
               READ SBDOTEXTL8 NEXT
                 FORMAT IS 'FDOTEGM'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         FDOTEGM OF SBDOTEXTL8-R TO
                         EXTSC5
                       MOVE EXTSC5 TO KRSSC5-TMP
                       IF (KRSSC5 NOT = KRSSC5-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        CONCES PROPRIETAIRE
               MOVE LOW-VALUES TO OSNECO OF EXTSC5
      *        De-reg Date NBR
               MOVE -99999999 TO OSZXNU OF EXTSC5
           END-PERFORM
      *    USER: Exit processing
      *    U:Pay Cat 1 De-Regs
           MOVE YL0133 OF WORK-CONTEXT TO YL0155 OF WORK-CONTEXT
      *    U:Pay Cat 2 De-Regs
           MOVE YL0134 OF WORK-CONTEXT TO YL0156 OF WORK-CONTEXT
      *    U:Pay Cat 3 De-Regs
           MOVE YL0135 OF WORK-CONTEXT TO YL0157 OF WORK-CONTEXT
      *    U:Pay Cat 4 De-Regs
           MOVE YL0136 OF WORK-CONTEXT TO YL0158 OF WORK-CONTEXT
      *    U:Pay Cat 5 De-Regs
           MOVE YL0137 OF WORK-CONTEXT TO YL0159 OF WORK-CONTEXT
      *    U:Pay Cat N De-Regs
           MOVE YL0138 OF WORK-CONTEXT TO YL0160 OF WORK-CONTEXT
      *    U:Pay Cat O De-Regs
           MOVE YL0139 OF WORK-CONTEXT TO YL0161 OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       SC5EXIT.
           EXIT.
      /EJECT
       SC6RVGN SECTION.
      *==============================================================
      *    Rtv Car or Van SCP Mdl - Vehicle Model Bonus Atr  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    USER: Initialize routine
      *    Car/Van Indicator
           MOVE 'C' TO YL0140 OF WORK-CONTEXT
      *    Setup key
      *    Model Application Code
           MOVE 'RIC' TO LLMDLAPPCD OF KRSSC6
      *    SCP Model Code
           MOVE OSSTMDLSCP OF FDOTEGM OF SBDOTEXTL8-R TO LLSCMDLCDE OF
             KRSSC6
      *    Initialise Full Externally Described Keylist
      *    Model Application Code
           MOVE LOW-VALUES TO LLMDLAPPCD OF EXTSC6
      *    SCP Model Code
           MOVE LOW-VALUES TO LLSCMDLCDE OF EXTSC6
           MOVE CORRESPONDING
             KRSSC6 TO
             VAMDLBNSF1 OF VAMDLBNSL1-R
           SET C-INDICATOR-OFF(90) TO TRUE
           READ VAMDLBNSL1
             FORMAT IS 'VAMDLBNSF1'
           END-READ
           IF (C-NO-RECORD) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               END-IF
           END-IF
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR7127' TO W0RTN
      *        USER: Processing if Data record not found
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SC6EXIT
           END-IF
      *
           IF (C-INDICATOR-OFF(90)) THEN
      *        USER: Process Data record
      *        Car/Van Indicator
               MOVE LLCORV OF VAMDLBNSF1 OF VAMDLBNSL1-R TO YL0140 OF
                 WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
           END-IF
      *==============================================================
           CONTINUE.
       SC6EXIT.
           EXIT.
      /EJECT
       SC7RVGN SECTION.
      *==============================================================
      *    Rtv Rtn Latest Brand Mdl - Bonus Sls-RIC Mdl Dsp Seq  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    SCP Model Code
           MOVE OSSTMDLSCP OF FDOTEGM OF SBDOTEXTL8-R TO O9SCMDLCDE OF
             KRSSC7
      *    Initialise Full Externally Described Keylist
      *    SCP Model Code
           MOVE LOW-VALUES TO O9SCMDLCDE OF EXTSC7
      *    Bns RIC Config Year
           MOVE 9999 TO O9BNSRICYR OF EXTSC7
      *    Bns RIC Display Sequence
           MOVE -999 TO O9BNSRICSQ OF EXTSC7
           MOVE CORRESPONDING
             EXTSC7 TO
             SBRICDSQF4 OF SBRICDSQL4-R
           MOVE CORRESPONDING
             KRSSC7 TO
             SBRICDSQF4 OF SBRICDSQL4-R
           START SBRICDSQL4 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'SBRICDSQF4'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ SBRICDSQL4 NEXT
             FORMAT IS 'SBRICDSQF4'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     SBRICDSQF4 OF SBRICDSQL4-R TO
                     EXTSC7
                   MOVE EXTSC7 TO KRSSC7-TMP
                   IF (KRSSC7 NOT = KRSSC7-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    SCP Model Code
           MOVE LOW-VALUES TO O9SCMDLCDE OF EXTSC7
      *    Bns RIC Config Year
           MOVE 9999 TO O9BNSRICYR OF EXTSC7
      *    Bns RIC Display Sequence
           MOVE -999 TO O9BNSRICSQ OF EXTSC7
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR7404' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Bns Brand Name
               MOVE SPACES TO YL0142 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SC7EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Bns Brand Name
               MOVE O9BNSBRNDD OF SBRICDSQF4 OF SBRICDSQL4-R TO YL0142
                 OF WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
      *        *QUIT
               GO SC7EXIT
               SET C-INDICATOR-OFF(90) TO TRUE
               READ SBRICDSQL4 NEXT
                 FORMAT IS 'SBRICDSQF4'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         SBRICDSQF4 OF SBRICDSQL4-R TO
                         EXTSC7
                       MOVE EXTSC7 TO KRSSC7-TMP
                       IF (KRSSC7 NOT = KRSSC7-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        SCP Model Code
               MOVE LOW-VALUES TO O9SCMDLCDE OF EXTSC7
      *        Bns RIC Config Year
               MOVE 9999 TO O9BNSRICYR OF EXTSC7
      *        Bns RIC Display Sequence
               MOVE -999 TO O9BNSRICSQ OF EXTSC7
           END-PERFORM
      *==============================================================
           CONTINUE.
       SC7EXIT.
           EXIT.
      /EJECT
       SC8RVGN SECTION.
      *==============================================================
      *    Rtv First Dtls for Chass - OBT Extract  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    Chassis number
           MOVE OSYPTX OF FDOTEGM OF SBDOTEXTL8-R TO Q2ASXX OF KRSSC8
      *    Initialise Full Externally Described Keylist
      *    Chassis number
           MOVE LOW-VALUES TO Q2ASXX OF EXTSC8
           MOVE CORRESPONDING
             EXTSC8 TO
             RAOBEXTRF4 OF RAOBEXTRL4-R
           MOVE CORRESPONDING
             KRSSC8 TO
             RAOBEXTRF4 OF RAOBEXTRL4-R
           START RAOBEXTRL4 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'RAOBEXTRF4'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ RAOBEXTRL4 NEXT
             FORMAT IS 'RAOBEXTRF4'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     RAOBEXTRF4 OF RAOBEXTRL4-R TO
                     EXTSC8
                   MOVE EXTSC8 TO KRSSC8-TMP
                   IF (KRSSC8 NOT = KRSSC8-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    Chassis number
           MOVE LOW-VALUES TO Q2ASXX OF EXTSC8
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR5706' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Fleet Operator Number
               MOVE SPACES TO YL0145 OF WORK-CONTEXT
      *        BDC Payment Term
               MOVE SPACES TO YL0146 OF WORK-CONTEXT
      *        OBT Count Target Status
               MOVE SPACES TO YL0141 OF WORK-CONTEXT
      *        Fleet Programmes Code
               MOVE SPACES TO YL0143 OF WORK-CONTEXT
      *        Target Market
               MOVE SPACES TO YL0147 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SC8EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Fleet Operator Number
               MOVE Q2FLOPNO OF RAOBEXTRF4 OF RAOBEXTRL4-R TO YL0145 OF
                 WORK-CONTEXT
      *        BDC Payment Term
               MOVE Q2BDCPTRM OF RAOBEXTRF4 OF RAOBEXTRL4-R TO YL0146
                 OF WORK-CONTEXT
      *        OBT Count Target Status
               MOVE Q2CNTTARG OF RAOBEXTRF4 OF RAOBEXTRL4-R TO YL0141
                 OF WORK-CONTEXT
      *        Fleet Programmes Code
               MOVE Q2FLPGMCDE OF RAOBEXTRF4 OF RAOBEXTRL4-R TO YL0143
                 OF WORK-CONTEXT
      *        Target Market
               MOVE Q2TGTMRKET OF RAOBEXTRF4 OF RAOBEXTRL4-R TO YL0147
                 OF WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
      *        *QUIT
               GO SC8EXIT
               SET C-INDICATOR-OFF(90) TO TRUE
               READ RAOBEXTRL4 NEXT
                 FORMAT IS 'RAOBEXTRF4'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         RAOBEXTRF4 OF RAOBEXTRL4-R TO
                         EXTSC8
                       MOVE EXTSC8 TO KRSSC8-TMP
                       IF (KRSSC8 NOT = KRSSC8-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        Chassis number
               MOVE LOW-VALUES TO Q2ASXX OF EXTSC8
           END-PERFORM
      *==============================================================
           CONTINUE.
       SC8EXIT.
           EXIT.
      /EJECT
       SC9RVGN SECTION.
      *==============================================================
      *    Rtv Target Value (Single) - Target Information  * Car
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    Level Code
           MOVE 00030 TO S9LVLCDE OF KRSSC9
      *    Dealer Number
           MOVE WUDLRNO OF WORK-CONTEXT TO S9DLRNBR OF KRSSC9
      *    Dealer Number Suffix
           MOVE WUUDLRSFX OF WORK-CONTEXT TO S9DLRSFX OF KRSSC9
      *    Target Period Code
           MOVE WUUTGTPRDC OF WORK-CONTEXT TO S9PERCDE OF KRSSC9
      *    Object Code
           MOVE 'CAR' TO S9OBJCDE OF KRSSC9
      *    Initialise Full Externally Described Keylist
      *    Level Code
           MOVE -99999 TO S9LVLCDE OF EXTSC9
      *    Dealer Number
           MOVE LOW-VALUES TO S9DLRNBR OF EXTSC9
      *    Dealer Number Suffix
           MOVE LOW-VALUES TO S9DLRSFX OF EXTSC9
      *    Target Period Code
           MOVE LOW-VALUES TO S9PERCDE OF EXTSC9
      *    Object Code
           MOVE LOW-VALUES TO S9OBJCDE OF EXTSC9
           MOVE CORRESPONDING
             EXTSC9 TO
             FTGTDSK OF AMTGTDTAL7-R
           MOVE CORRESPONDING
             KRSSC9 TO
             FTGTDSK OF AMTGTDTAL7-R
           START AMTGTDTAL7 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'FTGTDSK'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ AMTGTDTAL7 NEXT
             FORMAT IS 'FTGTDSK'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     FTGTDSK OF AMTGTDTAL7-R TO
                     EXTSC9
                   MOVE EXTSC9 TO KRSSC9-TMP
                   IF (KRSSC9 NOT = KRSSC9-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    Level Code
           MOVE -99999 TO S9LVLCDE OF EXTSC9
      *    Dealer Number
           MOVE LOW-VALUES TO S9DLRNBR OF EXTSC9
      *    Dealer Number Suffix
           MOVE LOW-VALUES TO S9DLRSFX OF EXTSC9
      *    Target Period Code
           MOVE LOW-VALUES TO S9PERCDE OF EXTSC9
      *    Object Code
           MOVE LOW-VALUES TO S9OBJCDE OF EXTSC9
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR2873' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Target Value
               MOVE ZEROS TO YL0097 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SC9EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Target Value
               MOVE S9TGOVAL OF FTGTDSK OF AMTGTDTAL7-R TO YL0097 OF
                 WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
               SET C-INDICATOR-OFF(90) TO TRUE
               READ AMTGTDTAL7 NEXT
                 FORMAT IS 'FTGTDSK'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         FTGTDSK OF AMTGTDTAL7-R TO
                         EXTSC9
                       MOVE EXTSC9 TO KRSSC9-TMP
                       IF (KRSSC9 NOT = KRSSC9-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        Level Code
               MOVE -99999 TO S9LVLCDE OF EXTSC9
      *        Dealer Number
               MOVE LOW-VALUES TO S9DLRNBR OF EXTSC9
      *        Dealer Number Suffix
               MOVE LOW-VALUES TO S9DLRSFX OF EXTSC9
      *        Target Period Code
               MOVE LOW-VALUES TO S9PERCDE OF EXTSC9
      *        Object Code
               MOVE LOW-VALUES TO S9OBJCDE OF EXTSC9
           END-PERFORM
      *==============================================================
           CONTINUE.
       SC9EXIT.
           EXIT.
      /EJECT
       SD1RVGN SECTION.
      *==============================================================
      *    Rtv Target Value (Single) - Target Information  * Van
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    Level Code
           MOVE 00030 TO S9LVLCDE OF KRSSD1
      *    Dealer Number
           MOVE WUDLRNO OF WORK-CONTEXT TO S9DLRNBR OF KRSSD1
      *    Dealer Number Suffix
           MOVE WUUDLRSFX OF WORK-CONTEXT TO S9DLRSFX OF KRSSD1
      *    Target Period Code
           MOVE WUUTGTPRDC OF WORK-CONTEXT TO S9PERCDE OF KRSSD1
      *    Object Code
           MOVE 'VAN' TO S9OBJCDE OF KRSSD1
      *    Initialise Full Externally Described Keylist
      *    Level Code
           MOVE -99999 TO S9LVLCDE OF EXTSD1
      *    Dealer Number
           MOVE LOW-VALUES TO S9DLRNBR OF EXTSD1
      *    Dealer Number Suffix
           MOVE LOW-VALUES TO S9DLRSFX OF EXTSD1
      *    Target Period Code
           MOVE LOW-VALUES TO S9PERCDE OF EXTSD1
      *    Object Code
           MOVE LOW-VALUES TO S9OBJCDE OF EXTSD1
           MOVE CORRESPONDING
             EXTSD1 TO
             FTGTDSK OF AMTGTDTAL7-R
           MOVE CORRESPONDING
             KRSSD1 TO
             FTGTDSK OF AMTGTDTAL7-R
           START AMTGTDTAL7 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'FTGTDSK'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ AMTGTDTAL7 NEXT
             FORMAT IS 'FTGTDSK'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     FTGTDSK OF AMTGTDTAL7-R TO
                     EXTSD1
                   MOVE EXTSD1 TO KRSSD1-TMP
                   IF (KRSSD1 NOT = KRSSD1-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    Level Code
           MOVE -99999 TO S9LVLCDE OF EXTSD1
      *    Dealer Number
           MOVE LOW-VALUES TO S9DLRNBR OF EXTSD1
      *    Dealer Number Suffix
           MOVE LOW-VALUES TO S9DLRSFX OF EXTSD1
      *    Target Period Code
           MOVE LOW-VALUES TO S9PERCDE OF EXTSD1
      *    Object Code
           MOVE LOW-VALUES TO S9OBJCDE OF EXTSD1
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR2873' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Target Value
               MOVE ZEROS TO YL0097 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SD1EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Target Value
               MOVE S9TGOVAL OF FTGTDSK OF AMTGTDTAL7-R TO YL0097 OF
                 WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
               SET C-INDICATOR-OFF(90) TO TRUE
               READ AMTGTDTAL7 NEXT
                 FORMAT IS 'FTGTDSK'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         FTGTDSK OF AMTGTDTAL7-R TO
                         EXTSD1
                       MOVE EXTSD1 TO KRSSD1-TMP
                       IF (KRSSD1 NOT = KRSSD1-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        Level Code
               MOVE -99999 TO S9LVLCDE OF EXTSD1
      *        Dealer Number
               MOVE LOW-VALUES TO S9DLRNBR OF EXTSD1
      *        Dealer Number Suffix
               MOVE LOW-VALUES TO S9DLRSFX OF EXTSD1
      *        Target Period Code
               MOVE LOW-VALUES TO S9PERCDE OF EXTSD1
      *        Object Code
               MOVE LOW-VALUES TO S9OBJCDE OF EXTSD1
           END-PERFORM
      *==============================================================
           CONTINUE.
       SD1EXIT.
           EXIT.
      /EJECT
       SD2RVGN SECTION.
      *==============================================================
      *    Rtv Target Value (Single) - Target Information  * Dacia car
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    Level Code
           MOVE 00030 TO S9LVLCDE OF KRSSD2
      *    Dealer Number
           MOVE WUWECF OF WORK-CONTEXT TO S9DLRNBR OF KRSSD2
      *    Dealer Number Suffix
           MOVE WUWFCF OF WORK-CONTEXT TO S9DLRSFX OF KRSSD2
      *    Target Period Code
           MOVE WUUTGTPRDC OF WORK-CONTEXT TO S9PERCDE OF KRSSD2
      *    Object Code
           MOVE 'CAR' TO S9OBJCDE OF KRSSD2
      *    Initialise Full Externally Described Keylist
      *    Level Code
           MOVE -99999 TO S9LVLCDE OF EXTSD2
      *    Dealer Number
           MOVE LOW-VALUES TO S9DLRNBR OF EXTSD2
      *    Dealer Number Suffix
           MOVE LOW-VALUES TO S9DLRSFX OF EXTSD2
      *    Target Period Code
           MOVE LOW-VALUES TO S9PERCDE OF EXTSD2
      *    Object Code
           MOVE LOW-VALUES TO S9OBJCDE OF EXTSD2
           MOVE CORRESPONDING
             EXTSD2 TO
             FTGTDSK OF AMTGTDTAL7-R
           MOVE CORRESPONDING
             KRSSD2 TO
             FTGTDSK OF AMTGTDTAL7-R
           START AMTGTDTAL7 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'FTGTDSK'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ AMTGTDTAL7 NEXT
             FORMAT IS 'FTGTDSK'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     FTGTDSK OF AMTGTDTAL7-R TO
                     EXTSD2
                   MOVE EXTSD2 TO KRSSD2-TMP
                   IF (KRSSD2 NOT = KRSSD2-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    Level Code
           MOVE -99999 TO S9LVLCDE OF EXTSD2
      *    Dealer Number
           MOVE LOW-VALUES TO S9DLRNBR OF EXTSD2
      *    Dealer Number Suffix
           MOVE LOW-VALUES TO S9DLRSFX OF EXTSD2
      *    Target Period Code
           MOVE LOW-VALUES TO S9PERCDE OF EXTSD2
      *    Object Code
           MOVE LOW-VALUES TO S9OBJCDE OF EXTSD2
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR2873' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Target Value
               MOVE ZEROS TO YL0098 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SD2EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Target Value
               MOVE S9TGOVAL OF FTGTDSK OF AMTGTDTAL7-R TO YL0098 OF
                 WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
               SET C-INDICATOR-OFF(90) TO TRUE
               READ AMTGTDTAL7 NEXT
                 FORMAT IS 'FTGTDSK'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         FTGTDSK OF AMTGTDTAL7-R TO
                         EXTSD2
                       MOVE EXTSD2 TO KRSSD2-TMP
                       IF (KRSSD2 NOT = KRSSD2-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        Level Code
               MOVE -99999 TO S9LVLCDE OF EXTSD2
      *        Dealer Number
               MOVE LOW-VALUES TO S9DLRNBR OF EXTSD2
      *        Dealer Number Suffix
               MOVE LOW-VALUES TO S9DLRSFX OF EXTSD2
      *        Target Period Code
               MOVE LOW-VALUES TO S9PERCDE OF EXTSD2
      *        Object Code
               MOVE LOW-VALUES TO S9OBJCDE OF EXTSD2
           END-PERFORM
      *==============================================================
           CONTINUE.
       SD2EXIT.
           EXIT.
      /EJECT
       SD3RVGN SECTION.
      *==============================================================
      *    Rtv Target Value (Single) - Target Information  * Van
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    Level Code
           MOVE 00030 TO S9LVLCDE OF KRSSD3
      *    Dealer Number
           MOVE WUWECF OF WORK-CONTEXT TO S9DLRNBR OF KRSSD3
      *    Dealer Number Suffix
           MOVE YL0099 OF WORK-CONTEXT TO S9DLRSFX OF KRSSD3
      *    Target Period Code
           MOVE WUUTGTPRDC OF WORK-CONTEXT TO S9PERCDE OF KRSSD3
      *    Object Code
           MOVE 'VAN' TO S9OBJCDE OF KRSSD3
      *    Initialise Full Externally Described Keylist
      *    Level Code
           MOVE -99999 TO S9LVLCDE OF EXTSD3
      *    Dealer Number
           MOVE LOW-VALUES TO S9DLRNBR OF EXTSD3
      *    Dealer Number Suffix
           MOVE LOW-VALUES TO S9DLRSFX OF EXTSD3
      *    Target Period Code
           MOVE LOW-VALUES TO S9PERCDE OF EXTSD3
      *    Object Code
           MOVE LOW-VALUES TO S9OBJCDE OF EXTSD3
           MOVE CORRESPONDING
             EXTSD3 TO
             FTGTDSK OF AMTGTDTAL7-R
           MOVE CORRESPONDING
             KRSSD3 TO
             FTGTDSK OF AMTGTDTAL7-R
           START AMTGTDTAL7 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'FTGTDSK'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ AMTGTDTAL7 NEXT
             FORMAT IS 'FTGTDSK'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     FTGTDSK OF AMTGTDTAL7-R TO
                     EXTSD3
                   MOVE EXTSD3 TO KRSSD3-TMP
                   IF (KRSSD3 NOT = KRSSD3-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    Level Code
           MOVE -99999 TO S9LVLCDE OF EXTSD3
      *    Dealer Number
           MOVE LOW-VALUES TO S9DLRNBR OF EXTSD3
      *    Dealer Number Suffix
           MOVE LOW-VALUES TO S9DLRSFX OF EXTSD3
      *    Target Period Code
           MOVE LOW-VALUES TO S9PERCDE OF EXTSD3
      *    Object Code
           MOVE LOW-VALUES TO S9OBJCDE OF EXTSD3
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR2873' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Target Value
               MOVE ZEROS TO YL0098 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SD3EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Target Value
               MOVE S9TGOVAL OF FTGTDSK OF AMTGTDTAL7-R TO YL0098 OF
                 WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
               SET C-INDICATOR-OFF(90) TO TRUE
               READ AMTGTDTAL7 NEXT
                 FORMAT IS 'FTGTDSK'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         FTGTDSK OF AMTGTDTAL7-R TO
                         EXTSD3
                       MOVE EXTSD3 TO KRSSD3-TMP
                       IF (KRSSD3 NOT = KRSSD3-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        Level Code
               MOVE -99999 TO S9LVLCDE OF EXTSD3
      *        Dealer Number
               MOVE LOW-VALUES TO S9DLRNBR OF EXTSD3
      *        Dealer Number Suffix
               MOVE LOW-VALUES TO S9DLRSFX OF EXTSD3
      *        Target Period Code
               MOVE LOW-VALUES TO S9PERCDE OF EXTSD3
      *        Object Code
               MOVE LOW-VALUES TO S9OBJCDE OF EXTSD3
           END-PERFORM
      *==============================================================
           CONTINUE.
       SD3EXIT.
           EXIT.
      /EJECT
       SD4RVGN SECTION.
      *==============================================================
      *    Rtv No of Regs TCTT - BDC.-.SEDRE DOT Extract  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    USER: Initialize routine
      *    Cvt *Job date to DTX
      *    * Job date contains a leading 1 when the year is 2000 or
      *      greater
      *    U:Job Date DTX
           ADD ZZJDT OF JOB-CONTEXT, 19000000 GIVING YL0107 OF
             WORK-CONTEXT
      *    Utl Cvt Dealer 6 to 5N
           MOVE 5 TO YRSW03
           MOVE 2 TO YRSW02
           IF (YRSW02 NOT > 0 OR
               YRSW03 NOT > 0 OR
               YRSW02 > 00006 OR
               YRSW03 > 00006) THEN
               MOVE 'Y2U0510' TO W0RTN
           ELSE
               MOVE WUNECO OF WORK-CONTEXT TO W0STRNG
               MOVE W0STRNG(YRSW02:YRSW03) TO WUUCODE5 OF WORK-CONTEXT
           END-IF
           IF (WUUCODE5 OF WORK-CONTEXT = SPACES) THEN
               MOVE ZERO TO YL0108 OF WORK-CONTEXT
           ELSE
               MOVE WUUCODE5 OF WORK-CONTEXT TO YL0108 OF WORK-CONTEXT
           END-IF
      *    U:Pay Cat 1 Regs
           MOVE ZEROS TO YL0100 OF WORK-CONTEXT
      *    U:Pay Cat 1 Regs
           MOVE ZEROS TO YL0109 OF WORK-CONTEXT
      *    U:Pay Cat 2 Regs
           MOVE ZEROS TO YL0101 OF WORK-CONTEXT
      *    U:Pay Cat 2 Regs
           MOVE ZEROS TO YL0110 OF WORK-CONTEXT
      *    U:Pay Cat 3 Regs
           MOVE ZEROS TO YL0102 OF WORK-CONTEXT
      *    U:Pay Cat 3 Regs
           MOVE ZEROS TO YL0111 OF WORK-CONTEXT
      *    U:Pay Cat 4 Regs
           MOVE ZEROS TO YL0103 OF WORK-CONTEXT
      *    U:Pay Cat 4 Regs
           MOVE ZEROS TO YL0112 OF WORK-CONTEXT
      *    U:Pay Cat 5 Regs
           MOVE ZEROS TO YL0104 OF WORK-CONTEXT
      *    U:Pay Cat 5 Regs
           MOVE ZEROS TO YL0113 OF WORK-CONTEXT
      *    U:Pay Cat N Regs
           MOVE ZEROS TO YL0105 OF WORK-CONTEXT
      *    U:Pay Cat N Regs
           MOVE ZEROS TO YL0114 OF WORK-CONTEXT
      *    U:Pay Cat O Regs
           MOVE ZEROS TO YL0106 OF WORK-CONTEXT
      *    U:Pay Cat O Regs
           MOVE ZEROS TO YL0115 OF WORK-CONTEXT
      *    Setup key
      *    CONCES PROPRIETAIRE
           MOVE WUNECO OF WORK-CONTEXT TO OSNECO OF KPSSD4
      *    DATE 58 IMMATRICULATION
           MOVE WUUFRMDTXC OF WORK-CONTEXT TO OSW0NB OF KPSSD4
           MOVE CORRESPONDING KPSSD4 TO KRSSD4
      *    Initialise Full Externally Described Keylist
      *    CONCES PROPRIETAIRE
           MOVE LOW-VALUES TO OSNECO OF EXTSD4
      *    DATE 58 IMMATRICULATION
           MOVE -99999999 TO OSW0NB OF EXTSD4
      *    COMMANDE CLIENT
           MOVE LOW-VALUES TO OSNUCO OF EXTSD4
           MOVE CORRESPONDING
             EXTSD4 TO
             FDOTEGL OF SBDOTEXTL7-R
           MOVE CORRESPONDING
             KPSSD4 TO
             FDOTEGL OF SBDOTEXTL7-R
           START SBDOTEXTL7 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'FDOTEGL'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ SBDOTEXTL7 NEXT
             FORMAT IS 'FDOTEGL'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     FDOTEGL OF SBDOTEXTL7-R TO
                     EXTSD4
                   MOVE EXTSD4 TO KRSSD4-TMP
                   IF (KRSSD4 NOT = KRSSD4-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    CONCES PROPRIETAIRE
           MOVE LOW-VALUES TO OSNECO OF EXTSD4
      *    DATE 58 IMMATRICULATION
           MOVE -99999999 TO OSW0NB OF EXTSD4
      *    COMMANDE CLIENT
           MOVE LOW-VALUES TO OSNUCO OF EXTSD4
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR5554' TO W0RTN
           END-IF
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        Count number of registrations for the Model
      *        CASE: DB1.DATE 58 IMMATRICULATION LE PAR.U:Number (8.0)
      *        *IF
               IF (OSW0NB OF FDOTEGL OF SBDOTEXTL7-R NOT > WUUTODTXC OF
                 WORK-CONTEXT) THEN
      *            Include this one?
      *            CASE: DB1.DATE 58 IMMATRICULATION is NE Zero
      *            *IF
                   IF (OSW0NB OF FDOTEGL OF SBDOTEXTL7-R NOT = 0) THEN
      *                Car/Van Indicator
                       MOVE ' ' TO YL0116 OF WORK-CONTEXT
      *                OBT Count Target Status
                       MOVE ' ' TO YL0117 OF WORK-CONTEXT
      *                Rtv Car or Van SCP Mdl - Vehicle Model Bonus
      *                  Atr  *
                       PERFORM SD5RVGN
      *                Rtv Rtn Latest Brand Mdl - Bonus Sls-RIC Mdl
      *                  Dsp Seq  *
                       PERFORM SD6RVGN
      *                Fleet Programmes Code
                       MOVE SPACES TO YL0119 OF WORK-CONTEXT
                       MOVE ' ' TO YL0119 OF WORK-CONTEXT
      *                U:Continue
                       MOVE 'Y' TO YL0120 OF WORK-CONTEXT
      *                Rtv All Dtl by Dlr/Mdl/ON - OBT Extract  *
                       PERFORM SD7RVGN
      *                Check Target Type Deselection
      *                CASE: PAR.U:Target Prefix is Target total
      *                *IF
                       IF ('TT' = 'TT') THEN
                           CONTINUE
                       ELSE
      *                    CASE: PAR.U:Target Prefix is Target Local
      *                      Market
      *                    *IF
                           IF ('TT' = 'TL') THEN
      *                        CASE: LCL.Target Market is Local Market
      *                          Target List
      *                        *IF
                               IF (YL0123 OF WORK-CONTEXT = 'L' OR
                                   YL0123 OF WORK-CONTEXT = 'W' OR
                                   YL0123 OF WORK-CONTEXT = 'R') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0120 OF WORK-CONTEXT
                               END-IF
                           ELSE
      *                        CASE: PAR.U:Target Prefix is Target
      *                          Major Fleet
      *                        *IF
                               IF ('TT' = 'TM') THEN
      *                        CASE: LCL.Target Market is Major Fleet
      *                          Target
      *                        *IF
                               IF (YL0123 OF WORK-CONTEXT = 'M') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0120 OF WORK-CONTEXT
                               END-IF
                               ELSE
      *                        CASE: PAR.U:Target Prefix is Target not
      *                          fleet
      *                        *IF
                               IF ('TT' = 'TN') THEN
      *                        CASE:
      *                        - c1 OR c2
      *                        |- c1    : LCL.Fleet Programmes Code is
      *                          *Blank
      *                        |- c2    : LCL.Fleet Programmes Code is
      *                          UNS - Unsupported (30286)
      *                        '-
      *                        *IF
                               IF (YL0119 OF WORK-CONTEXT = ' ' OR
                                   YL0119 OF WORK-CONTEXT = 'UNS') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0120 OF WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
      *                If O.K. to Continue - Following Record
      *                  Deselection
      *                CASE: LCL.U:Continue is Yes
      *                *IF
                       IF (YL0120 OF WORK-CONTEXT = 'Y') THEN
      *                    CASE: DB1.De-reg Date NBR is NE Zero
      *                    *IF
                           IF (OSZXNU OF FDOTEGL OF SBDOTEXTL7-R NOT =
                             0) THEN
      *                        For De-Regs
      *                        CASE:
      *                        - c1 OR c2
      *                        |- c1    : LCL.OBT Count Target Status
      *                          is In Target List
      *                        |- c2    : LCL.Bns Brand Name is RENAULT
      *                        '-
      *                        *IF
                               IF ((YL0117 OF WORK-CONTEXT = 'I' OR
                                    YL0117 OF WORK-CONTEXT = '1' OR
                                    YL0117 OF WORK-CONTEXT = '2' OR
                                    YL0117 OF WORK-CONTEXT = '3' OR
                                    YL0117 OF WORK-CONTEXT = '4' OR
                                    YL0117 OF WORK-CONTEXT = '5' OR
                                    YL0117 OF WORK-CONTEXT = 'N') OR
                                   YL0118 OF WORK-CONTEXT = 'RENAULT')
                                 THEN
      *                        U:Pay Cat 5 Regs
                               ADD YL0113 OF WORK-CONTEXT, 1 GIVING
                                 YL0113 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Pay Cat O Regs
                               ADD YL0115 OF WORK-CONTEXT, 1 GIVING
                                 YL0115 OF WORK-CONTEXT
                               END-IF
                           ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 1
      *                        *IF
                               IF (YL0117 OF WORK-CONTEXT = '1') THEN
      *                        U:Pay Cat 1 Regs
                               ADD YL0109 OF WORK-CONTEXT, 1 GIVING
                                 YL0109 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 2
      *                        *IF
                               IF (YL0117 OF WORK-CONTEXT = '2') THEN
      *                        U:Pay Cat 2 Regs
                               ADD YL0110 OF WORK-CONTEXT, 1 GIVING
                                 YL0110 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 3
      *                        *IF
                               IF (YL0117 OF WORK-CONTEXT = '3') THEN
      *                        U:Pay Cat 3 Regs
                               ADD YL0111 OF WORK-CONTEXT, 1 GIVING
                                 YL0111 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 4
      *                        *IF
                               IF (YL0117 OF WORK-CONTEXT = '4') THEN
      *                        U:Pay Cat 4 Regs
                               ADD YL0112 OF WORK-CONTEXT, 1 GIVING
                                 YL0112 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 5
      *                        *IF
                               IF (YL0117 OF WORK-CONTEXT = '5') THEN
      *                        U:Pay Cat 5 Regs
                               ADD YL0113 OF WORK-CONTEXT, 1 GIVING
                                 YL0113 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category N - New
      *                        *IF
                               IF (YL0117 OF WORK-CONTEXT = 'N') THEN
      *                        U:Pay Cat N Regs
                               ADD YL0114 OF WORK-CONTEXT, 1 GIVING
                                 YL0114 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Pay Cat O Regs
                               ADD YL0115 OF WORK-CONTEXT, 1 GIVING
                                 YL0115 OF WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
                   END-IF
               END-IF
               SET C-INDICATOR-OFF(90) TO TRUE
               READ SBDOTEXTL7 NEXT
                 FORMAT IS 'FDOTEGL'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         FDOTEGL OF SBDOTEXTL7-R TO
                         EXTSD4
                       MOVE EXTSD4 TO KRSSD4-TMP
                       IF (KRSSD4 NOT = KRSSD4-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        CONCES PROPRIETAIRE
               MOVE LOW-VALUES TO OSNECO OF EXTSD4
      *        DATE 58 IMMATRICULATION
               MOVE -99999999 TO OSW0NB OF EXTSD4
      *        COMMANDE CLIENT
               MOVE LOW-VALUES TO OSNUCO OF EXTSD4
           END-PERFORM
      *    USER: Exit processing
      *    U:Pay Cat 1 Regs
           MOVE YL0109 OF WORK-CONTEXT TO YL0100 OF WORK-CONTEXT
      *    U:Pay Cat 2 Regs
           MOVE YL0110 OF WORK-CONTEXT TO YL0101 OF WORK-CONTEXT
      *    U:Pay Cat 3 Regs
           MOVE YL0111 OF WORK-CONTEXT TO YL0102 OF WORK-CONTEXT
      *    U:Pay Cat 4 Regs
           MOVE YL0112 OF WORK-CONTEXT TO YL0103 OF WORK-CONTEXT
      *    U:Pay Cat 5 Regs
           MOVE YL0113 OF WORK-CONTEXT TO YL0104 OF WORK-CONTEXT
      *    U:Pay Cat N Regs
           MOVE YL0114 OF WORK-CONTEXT TO YL0105 OF WORK-CONTEXT
      *    U:Pay Cat O Regs
           MOVE YL0115 OF WORK-CONTEXT TO YL0106 OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       SD4EXIT.
           EXIT.
      /EJECT
       SD5RVGN SECTION.
      *==============================================================
      *    Rtv Car or Van SCP Mdl - Vehicle Model Bonus Atr  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    USER: Initialize routine
      *    Car/Van Indicator
           MOVE 'C' TO YL0116 OF WORK-CONTEXT
      *    Setup key
      *    Model Application Code
           MOVE 'RIC' TO LLMDLAPPCD OF KRSSD5
      *    SCP Model Code
           MOVE OSSTMDLSCP OF FDOTEGL OF SBDOTEXTL7-R TO LLSCMDLCDE OF
             KRSSD5
      *    Initialise Full Externally Described Keylist
      *    Model Application Code
           MOVE LOW-VALUES TO LLMDLAPPCD OF EXTSD5
      *    SCP Model Code
           MOVE LOW-VALUES TO LLSCMDLCDE OF EXTSD5
           MOVE CORRESPONDING
             KRSSD5 TO
             VAMDLBNSF1 OF VAMDLBNSL1-R
           SET C-INDICATOR-OFF(90) TO TRUE
           READ VAMDLBNSL1
             FORMAT IS 'VAMDLBNSF1'
           END-READ
           IF (C-NO-RECORD) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               END-IF
           END-IF
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR7127' TO W0RTN
      *        USER: Processing if Data record not found
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SD5EXIT
           END-IF
      *
           IF (C-INDICATOR-OFF(90)) THEN
      *        USER: Process Data record
      *        Car/Van Indicator
               MOVE LLCORV OF VAMDLBNSF1 OF VAMDLBNSL1-R TO YL0116 OF
                 WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
           END-IF
      *==============================================================
           CONTINUE.
       SD5EXIT.
           EXIT.
      /EJECT
       SD6RVGN SECTION.
      *==============================================================
      *    Rtv Rtn Latest Brand Mdl - Bonus Sls-RIC Mdl Dsp Seq  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    SCP Model Code
           MOVE OSSTMDLSCP OF FDOTEGL OF SBDOTEXTL7-R TO O9SCMDLCDE OF
             KRSSD6
      *    Initialise Full Externally Described Keylist
      *    SCP Model Code
           MOVE LOW-VALUES TO O9SCMDLCDE OF EXTSD6
      *    Bns RIC Config Year
           MOVE 9999 TO O9BNSRICYR OF EXTSD6
      *    Bns RIC Display Sequence
           MOVE -999 TO O9BNSRICSQ OF EXTSD6
           MOVE CORRESPONDING
             EXTSD6 TO
             SBRICDSQF4 OF SBRICDSQL4-R
           MOVE CORRESPONDING
             KRSSD6 TO
             SBRICDSQF4 OF SBRICDSQL4-R
           START SBRICDSQL4 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'SBRICDSQF4'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ SBRICDSQL4 NEXT
             FORMAT IS 'SBRICDSQF4'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     SBRICDSQF4 OF SBRICDSQL4-R TO
                     EXTSD6
                   MOVE EXTSD6 TO KRSSD6-TMP
                   IF (KRSSD6 NOT = KRSSD6-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    SCP Model Code
           MOVE LOW-VALUES TO O9SCMDLCDE OF EXTSD6
      *    Bns RIC Config Year
           MOVE 9999 TO O9BNSRICYR OF EXTSD6
      *    Bns RIC Display Sequence
           MOVE -999 TO O9BNSRICSQ OF EXTSD6
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR7404' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Bns Brand Name
               MOVE SPACES TO YL0118 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SD6EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Bns Brand Name
               MOVE O9BNSBRNDD OF SBRICDSQF4 OF SBRICDSQL4-R TO YL0118
                 OF WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
      *        *QUIT
               GO SD6EXIT
               SET C-INDICATOR-OFF(90) TO TRUE
               READ SBRICDSQL4 NEXT
                 FORMAT IS 'SBRICDSQF4'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         SBRICDSQF4 OF SBRICDSQL4-R TO
                         EXTSD6
                       MOVE EXTSD6 TO KRSSD6-TMP
                       IF (KRSSD6 NOT = KRSSD6-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        SCP Model Code
               MOVE LOW-VALUES TO O9SCMDLCDE OF EXTSD6
      *        Bns RIC Config Year
               MOVE 9999 TO O9BNSRICYR OF EXTSD6
      *        Bns RIC Display Sequence
               MOVE -999 TO O9BNSRICSQ OF EXTSD6
           END-PERFORM
      *==============================================================
           CONTINUE.
       SD6EXIT.
           EXIT.
      /EJECT
       SD7RVGN SECTION.
      *==============================================================
      *    Rtv All Dtl by Dlr/Mdl/ON - OBT Extract  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    Dealer number (Num key)
           MOVE YL0108 OF WORK-CONTEXT TO Q2DLRNOKEY OF KRSSD7
      *    BDC Model
           MOVE OSSTMDLSCP OF FDOTEGL OF SBDOTEXTL7-R TO Q2BDCM OF
             KRSSD7
      *    BDC Customer Order Number
           MOVE OSNUCO OF FDOTEGL OF SBDOTEXTL7-R TO Q2BDCCON OF KRSSD7
      *    Initialise Full Externally Described Keylist
      *    Dealer number (Num key)
           MOVE -99999 TO Q2DLRNOKEY OF EXTSD7
      *    BDC Model
           MOVE LOW-VALUES TO Q2BDCM OF EXTSD7
      *    BDC Customer Order Number
           MOVE LOW-VALUES TO Q2BDCCON OF EXTSD7
           MOVE CORRESPONDING
             EXTSD7 TO
             FOBEXCB OF RAOBEXTRL2-R
           MOVE CORRESPONDING
             KRSSD7 TO
             FOBEXCB OF RAOBEXTRL2-R
           START RAOBEXTRL2 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'FOBEXCB'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ RAOBEXTRL2 NEXT
             FORMAT IS 'FOBEXCB'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     FOBEXCB OF RAOBEXTRL2-R TO
                     EXTSD7
                   MOVE EXTSD7 TO KRSSD7-TMP
                   IF (KRSSD7 NOT = KRSSD7-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    Dealer number (Num key)
           MOVE -99999 TO Q2DLRNOKEY OF EXTSD7
      *    BDC Model
           MOVE LOW-VALUES TO Q2BDCM OF EXTSD7
      *    BDC Customer Order Number
           MOVE LOW-VALUES TO Q2BDCCON OF EXTSD7
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR5706' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Fleet Operator Number
               MOVE SPACES TO YL0121 OF WORK-CONTEXT
      *        BDC Payment Term
               MOVE SPACES TO YL0122 OF WORK-CONTEXT
      *        OBT Count Target Status
               MOVE SPACES TO YL0117 OF WORK-CONTEXT
      *        Fleet Programmes Code
               MOVE SPACES TO YL0119 OF WORK-CONTEXT
      *        Target Market
               MOVE SPACES TO YL0123 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SD7EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Fleet Operator Number
               MOVE Q2FLOPNO OF FOBEXCB OF RAOBEXTRL2-R TO YL0121 OF
                 WORK-CONTEXT
      *        BDC Payment Term
               MOVE Q2BDCPTRM OF FOBEXCB OF RAOBEXTRL2-R TO YL0122 OF
                 WORK-CONTEXT
      *        OBT Count Target Status
               MOVE Q2CNTTARG OF FOBEXCB OF RAOBEXTRL2-R TO YL0117 OF
                 WORK-CONTEXT
      *        Fleet Programmes Code
               MOVE Q2FLPGMCDE OF FOBEXCB OF RAOBEXTRL2-R TO YL0119 OF
                 WORK-CONTEXT
      *        Target Market
               MOVE Q2TGTMRKET OF FOBEXCB OF RAOBEXTRL2-R TO YL0123 OF
                 WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
      *        *QUIT
               GO SD7EXIT
               SET C-INDICATOR-OFF(90) TO TRUE
               READ RAOBEXTRL2 NEXT
                 FORMAT IS 'FOBEXCB'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         FOBEXCB OF RAOBEXTRL2-R TO
                         EXTSD7
                       MOVE EXTSD7 TO KRSSD7-TMP
                       IF (KRSSD7 NOT = KRSSD7-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        Dealer number (Num key)
               MOVE -99999 TO Q2DLRNOKEY OF EXTSD7
      *        BDC Model
               MOVE LOW-VALUES TO Q2BDCM OF EXTSD7
      *        BDC Customer Order Number
               MOVE LOW-VALUES TO Q2BDCCON OF EXTSD7
           END-PERFORM
      *==============================================================
           CONTINUE.
       SD7EXIT.
           EXIT.
      /EJECT
       SD8RVGN SECTION.
      *==============================================================
      *    Rtv No of Regs Derg TCTT - BDC.-.SEDRE DOT Extract  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    USER: Initialize routine
      *    Cvt *Job date to DTX
      *    * Job date contains a leading 1 when the year is 2000 or
      *      greater
      *    U:Job Date DTX
           ADD ZZJDT OF JOB-CONTEXT, 19000000 GIVING YL0131 OF
             WORK-CONTEXT
      *    Utl Cvt Dealer 6 to 5N
           MOVE 5 TO YRSW03
           MOVE 2 TO YRSW02
           IF (YRSW02 NOT > 0 OR
               YRSW03 NOT > 0 OR
               YRSW02 > 00006 OR
               YRSW03 > 00006) THEN
               MOVE 'Y2U0510' TO W0RTN
           ELSE
               MOVE WUNECO OF WORK-CONTEXT TO W0STRNG
               MOVE W0STRNG(YRSW02:YRSW03) TO WUUCODE5 OF WORK-CONTEXT
           END-IF
           IF (WUUCODE5 OF WORK-CONTEXT = SPACES) THEN
               MOVE ZERO TO YL0132 OF WORK-CONTEXT
           ELSE
               MOVE WUUCODE5 OF WORK-CONTEXT TO YL0132 OF WORK-CONTEXT
           END-IF
      *    U:Pay Cat 1 De-Regs
           MOVE ZEROS TO YL0124 OF WORK-CONTEXT
      *    U:Pay Cat 1 De-Regs
           MOVE ZEROS TO YL0133 OF WORK-CONTEXT
      *    U:Pay Cat 2 De-Regs
           MOVE ZEROS TO YL0125 OF WORK-CONTEXT
      *    U:Pay Cat 2 De-Regs
           MOVE ZEROS TO YL0134 OF WORK-CONTEXT
      *    U:Pay Cat 3 De-Regs
           MOVE ZEROS TO YL0126 OF WORK-CONTEXT
      *    U:Pay Cat 3 De-Regs
           MOVE ZEROS TO YL0135 OF WORK-CONTEXT
      *    U:Pay Cat 4 De-Regs
           MOVE ZEROS TO YL0127 OF WORK-CONTEXT
      *    U:Pay Cat 4 De-Regs
           MOVE ZEROS TO YL0136 OF WORK-CONTEXT
      *    U:Pay Cat 5 De-Regs
           MOVE ZEROS TO YL0128 OF WORK-CONTEXT
      *    U:Pay Cat 5 De-Regs
           MOVE ZEROS TO YL0137 OF WORK-CONTEXT
      *    U:Pay Cat N De-Regs
           MOVE ZEROS TO YL0129 OF WORK-CONTEXT
      *    U:Pay Cat N De-Regs
           MOVE ZEROS TO YL0138 OF WORK-CONTEXT
      *    U:Pay Cat O De-Regs
           MOVE ZEROS TO YL0130 OF WORK-CONTEXT
      *    U:Pay Cat O De-Regs
           MOVE ZEROS TO YL0139 OF WORK-CONTEXT
      *    Setup key
      *    CONCES PROPRIETAIRE
           MOVE WUNECO OF WORK-CONTEXT TO OSNECO OF KPSSD8
      *    De-reg Date NBR
           MOVE WUUFRMDTXC OF WORK-CONTEXT TO OSZXNU OF KPSSD8
           MOVE CORRESPONDING KPSSD8 TO KRSSD8
      *    Initialise Full Externally Described Keylist
      *    CONCES PROPRIETAIRE
           MOVE LOW-VALUES TO OSNECO OF EXTSD8
      *    De-reg Date NBR
           MOVE -99999999 TO OSZXNU OF EXTSD8
           MOVE CORRESPONDING
             EXTSD8 TO
             FDOTEGM OF SBDOTEXTL8-R
           MOVE CORRESPONDING
             KPSSD8 TO
             FDOTEGM OF SBDOTEXTL8-R
           START SBDOTEXTL8 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'FDOTEGM'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ SBDOTEXTL8 NEXT
             FORMAT IS 'FDOTEGM'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     FDOTEGM OF SBDOTEXTL8-R TO
                     EXTSD8
                   MOVE EXTSD8 TO KRSSD8-TMP
                   IF (KRSSD8 NOT = KRSSD8-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    CONCES PROPRIETAIRE
           MOVE LOW-VALUES TO OSNECO OF EXTSD8
      *    De-reg Date NBR
           MOVE -99999999 TO OSZXNU OF EXTSD8
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR5554' TO W0RTN
           END-IF
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        Count number of de-regs for the Model
      *        CASE: DB1.De-reg Date NBR LE PAR.U:Number (8.0)
      *        *IF
               IF (OSZXNU OF FDOTEGM OF SBDOTEXTL8-R NOT > WUUTODTXC OF
                 WORK-CONTEXT) THEN
      *            Include this one?
      *            CASE: DB1.De-reg Date NBR is NE Zero
      *            *IF
                   IF (OSZXNU OF FDOTEGM OF SBDOTEXTL8-R NOT = 0) THEN
      *                Car/Van Indicator
                       MOVE ' ' TO YL0140 OF WORK-CONTEXT
      *                OBT Count Target Status
                       MOVE ' ' TO YL0141 OF WORK-CONTEXT
      *                Rtv Car or Van SCP Mdl - Vehicle Model Bonus
      *                  Atr  *
                       PERFORM SD9RVGN
      *                Rtv Rtn Latest Brand Mdl - Bonus Sls-RIC Mdl
      *                  Dsp Seq  *
                       PERFORM SE1RVGN
      *                Fleet Programmes Code
                       MOVE SPACES TO YL0143 OF WORK-CONTEXT
                       MOVE ' ' TO YL0143 OF WORK-CONTEXT
      *                U:Continue
                       MOVE 'Y' TO YL0144 OF WORK-CONTEXT
      *                Rtv First Dtls for Chass - OBT Extract  *
                       PERFORM SE2RVGN
      *                Check Target Type Deselection
      *                CASE: PAR.U:Target Prefix is Target total
      *                *IF
                       IF ('TT' = 'TT') THEN
                           CONTINUE
                       ELSE
      *                    CASE: PAR.U:Target Prefix is Target Local
      *                      Market
      *                    *IF
                           IF ('TT' = 'TL') THEN
      *                        CASE: LCL.Target Market is Local Market
      *                          Target List
      *                        *IF
                               IF (YL0147 OF WORK-CONTEXT = 'L' OR
                                   YL0147 OF WORK-CONTEXT = 'W' OR
                                   YL0147 OF WORK-CONTEXT = 'R') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0144 OF WORK-CONTEXT
                               END-IF
                           ELSE
      *                        CASE: PAR.U:Target Prefix is Target
      *                          Major Fleet
      *                        *IF
                               IF ('TT' = 'TM') THEN
      *                        CASE: LCL.Target Market is Major Fleet
      *                          Target
      *                        *IF
                               IF (YL0147 OF WORK-CONTEXT = 'M') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0144 OF WORK-CONTEXT
                               END-IF
                               ELSE
      *                        CASE: PAR.U:Target Prefix is Target not
      *                          fleet
      *                        *IF
                               IF ('TT' = 'TN') THEN
      *                        CASE:
      *                        - c1 OR c2
      *                        |- c1    : LCL.Fleet Programmes Code is
      *                          *Blank
      *                        |- c2    : LCL.Fleet Programmes Code is
      *                          UNS - Unsupported (30286)
      *                        '-
      *                        *IF
                               IF (YL0143 OF WORK-CONTEXT = ' ' OR
                                   YL0143 OF WORK-CONTEXT = 'UNS') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0144 OF WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
      *                If O.K. to Continue - Following Record
      *                  Deselection
      *                CASE: LCL.U:Continue is Yes
      *                *IF
                       IF (YL0144 OF WORK-CONTEXT = 'Y') THEN
      *                    CASE: LCL.OBT Count Target Status is
      *                      Payment Category 1
      *                    *IF
                           IF (YL0141 OF WORK-CONTEXT = '1') THEN
      *                        U:Pay Cat 1 De-Regs
                               ADD YL0133 OF WORK-CONTEXT, 1 GIVING
                                 YL0133 OF WORK-CONTEXT
                           ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 2
      *                        *IF
                               IF (YL0141 OF WORK-CONTEXT = '2') THEN
      *                        U:Pay Cat 2 De-Regs
                               ADD YL0134 OF WORK-CONTEXT, 1 GIVING
                                 YL0134 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 3
      *                        *IF
                               IF (YL0141 OF WORK-CONTEXT = '3') THEN
      *                        U:Pay Cat 3 De-Regs
                               ADD YL0135 OF WORK-CONTEXT, 1 GIVING
                                 YL0135 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 4
      *                        *IF
                               IF (YL0141 OF WORK-CONTEXT = '4') THEN
      *                        U:Pay Cat 4 De-Regs
                               ADD YL0136 OF WORK-CONTEXT, 1 GIVING
                                 YL0136 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 5
      *                        *IF
                               IF (YL0141 OF WORK-CONTEXT = '5') THEN
      *                        U:Pay Cat 5 De-Regs
                               ADD YL0137 OF WORK-CONTEXT, 1 GIVING
                                 YL0137 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category N - New
      *                        *IF
                               IF (YL0141 OF WORK-CONTEXT = 'N') THEN
      *                        U:Pay Cat N De-Regs
                               ADD YL0138 OF WORK-CONTEXT, 1 GIVING
                                 YL0138 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
      *                        CASE: LCL.Bns Brand Name is RENAULT
      *                        *IF
                               IF (YL0142 OF WORK-CONTEXT = 'RENAULT')
                                 THEN
      *                        U:Pay Cat 5 De-Regs
                               ADD YL0137 OF WORK-CONTEXT, 1 GIVING
                                 YL0137 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Pay Cat O De-Regs
                               ADD YL0139 OF WORK-CONTEXT, 1 GIVING
                                 YL0139 OF WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
                   END-IF
               END-IF
               SET C-INDICATOR-OFF(90) TO TRUE
               READ SBDOTEXTL8 NEXT
                 FORMAT IS 'FDOTEGM'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         FDOTEGM OF SBDOTEXTL8-R TO
                         EXTSD8
                       MOVE EXTSD8 TO KRSSD8-TMP
                       IF (KRSSD8 NOT = KRSSD8-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        CONCES PROPRIETAIRE
               MOVE LOW-VALUES TO OSNECO OF EXTSD8
      *        De-reg Date NBR
               MOVE -99999999 TO OSZXNU OF EXTSD8
           END-PERFORM
      *    USER: Exit processing
      *    U:Pay Cat 1 De-Regs
           MOVE YL0133 OF WORK-CONTEXT TO YL0124 OF WORK-CONTEXT
      *    U:Pay Cat 2 De-Regs
           MOVE YL0134 OF WORK-CONTEXT TO YL0125 OF WORK-CONTEXT
      *    U:Pay Cat 3 De-Regs
           MOVE YL0135 OF WORK-CONTEXT TO YL0126 OF WORK-CONTEXT
      *    U:Pay Cat 4 De-Regs
           MOVE YL0136 OF WORK-CONTEXT TO YL0127 OF WORK-CONTEXT
      *    U:Pay Cat 5 De-Regs
           MOVE YL0137 OF WORK-CONTEXT TO YL0128 OF WORK-CONTEXT
      *    U:Pay Cat N De-Regs
           MOVE YL0138 OF WORK-CONTEXT TO YL0129 OF WORK-CONTEXT
      *    U:Pay Cat O De-Regs
           MOVE YL0139 OF WORK-CONTEXT TO YL0130 OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       SD8EXIT.
           EXIT.
      /EJECT
       SD9RVGN SECTION.
      *==============================================================
      *    Rtv Car or Van SCP Mdl - Vehicle Model Bonus Atr  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    USER: Initialize routine
      *    Car/Van Indicator
           MOVE 'C' TO YL0140 OF WORK-CONTEXT
      *    Setup key
      *    Model Application Code
           MOVE 'RIC' TO LLMDLAPPCD OF KRSSD9
      *    SCP Model Code
           MOVE OSSTMDLSCP OF FDOTEGM OF SBDOTEXTL8-R TO LLSCMDLCDE OF
             KRSSD9
      *    Initialise Full Externally Described Keylist
      *    Model Application Code
           MOVE LOW-VALUES TO LLMDLAPPCD OF EXTSD9
      *    SCP Model Code
           MOVE LOW-VALUES TO LLSCMDLCDE OF EXTSD9
           MOVE CORRESPONDING
             KRSSD9 TO
             VAMDLBNSF1 OF VAMDLBNSL1-R
           SET C-INDICATOR-OFF(90) TO TRUE
           READ VAMDLBNSL1
             FORMAT IS 'VAMDLBNSF1'
           END-READ
           IF (C-NO-RECORD) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               END-IF
           END-IF
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR7127' TO W0RTN
      *        USER: Processing if Data record not found
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SD9EXIT
           END-IF
      *
           IF (C-INDICATOR-OFF(90)) THEN
      *        USER: Process Data record
      *        Car/Van Indicator
               MOVE LLCORV OF VAMDLBNSF1 OF VAMDLBNSL1-R TO YL0140 OF
                 WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
           END-IF
      *==============================================================
           CONTINUE.
       SD9EXIT.
           EXIT.
      /EJECT
       SE1RVGN SECTION.
      *==============================================================
      *    Rtv Rtn Latest Brand Mdl - Bonus Sls-RIC Mdl Dsp Seq  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    SCP Model Code
           MOVE OSSTMDLSCP OF FDOTEGM OF SBDOTEXTL8-R TO O9SCMDLCDE OF
             KRSSE1
      *    Initialise Full Externally Described Keylist
      *    SCP Model Code
           MOVE LOW-VALUES TO O9SCMDLCDE OF EXTSE1
      *    Bns RIC Config Year
           MOVE 9999 TO O9BNSRICYR OF EXTSE1
      *    Bns RIC Display Sequence
           MOVE -999 TO O9BNSRICSQ OF EXTSE1
           MOVE CORRESPONDING
             EXTSE1 TO
             SBRICDSQF4 OF SBRICDSQL4-R
           MOVE CORRESPONDING
             KRSSE1 TO
             SBRICDSQF4 OF SBRICDSQL4-R
           START SBRICDSQL4 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'SBRICDSQF4'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ SBRICDSQL4 NEXT
             FORMAT IS 'SBRICDSQF4'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     SBRICDSQF4 OF SBRICDSQL4-R TO
                     EXTSE1
                   MOVE EXTSE1 TO KRSSE1-TMP
                   IF (KRSSE1 NOT = KRSSE1-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    SCP Model Code
           MOVE LOW-VALUES TO O9SCMDLCDE OF EXTSE1
      *    Bns RIC Config Year
           MOVE 9999 TO O9BNSRICYR OF EXTSE1
      *    Bns RIC Display Sequence
           MOVE -999 TO O9BNSRICSQ OF EXTSE1
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR7404' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Bns Brand Name
               MOVE SPACES TO YL0142 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SE1EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Bns Brand Name
               MOVE O9BNSBRNDD OF SBRICDSQF4 OF SBRICDSQL4-R TO YL0142
                 OF WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
      *        *QUIT
               GO SE1EXIT
               SET C-INDICATOR-OFF(90) TO TRUE
               READ SBRICDSQL4 NEXT
                 FORMAT IS 'SBRICDSQF4'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         SBRICDSQF4 OF SBRICDSQL4-R TO
                         EXTSE1
                       MOVE EXTSE1 TO KRSSE1-TMP
                       IF (KRSSE1 NOT = KRSSE1-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        SCP Model Code
               MOVE LOW-VALUES TO O9SCMDLCDE OF EXTSE1
      *        Bns RIC Config Year
               MOVE 9999 TO O9BNSRICYR OF EXTSE1
      *        Bns RIC Display Sequence
               MOVE -999 TO O9BNSRICSQ OF EXTSE1
           END-PERFORM
      *==============================================================
           CONTINUE.
       SE1EXIT.
           EXIT.
      /EJECT
       SE2RVGN SECTION.
      *==============================================================
      *    Rtv First Dtls for Chass - OBT Extract  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    Chassis number
           MOVE OSYPTX OF FDOTEGM OF SBDOTEXTL8-R TO Q2ASXX OF KRSSE2
      *    Initialise Full Externally Described Keylist
      *    Chassis number
           MOVE LOW-VALUES TO Q2ASXX OF EXTSE2
           MOVE CORRESPONDING
             EXTSE2 TO
             RAOBEXTRF4 OF RAOBEXTRL4-R
           MOVE CORRESPONDING
             KRSSE2 TO
             RAOBEXTRF4 OF RAOBEXTRL4-R
           START RAOBEXTRL4 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'RAOBEXTRF4'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ RAOBEXTRL4 NEXT
             FORMAT IS 'RAOBEXTRF4'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     RAOBEXTRF4 OF RAOBEXTRL4-R TO
                     EXTSE2
                   MOVE EXTSE2 TO KRSSE2-TMP
                   IF (KRSSE2 NOT = KRSSE2-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    Chassis number
           MOVE LOW-VALUES TO Q2ASXX OF EXTSE2
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR5706' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Fleet Operator Number
               MOVE SPACES TO YL0145 OF WORK-CONTEXT
      *        BDC Payment Term
               MOVE SPACES TO YL0146 OF WORK-CONTEXT
      *        OBT Count Target Status
               MOVE SPACES TO YL0141 OF WORK-CONTEXT
      *        Fleet Programmes Code
               MOVE SPACES TO YL0143 OF WORK-CONTEXT
      *        Target Market
               MOVE SPACES TO YL0147 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SE2EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Fleet Operator Number
               MOVE Q2FLOPNO OF RAOBEXTRF4 OF RAOBEXTRL4-R TO YL0145 OF
                 WORK-CONTEXT
      *        BDC Payment Term
               MOVE Q2BDCPTRM OF RAOBEXTRF4 OF RAOBEXTRL4-R TO YL0146
                 OF WORK-CONTEXT
      *        OBT Count Target Status
               MOVE Q2CNTTARG OF RAOBEXTRF4 OF RAOBEXTRL4-R TO YL0141
                 OF WORK-CONTEXT
      *        Fleet Programmes Code
               MOVE Q2FLPGMCDE OF RAOBEXTRF4 OF RAOBEXTRL4-R TO YL0143
                 OF WORK-CONTEXT
      *        Target Market
               MOVE Q2TGTMRKET OF RAOBEXTRF4 OF RAOBEXTRL4-R TO YL0147
                 OF WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
      *        *QUIT
               GO SE2EXIT
               SET C-INDICATOR-OFF(90) TO TRUE
               READ RAOBEXTRL4 NEXT
                 FORMAT IS 'RAOBEXTRF4'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         RAOBEXTRF4 OF RAOBEXTRL4-R TO
                         EXTSE2
                       MOVE EXTSE2 TO KRSSE2-TMP
                       IF (KRSSE2 NOT = KRSSE2-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        Chassis number
               MOVE LOW-VALUES TO Q2ASXX OF EXTSE2
           END-PERFORM
      *==============================================================
           CONTINUE.
       SE2EXIT.
           EXIT.
      /EJECT
       SE3RVGN SECTION.
      *==============================================================
      *    Rtv No of Regs TCTT - BDC.-.SEDRE DOT Extract  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    USER: Initialize routine
      *    Cvt *Job date to DTX
      *    * Job date contains a leading 1 when the year is 2000 or
      *      greater
      *    U:Job Date DTX
           ADD ZZJDT OF JOB-CONTEXT, 19000000 GIVING YL0107 OF
             WORK-CONTEXT
      *    Utl Cvt Dealer 6 to 5N
           MOVE 5 TO YRSW03
           MOVE 2 TO YRSW02
           IF (YRSW02 NOT > 0 OR
               YRSW03 NOT > 0 OR
               YRSW02 > 00006 OR
               YRSW03 > 00006) THEN
               MOVE 'Y2U0510' TO W0RTN
           ELSE
               MOVE WUTOCF OF WORK-CONTEXT TO W0STRNG
               MOVE W0STRNG(YRSW02:YRSW03) TO WUUCODE5 OF WORK-CONTEXT
           END-IF
           IF (WUUCODE5 OF WORK-CONTEXT = SPACES) THEN
               MOVE ZERO TO YL0108 OF WORK-CONTEXT
           ELSE
               MOVE WUUCODE5 OF WORK-CONTEXT TO YL0108 OF WORK-CONTEXT
           END-IF
      *    U:Pay Cat 1 Regs
           MOVE ZEROS TO YL0148 OF WORK-CONTEXT
      *    U:Pay Cat 1 Regs
           MOVE ZEROS TO YL0109 OF WORK-CONTEXT
      *    U:Pay Cat 2 Regs
           MOVE ZEROS TO YL0149 OF WORK-CONTEXT
      *    U:Pay Cat 2 Regs
           MOVE ZEROS TO YL0110 OF WORK-CONTEXT
      *    U:Pay Cat 3 Regs
           MOVE ZEROS TO YL0150 OF WORK-CONTEXT
      *    U:Pay Cat 3 Regs
           MOVE ZEROS TO YL0111 OF WORK-CONTEXT
      *    U:Pay Cat 4 Regs
           MOVE ZEROS TO YL0151 OF WORK-CONTEXT
      *    U:Pay Cat 4 Regs
           MOVE ZEROS TO YL0112 OF WORK-CONTEXT
      *    U:Pay Cat 5 Regs
           MOVE ZEROS TO YL0152 OF WORK-CONTEXT
      *    U:Pay Cat 5 Regs
           MOVE ZEROS TO YL0113 OF WORK-CONTEXT
      *    U:Pay Cat N Regs
           MOVE ZEROS TO YL0153 OF WORK-CONTEXT
      *    U:Pay Cat N Regs
           MOVE ZEROS TO YL0114 OF WORK-CONTEXT
      *    U:Pay Cat O Regs
           MOVE ZEROS TO YL0154 OF WORK-CONTEXT
      *    U:Pay Cat O Regs
           MOVE ZEROS TO YL0115 OF WORK-CONTEXT
      *    Setup key
      *    CONCES PROPRIETAIRE
           MOVE WUTOCF OF WORK-CONTEXT TO OSNECO OF KPSSE3
      *    DATE 58 IMMATRICULATION
           MOVE WUUFRMDTXC OF WORK-CONTEXT TO OSW0NB OF KPSSE3
           MOVE CORRESPONDING KPSSE3 TO KRSSE3
      *    Initialise Full Externally Described Keylist
      *    CONCES PROPRIETAIRE
           MOVE LOW-VALUES TO OSNECO OF EXTSE3
      *    DATE 58 IMMATRICULATION
           MOVE -99999999 TO OSW0NB OF EXTSE3
      *    COMMANDE CLIENT
           MOVE LOW-VALUES TO OSNUCO OF EXTSE3
           MOVE CORRESPONDING
             EXTSE3 TO
             FDOTEGL OF SBDOTEXTL7-R
           MOVE CORRESPONDING
             KPSSE3 TO
             FDOTEGL OF SBDOTEXTL7-R
           START SBDOTEXTL7 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'FDOTEGL'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ SBDOTEXTL7 NEXT
             FORMAT IS 'FDOTEGL'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     FDOTEGL OF SBDOTEXTL7-R TO
                     EXTSE3
                   MOVE EXTSE3 TO KRSSE3-TMP
                   IF (KRSSE3 NOT = KRSSE3-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    CONCES PROPRIETAIRE
           MOVE LOW-VALUES TO OSNECO OF EXTSE3
      *    DATE 58 IMMATRICULATION
           MOVE -99999999 TO OSW0NB OF EXTSE3
      *    COMMANDE CLIENT
           MOVE LOW-VALUES TO OSNUCO OF EXTSE3
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR5554' TO W0RTN
           END-IF
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        Count number of registrations for the Model
      *        CASE: DB1.DATE 58 IMMATRICULATION LE PAR.U:Number (8.0)
      *        *IF
               IF (OSW0NB OF FDOTEGL OF SBDOTEXTL7-R NOT > WUUTODTXC OF
                 WORK-CONTEXT) THEN
      *            Include this one?
      *            CASE: DB1.DATE 58 IMMATRICULATION is NE Zero
      *            *IF
                   IF (OSW0NB OF FDOTEGL OF SBDOTEXTL7-R NOT = 0) THEN
      *                Car/Van Indicator
                       MOVE ' ' TO YL0116 OF WORK-CONTEXT
      *                OBT Count Target Status
                       MOVE ' ' TO YL0117 OF WORK-CONTEXT
      *                Rtv Car or Van SCP Mdl - Vehicle Model Bonus
      *                  Atr  *
                       PERFORM SE4RVGN
      *                Rtv Rtn Latest Brand Mdl - Bonus Sls-RIC Mdl
      *                  Dsp Seq  *
                       PERFORM SE5RVGN
      *                Fleet Programmes Code
                       MOVE SPACES TO YL0119 OF WORK-CONTEXT
                       MOVE ' ' TO YL0119 OF WORK-CONTEXT
      *                U:Continue
                       MOVE 'Y' TO YL0120 OF WORK-CONTEXT
      *                Rtv All Dtl by Dlr/Mdl/ON - OBT Extract  *
                       PERFORM SE6RVGN
      *                Check Target Type Deselection
      *                CASE: PAR.U:Target Prefix is Target total
      *                *IF
                       IF ('TT' = 'TT') THEN
                           CONTINUE
                       ELSE
      *                    CASE: PAR.U:Target Prefix is Target Local
      *                      Market
      *                    *IF
                           IF ('TT' = 'TL') THEN
      *                        CASE: LCL.Target Market is Local Market
      *                          Target List
      *                        *IF
                               IF (YL0123 OF WORK-CONTEXT = 'L' OR
                                   YL0123 OF WORK-CONTEXT = 'W' OR
                                   YL0123 OF WORK-CONTEXT = 'R') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0120 OF WORK-CONTEXT
                               END-IF
                           ELSE
      *                        CASE: PAR.U:Target Prefix is Target
      *                          Major Fleet
      *                        *IF
                               IF ('TT' = 'TM') THEN
      *                        CASE: LCL.Target Market is Major Fleet
      *                          Target
      *                        *IF
                               IF (YL0123 OF WORK-CONTEXT = 'M') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0120 OF WORK-CONTEXT
                               END-IF
                               ELSE
      *                        CASE: PAR.U:Target Prefix is Target not
      *                          fleet
      *                        *IF
                               IF ('TT' = 'TN') THEN
      *                        CASE:
      *                        - c1 OR c2
      *                        |- c1    : LCL.Fleet Programmes Code is
      *                          *Blank
      *                        |- c2    : LCL.Fleet Programmes Code is
      *                          UNS - Unsupported (30286)
      *                        '-
      *                        *IF
                               IF (YL0119 OF WORK-CONTEXT = ' ' OR
                                   YL0119 OF WORK-CONTEXT = 'UNS') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0120 OF WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
      *                If O.K. to Continue - Following Record
      *                  Deselection
      *                CASE: LCL.U:Continue is Yes
      *                *IF
                       IF (YL0120 OF WORK-CONTEXT = 'Y') THEN
      *                    CASE: DB1.De-reg Date NBR is NE Zero
      *                    *IF
                           IF (OSZXNU OF FDOTEGL OF SBDOTEXTL7-R NOT =
                             0) THEN
      *                        For De-Regs
      *                        CASE:
      *                        - c1 OR c2
      *                        |- c1    : LCL.OBT Count Target Status
      *                          is In Target List
      *                        |- c2    : LCL.Bns Brand Name is RENAULT
      *                        '-
      *                        *IF
                               IF ((YL0117 OF WORK-CONTEXT = 'I' OR
                                    YL0117 OF WORK-CONTEXT = '1' OR
                                    YL0117 OF WORK-CONTEXT = '2' OR
                                    YL0117 OF WORK-CONTEXT = '3' OR
                                    YL0117 OF WORK-CONTEXT = '4' OR
                                    YL0117 OF WORK-CONTEXT = '5' OR
                                    YL0117 OF WORK-CONTEXT = 'N') OR
                                   YL0118 OF WORK-CONTEXT = 'RENAULT')
                                 THEN
      *                        U:Pay Cat 5 Regs
                               ADD YL0113 OF WORK-CONTEXT, 1 GIVING
                                 YL0113 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Pay Cat O Regs
                               ADD YL0115 OF WORK-CONTEXT, 1 GIVING
                                 YL0115 OF WORK-CONTEXT
                               END-IF
                           ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 1
      *                        *IF
                               IF (YL0117 OF WORK-CONTEXT = '1') THEN
      *                        U:Pay Cat 1 Regs
                               ADD YL0109 OF WORK-CONTEXT, 1 GIVING
                                 YL0109 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 2
      *                        *IF
                               IF (YL0117 OF WORK-CONTEXT = '2') THEN
      *                        U:Pay Cat 2 Regs
                               ADD YL0110 OF WORK-CONTEXT, 1 GIVING
                                 YL0110 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 3
      *                        *IF
                               IF (YL0117 OF WORK-CONTEXT = '3') THEN
      *                        U:Pay Cat 3 Regs
                               ADD YL0111 OF WORK-CONTEXT, 1 GIVING
                                 YL0111 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 4
      *                        *IF
                               IF (YL0117 OF WORK-CONTEXT = '4') THEN
      *                        U:Pay Cat 4 Regs
                               ADD YL0112 OF WORK-CONTEXT, 1 GIVING
                                 YL0112 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 5
      *                        *IF
                               IF (YL0117 OF WORK-CONTEXT = '5') THEN
      *                        U:Pay Cat 5 Regs
                               ADD YL0113 OF WORK-CONTEXT, 1 GIVING
                                 YL0113 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category N - New
      *                        *IF
                               IF (YL0117 OF WORK-CONTEXT = 'N') THEN
      *                        U:Pay Cat N Regs
                               ADD YL0114 OF WORK-CONTEXT, 1 GIVING
                                 YL0114 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Pay Cat O Regs
                               ADD YL0115 OF WORK-CONTEXT, 1 GIVING
                                 YL0115 OF WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
                   END-IF
               END-IF
               SET C-INDICATOR-OFF(90) TO TRUE
               READ SBDOTEXTL7 NEXT
                 FORMAT IS 'FDOTEGL'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         FDOTEGL OF SBDOTEXTL7-R TO
                         EXTSE3
                       MOVE EXTSE3 TO KRSSE3-TMP
                       IF (KRSSE3 NOT = KRSSE3-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        CONCES PROPRIETAIRE
               MOVE LOW-VALUES TO OSNECO OF EXTSE3
      *        DATE 58 IMMATRICULATION
               MOVE -99999999 TO OSW0NB OF EXTSE3
      *        COMMANDE CLIENT
               MOVE LOW-VALUES TO OSNUCO OF EXTSE3
           END-PERFORM
      *    USER: Exit processing
      *    U:Pay Cat 1 Regs
           MOVE YL0109 OF WORK-CONTEXT TO YL0148 OF WORK-CONTEXT
      *    U:Pay Cat 2 Regs
           MOVE YL0110 OF WORK-CONTEXT TO YL0149 OF WORK-CONTEXT
      *    U:Pay Cat 3 Regs
           MOVE YL0111 OF WORK-CONTEXT TO YL0150 OF WORK-CONTEXT
      *    U:Pay Cat 4 Regs
           MOVE YL0112 OF WORK-CONTEXT TO YL0151 OF WORK-CONTEXT
      *    U:Pay Cat 5 Regs
           MOVE YL0113 OF WORK-CONTEXT TO YL0152 OF WORK-CONTEXT
      *    U:Pay Cat N Regs
           MOVE YL0114 OF WORK-CONTEXT TO YL0153 OF WORK-CONTEXT
      *    U:Pay Cat O Regs
           MOVE YL0115 OF WORK-CONTEXT TO YL0154 OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       SE3EXIT.
           EXIT.
      /EJECT
       SE4RVGN SECTION.
      *==============================================================
      *    Rtv Car or Van SCP Mdl - Vehicle Model Bonus Atr  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    USER: Initialize routine
      *    Car/Van Indicator
           MOVE 'C' TO YL0116 OF WORK-CONTEXT
      *    Setup key
      *    Model Application Code
           MOVE 'RIC' TO LLMDLAPPCD OF KRSSE4
      *    SCP Model Code
           MOVE OSSTMDLSCP OF FDOTEGL OF SBDOTEXTL7-R TO LLSCMDLCDE OF
             KRSSE4
      *    Initialise Full Externally Described Keylist
      *    Model Application Code
           MOVE LOW-VALUES TO LLMDLAPPCD OF EXTSE4
      *    SCP Model Code
           MOVE LOW-VALUES TO LLSCMDLCDE OF EXTSE4
           MOVE CORRESPONDING
             KRSSE4 TO
             VAMDLBNSF1 OF VAMDLBNSL1-R
           SET C-INDICATOR-OFF(90) TO TRUE
           READ VAMDLBNSL1
             FORMAT IS 'VAMDLBNSF1'
           END-READ
           IF (C-NO-RECORD) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               END-IF
           END-IF
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR7127' TO W0RTN
      *        USER: Processing if Data record not found
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SE4EXIT
           END-IF
      *
           IF (C-INDICATOR-OFF(90)) THEN
      *        USER: Process Data record
      *        Car/Van Indicator
               MOVE LLCORV OF VAMDLBNSF1 OF VAMDLBNSL1-R TO YL0116 OF
                 WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
           END-IF
      *==============================================================
           CONTINUE.
       SE4EXIT.
           EXIT.
      /EJECT
       SE5RVGN SECTION.
      *==============================================================
      *    Rtv Rtn Latest Brand Mdl - Bonus Sls-RIC Mdl Dsp Seq  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    SCP Model Code
           MOVE OSSTMDLSCP OF FDOTEGL OF SBDOTEXTL7-R TO O9SCMDLCDE OF
             KRSSE5
      *    Initialise Full Externally Described Keylist
      *    SCP Model Code
           MOVE LOW-VALUES TO O9SCMDLCDE OF EXTSE5
      *    Bns RIC Config Year
           MOVE 9999 TO O9BNSRICYR OF EXTSE5
      *    Bns RIC Display Sequence
           MOVE -999 TO O9BNSRICSQ OF EXTSE5
           MOVE CORRESPONDING
             EXTSE5 TO
             SBRICDSQF4 OF SBRICDSQL4-R
           MOVE CORRESPONDING
             KRSSE5 TO
             SBRICDSQF4 OF SBRICDSQL4-R
           START SBRICDSQL4 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'SBRICDSQF4'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ SBRICDSQL4 NEXT
             FORMAT IS 'SBRICDSQF4'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     SBRICDSQF4 OF SBRICDSQL4-R TO
                     EXTSE5
                   MOVE EXTSE5 TO KRSSE5-TMP
                   IF (KRSSE5 NOT = KRSSE5-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    SCP Model Code
           MOVE LOW-VALUES TO O9SCMDLCDE OF EXTSE5
      *    Bns RIC Config Year
           MOVE 9999 TO O9BNSRICYR OF EXTSE5
      *    Bns RIC Display Sequence
           MOVE -999 TO O9BNSRICSQ OF EXTSE5
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR7404' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Bns Brand Name
               MOVE SPACES TO YL0118 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SE5EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Bns Brand Name
               MOVE O9BNSBRNDD OF SBRICDSQF4 OF SBRICDSQL4-R TO YL0118
                 OF WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
      *        *QUIT
               GO SE5EXIT
               SET C-INDICATOR-OFF(90) TO TRUE
               READ SBRICDSQL4 NEXT
                 FORMAT IS 'SBRICDSQF4'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         SBRICDSQF4 OF SBRICDSQL4-R TO
                         EXTSE5
                       MOVE EXTSE5 TO KRSSE5-TMP
                       IF (KRSSE5 NOT = KRSSE5-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        SCP Model Code
               MOVE LOW-VALUES TO O9SCMDLCDE OF EXTSE5
      *        Bns RIC Config Year
               MOVE 9999 TO O9BNSRICYR OF EXTSE5
      *        Bns RIC Display Sequence
               MOVE -999 TO O9BNSRICSQ OF EXTSE5
           END-PERFORM
      *==============================================================
           CONTINUE.
       SE5EXIT.
           EXIT.
      /EJECT
       SE6RVGN SECTION.
      *==============================================================
      *    Rtv All Dtl by Dlr/Mdl/ON - OBT Extract  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    Dealer number (Num key)
           MOVE YL0108 OF WORK-CONTEXT TO Q2DLRNOKEY OF KRSSE6
      *    BDC Model
           MOVE OSSTMDLSCP OF FDOTEGL OF SBDOTEXTL7-R TO Q2BDCM OF
             KRSSE6
      *    BDC Customer Order Number
           MOVE OSNUCO OF FDOTEGL OF SBDOTEXTL7-R TO Q2BDCCON OF KRSSE6
      *    Initialise Full Externally Described Keylist
      *    Dealer number (Num key)
           MOVE -99999 TO Q2DLRNOKEY OF EXTSE6
      *    BDC Model
           MOVE LOW-VALUES TO Q2BDCM OF EXTSE6
      *    BDC Customer Order Number
           MOVE LOW-VALUES TO Q2BDCCON OF EXTSE6
           MOVE CORRESPONDING
             EXTSE6 TO
             FOBEXCB OF RAOBEXTRL2-R
           MOVE CORRESPONDING
             KRSSE6 TO
             FOBEXCB OF RAOBEXTRL2-R
           START RAOBEXTRL2 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'FOBEXCB'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ RAOBEXTRL2 NEXT
             FORMAT IS 'FOBEXCB'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     FOBEXCB OF RAOBEXTRL2-R TO
                     EXTSE6
                   MOVE EXTSE6 TO KRSSE6-TMP
                   IF (KRSSE6 NOT = KRSSE6-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    Dealer number (Num key)
           MOVE -99999 TO Q2DLRNOKEY OF EXTSE6
      *    BDC Model
           MOVE LOW-VALUES TO Q2BDCM OF EXTSE6
      *    BDC Customer Order Number
           MOVE LOW-VALUES TO Q2BDCCON OF EXTSE6
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR5706' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Fleet Operator Number
               MOVE SPACES TO YL0121 OF WORK-CONTEXT
      *        BDC Payment Term
               MOVE SPACES TO YL0122 OF WORK-CONTEXT
      *        OBT Count Target Status
               MOVE SPACES TO YL0117 OF WORK-CONTEXT
      *        Fleet Programmes Code
               MOVE SPACES TO YL0119 OF WORK-CONTEXT
      *        Target Market
               MOVE SPACES TO YL0123 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SE6EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Fleet Operator Number
               MOVE Q2FLOPNO OF FOBEXCB OF RAOBEXTRL2-R TO YL0121 OF
                 WORK-CONTEXT
      *        BDC Payment Term
               MOVE Q2BDCPTRM OF FOBEXCB OF RAOBEXTRL2-R TO YL0122 OF
                 WORK-CONTEXT
      *        OBT Count Target Status
               MOVE Q2CNTTARG OF FOBEXCB OF RAOBEXTRL2-R TO YL0117 OF
                 WORK-CONTEXT
      *        Fleet Programmes Code
               MOVE Q2FLPGMCDE OF FOBEXCB OF RAOBEXTRL2-R TO YL0119 OF
                 WORK-CONTEXT
      *        Target Market
               MOVE Q2TGTMRKET OF FOBEXCB OF RAOBEXTRL2-R TO YL0123 OF
                 WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
      *        *QUIT
               GO SE6EXIT
               SET C-INDICATOR-OFF(90) TO TRUE
               READ RAOBEXTRL2 NEXT
                 FORMAT IS 'FOBEXCB'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         FOBEXCB OF RAOBEXTRL2-R TO
                         EXTSE6
                       MOVE EXTSE6 TO KRSSE6-TMP
                       IF (KRSSE6 NOT = KRSSE6-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        Dealer number (Num key)
               MOVE -99999 TO Q2DLRNOKEY OF EXTSE6
      *        BDC Model
               MOVE LOW-VALUES TO Q2BDCM OF EXTSE6
      *        BDC Customer Order Number
               MOVE LOW-VALUES TO Q2BDCCON OF EXTSE6
           END-PERFORM
      *==============================================================
           CONTINUE.
       SE6EXIT.
           EXIT.
      /EJECT
       SE7RVGN SECTION.
      *==============================================================
      *    Rtv No of Regs Derg TCTT - BDC.-.SEDRE DOT Extract  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    USER: Initialize routine
      *    Cvt *Job date to DTX
      *    * Job date contains a leading 1 when the year is 2000 or
      *      greater
      *    U:Job Date DTX
           ADD ZZJDT OF JOB-CONTEXT, 19000000 GIVING YL0131 OF
             WORK-CONTEXT
      *    Utl Cvt Dealer 6 to 5N
           MOVE 5 TO YRSW03
           MOVE 2 TO YRSW02
           IF (YRSW02 NOT > 0 OR
               YRSW03 NOT > 0 OR
               YRSW02 > 00006 OR
               YRSW03 > 00006) THEN
               MOVE 'Y2U0510' TO W0RTN
           ELSE
               MOVE WUTOCF OF WORK-CONTEXT TO W0STRNG
               MOVE W0STRNG(YRSW02:YRSW03) TO WUUCODE5 OF WORK-CONTEXT
           END-IF
           IF (WUUCODE5 OF WORK-CONTEXT = SPACES) THEN
               MOVE ZERO TO YL0132 OF WORK-CONTEXT
           ELSE
               MOVE WUUCODE5 OF WORK-CONTEXT TO YL0132 OF WORK-CONTEXT
           END-IF
      *    U:Pay Cat 1 De-Regs
           MOVE ZEROS TO YL0155 OF WORK-CONTEXT
      *    U:Pay Cat 1 De-Regs
           MOVE ZEROS TO YL0133 OF WORK-CONTEXT
      *    U:Pay Cat 2 De-Regs
           MOVE ZEROS TO YL0156 OF WORK-CONTEXT
      *    U:Pay Cat 2 De-Regs
           MOVE ZEROS TO YL0134 OF WORK-CONTEXT
      *    U:Pay Cat 3 De-Regs
           MOVE ZEROS TO YL0157 OF WORK-CONTEXT
      *    U:Pay Cat 3 De-Regs
           MOVE ZEROS TO YL0135 OF WORK-CONTEXT
      *    U:Pay Cat 4 De-Regs
           MOVE ZEROS TO YL0158 OF WORK-CONTEXT
      *    U:Pay Cat 4 De-Regs
           MOVE ZEROS TO YL0136 OF WORK-CONTEXT
      *    U:Pay Cat 5 De-Regs
           MOVE ZEROS TO YL0159 OF WORK-CONTEXT
      *    U:Pay Cat 5 De-Regs
           MOVE ZEROS TO YL0137 OF WORK-CONTEXT
      *    U:Pay Cat N De-Regs
           MOVE ZEROS TO YL0160 OF WORK-CONTEXT
      *    U:Pay Cat N De-Regs
           MOVE ZEROS TO YL0138 OF WORK-CONTEXT
      *    U:Pay Cat O De-Regs
           MOVE ZEROS TO YL0161 OF WORK-CONTEXT
      *    U:Pay Cat O De-Regs
           MOVE ZEROS TO YL0139 OF WORK-CONTEXT
      *    Setup key
      *    CONCES PROPRIETAIRE
           MOVE WUTOCF OF WORK-CONTEXT TO OSNECO OF KPSSE7
      *    De-reg Date NBR
           MOVE WUUFRMDTXC OF WORK-CONTEXT TO OSZXNU OF KPSSE7
           MOVE CORRESPONDING KPSSE7 TO KRSSE7
      *    Initialise Full Externally Described Keylist
      *    CONCES PROPRIETAIRE
           MOVE LOW-VALUES TO OSNECO OF EXTSE7
      *    De-reg Date NBR
           MOVE -99999999 TO OSZXNU OF EXTSE7
           MOVE CORRESPONDING
             EXTSE7 TO
             FDOTEGM OF SBDOTEXTL8-R
           MOVE CORRESPONDING
             KPSSE7 TO
             FDOTEGM OF SBDOTEXTL8-R
           START SBDOTEXTL8 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'FDOTEGM'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ SBDOTEXTL8 NEXT
             FORMAT IS 'FDOTEGM'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     FDOTEGM OF SBDOTEXTL8-R TO
                     EXTSE7
                   MOVE EXTSE7 TO KRSSE7-TMP
                   IF (KRSSE7 NOT = KRSSE7-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    CONCES PROPRIETAIRE
           MOVE LOW-VALUES TO OSNECO OF EXTSE7
      *    De-reg Date NBR
           MOVE -99999999 TO OSZXNU OF EXTSE7
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR5554' TO W0RTN
           END-IF
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        Count number of de-regs for the Model
      *        CASE: DB1.De-reg Date NBR LE PAR.U:Number (8.0)
      *        *IF
               IF (OSZXNU OF FDOTEGM OF SBDOTEXTL8-R NOT > WUUTODTXC OF
                 WORK-CONTEXT) THEN
      *            Include this one?
      *            CASE: DB1.De-reg Date NBR is NE Zero
      *            *IF
                   IF (OSZXNU OF FDOTEGM OF SBDOTEXTL8-R NOT = 0) THEN
      *                Car/Van Indicator
                       MOVE ' ' TO YL0140 OF WORK-CONTEXT
      *                OBT Count Target Status
                       MOVE ' ' TO YL0141 OF WORK-CONTEXT
      *                Rtv Car or Van SCP Mdl - Vehicle Model Bonus
      *                  Atr  *
                       PERFORM SE8RVGN
      *                Rtv Rtn Latest Brand Mdl - Bonus Sls-RIC Mdl
      *                  Dsp Seq  *
                       PERFORM SE9RVGN
      *                Fleet Programmes Code
                       MOVE SPACES TO YL0143 OF WORK-CONTEXT
                       MOVE ' ' TO YL0143 OF WORK-CONTEXT
      *                U:Continue
                       MOVE 'Y' TO YL0144 OF WORK-CONTEXT
      *                Rtv First Dtls for Chass - OBT Extract  *
                       PERFORM SF1RVGN
      *                Check Target Type Deselection
      *                CASE: PAR.U:Target Prefix is Target total
      *                *IF
                       IF ('TT' = 'TT') THEN
                           CONTINUE
                       ELSE
      *                    CASE: PAR.U:Target Prefix is Target Local
      *                      Market
      *                    *IF
                           IF ('TT' = 'TL') THEN
      *                        CASE: LCL.Target Market is Local Market
      *                          Target List
      *                        *IF
                               IF (YL0147 OF WORK-CONTEXT = 'L' OR
                                   YL0147 OF WORK-CONTEXT = 'W' OR
                                   YL0147 OF WORK-CONTEXT = 'R') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0144 OF WORK-CONTEXT
                               END-IF
                           ELSE
      *                        CASE: PAR.U:Target Prefix is Target
      *                          Major Fleet
      *                        *IF
                               IF ('TT' = 'TM') THEN
      *                        CASE: LCL.Target Market is Major Fleet
      *                          Target
      *                        *IF
                               IF (YL0147 OF WORK-CONTEXT = 'M') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0144 OF WORK-CONTEXT
                               END-IF
                               ELSE
      *                        CASE: PAR.U:Target Prefix is Target not
      *                          fleet
      *                        *IF
                               IF ('TT' = 'TN') THEN
      *                        CASE:
      *                        - c1 OR c2
      *                        |- c1    : LCL.Fleet Programmes Code is
      *                          *Blank
      *                        |- c2    : LCL.Fleet Programmes Code is
      *                          UNS - Unsupported (30286)
      *                        '-
      *                        *IF
                               IF (YL0143 OF WORK-CONTEXT = ' ' OR
                                   YL0143 OF WORK-CONTEXT = 'UNS') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0144 OF WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
      *                If O.K. to Continue - Following Record
      *                  Deselection
      *                CASE: LCL.U:Continue is Yes
      *                *IF
                       IF (YL0144 OF WORK-CONTEXT = 'Y') THEN
      *                    CASE: LCL.OBT Count Target Status is
      *                      Payment Category 1
      *                    *IF
                           IF (YL0141 OF WORK-CONTEXT = '1') THEN
      *                        U:Pay Cat 1 De-Regs
                               ADD YL0133 OF WORK-CONTEXT, 1 GIVING
                                 YL0133 OF WORK-CONTEXT
                           ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 2
      *                        *IF
                               IF (YL0141 OF WORK-CONTEXT = '2') THEN
      *                        U:Pay Cat 2 De-Regs
                               ADD YL0134 OF WORK-CONTEXT, 1 GIVING
                                 YL0134 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 3
      *                        *IF
                               IF (YL0141 OF WORK-CONTEXT = '3') THEN
      *                        U:Pay Cat 3 De-Regs
                               ADD YL0135 OF WORK-CONTEXT, 1 GIVING
                                 YL0135 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 4
      *                        *IF
                               IF (YL0141 OF WORK-CONTEXT = '4') THEN
      *                        U:Pay Cat 4 De-Regs
                               ADD YL0136 OF WORK-CONTEXT, 1 GIVING
                                 YL0136 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 5
      *                        *IF
                               IF (YL0141 OF WORK-CONTEXT = '5') THEN
      *                        U:Pay Cat 5 De-Regs
                               ADD YL0137 OF WORK-CONTEXT, 1 GIVING
                                 YL0137 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category N - New
      *                        *IF
                               IF (YL0141 OF WORK-CONTEXT = 'N') THEN
      *                        U:Pay Cat N De-Regs
                               ADD YL0138 OF WORK-CONTEXT, 1 GIVING
                                 YL0138 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
      *                        CASE: LCL.Bns Brand Name is RENAULT
      *                        *IF
                               IF (YL0142 OF WORK-CONTEXT = 'RENAULT')
                                 THEN
      *                        U:Pay Cat 5 De-Regs
                               ADD YL0137 OF WORK-CONTEXT, 1 GIVING
                                 YL0137 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Pay Cat O De-Regs
                               ADD YL0139 OF WORK-CONTEXT, 1 GIVING
                                 YL0139 OF WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
                   END-IF
               END-IF
               SET C-INDICATOR-OFF(90) TO TRUE
               READ SBDOTEXTL8 NEXT
                 FORMAT IS 'FDOTEGM'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         FDOTEGM OF SBDOTEXTL8-R TO
                         EXTSE7
                       MOVE EXTSE7 TO KRSSE7-TMP
                       IF (KRSSE7 NOT = KRSSE7-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        CONCES PROPRIETAIRE
               MOVE LOW-VALUES TO OSNECO OF EXTSE7
      *        De-reg Date NBR
               MOVE -99999999 TO OSZXNU OF EXTSE7
           END-PERFORM
      *    USER: Exit processing
      *    U:Pay Cat 1 De-Regs
           MOVE YL0133 OF WORK-CONTEXT TO YL0155 OF WORK-CONTEXT
      *    U:Pay Cat 2 De-Regs
           MOVE YL0134 OF WORK-CONTEXT TO YL0156 OF WORK-CONTEXT
      *    U:Pay Cat 3 De-Regs
           MOVE YL0135 OF WORK-CONTEXT TO YL0157 OF WORK-CONTEXT
      *    U:Pay Cat 4 De-Regs
           MOVE YL0136 OF WORK-CONTEXT TO YL0158 OF WORK-CONTEXT
      *    U:Pay Cat 5 De-Regs
           MOVE YL0137 OF WORK-CONTEXT TO YL0159 OF WORK-CONTEXT
      *    U:Pay Cat N De-Regs
           MOVE YL0138 OF WORK-CONTEXT TO YL0160 OF WORK-CONTEXT
      *    U:Pay Cat O De-Regs
           MOVE YL0139 OF WORK-CONTEXT TO YL0161 OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       SE7EXIT.
           EXIT.
      /EJECT
       SE8RVGN SECTION.
      *==============================================================
      *    Rtv Car or Van SCP Mdl - Vehicle Model Bonus Atr  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    USER: Initialize routine
      *    Car/Van Indicator
           MOVE 'C' TO YL0140 OF WORK-CONTEXT
      *    Setup key
      *    Model Application Code
           MOVE 'RIC' TO LLMDLAPPCD OF KRSSE8
      *    SCP Model Code
           MOVE OSSTMDLSCP OF FDOTEGM OF SBDOTEXTL8-R TO LLSCMDLCDE OF
             KRSSE8
      *    Initialise Full Externally Described Keylist
      *    Model Application Code
           MOVE LOW-VALUES TO LLMDLAPPCD OF EXTSE8
      *    SCP Model Code
           MOVE LOW-VALUES TO LLSCMDLCDE OF EXTSE8
           MOVE CORRESPONDING
             KRSSE8 TO
             VAMDLBNSF1 OF VAMDLBNSL1-R
           SET C-INDICATOR-OFF(90) TO TRUE
           READ VAMDLBNSL1
             FORMAT IS 'VAMDLBNSF1'
           END-READ
           IF (C-NO-RECORD) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               END-IF
           END-IF
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR7127' TO W0RTN
      *        USER: Processing if Data record not found
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SE8EXIT
           END-IF
      *
           IF (C-INDICATOR-OFF(90)) THEN
      *        USER: Process Data record
      *        Car/Van Indicator
               MOVE LLCORV OF VAMDLBNSF1 OF VAMDLBNSL1-R TO YL0140 OF
                 WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
           END-IF
      *==============================================================
           CONTINUE.
       SE8EXIT.
           EXIT.
      /EJECT
       SE9RVGN SECTION.
      *==============================================================
      *    Rtv Rtn Latest Brand Mdl - Bonus Sls-RIC Mdl Dsp Seq  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    SCP Model Code
           MOVE OSSTMDLSCP OF FDOTEGM OF SBDOTEXTL8-R TO O9SCMDLCDE OF
             KRSSE9
      *    Initialise Full Externally Described Keylist
      *    SCP Model Code
           MOVE LOW-VALUES TO O9SCMDLCDE OF EXTSE9
      *    Bns RIC Config Year
           MOVE 9999 TO O9BNSRICYR OF EXTSE9
      *    Bns RIC Display Sequence
           MOVE -999 TO O9BNSRICSQ OF EXTSE9
           MOVE CORRESPONDING
             EXTSE9 TO
             SBRICDSQF4 OF SBRICDSQL4-R
           MOVE CORRESPONDING
             KRSSE9 TO
             SBRICDSQF4 OF SBRICDSQL4-R
           START SBRICDSQL4 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'SBRICDSQF4'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ SBRICDSQL4 NEXT
             FORMAT IS 'SBRICDSQF4'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     SBRICDSQF4 OF SBRICDSQL4-R TO
                     EXTSE9
                   MOVE EXTSE9 TO KRSSE9-TMP
                   IF (KRSSE9 NOT = KRSSE9-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    SCP Model Code
           MOVE LOW-VALUES TO O9SCMDLCDE OF EXTSE9
      *    Bns RIC Config Year
           MOVE 9999 TO O9BNSRICYR OF EXTSE9
      *    Bns RIC Display Sequence
           MOVE -999 TO O9BNSRICSQ OF EXTSE9
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR7404' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Bns Brand Name
               MOVE SPACES TO YL0142 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SE9EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Bns Brand Name
               MOVE O9BNSBRNDD OF SBRICDSQF4 OF SBRICDSQL4-R TO YL0142
                 OF WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
      *        *QUIT
               GO SE9EXIT
               SET C-INDICATOR-OFF(90) TO TRUE
               READ SBRICDSQL4 NEXT
                 FORMAT IS 'SBRICDSQF4'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         SBRICDSQF4 OF SBRICDSQL4-R TO
                         EXTSE9
                       MOVE EXTSE9 TO KRSSE9-TMP
                       IF (KRSSE9 NOT = KRSSE9-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        SCP Model Code
               MOVE LOW-VALUES TO O9SCMDLCDE OF EXTSE9
      *        Bns RIC Config Year
               MOVE 9999 TO O9BNSRICYR OF EXTSE9
      *        Bns RIC Display Sequence
               MOVE -999 TO O9BNSRICSQ OF EXTSE9
           END-PERFORM
      *==============================================================
           CONTINUE.
       SE9EXIT.
           EXIT.
      /EJECT
       SF1RVGN SECTION.
      *==============================================================
      *    Rtv First Dtls for Chass - OBT Extract  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    Chassis number
           MOVE OSYPTX OF FDOTEGM OF SBDOTEXTL8-R TO Q2ASXX OF KRSSF1
      *    Initialise Full Externally Described Keylist
      *    Chassis number
           MOVE LOW-VALUES TO Q2ASXX OF EXTSF1
           MOVE CORRESPONDING
             EXTSF1 TO
             RAOBEXTRF4 OF RAOBEXTRL4-R
           MOVE CORRESPONDING
             KRSSF1 TO
             RAOBEXTRF4 OF RAOBEXTRL4-R
           START RAOBEXTRL4 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'RAOBEXTRF4'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ RAOBEXTRL4 NEXT
             FORMAT IS 'RAOBEXTRF4'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     RAOBEXTRF4 OF RAOBEXTRL4-R TO
                     EXTSF1
                   MOVE EXTSF1 TO KRSSF1-TMP
                   IF (KRSSF1 NOT = KRSSF1-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    Chassis number
           MOVE LOW-VALUES TO Q2ASXX OF EXTSF1
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR5706' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Fleet Operator Number
               MOVE SPACES TO YL0145 OF WORK-CONTEXT
      *        BDC Payment Term
               MOVE SPACES TO YL0146 OF WORK-CONTEXT
      *        OBT Count Target Status
               MOVE SPACES TO YL0141 OF WORK-CONTEXT
      *        Fleet Programmes Code
               MOVE SPACES TO YL0143 OF WORK-CONTEXT
      *        Target Market
               MOVE SPACES TO YL0147 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SF1EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Fleet Operator Number
               MOVE Q2FLOPNO OF RAOBEXTRF4 OF RAOBEXTRL4-R TO YL0145 OF
                 WORK-CONTEXT
      *        BDC Payment Term
               MOVE Q2BDCPTRM OF RAOBEXTRF4 OF RAOBEXTRL4-R TO YL0146
                 OF WORK-CONTEXT
      *        OBT Count Target Status
               MOVE Q2CNTTARG OF RAOBEXTRF4 OF RAOBEXTRL4-R TO YL0141
                 OF WORK-CONTEXT
      *        Fleet Programmes Code
               MOVE Q2FLPGMCDE OF RAOBEXTRF4 OF RAOBEXTRL4-R TO YL0143
                 OF WORK-CONTEXT
      *        Target Market
               MOVE Q2TGTMRKET OF RAOBEXTRF4 OF RAOBEXTRL4-R TO YL0147
                 OF WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
      *        *QUIT
               GO SF1EXIT
               SET C-INDICATOR-OFF(90) TO TRUE
               READ RAOBEXTRL4 NEXT
                 FORMAT IS 'RAOBEXTRF4'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         RAOBEXTRF4 OF RAOBEXTRL4-R TO
                         EXTSF1
                       MOVE EXTSF1 TO KRSSF1-TMP
                       IF (KRSSF1 NOT = KRSSF1-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        Chassis number
               MOVE LOW-VALUES TO Q2ASXX OF EXTSF1
           END-PERFORM
      *==============================================================
           CONTINUE.
       SF1EXIT.
           EXIT.
      /EJECT
       SF2RVGN SECTION.
      *==============================================================
      *    Rtv Target Value (Single) - Target Information  * Car
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    Level Code
           MOVE 00030 TO S9LVLCDE OF KRSSF2
      *    Dealer Number
           MOVE WUDLRNO OF WORK-CONTEXT TO S9DLRNBR OF KRSSF2
      *    Dealer Number Suffix
           MOVE WUUDLRSFX OF WORK-CONTEXT TO S9DLRSFX OF KRSSF2
      *    Target Period Code
           MOVE WUUTGTPRDE OF WORK-CONTEXT TO S9PERCDE OF KRSSF2
      *    Object Code
           MOVE 'CAR' TO S9OBJCDE OF KRSSF2
      *    Initialise Full Externally Described Keylist
      *    Level Code
           MOVE -99999 TO S9LVLCDE OF EXTSF2
      *    Dealer Number
           MOVE LOW-VALUES TO S9DLRNBR OF EXTSF2
      *    Dealer Number Suffix
           MOVE LOW-VALUES TO S9DLRSFX OF EXTSF2
      *    Target Period Code
           MOVE LOW-VALUES TO S9PERCDE OF EXTSF2
      *    Object Code
           MOVE LOW-VALUES TO S9OBJCDE OF EXTSF2
           MOVE CORRESPONDING
             EXTSF2 TO
             FTGTDSK OF AMTGTDTAL7-R
           MOVE CORRESPONDING
             KRSSF2 TO
             FTGTDSK OF AMTGTDTAL7-R
           START AMTGTDTAL7 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'FTGTDSK'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ AMTGTDTAL7 NEXT
             FORMAT IS 'FTGTDSK'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     FTGTDSK OF AMTGTDTAL7-R TO
                     EXTSF2
                   MOVE EXTSF2 TO KRSSF2-TMP
                   IF (KRSSF2 NOT = KRSSF2-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    Level Code
           MOVE -99999 TO S9LVLCDE OF EXTSF2
      *    Dealer Number
           MOVE LOW-VALUES TO S9DLRNBR OF EXTSF2
      *    Dealer Number Suffix
           MOVE LOW-VALUES TO S9DLRSFX OF EXTSF2
      *    Target Period Code
           MOVE LOW-VALUES TO S9PERCDE OF EXTSF2
      *    Object Code
           MOVE LOW-VALUES TO S9OBJCDE OF EXTSF2
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR2873' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Target Value
               MOVE ZEROS TO YL0097 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SF2EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Target Value
               MOVE S9TGOVAL OF FTGTDSK OF AMTGTDTAL7-R TO YL0097 OF
                 WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
               SET C-INDICATOR-OFF(90) TO TRUE
               READ AMTGTDTAL7 NEXT
                 FORMAT IS 'FTGTDSK'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         FTGTDSK OF AMTGTDTAL7-R TO
                         EXTSF2
                       MOVE EXTSF2 TO KRSSF2-TMP
                       IF (KRSSF2 NOT = KRSSF2-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        Level Code
               MOVE -99999 TO S9LVLCDE OF EXTSF2
      *        Dealer Number
               MOVE LOW-VALUES TO S9DLRNBR OF EXTSF2
      *        Dealer Number Suffix
               MOVE LOW-VALUES TO S9DLRSFX OF EXTSF2
      *        Target Period Code
               MOVE LOW-VALUES TO S9PERCDE OF EXTSF2
      *        Object Code
               MOVE LOW-VALUES TO S9OBJCDE OF EXTSF2
           END-PERFORM
      *==============================================================
           CONTINUE.
       SF2EXIT.
           EXIT.
      /EJECT
       SF3RVGN SECTION.
      *==============================================================
      *    Rtv Target Value (Single) - Target Information  * Van
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    Level Code
           MOVE 00030 TO S9LVLCDE OF KRSSF3
      *    Dealer Number
           MOVE WUDLRNO OF WORK-CONTEXT TO S9DLRNBR OF KRSSF3
      *    Dealer Number Suffix
           MOVE WUUDLRSFX OF WORK-CONTEXT TO S9DLRSFX OF KRSSF3
      *    Target Period Code
           MOVE WUUTGTPRDE OF WORK-CONTEXT TO S9PERCDE OF KRSSF3
      *    Object Code
           MOVE 'VAN' TO S9OBJCDE OF KRSSF3
      *    Initialise Full Externally Described Keylist
      *    Level Code
           MOVE -99999 TO S9LVLCDE OF EXTSF3
      *    Dealer Number
           MOVE LOW-VALUES TO S9DLRNBR OF EXTSF3
      *    Dealer Number Suffix
           MOVE LOW-VALUES TO S9DLRSFX OF EXTSF3
      *    Target Period Code
           MOVE LOW-VALUES TO S9PERCDE OF EXTSF3
      *    Object Code
           MOVE LOW-VALUES TO S9OBJCDE OF EXTSF3
           MOVE CORRESPONDING
             EXTSF3 TO
             FTGTDSK OF AMTGTDTAL7-R
           MOVE CORRESPONDING
             KRSSF3 TO
             FTGTDSK OF AMTGTDTAL7-R
           START AMTGTDTAL7 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'FTGTDSK'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ AMTGTDTAL7 NEXT
             FORMAT IS 'FTGTDSK'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     FTGTDSK OF AMTGTDTAL7-R TO
                     EXTSF3
                   MOVE EXTSF3 TO KRSSF3-TMP
                   IF (KRSSF3 NOT = KRSSF3-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    Level Code
           MOVE -99999 TO S9LVLCDE OF EXTSF3
      *    Dealer Number
           MOVE LOW-VALUES TO S9DLRNBR OF EXTSF3
      *    Dealer Number Suffix
           MOVE LOW-VALUES TO S9DLRSFX OF EXTSF3
      *    Target Period Code
           MOVE LOW-VALUES TO S9PERCDE OF EXTSF3
      *    Object Code
           MOVE LOW-VALUES TO S9OBJCDE OF EXTSF3
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR2873' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Target Value
               MOVE ZEROS TO YL0097 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SF3EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Target Value
               MOVE S9TGOVAL OF FTGTDSK OF AMTGTDTAL7-R TO YL0097 OF
                 WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
               SET C-INDICATOR-OFF(90) TO TRUE
               READ AMTGTDTAL7 NEXT
                 FORMAT IS 'FTGTDSK'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         FTGTDSK OF AMTGTDTAL7-R TO
                         EXTSF3
                       MOVE EXTSF3 TO KRSSF3-TMP
                       IF (KRSSF3 NOT = KRSSF3-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        Level Code
               MOVE -99999 TO S9LVLCDE OF EXTSF3
      *        Dealer Number
               MOVE LOW-VALUES TO S9DLRNBR OF EXTSF3
      *        Dealer Number Suffix
               MOVE LOW-VALUES TO S9DLRSFX OF EXTSF3
      *        Target Period Code
               MOVE LOW-VALUES TO S9PERCDE OF EXTSF3
      *        Object Code
               MOVE LOW-VALUES TO S9OBJCDE OF EXTSF3
           END-PERFORM
      *==============================================================
           CONTINUE.
       SF3EXIT.
           EXIT.
      /EJECT
       SF4RVGN SECTION.
      *==============================================================
      *    Rtv Target Value (Single) - Target Information  * Dacia car
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    Level Code
           MOVE 00030 TO S9LVLCDE OF KRSSF4
      *    Dealer Number
           MOVE WUWECF OF WORK-CONTEXT TO S9DLRNBR OF KRSSF4
      *    Dealer Number Suffix
           MOVE WUWFCF OF WORK-CONTEXT TO S9DLRSFX OF KRSSF4
      *    Target Period Code
           MOVE WUUTGTPRDE OF WORK-CONTEXT TO S9PERCDE OF KRSSF4
      *    Object Code
           MOVE 'CAR' TO S9OBJCDE OF KRSSF4
      *    Initialise Full Externally Described Keylist
      *    Level Code
           MOVE -99999 TO S9LVLCDE OF EXTSF4
      *    Dealer Number
           MOVE LOW-VALUES TO S9DLRNBR OF EXTSF4
      *    Dealer Number Suffix
           MOVE LOW-VALUES TO S9DLRSFX OF EXTSF4
      *    Target Period Code
           MOVE LOW-VALUES TO S9PERCDE OF EXTSF4
      *    Object Code
           MOVE LOW-VALUES TO S9OBJCDE OF EXTSF4
           MOVE CORRESPONDING
             EXTSF4 TO
             FTGTDSK OF AMTGTDTAL7-R
           MOVE CORRESPONDING
             KRSSF4 TO
             FTGTDSK OF AMTGTDTAL7-R
           START AMTGTDTAL7 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'FTGTDSK'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ AMTGTDTAL7 NEXT
             FORMAT IS 'FTGTDSK'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     FTGTDSK OF AMTGTDTAL7-R TO
                     EXTSF4
                   MOVE EXTSF4 TO KRSSF4-TMP
                   IF (KRSSF4 NOT = KRSSF4-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    Level Code
           MOVE -99999 TO S9LVLCDE OF EXTSF4
      *    Dealer Number
           MOVE LOW-VALUES TO S9DLRNBR OF EXTSF4
      *    Dealer Number Suffix
           MOVE LOW-VALUES TO S9DLRSFX OF EXTSF4
      *    Target Period Code
           MOVE LOW-VALUES TO S9PERCDE OF EXTSF4
      *    Object Code
           MOVE LOW-VALUES TO S9OBJCDE OF EXTSF4
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR2873' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Target Value
               MOVE ZEROS TO YL0098 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SF4EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Target Value
               MOVE S9TGOVAL OF FTGTDSK OF AMTGTDTAL7-R TO YL0098 OF
                 WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
               SET C-INDICATOR-OFF(90) TO TRUE
               READ AMTGTDTAL7 NEXT
                 FORMAT IS 'FTGTDSK'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         FTGTDSK OF AMTGTDTAL7-R TO
                         EXTSF4
                       MOVE EXTSF4 TO KRSSF4-TMP
                       IF (KRSSF4 NOT = KRSSF4-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        Level Code
               MOVE -99999 TO S9LVLCDE OF EXTSF4
      *        Dealer Number
               MOVE LOW-VALUES TO S9DLRNBR OF EXTSF4
      *        Dealer Number Suffix
               MOVE LOW-VALUES TO S9DLRSFX OF EXTSF4
      *        Target Period Code
               MOVE LOW-VALUES TO S9PERCDE OF EXTSF4
      *        Object Code
               MOVE LOW-VALUES TO S9OBJCDE OF EXTSF4
           END-PERFORM
      *==============================================================
           CONTINUE.
       SF4EXIT.
           EXIT.
      /EJECT
       SF5RVGN SECTION.
      *==============================================================
      *    Rtv Target Value (Single) - Target Information  * Van
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    Level Code
           MOVE 00030 TO S9LVLCDE OF KRSSF5
      *    Dealer Number
           MOVE WUWECF OF WORK-CONTEXT TO S9DLRNBR OF KRSSF5
      *    Dealer Number Suffix
           MOVE YL0099 OF WORK-CONTEXT TO S9DLRSFX OF KRSSF5
      *    Target Period Code
           MOVE WUUTGTPRDE OF WORK-CONTEXT TO S9PERCDE OF KRSSF5
      *    Object Code
           MOVE 'VAN' TO S9OBJCDE OF KRSSF5
      *    Initialise Full Externally Described Keylist
      *    Level Code
           MOVE -99999 TO S9LVLCDE OF EXTSF5
      *    Dealer Number
           MOVE LOW-VALUES TO S9DLRNBR OF EXTSF5
      *    Dealer Number Suffix
           MOVE LOW-VALUES TO S9DLRSFX OF EXTSF5
      *    Target Period Code
           MOVE LOW-VALUES TO S9PERCDE OF EXTSF5
      *    Object Code
           MOVE LOW-VALUES TO S9OBJCDE OF EXTSF5
           MOVE CORRESPONDING
             EXTSF5 TO
             FTGTDSK OF AMTGTDTAL7-R
           MOVE CORRESPONDING
             KRSSF5 TO
             FTGTDSK OF AMTGTDTAL7-R
           START AMTGTDTAL7 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'FTGTDSK'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ AMTGTDTAL7 NEXT
             FORMAT IS 'FTGTDSK'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     FTGTDSK OF AMTGTDTAL7-R TO
                     EXTSF5
                   MOVE EXTSF5 TO KRSSF5-TMP
                   IF (KRSSF5 NOT = KRSSF5-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    Level Code
           MOVE -99999 TO S9LVLCDE OF EXTSF5
      *    Dealer Number
           MOVE LOW-VALUES TO S9DLRNBR OF EXTSF5
      *    Dealer Number Suffix
           MOVE LOW-VALUES TO S9DLRSFX OF EXTSF5
      *    Target Period Code
           MOVE LOW-VALUES TO S9PERCDE OF EXTSF5
      *    Object Code
           MOVE LOW-VALUES TO S9OBJCDE OF EXTSF5
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR2873' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Target Value
               MOVE ZEROS TO YL0098 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SF5EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Target Value
               MOVE S9TGOVAL OF FTGTDSK OF AMTGTDTAL7-R TO YL0098 OF
                 WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
               SET C-INDICATOR-OFF(90) TO TRUE
               READ AMTGTDTAL7 NEXT
                 FORMAT IS 'FTGTDSK'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         FTGTDSK OF AMTGTDTAL7-R TO
                         EXTSF5
                       MOVE EXTSF5 TO KRSSF5-TMP
                       IF (KRSSF5 NOT = KRSSF5-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        Level Code
               MOVE -99999 TO S9LVLCDE OF EXTSF5
      *        Dealer Number
               MOVE LOW-VALUES TO S9DLRNBR OF EXTSF5
      *        Dealer Number Suffix
               MOVE LOW-VALUES TO S9DLRSFX OF EXTSF5
      *        Target Period Code
               MOVE LOW-VALUES TO S9PERCDE OF EXTSF5
      *        Object Code
               MOVE LOW-VALUES TO S9OBJCDE OF EXTSF5
           END-PERFORM
      *==============================================================
           CONTINUE.
       SF5EXIT.
           EXIT.
      /EJECT
       SF6RVGN SECTION.
      *==============================================================
      *    Rtv No of Regs TCTT - BDC.-.SEDRE DOT Extract  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    USER: Initialize routine
      *    Cvt *Job date to DTX
      *    * Job date contains a leading 1 when the year is 2000 or
      *      greater
      *    U:Job Date DTX
           ADD ZZJDT OF JOB-CONTEXT, 19000000 GIVING YL0107 OF
             WORK-CONTEXT
      *    Utl Cvt Dealer 6 to 5N
           MOVE 5 TO YRSW03
           MOVE 2 TO YRSW02
           IF (YRSW02 NOT > 0 OR
               YRSW03 NOT > 0 OR
               YRSW02 > 00006 OR
               YRSW03 > 00006) THEN
               MOVE 'Y2U0510' TO W0RTN
           ELSE
               MOVE WUNECO OF WORK-CONTEXT TO W0STRNG
               MOVE W0STRNG(YRSW02:YRSW03) TO WUUCODE5 OF WORK-CONTEXT
           END-IF
           IF (WUUCODE5 OF WORK-CONTEXT = SPACES) THEN
               MOVE ZERO TO YL0108 OF WORK-CONTEXT
           ELSE
               MOVE WUUCODE5 OF WORK-CONTEXT TO YL0108 OF WORK-CONTEXT
           END-IF
      *    U:Pay Cat 1 Regs
           MOVE ZEROS TO YL0100 OF WORK-CONTEXT
      *    U:Pay Cat 1 Regs
           MOVE ZEROS TO YL0109 OF WORK-CONTEXT
      *    U:Pay Cat 2 Regs
           MOVE ZEROS TO YL0101 OF WORK-CONTEXT
      *    U:Pay Cat 2 Regs
           MOVE ZEROS TO YL0110 OF WORK-CONTEXT
      *    U:Pay Cat 3 Regs
           MOVE ZEROS TO YL0102 OF WORK-CONTEXT
      *    U:Pay Cat 3 Regs
           MOVE ZEROS TO YL0111 OF WORK-CONTEXT
      *    U:Pay Cat 4 Regs
           MOVE ZEROS TO YL0103 OF WORK-CONTEXT
      *    U:Pay Cat 4 Regs
           MOVE ZEROS TO YL0112 OF WORK-CONTEXT
      *    U:Pay Cat 5 Regs
           MOVE ZEROS TO YL0104 OF WORK-CONTEXT
      *    U:Pay Cat 5 Regs
           MOVE ZEROS TO YL0113 OF WORK-CONTEXT
      *    U:Pay Cat N Regs
           MOVE ZEROS TO YL0105 OF WORK-CONTEXT
      *    U:Pay Cat N Regs
           MOVE ZEROS TO YL0114 OF WORK-CONTEXT
      *    U:Pay Cat O Regs
           MOVE ZEROS TO YL0106 OF WORK-CONTEXT
      *    U:Pay Cat O Regs
           MOVE ZEROS TO YL0115 OF WORK-CONTEXT
      *    Setup key
      *    CONCES PROPRIETAIRE
           MOVE WUNECO OF WORK-CONTEXT TO OSNECO OF KPSSF6
      *    DATE 58 IMMATRICULATION
           MOVE WUXBDX OF WORK-CONTEXT TO OSW0NB OF KPSSF6
           MOVE CORRESPONDING KPSSF6 TO KRSSF6
      *    Initialise Full Externally Described Keylist
      *    CONCES PROPRIETAIRE
           MOVE LOW-VALUES TO OSNECO OF EXTSF6
      *    DATE 58 IMMATRICULATION
           MOVE -99999999 TO OSW0NB OF EXTSF6
      *    COMMANDE CLIENT
           MOVE LOW-VALUES TO OSNUCO OF EXTSF6
           MOVE CORRESPONDING
             EXTSF6 TO
             FDOTEGL OF SBDOTEXTL7-R
           MOVE CORRESPONDING
             KPSSF6 TO
             FDOTEGL OF SBDOTEXTL7-R
           START SBDOTEXTL7 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'FDOTEGL'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ SBDOTEXTL7 NEXT
             FORMAT IS 'FDOTEGL'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     FDOTEGL OF SBDOTEXTL7-R TO
                     EXTSF6
                   MOVE EXTSF6 TO KRSSF6-TMP
                   IF (KRSSF6 NOT = KRSSF6-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    CONCES PROPRIETAIRE
           MOVE LOW-VALUES TO OSNECO OF EXTSF6
      *    DATE 58 IMMATRICULATION
           MOVE -99999999 TO OSW0NB OF EXTSF6
      *    COMMANDE CLIENT
           MOVE LOW-VALUES TO OSNUCO OF EXTSF6
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR5554' TO W0RTN
           END-IF
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        Count number of registrations for the Model
      *        CASE: DB1.DATE 58 IMMATRICULATION LE PAR.U:Number (8.0)
      *        *IF
               IF (OSW0NB OF FDOTEGL OF SBDOTEXTL7-R NOT > WUXCDX OF
                 WORK-CONTEXT) THEN
      *            Include this one?
      *            CASE: DB1.DATE 58 IMMATRICULATION is NE Zero
      *            *IF
                   IF (OSW0NB OF FDOTEGL OF SBDOTEXTL7-R NOT = 0) THEN
      *                Car/Van Indicator
                       MOVE ' ' TO YL0116 OF WORK-CONTEXT
      *                OBT Count Target Status
                       MOVE ' ' TO YL0117 OF WORK-CONTEXT
      *                Rtv Car or Van SCP Mdl - Vehicle Model Bonus
      *                  Atr  *
                       PERFORM SF7RVGN
      *                Rtv Rtn Latest Brand Mdl - Bonus Sls-RIC Mdl
      *                  Dsp Seq  *
                       PERFORM SF8RVGN
      *                Fleet Programmes Code
                       MOVE SPACES TO YL0119 OF WORK-CONTEXT
                       MOVE ' ' TO YL0119 OF WORK-CONTEXT
      *                U:Continue
                       MOVE 'Y' TO YL0120 OF WORK-CONTEXT
      *                Rtv All Dtl by Dlr/Mdl/ON - OBT Extract  *
                       PERFORM SF9RVGN
      *                Check Target Type Deselection
      *                CASE: PAR.U:Target Prefix is Target total
      *                *IF
                       IF ('TT' = 'TT') THEN
                           CONTINUE
                       ELSE
      *                    CASE: PAR.U:Target Prefix is Target Local
      *                      Market
      *                    *IF
                           IF ('TT' = 'TL') THEN
      *                        CASE: LCL.Target Market is Local Market
      *                          Target List
      *                        *IF
                               IF (YL0123 OF WORK-CONTEXT = 'L' OR
                                   YL0123 OF WORK-CONTEXT = 'W' OR
                                   YL0123 OF WORK-CONTEXT = 'R') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0120 OF WORK-CONTEXT
                               END-IF
                           ELSE
      *                        CASE: PAR.U:Target Prefix is Target
      *                          Major Fleet
      *                        *IF
                               IF ('TT' = 'TM') THEN
      *                        CASE: LCL.Target Market is Major Fleet
      *                          Target
      *                        *IF
                               IF (YL0123 OF WORK-CONTEXT = 'M') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0120 OF WORK-CONTEXT
                               END-IF
                               ELSE
      *                        CASE: PAR.U:Target Prefix is Target not
      *                          fleet
      *                        *IF
                               IF ('TT' = 'TN') THEN
      *                        CASE:
      *                        - c1 OR c2
      *                        |- c1    : LCL.Fleet Programmes Code is
      *                          *Blank
      *                        |- c2    : LCL.Fleet Programmes Code is
      *                          UNS - Unsupported (30286)
      *                        '-
      *                        *IF
                               IF (YL0119 OF WORK-CONTEXT = ' ' OR
                                   YL0119 OF WORK-CONTEXT = 'UNS') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0120 OF WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
      *                If O.K. to Continue - Following Record
      *                  Deselection
      *                CASE: LCL.U:Continue is Yes
      *                *IF
                       IF (YL0120 OF WORK-CONTEXT = 'Y') THEN
      *                    CASE: DB1.De-reg Date NBR is NE Zero
      *                    *IF
                           IF (OSZXNU OF FDOTEGL OF SBDOTEXTL7-R NOT =
                             0) THEN
      *                        For De-Regs
      *                        CASE:
      *                        - c1 OR c2
      *                        |- c1    : LCL.OBT Count Target Status
      *                          is In Target List
      *                        |- c2    : LCL.Bns Brand Name is RENAULT
      *                        '-
      *                        *IF
                               IF ((YL0117 OF WORK-CONTEXT = 'I' OR
                                    YL0117 OF WORK-CONTEXT = '1' OR
                                    YL0117 OF WORK-CONTEXT = '2' OR
                                    YL0117 OF WORK-CONTEXT = '3' OR
                                    YL0117 OF WORK-CONTEXT = '4' OR
                                    YL0117 OF WORK-CONTEXT = '5' OR
                                    YL0117 OF WORK-CONTEXT = 'N') OR
                                   YL0118 OF WORK-CONTEXT = 'RENAULT')
                                 THEN
      *                        U:Pay Cat 5 Regs
                               ADD YL0113 OF WORK-CONTEXT, 1 GIVING
                                 YL0113 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Pay Cat O Regs
                               ADD YL0115 OF WORK-CONTEXT, 1 GIVING
                                 YL0115 OF WORK-CONTEXT
                               END-IF
                           ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 1
      *                        *IF
                               IF (YL0117 OF WORK-CONTEXT = '1') THEN
      *                        U:Pay Cat 1 Regs
                               ADD YL0109 OF WORK-CONTEXT, 1 GIVING
                                 YL0109 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 2
      *                        *IF
                               IF (YL0117 OF WORK-CONTEXT = '2') THEN
      *                        U:Pay Cat 2 Regs
                               ADD YL0110 OF WORK-CONTEXT, 1 GIVING
                                 YL0110 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 3
      *                        *IF
                               IF (YL0117 OF WORK-CONTEXT = '3') THEN
      *                        U:Pay Cat 3 Regs
                               ADD YL0111 OF WORK-CONTEXT, 1 GIVING
                                 YL0111 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 4
      *                        *IF
                               IF (YL0117 OF WORK-CONTEXT = '4') THEN
      *                        U:Pay Cat 4 Regs
                               ADD YL0112 OF WORK-CONTEXT, 1 GIVING
                                 YL0112 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 5
      *                        *IF
                               IF (YL0117 OF WORK-CONTEXT = '5') THEN
      *                        U:Pay Cat 5 Regs
                               ADD YL0113 OF WORK-CONTEXT, 1 GIVING
                                 YL0113 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category N - New
      *                        *IF
                               IF (YL0117 OF WORK-CONTEXT = 'N') THEN
      *                        U:Pay Cat N Regs
                               ADD YL0114 OF WORK-CONTEXT, 1 GIVING
                                 YL0114 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Pay Cat O Regs
                               ADD YL0115 OF WORK-CONTEXT, 1 GIVING
                                 YL0115 OF WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
                   END-IF
               END-IF
               SET C-INDICATOR-OFF(90) TO TRUE
               READ SBDOTEXTL7 NEXT
                 FORMAT IS 'FDOTEGL'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         FDOTEGL OF SBDOTEXTL7-R TO
                         EXTSF6
                       MOVE EXTSF6 TO KRSSF6-TMP
                       IF (KRSSF6 NOT = KRSSF6-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        CONCES PROPRIETAIRE
               MOVE LOW-VALUES TO OSNECO OF EXTSF6
      *        DATE 58 IMMATRICULATION
               MOVE -99999999 TO OSW0NB OF EXTSF6
      *        COMMANDE CLIENT
               MOVE LOW-VALUES TO OSNUCO OF EXTSF6
           END-PERFORM
      *    USER: Exit processing
      *    U:Pay Cat 1 Regs
           MOVE YL0109 OF WORK-CONTEXT TO YL0100 OF WORK-CONTEXT
      *    U:Pay Cat 2 Regs
           MOVE YL0110 OF WORK-CONTEXT TO YL0101 OF WORK-CONTEXT
      *    U:Pay Cat 3 Regs
           MOVE YL0111 OF WORK-CONTEXT TO YL0102 OF WORK-CONTEXT
      *    U:Pay Cat 4 Regs
           MOVE YL0112 OF WORK-CONTEXT TO YL0103 OF WORK-CONTEXT
      *    U:Pay Cat 5 Regs
           MOVE YL0113 OF WORK-CONTEXT TO YL0104 OF WORK-CONTEXT
      *    U:Pay Cat N Regs
           MOVE YL0114 OF WORK-CONTEXT TO YL0105 OF WORK-CONTEXT
      *    U:Pay Cat O Regs
           MOVE YL0115 OF WORK-CONTEXT TO YL0106 OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       SF6EXIT.
           EXIT.
      /EJECT
       SF7RVGN SECTION.
      *==============================================================
      *    Rtv Car or Van SCP Mdl - Vehicle Model Bonus Atr  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    USER: Initialize routine
      *    Car/Van Indicator
           MOVE 'C' TO YL0116 OF WORK-CONTEXT
      *    Setup key
      *    Model Application Code
           MOVE 'RIC' TO LLMDLAPPCD OF KRSSF7
      *    SCP Model Code
           MOVE OSSTMDLSCP OF FDOTEGL OF SBDOTEXTL7-R TO LLSCMDLCDE OF
             KRSSF7
      *    Initialise Full Externally Described Keylist
      *    Model Application Code
           MOVE LOW-VALUES TO LLMDLAPPCD OF EXTSF7
      *    SCP Model Code
           MOVE LOW-VALUES TO LLSCMDLCDE OF EXTSF7
           MOVE CORRESPONDING
             KRSSF7 TO
             VAMDLBNSF1 OF VAMDLBNSL1-R
           SET C-INDICATOR-OFF(90) TO TRUE
           READ VAMDLBNSL1
             FORMAT IS 'VAMDLBNSF1'
           END-READ
           IF (C-NO-RECORD) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               END-IF
           END-IF
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR7127' TO W0RTN
      *        USER: Processing if Data record not found
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SF7EXIT
           END-IF
      *
           IF (C-INDICATOR-OFF(90)) THEN
      *        USER: Process Data record
      *        Car/Van Indicator
               MOVE LLCORV OF VAMDLBNSF1 OF VAMDLBNSL1-R TO YL0116 OF
                 WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
           END-IF
      *==============================================================
           CONTINUE.
       SF7EXIT.
           EXIT.
      /EJECT
       SF8RVGN SECTION.
      *==============================================================
      *    Rtv Rtn Latest Brand Mdl - Bonus Sls-RIC Mdl Dsp Seq  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    SCP Model Code
           MOVE OSSTMDLSCP OF FDOTEGL OF SBDOTEXTL7-R TO O9SCMDLCDE OF
             KRSSF8
      *    Initialise Full Externally Described Keylist
      *    SCP Model Code
           MOVE LOW-VALUES TO O9SCMDLCDE OF EXTSF8
      *    Bns RIC Config Year
           MOVE 9999 TO O9BNSRICYR OF EXTSF8
      *    Bns RIC Display Sequence
           MOVE -999 TO O9BNSRICSQ OF EXTSF8
           MOVE CORRESPONDING
             EXTSF8 TO
             SBRICDSQF4 OF SBRICDSQL4-R
           MOVE CORRESPONDING
             KRSSF8 TO
             SBRICDSQF4 OF SBRICDSQL4-R
           START SBRICDSQL4 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'SBRICDSQF4'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ SBRICDSQL4 NEXT
             FORMAT IS 'SBRICDSQF4'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     SBRICDSQF4 OF SBRICDSQL4-R TO
                     EXTSF8
                   MOVE EXTSF8 TO KRSSF8-TMP
                   IF (KRSSF8 NOT = KRSSF8-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    SCP Model Code
           MOVE LOW-VALUES TO O9SCMDLCDE OF EXTSF8
      *    Bns RIC Config Year
           MOVE 9999 TO O9BNSRICYR OF EXTSF8
      *    Bns RIC Display Sequence
           MOVE -999 TO O9BNSRICSQ OF EXTSF8
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR7404' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Bns Brand Name
               MOVE SPACES TO YL0118 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SF8EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Bns Brand Name
               MOVE O9BNSBRNDD OF SBRICDSQF4 OF SBRICDSQL4-R TO YL0118
                 OF WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
      *        *QUIT
               GO SF8EXIT
               SET C-INDICATOR-OFF(90) TO TRUE
               READ SBRICDSQL4 NEXT
                 FORMAT IS 'SBRICDSQF4'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         SBRICDSQF4 OF SBRICDSQL4-R TO
                         EXTSF8
                       MOVE EXTSF8 TO KRSSF8-TMP
                       IF (KRSSF8 NOT = KRSSF8-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        SCP Model Code
               MOVE LOW-VALUES TO O9SCMDLCDE OF EXTSF8
      *        Bns RIC Config Year
               MOVE 9999 TO O9BNSRICYR OF EXTSF8
      *        Bns RIC Display Sequence
               MOVE -999 TO O9BNSRICSQ OF EXTSF8
           END-PERFORM
      *==============================================================
           CONTINUE.
       SF8EXIT.
           EXIT.
      /EJECT
       SF9RVGN SECTION.
      *==============================================================
      *    Rtv All Dtl by Dlr/Mdl/ON - OBT Extract  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    Dealer number (Num key)
           MOVE YL0108 OF WORK-CONTEXT TO Q2DLRNOKEY OF KRSSF9
      *    BDC Model
           MOVE OSSTMDLSCP OF FDOTEGL OF SBDOTEXTL7-R TO Q2BDCM OF
             KRSSF9
      *    BDC Customer Order Number
           MOVE OSNUCO OF FDOTEGL OF SBDOTEXTL7-R TO Q2BDCCON OF KRSSF9
      *    Initialise Full Externally Described Keylist
      *    Dealer number (Num key)
           MOVE -99999 TO Q2DLRNOKEY OF EXTSF9
      *    BDC Model
           MOVE LOW-VALUES TO Q2BDCM OF EXTSF9
      *    BDC Customer Order Number
           MOVE LOW-VALUES TO Q2BDCCON OF EXTSF9
           MOVE CORRESPONDING
             EXTSF9 TO
             FOBEXCB OF RAOBEXTRL2-R
           MOVE CORRESPONDING
             KRSSF9 TO
             FOBEXCB OF RAOBEXTRL2-R
           START RAOBEXTRL2 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'FOBEXCB'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ RAOBEXTRL2 NEXT
             FORMAT IS 'FOBEXCB'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     FOBEXCB OF RAOBEXTRL2-R TO
                     EXTSF9
                   MOVE EXTSF9 TO KRSSF9-TMP
                   IF (KRSSF9 NOT = KRSSF9-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    Dealer number (Num key)
           MOVE -99999 TO Q2DLRNOKEY OF EXTSF9
      *    BDC Model
           MOVE LOW-VALUES TO Q2BDCM OF EXTSF9
      *    BDC Customer Order Number
           MOVE LOW-VALUES TO Q2BDCCON OF EXTSF9
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR5706' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Fleet Operator Number
               MOVE SPACES TO YL0121 OF WORK-CONTEXT
      *        BDC Payment Term
               MOVE SPACES TO YL0122 OF WORK-CONTEXT
      *        OBT Count Target Status
               MOVE SPACES TO YL0117 OF WORK-CONTEXT
      *        Fleet Programmes Code
               MOVE SPACES TO YL0119 OF WORK-CONTEXT
      *        Target Market
               MOVE SPACES TO YL0123 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SF9EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Fleet Operator Number
               MOVE Q2FLOPNO OF FOBEXCB OF RAOBEXTRL2-R TO YL0121 OF
                 WORK-CONTEXT
      *        BDC Payment Term
               MOVE Q2BDCPTRM OF FOBEXCB OF RAOBEXTRL2-R TO YL0122 OF
                 WORK-CONTEXT
      *        OBT Count Target Status
               MOVE Q2CNTTARG OF FOBEXCB OF RAOBEXTRL2-R TO YL0117 OF
                 WORK-CONTEXT
      *        Fleet Programmes Code
               MOVE Q2FLPGMCDE OF FOBEXCB OF RAOBEXTRL2-R TO YL0119 OF
                 WORK-CONTEXT
      *        Target Market
               MOVE Q2TGTMRKET OF FOBEXCB OF RAOBEXTRL2-R TO YL0123 OF
                 WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
      *        *QUIT
               GO SF9EXIT
               SET C-INDICATOR-OFF(90) TO TRUE
               READ RAOBEXTRL2 NEXT
                 FORMAT IS 'FOBEXCB'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         FOBEXCB OF RAOBEXTRL2-R TO
                         EXTSF9
                       MOVE EXTSF9 TO KRSSF9-TMP
                       IF (KRSSF9 NOT = KRSSF9-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        Dealer number (Num key)
               MOVE -99999 TO Q2DLRNOKEY OF EXTSF9
      *        BDC Model
               MOVE LOW-VALUES TO Q2BDCM OF EXTSF9
      *        BDC Customer Order Number
               MOVE LOW-VALUES TO Q2BDCCON OF EXTSF9
           END-PERFORM
      *==============================================================
           CONTINUE.
       SF9EXIT.
           EXIT.
      /EJECT
       SG1RVGN SECTION.
      *==============================================================
      *    Rtv No of Regs Derg TCTT - BDC.-.SEDRE DOT Extract  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    USER: Initialize routine
      *    Cvt *Job date to DTX
      *    * Job date contains a leading 1 when the year is 2000 or
      *      greater
      *    U:Job Date DTX
           ADD ZZJDT OF JOB-CONTEXT, 19000000 GIVING YL0131 OF
             WORK-CONTEXT
      *    Utl Cvt Dealer 6 to 5N
           MOVE 5 TO YRSW03
           MOVE 2 TO YRSW02
           IF (YRSW02 NOT > 0 OR
               YRSW03 NOT > 0 OR
               YRSW02 > 00006 OR
               YRSW03 > 00006) THEN
               MOVE 'Y2U0510' TO W0RTN
           ELSE
               MOVE WUNECO OF WORK-CONTEXT TO W0STRNG
               MOVE W0STRNG(YRSW02:YRSW03) TO WUUCODE5 OF WORK-CONTEXT
           END-IF
           IF (WUUCODE5 OF WORK-CONTEXT = SPACES) THEN
               MOVE ZERO TO YL0132 OF WORK-CONTEXT
           ELSE
               MOVE WUUCODE5 OF WORK-CONTEXT TO YL0132 OF WORK-CONTEXT
           END-IF
      *    U:Pay Cat 1 De-Regs
           MOVE ZEROS TO YL0124 OF WORK-CONTEXT
      *    U:Pay Cat 1 De-Regs
           MOVE ZEROS TO YL0133 OF WORK-CONTEXT
      *    U:Pay Cat 2 De-Regs
           MOVE ZEROS TO YL0125 OF WORK-CONTEXT
      *    U:Pay Cat 2 De-Regs
           MOVE ZEROS TO YL0134 OF WORK-CONTEXT
      *    U:Pay Cat 3 De-Regs
           MOVE ZEROS TO YL0126 OF WORK-CONTEXT
      *    U:Pay Cat 3 De-Regs
           MOVE ZEROS TO YL0135 OF WORK-CONTEXT
      *    U:Pay Cat 4 De-Regs
           MOVE ZEROS TO YL0127 OF WORK-CONTEXT
      *    U:Pay Cat 4 De-Regs
           MOVE ZEROS TO YL0136 OF WORK-CONTEXT
      *    U:Pay Cat 5 De-Regs
           MOVE ZEROS TO YL0128 OF WORK-CONTEXT
      *    U:Pay Cat 5 De-Regs
           MOVE ZEROS TO YL0137 OF WORK-CONTEXT
      *    U:Pay Cat N De-Regs
           MOVE ZEROS TO YL0129 OF WORK-CONTEXT
      *    U:Pay Cat N De-Regs
           MOVE ZEROS TO YL0138 OF WORK-CONTEXT
      *    U:Pay Cat O De-Regs
           MOVE ZEROS TO YL0130 OF WORK-CONTEXT
      *    U:Pay Cat O De-Regs
           MOVE ZEROS TO YL0139 OF WORK-CONTEXT
      *    Setup key
      *    CONCES PROPRIETAIRE
           MOVE WUNECO OF WORK-CONTEXT TO OSNECO OF KPSSG1
      *    De-reg Date NBR
           MOVE WUXBDX OF WORK-CONTEXT TO OSZXNU OF KPSSG1
           MOVE CORRESPONDING KPSSG1 TO KRSSG1
      *    Initialise Full Externally Described Keylist
      *    CONCES PROPRIETAIRE
           MOVE LOW-VALUES TO OSNECO OF EXTSG1
      *    De-reg Date NBR
           MOVE -99999999 TO OSZXNU OF EXTSG1
           MOVE CORRESPONDING
             EXTSG1 TO
             FDOTEGM OF SBDOTEXTL8-R
           MOVE CORRESPONDING
             KPSSG1 TO
             FDOTEGM OF SBDOTEXTL8-R
           START SBDOTEXTL8 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'FDOTEGM'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ SBDOTEXTL8 NEXT
             FORMAT IS 'FDOTEGM'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     FDOTEGM OF SBDOTEXTL8-R TO
                     EXTSG1
                   MOVE EXTSG1 TO KRSSG1-TMP
                   IF (KRSSG1 NOT = KRSSG1-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    CONCES PROPRIETAIRE
           MOVE LOW-VALUES TO OSNECO OF EXTSG1
      *    De-reg Date NBR
           MOVE -99999999 TO OSZXNU OF EXTSG1
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR5554' TO W0RTN
           END-IF
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        Count number of de-regs for the Model
      *        CASE: DB1.De-reg Date NBR LE PAR.U:Number (8.0)
      *        *IF
               IF (OSZXNU OF FDOTEGM OF SBDOTEXTL8-R NOT > WUXCDX OF
                 WORK-CONTEXT) THEN
      *            Include this one?
      *            CASE: DB1.De-reg Date NBR is NE Zero
      *            *IF
                   IF (OSZXNU OF FDOTEGM OF SBDOTEXTL8-R NOT = 0) THEN
      *                Car/Van Indicator
                       MOVE ' ' TO YL0140 OF WORK-CONTEXT
      *                OBT Count Target Status
                       MOVE ' ' TO YL0141 OF WORK-CONTEXT
      *                Rtv Car or Van SCP Mdl - Vehicle Model Bonus
      *                  Atr  *
                       PERFORM SG2RVGN
      *                Rtv Rtn Latest Brand Mdl - Bonus Sls-RIC Mdl
      *                  Dsp Seq  *
                       PERFORM SG3RVGN
      *                Fleet Programmes Code
                       MOVE SPACES TO YL0143 OF WORK-CONTEXT
                       MOVE ' ' TO YL0143 OF WORK-CONTEXT
      *                U:Continue
                       MOVE 'Y' TO YL0144 OF WORK-CONTEXT
      *                Rtv First Dtls for Chass - OBT Extract  *
                       PERFORM SG4RVGN
      *                Check Target Type Deselection
      *                CASE: PAR.U:Target Prefix is Target total
      *                *IF
                       IF ('TT' = 'TT') THEN
                           CONTINUE
                       ELSE
      *                    CASE: PAR.U:Target Prefix is Target Local
      *                      Market
      *                    *IF
                           IF ('TT' = 'TL') THEN
      *                        CASE: LCL.Target Market is Local Market
      *                          Target List
      *                        *IF
                               IF (YL0147 OF WORK-CONTEXT = 'L' OR
                                   YL0147 OF WORK-CONTEXT = 'W' OR
                                   YL0147 OF WORK-CONTEXT = 'R') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0144 OF WORK-CONTEXT
                               END-IF
                           ELSE
      *                        CASE: PAR.U:Target Prefix is Target
      *                          Major Fleet
      *                        *IF
                               IF ('TT' = 'TM') THEN
      *                        CASE: LCL.Target Market is Major Fleet
      *                          Target
      *                        *IF
                               IF (YL0147 OF WORK-CONTEXT = 'M') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0144 OF WORK-CONTEXT
                               END-IF
                               ELSE
      *                        CASE: PAR.U:Target Prefix is Target not
      *                          fleet
      *                        *IF
                               IF ('TT' = 'TN') THEN
      *                        CASE:
      *                        - c1 OR c2
      *                        |- c1    : LCL.Fleet Programmes Code is
      *                          *Blank
      *                        |- c2    : LCL.Fleet Programmes Code is
      *                          UNS - Unsupported (30286)
      *                        '-
      *                        *IF
                               IF (YL0143 OF WORK-CONTEXT = ' ' OR
                                   YL0143 OF WORK-CONTEXT = 'UNS') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0144 OF WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
      *                If O.K. to Continue - Following Record
      *                  Deselection
      *                CASE: LCL.U:Continue is Yes
      *                *IF
                       IF (YL0144 OF WORK-CONTEXT = 'Y') THEN
      *                    CASE: LCL.OBT Count Target Status is
      *                      Payment Category 1
      *                    *IF
                           IF (YL0141 OF WORK-CONTEXT = '1') THEN
      *                        U:Pay Cat 1 De-Regs
                               ADD YL0133 OF WORK-CONTEXT, 1 GIVING
                                 YL0133 OF WORK-CONTEXT
                           ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 2
      *                        *IF
                               IF (YL0141 OF WORK-CONTEXT = '2') THEN
      *                        U:Pay Cat 2 De-Regs
                               ADD YL0134 OF WORK-CONTEXT, 1 GIVING
                                 YL0134 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 3
      *                        *IF
                               IF (YL0141 OF WORK-CONTEXT = '3') THEN
      *                        U:Pay Cat 3 De-Regs
                               ADD YL0135 OF WORK-CONTEXT, 1 GIVING
                                 YL0135 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 4
      *                        *IF
                               IF (YL0141 OF WORK-CONTEXT = '4') THEN
      *                        U:Pay Cat 4 De-Regs
                               ADD YL0136 OF WORK-CONTEXT, 1 GIVING
                                 YL0136 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 5
      *                        *IF
                               IF (YL0141 OF WORK-CONTEXT = '5') THEN
      *                        U:Pay Cat 5 De-Regs
                               ADD YL0137 OF WORK-CONTEXT, 1 GIVING
                                 YL0137 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category N - New
      *                        *IF
                               IF (YL0141 OF WORK-CONTEXT = 'N') THEN
      *                        U:Pay Cat N De-Regs
                               ADD YL0138 OF WORK-CONTEXT, 1 GIVING
                                 YL0138 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
      *                        CASE: LCL.Bns Brand Name is RENAULT
      *                        *IF
                               IF (YL0142 OF WORK-CONTEXT = 'RENAULT')
                                 THEN
      *                        U:Pay Cat 5 De-Regs
                               ADD YL0137 OF WORK-CONTEXT, 1 GIVING
                                 YL0137 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Pay Cat O De-Regs
                               ADD YL0139 OF WORK-CONTEXT, 1 GIVING
                                 YL0139 OF WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
                   END-IF
               END-IF
               SET C-INDICATOR-OFF(90) TO TRUE
               READ SBDOTEXTL8 NEXT
                 FORMAT IS 'FDOTEGM'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         FDOTEGM OF SBDOTEXTL8-R TO
                         EXTSG1
                       MOVE EXTSG1 TO KRSSG1-TMP
                       IF (KRSSG1 NOT = KRSSG1-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        CONCES PROPRIETAIRE
               MOVE LOW-VALUES TO OSNECO OF EXTSG1
      *        De-reg Date NBR
               MOVE -99999999 TO OSZXNU OF EXTSG1
           END-PERFORM
      *    USER: Exit processing
      *    U:Pay Cat 1 De-Regs
           MOVE YL0133 OF WORK-CONTEXT TO YL0124 OF WORK-CONTEXT
      *    U:Pay Cat 2 De-Regs
           MOVE YL0134 OF WORK-CONTEXT TO YL0125 OF WORK-CONTEXT
      *    U:Pay Cat 3 De-Regs
           MOVE YL0135 OF WORK-CONTEXT TO YL0126 OF WORK-CONTEXT
      *    U:Pay Cat 4 De-Regs
           MOVE YL0136 OF WORK-CONTEXT TO YL0127 OF WORK-CONTEXT
      *    U:Pay Cat 5 De-Regs
           MOVE YL0137 OF WORK-CONTEXT TO YL0128 OF WORK-CONTEXT
      *    U:Pay Cat N De-Regs
           MOVE YL0138 OF WORK-CONTEXT TO YL0129 OF WORK-CONTEXT
      *    U:Pay Cat O De-Regs
           MOVE YL0139 OF WORK-CONTEXT TO YL0130 OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       SG1EXIT.
           EXIT.
      /EJECT
       SG2RVGN SECTION.
      *==============================================================
      *    Rtv Car or Van SCP Mdl - Vehicle Model Bonus Atr  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    USER: Initialize routine
      *    Car/Van Indicator
           MOVE 'C' TO YL0140 OF WORK-CONTEXT
      *    Setup key
      *    Model Application Code
           MOVE 'RIC' TO LLMDLAPPCD OF KRSSG2
      *    SCP Model Code
           MOVE OSSTMDLSCP OF FDOTEGM OF SBDOTEXTL8-R TO LLSCMDLCDE OF
             KRSSG2
      *    Initialise Full Externally Described Keylist
      *    Model Application Code
           MOVE LOW-VALUES TO LLMDLAPPCD OF EXTSG2
      *    SCP Model Code
           MOVE LOW-VALUES TO LLSCMDLCDE OF EXTSG2
           MOVE CORRESPONDING
             KRSSG2 TO
             VAMDLBNSF1 OF VAMDLBNSL1-R
           SET C-INDICATOR-OFF(90) TO TRUE
           READ VAMDLBNSL1
             FORMAT IS 'VAMDLBNSF1'
           END-READ
           IF (C-NO-RECORD) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               END-IF
           END-IF
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR7127' TO W0RTN
      *        USER: Processing if Data record not found
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SG2EXIT
           END-IF
      *
           IF (C-INDICATOR-OFF(90)) THEN
      *        USER: Process Data record
      *        Car/Van Indicator
               MOVE LLCORV OF VAMDLBNSF1 OF VAMDLBNSL1-R TO YL0140 OF
                 WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
           END-IF
      *==============================================================
           CONTINUE.
       SG2EXIT.
           EXIT.
      /EJECT
       SG3RVGN SECTION.
      *==============================================================
      *    Rtv Rtn Latest Brand Mdl - Bonus Sls-RIC Mdl Dsp Seq  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    SCP Model Code
           MOVE OSSTMDLSCP OF FDOTEGM OF SBDOTEXTL8-R TO O9SCMDLCDE OF
             KRSSG3
      *    Initialise Full Externally Described Keylist
      *    SCP Model Code
           MOVE LOW-VALUES TO O9SCMDLCDE OF EXTSG3
      *    Bns RIC Config Year
           MOVE 9999 TO O9BNSRICYR OF EXTSG3
      *    Bns RIC Display Sequence
           MOVE -999 TO O9BNSRICSQ OF EXTSG3
           MOVE CORRESPONDING
             EXTSG3 TO
             SBRICDSQF4 OF SBRICDSQL4-R
           MOVE CORRESPONDING
             KRSSG3 TO
             SBRICDSQF4 OF SBRICDSQL4-R
           START SBRICDSQL4 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'SBRICDSQF4'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ SBRICDSQL4 NEXT
             FORMAT IS 'SBRICDSQF4'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     SBRICDSQF4 OF SBRICDSQL4-R TO
                     EXTSG3
                   MOVE EXTSG3 TO KRSSG3-TMP
                   IF (KRSSG3 NOT = KRSSG3-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    SCP Model Code
           MOVE LOW-VALUES TO O9SCMDLCDE OF EXTSG3
      *    Bns RIC Config Year
           MOVE 9999 TO O9BNSRICYR OF EXTSG3
      *    Bns RIC Display Sequence
           MOVE -999 TO O9BNSRICSQ OF EXTSG3
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR7404' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Bns Brand Name
               MOVE SPACES TO YL0142 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SG3EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Bns Brand Name
               MOVE O9BNSBRNDD OF SBRICDSQF4 OF SBRICDSQL4-R TO YL0142
                 OF WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
      *        *QUIT
               GO SG3EXIT
               SET C-INDICATOR-OFF(90) TO TRUE
               READ SBRICDSQL4 NEXT
                 FORMAT IS 'SBRICDSQF4'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         SBRICDSQF4 OF SBRICDSQL4-R TO
                         EXTSG3
                       MOVE EXTSG3 TO KRSSG3-TMP
                       IF (KRSSG3 NOT = KRSSG3-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        SCP Model Code
               MOVE LOW-VALUES TO O9SCMDLCDE OF EXTSG3
      *        Bns RIC Config Year
               MOVE 9999 TO O9BNSRICYR OF EXTSG3
      *        Bns RIC Display Sequence
               MOVE -999 TO O9BNSRICSQ OF EXTSG3
           END-PERFORM
      *==============================================================
           CONTINUE.
       SG3EXIT.
           EXIT.
      /EJECT
       SG4RVGN SECTION.
      *==============================================================
      *    Rtv First Dtls for Chass - OBT Extract  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    Chassis number
           MOVE OSYPTX OF FDOTEGM OF SBDOTEXTL8-R TO Q2ASXX OF KRSSG4
      *    Initialise Full Externally Described Keylist
      *    Chassis number
           MOVE LOW-VALUES TO Q2ASXX OF EXTSG4
           MOVE CORRESPONDING
             EXTSG4 TO
             RAOBEXTRF4 OF RAOBEXTRL4-R
           MOVE CORRESPONDING
             KRSSG4 TO
             RAOBEXTRF4 OF RAOBEXTRL4-R
           START RAOBEXTRL4 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'RAOBEXTRF4'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ RAOBEXTRL4 NEXT
             FORMAT IS 'RAOBEXTRF4'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     RAOBEXTRF4 OF RAOBEXTRL4-R TO
                     EXTSG4
                   MOVE EXTSG4 TO KRSSG4-TMP
                   IF (KRSSG4 NOT = KRSSG4-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    Chassis number
           MOVE LOW-VALUES TO Q2ASXX OF EXTSG4
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR5706' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Fleet Operator Number
               MOVE SPACES TO YL0145 OF WORK-CONTEXT
      *        BDC Payment Term
               MOVE SPACES TO YL0146 OF WORK-CONTEXT
      *        OBT Count Target Status
               MOVE SPACES TO YL0141 OF WORK-CONTEXT
      *        Fleet Programmes Code
               MOVE SPACES TO YL0143 OF WORK-CONTEXT
      *        Target Market
               MOVE SPACES TO YL0147 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SG4EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Fleet Operator Number
               MOVE Q2FLOPNO OF RAOBEXTRF4 OF RAOBEXTRL4-R TO YL0145 OF
                 WORK-CONTEXT
      *        BDC Payment Term
               MOVE Q2BDCPTRM OF RAOBEXTRF4 OF RAOBEXTRL4-R TO YL0146
                 OF WORK-CONTEXT
      *        OBT Count Target Status
               MOVE Q2CNTTARG OF RAOBEXTRF4 OF RAOBEXTRL4-R TO YL0141
                 OF WORK-CONTEXT
      *        Fleet Programmes Code
               MOVE Q2FLPGMCDE OF RAOBEXTRF4 OF RAOBEXTRL4-R TO YL0143
                 OF WORK-CONTEXT
      *        Target Market
               MOVE Q2TGTMRKET OF RAOBEXTRF4 OF RAOBEXTRL4-R TO YL0147
                 OF WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
      *        *QUIT
               GO SG4EXIT
               SET C-INDICATOR-OFF(90) TO TRUE
               READ RAOBEXTRL4 NEXT
                 FORMAT IS 'RAOBEXTRF4'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         RAOBEXTRF4 OF RAOBEXTRL4-R TO
                         EXTSG4
                       MOVE EXTSG4 TO KRSSG4-TMP
                       IF (KRSSG4 NOT = KRSSG4-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        Chassis number
               MOVE LOW-VALUES TO Q2ASXX OF EXTSG4
           END-PERFORM
      *==============================================================
           CONTINUE.
       SG4EXIT.
           EXIT.
      /EJECT
       SG5RVGN SECTION.
      *==============================================================
      *    Rtv No of Regs TCTT - BDC.-.SEDRE DOT Extract  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    USER: Initialize routine
      *    Cvt *Job date to DTX
      *    * Job date contains a leading 1 when the year is 2000 or
      *      greater
      *    U:Job Date DTX
           ADD ZZJDT OF JOB-CONTEXT, 19000000 GIVING YL0107 OF
             WORK-CONTEXT
      *    Utl Cvt Dealer 6 to 5N
           MOVE 5 TO YRSW03
           MOVE 2 TO YRSW02
           IF (YRSW02 NOT > 0 OR
               YRSW03 NOT > 0 OR
               YRSW02 > 00006 OR
               YRSW03 > 00006) THEN
               MOVE 'Y2U0510' TO W0RTN
           ELSE
               MOVE WUTOCF OF WORK-CONTEXT TO W0STRNG
               MOVE W0STRNG(YRSW02:YRSW03) TO WUUCODE5 OF WORK-CONTEXT
           END-IF
           IF (WUUCODE5 OF WORK-CONTEXT = SPACES) THEN
               MOVE ZERO TO YL0108 OF WORK-CONTEXT
           ELSE
               MOVE WUUCODE5 OF WORK-CONTEXT TO YL0108 OF WORK-CONTEXT
           END-IF
      *    U:Pay Cat 1 Regs
           MOVE ZEROS TO YL0148 OF WORK-CONTEXT
      *    U:Pay Cat 1 Regs
           MOVE ZEROS TO YL0109 OF WORK-CONTEXT
      *    U:Pay Cat 2 Regs
           MOVE ZEROS TO YL0149 OF WORK-CONTEXT
      *    U:Pay Cat 2 Regs
           MOVE ZEROS TO YL0110 OF WORK-CONTEXT
      *    U:Pay Cat 3 Regs
           MOVE ZEROS TO YL0150 OF WORK-CONTEXT
      *    U:Pay Cat 3 Regs
           MOVE ZEROS TO YL0111 OF WORK-CONTEXT
      *    U:Pay Cat 4 Regs
           MOVE ZEROS TO YL0151 OF WORK-CONTEXT
      *    U:Pay Cat 4 Regs
           MOVE ZEROS TO YL0112 OF WORK-CONTEXT
      *    U:Pay Cat 5 Regs
           MOVE ZEROS TO YL0152 OF WORK-CONTEXT
      *    U:Pay Cat 5 Regs
           MOVE ZEROS TO YL0113 OF WORK-CONTEXT
      *    U:Pay Cat N Regs
           MOVE ZEROS TO YL0153 OF WORK-CONTEXT
      *    U:Pay Cat N Regs
           MOVE ZEROS TO YL0114 OF WORK-CONTEXT
      *    U:Pay Cat O Regs
           MOVE ZEROS TO YL0154 OF WORK-CONTEXT
      *    U:Pay Cat O Regs
           MOVE ZEROS TO YL0115 OF WORK-CONTEXT
      *    Setup key
      *    CONCES PROPRIETAIRE
           MOVE WUTOCF OF WORK-CONTEXT TO OSNECO OF KPSSG5
      *    DATE 58 IMMATRICULATION
           MOVE WUXBDX OF WORK-CONTEXT TO OSW0NB OF KPSSG5
           MOVE CORRESPONDING KPSSG5 TO KRSSG5
      *    Initialise Full Externally Described Keylist
      *    CONCES PROPRIETAIRE
           MOVE LOW-VALUES TO OSNECO OF EXTSG5
      *    DATE 58 IMMATRICULATION
           MOVE -99999999 TO OSW0NB OF EXTSG5
      *    COMMANDE CLIENT
           MOVE LOW-VALUES TO OSNUCO OF EXTSG5
           MOVE CORRESPONDING
             EXTSG5 TO
             FDOTEGL OF SBDOTEXTL7-R
           MOVE CORRESPONDING
             KPSSG5 TO
             FDOTEGL OF SBDOTEXTL7-R
           START SBDOTEXTL7 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'FDOTEGL'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ SBDOTEXTL7 NEXT
             FORMAT IS 'FDOTEGL'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     FDOTEGL OF SBDOTEXTL7-R TO
                     EXTSG5
                   MOVE EXTSG5 TO KRSSG5-TMP
                   IF (KRSSG5 NOT = KRSSG5-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    CONCES PROPRIETAIRE
           MOVE LOW-VALUES TO OSNECO OF EXTSG5
      *    DATE 58 IMMATRICULATION
           MOVE -99999999 TO OSW0NB OF EXTSG5
      *    COMMANDE CLIENT
           MOVE LOW-VALUES TO OSNUCO OF EXTSG5
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR5554' TO W0RTN
           END-IF
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        Count number of registrations for the Model
      *        CASE: DB1.DATE 58 IMMATRICULATION LE PAR.U:Number (8.0)
      *        *IF
               IF (OSW0NB OF FDOTEGL OF SBDOTEXTL7-R NOT > WUXCDX OF
                 WORK-CONTEXT) THEN
      *            Include this one?
      *            CASE: DB1.DATE 58 IMMATRICULATION is NE Zero
      *            *IF
                   IF (OSW0NB OF FDOTEGL OF SBDOTEXTL7-R NOT = 0) THEN
      *                Car/Van Indicator
                       MOVE ' ' TO YL0116 OF WORK-CONTEXT
      *                OBT Count Target Status
                       MOVE ' ' TO YL0117 OF WORK-CONTEXT
      *                Rtv Car or Van SCP Mdl - Vehicle Model Bonus
      *                  Atr  *
                       PERFORM SG6RVGN
      *                Rtv Rtn Latest Brand Mdl - Bonus Sls-RIC Mdl
      *                  Dsp Seq  *
                       PERFORM SG7RVGN
      *                Fleet Programmes Code
                       MOVE SPACES TO YL0119 OF WORK-CONTEXT
                       MOVE ' ' TO YL0119 OF WORK-CONTEXT
      *                U:Continue
                       MOVE 'Y' TO YL0120 OF WORK-CONTEXT
      *                Rtv All Dtl by Dlr/Mdl/ON - OBT Extract  *
                       PERFORM SG8RVGN
      *                Check Target Type Deselection
      *                CASE: PAR.U:Target Prefix is Target total
      *                *IF
                       IF ('TT' = 'TT') THEN
                           CONTINUE
                       ELSE
      *                    CASE: PAR.U:Target Prefix is Target Local
      *                      Market
      *                    *IF
                           IF ('TT' = 'TL') THEN
      *                        CASE: LCL.Target Market is Local Market
      *                          Target List
      *                        *IF
                               IF (YL0123 OF WORK-CONTEXT = 'L' OR
                                   YL0123 OF WORK-CONTEXT = 'W' OR
                                   YL0123 OF WORK-CONTEXT = 'R') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0120 OF WORK-CONTEXT
                               END-IF
                           ELSE
      *                        CASE: PAR.U:Target Prefix is Target
      *                          Major Fleet
      *                        *IF
                               IF ('TT' = 'TM') THEN
      *                        CASE: LCL.Target Market is Major Fleet
      *                          Target
      *                        *IF
                               IF (YL0123 OF WORK-CONTEXT = 'M') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0120 OF WORK-CONTEXT
                               END-IF
                               ELSE
      *                        CASE: PAR.U:Target Prefix is Target not
      *                          fleet
      *                        *IF
                               IF ('TT' = 'TN') THEN
      *                        CASE:
      *                        - c1 OR c2
      *                        |- c1    : LCL.Fleet Programmes Code is
      *                          *Blank
      *                        |- c2    : LCL.Fleet Programmes Code is
      *                          UNS - Unsupported (30286)
      *                        '-
      *                        *IF
                               IF (YL0119 OF WORK-CONTEXT = ' ' OR
                                   YL0119 OF WORK-CONTEXT = 'UNS') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0120 OF WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
      *                If O.K. to Continue - Following Record
      *                  Deselection
      *                CASE: LCL.U:Continue is Yes
      *                *IF
                       IF (YL0120 OF WORK-CONTEXT = 'Y') THEN
      *                    CASE: DB1.De-reg Date NBR is NE Zero
      *                    *IF
                           IF (OSZXNU OF FDOTEGL OF SBDOTEXTL7-R NOT =
                             0) THEN
      *                        For De-Regs
      *                        CASE:
      *                        - c1 OR c2
      *                        |- c1    : LCL.OBT Count Target Status
      *                          is In Target List
      *                        |- c2    : LCL.Bns Brand Name is RENAULT
      *                        '-
      *                        *IF
                               IF ((YL0117 OF WORK-CONTEXT = 'I' OR
                                    YL0117 OF WORK-CONTEXT = '1' OR
                                    YL0117 OF WORK-CONTEXT = '2' OR
                                    YL0117 OF WORK-CONTEXT = '3' OR
                                    YL0117 OF WORK-CONTEXT = '4' OR
                                    YL0117 OF WORK-CONTEXT = '5' OR
                                    YL0117 OF WORK-CONTEXT = 'N') OR
                                   YL0118 OF WORK-CONTEXT = 'RENAULT')
                                 THEN
      *                        U:Pay Cat 5 Regs
                               ADD YL0113 OF WORK-CONTEXT, 1 GIVING
                                 YL0113 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Pay Cat O Regs
                               ADD YL0115 OF WORK-CONTEXT, 1 GIVING
                                 YL0115 OF WORK-CONTEXT
                               END-IF
                           ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 1
      *                        *IF
                               IF (YL0117 OF WORK-CONTEXT = '1') THEN
      *                        U:Pay Cat 1 Regs
                               ADD YL0109 OF WORK-CONTEXT, 1 GIVING
                                 YL0109 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 2
      *                        *IF
                               IF (YL0117 OF WORK-CONTEXT = '2') THEN
      *                        U:Pay Cat 2 Regs
                               ADD YL0110 OF WORK-CONTEXT, 1 GIVING
                                 YL0110 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 3
      *                        *IF
                               IF (YL0117 OF WORK-CONTEXT = '3') THEN
      *                        U:Pay Cat 3 Regs
                               ADD YL0111 OF WORK-CONTEXT, 1 GIVING
                                 YL0111 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 4
      *                        *IF
                               IF (YL0117 OF WORK-CONTEXT = '4') THEN
      *                        U:Pay Cat 4 Regs
                               ADD YL0112 OF WORK-CONTEXT, 1 GIVING
                                 YL0112 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 5
      *                        *IF
                               IF (YL0117 OF WORK-CONTEXT = '5') THEN
      *                        U:Pay Cat 5 Regs
                               ADD YL0113 OF WORK-CONTEXT, 1 GIVING
                                 YL0113 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category N - New
      *                        *IF
                               IF (YL0117 OF WORK-CONTEXT = 'N') THEN
      *                        U:Pay Cat N Regs
                               ADD YL0114 OF WORK-CONTEXT, 1 GIVING
                                 YL0114 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Pay Cat O Regs
                               ADD YL0115 OF WORK-CONTEXT, 1 GIVING
                                 YL0115 OF WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
                   END-IF
               END-IF
               SET C-INDICATOR-OFF(90) TO TRUE
               READ SBDOTEXTL7 NEXT
                 FORMAT IS 'FDOTEGL'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         FDOTEGL OF SBDOTEXTL7-R TO
                         EXTSG5
                       MOVE EXTSG5 TO KRSSG5-TMP
                       IF (KRSSG5 NOT = KRSSG5-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        CONCES PROPRIETAIRE
               MOVE LOW-VALUES TO OSNECO OF EXTSG5
      *        DATE 58 IMMATRICULATION
               MOVE -99999999 TO OSW0NB OF EXTSG5
      *        COMMANDE CLIENT
               MOVE LOW-VALUES TO OSNUCO OF EXTSG5
           END-PERFORM
      *    USER: Exit processing
      *    U:Pay Cat 1 Regs
           MOVE YL0109 OF WORK-CONTEXT TO YL0148 OF WORK-CONTEXT
      *    U:Pay Cat 2 Regs
           MOVE YL0110 OF WORK-CONTEXT TO YL0149 OF WORK-CONTEXT
      *    U:Pay Cat 3 Regs
           MOVE YL0111 OF WORK-CONTEXT TO YL0150 OF WORK-CONTEXT
      *    U:Pay Cat 4 Regs
           MOVE YL0112 OF WORK-CONTEXT TO YL0151 OF WORK-CONTEXT
      *    U:Pay Cat 5 Regs
           MOVE YL0113 OF WORK-CONTEXT TO YL0152 OF WORK-CONTEXT
      *    U:Pay Cat N Regs
           MOVE YL0114 OF WORK-CONTEXT TO YL0153 OF WORK-CONTEXT
      *    U:Pay Cat O Regs
           MOVE YL0115 OF WORK-CONTEXT TO YL0154 OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       SG5EXIT.
           EXIT.
      /EJECT
       SG6RVGN SECTION.
      *==============================================================
      *    Rtv Car or Van SCP Mdl - Vehicle Model Bonus Atr  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    USER: Initialize routine
      *    Car/Van Indicator
           MOVE 'C' TO YL0116 OF WORK-CONTEXT
      *    Setup key
      *    Model Application Code
           MOVE 'RIC' TO LLMDLAPPCD OF KRSSG6
      *    SCP Model Code
           MOVE OSSTMDLSCP OF FDOTEGL OF SBDOTEXTL7-R TO LLSCMDLCDE OF
             KRSSG6
      *    Initialise Full Externally Described Keylist
      *    Model Application Code
           MOVE LOW-VALUES TO LLMDLAPPCD OF EXTSG6
      *    SCP Model Code
           MOVE LOW-VALUES TO LLSCMDLCDE OF EXTSG6
           MOVE CORRESPONDING
             KRSSG6 TO
             VAMDLBNSF1 OF VAMDLBNSL1-R
           SET C-INDICATOR-OFF(90) TO TRUE
           READ VAMDLBNSL1
             FORMAT IS 'VAMDLBNSF1'
           END-READ
           IF (C-NO-RECORD) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               END-IF
           END-IF
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR7127' TO W0RTN
      *        USER: Processing if Data record not found
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SG6EXIT
           END-IF
      *
           IF (C-INDICATOR-OFF(90)) THEN
      *        USER: Process Data record
      *        Car/Van Indicator
               MOVE LLCORV OF VAMDLBNSF1 OF VAMDLBNSL1-R TO YL0116 OF
                 WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
           END-IF
      *==============================================================
           CONTINUE.
       SG6EXIT.
           EXIT.
      /EJECT
       SG7RVGN SECTION.
      *==============================================================
      *    Rtv Rtn Latest Brand Mdl - Bonus Sls-RIC Mdl Dsp Seq  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    SCP Model Code
           MOVE OSSTMDLSCP OF FDOTEGL OF SBDOTEXTL7-R TO O9SCMDLCDE OF
             KRSSG7
      *    Initialise Full Externally Described Keylist
      *    SCP Model Code
           MOVE LOW-VALUES TO O9SCMDLCDE OF EXTSG7
      *    Bns RIC Config Year
           MOVE 9999 TO O9BNSRICYR OF EXTSG7
      *    Bns RIC Display Sequence
           MOVE -999 TO O9BNSRICSQ OF EXTSG7
           MOVE CORRESPONDING
             EXTSG7 TO
             SBRICDSQF4 OF SBRICDSQL4-R
           MOVE CORRESPONDING
             KRSSG7 TO
             SBRICDSQF4 OF SBRICDSQL4-R
           START SBRICDSQL4 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'SBRICDSQF4'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ SBRICDSQL4 NEXT
             FORMAT IS 'SBRICDSQF4'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     SBRICDSQF4 OF SBRICDSQL4-R TO
                     EXTSG7
                   MOVE EXTSG7 TO KRSSG7-TMP
                   IF (KRSSG7 NOT = KRSSG7-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    SCP Model Code
           MOVE LOW-VALUES TO O9SCMDLCDE OF EXTSG7
      *    Bns RIC Config Year
           MOVE 9999 TO O9BNSRICYR OF EXTSG7
      *    Bns RIC Display Sequence
           MOVE -999 TO O9BNSRICSQ OF EXTSG7
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR7404' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Bns Brand Name
               MOVE SPACES TO YL0118 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SG7EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Bns Brand Name
               MOVE O9BNSBRNDD OF SBRICDSQF4 OF SBRICDSQL4-R TO YL0118
                 OF WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
      *        *QUIT
               GO SG7EXIT
               SET C-INDICATOR-OFF(90) TO TRUE
               READ SBRICDSQL4 NEXT
                 FORMAT IS 'SBRICDSQF4'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         SBRICDSQF4 OF SBRICDSQL4-R TO
                         EXTSG7
                       MOVE EXTSG7 TO KRSSG7-TMP
                       IF (KRSSG7 NOT = KRSSG7-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        SCP Model Code
               MOVE LOW-VALUES TO O9SCMDLCDE OF EXTSG7
      *        Bns RIC Config Year
               MOVE 9999 TO O9BNSRICYR OF EXTSG7
      *        Bns RIC Display Sequence
               MOVE -999 TO O9BNSRICSQ OF EXTSG7
           END-PERFORM
      *==============================================================
           CONTINUE.
       SG7EXIT.
           EXIT.
      /EJECT
       SG8RVGN SECTION.
      *==============================================================
      *    Rtv All Dtl by Dlr/Mdl/ON - OBT Extract  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    Dealer number (Num key)
           MOVE YL0108 OF WORK-CONTEXT TO Q2DLRNOKEY OF KRSSG8
      *    BDC Model
           MOVE OSSTMDLSCP OF FDOTEGL OF SBDOTEXTL7-R TO Q2BDCM OF
             KRSSG8
      *    BDC Customer Order Number
           MOVE OSNUCO OF FDOTEGL OF SBDOTEXTL7-R TO Q2BDCCON OF KRSSG8
      *    Initialise Full Externally Described Keylist
      *    Dealer number (Num key)
           MOVE -99999 TO Q2DLRNOKEY OF EXTSG8
      *    BDC Model
           MOVE LOW-VALUES TO Q2BDCM OF EXTSG8
      *    BDC Customer Order Number
           MOVE LOW-VALUES TO Q2BDCCON OF EXTSG8
           MOVE CORRESPONDING
             EXTSG8 TO
             FOBEXCB OF RAOBEXTRL2-R
           MOVE CORRESPONDING
             KRSSG8 TO
             FOBEXCB OF RAOBEXTRL2-R
           START RAOBEXTRL2 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'FOBEXCB'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ RAOBEXTRL2 NEXT
             FORMAT IS 'FOBEXCB'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     FOBEXCB OF RAOBEXTRL2-R TO
                     EXTSG8
                   MOVE EXTSG8 TO KRSSG8-TMP
                   IF (KRSSG8 NOT = KRSSG8-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    Dealer number (Num key)
           MOVE -99999 TO Q2DLRNOKEY OF EXTSG8
      *    BDC Model
           MOVE LOW-VALUES TO Q2BDCM OF EXTSG8
      *    BDC Customer Order Number
           MOVE LOW-VALUES TO Q2BDCCON OF EXTSG8
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR5706' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Fleet Operator Number
               MOVE SPACES TO YL0121 OF WORK-CONTEXT
      *        BDC Payment Term
               MOVE SPACES TO YL0122 OF WORK-CONTEXT
      *        OBT Count Target Status
               MOVE SPACES TO YL0117 OF WORK-CONTEXT
      *        Fleet Programmes Code
               MOVE SPACES TO YL0119 OF WORK-CONTEXT
      *        Target Market
               MOVE SPACES TO YL0123 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SG8EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Fleet Operator Number
               MOVE Q2FLOPNO OF FOBEXCB OF RAOBEXTRL2-R TO YL0121 OF
                 WORK-CONTEXT
      *        BDC Payment Term
               MOVE Q2BDCPTRM OF FOBEXCB OF RAOBEXTRL2-R TO YL0122 OF
                 WORK-CONTEXT
      *        OBT Count Target Status
               MOVE Q2CNTTARG OF FOBEXCB OF RAOBEXTRL2-R TO YL0117 OF
                 WORK-CONTEXT
      *        Fleet Programmes Code
               MOVE Q2FLPGMCDE OF FOBEXCB OF RAOBEXTRL2-R TO YL0119 OF
                 WORK-CONTEXT
      *        Target Market
               MOVE Q2TGTMRKET OF FOBEXCB OF RAOBEXTRL2-R TO YL0123 OF
                 WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
      *        *QUIT
               GO SG8EXIT
               SET C-INDICATOR-OFF(90) TO TRUE
               READ RAOBEXTRL2 NEXT
                 FORMAT IS 'FOBEXCB'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         FOBEXCB OF RAOBEXTRL2-R TO
                         EXTSG8
                       MOVE EXTSG8 TO KRSSG8-TMP
                       IF (KRSSG8 NOT = KRSSG8-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        Dealer number (Num key)
               MOVE -99999 TO Q2DLRNOKEY OF EXTSG8
      *        BDC Model
               MOVE LOW-VALUES TO Q2BDCM OF EXTSG8
      *        BDC Customer Order Number
               MOVE LOW-VALUES TO Q2BDCCON OF EXTSG8
           END-PERFORM
      *==============================================================
           CONTINUE.
       SG8EXIT.
           EXIT.
      /EJECT
       SG9RVGN SECTION.
      *==============================================================
      *    Rtv No of Regs Derg TCTT - BDC.-.SEDRE DOT Extract  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    USER: Initialize routine
      *    Cvt *Job date to DTX
      *    * Job date contains a leading 1 when the year is 2000 or
      *      greater
      *    U:Job Date DTX
           ADD ZZJDT OF JOB-CONTEXT, 19000000 GIVING YL0131 OF
             WORK-CONTEXT
      *    Utl Cvt Dealer 6 to 5N
           MOVE 5 TO YRSW03
           MOVE 2 TO YRSW02
           IF (YRSW02 NOT > 0 OR
               YRSW03 NOT > 0 OR
               YRSW02 > 00006 OR
               YRSW03 > 00006) THEN
               MOVE 'Y2U0510' TO W0RTN
           ELSE
               MOVE WUTOCF OF WORK-CONTEXT TO W0STRNG
               MOVE W0STRNG(YRSW02:YRSW03) TO WUUCODE5 OF WORK-CONTEXT
           END-IF
           IF (WUUCODE5 OF WORK-CONTEXT = SPACES) THEN
               MOVE ZERO TO YL0132 OF WORK-CONTEXT
           ELSE
               MOVE WUUCODE5 OF WORK-CONTEXT TO YL0132 OF WORK-CONTEXT
           END-IF
      *    U:Pay Cat 1 De-Regs
           MOVE ZEROS TO YL0155 OF WORK-CONTEXT
      *    U:Pay Cat 1 De-Regs
           MOVE ZEROS TO YL0133 OF WORK-CONTEXT
      *    U:Pay Cat 2 De-Regs
           MOVE ZEROS TO YL0156 OF WORK-CONTEXT
      *    U:Pay Cat 2 De-Regs
           MOVE ZEROS TO YL0134 OF WORK-CONTEXT
      *    U:Pay Cat 3 De-Regs
           MOVE ZEROS TO YL0157 OF WORK-CONTEXT
      *    U:Pay Cat 3 De-Regs
           MOVE ZEROS TO YL0135 OF WORK-CONTEXT
      *    U:Pay Cat 4 De-Regs
           MOVE ZEROS TO YL0158 OF WORK-CONTEXT
      *    U:Pay Cat 4 De-Regs
           MOVE ZEROS TO YL0136 OF WORK-CONTEXT
      *    U:Pay Cat 5 De-Regs
           MOVE ZEROS TO YL0159 OF WORK-CONTEXT
      *    U:Pay Cat 5 De-Regs
           MOVE ZEROS TO YL0137 OF WORK-CONTEXT
      *    U:Pay Cat N De-Regs
           MOVE ZEROS TO YL0160 OF WORK-CONTEXT
      *    U:Pay Cat N De-Regs
           MOVE ZEROS TO YL0138 OF WORK-CONTEXT
      *    U:Pay Cat O De-Regs
           MOVE ZEROS TO YL0161 OF WORK-CONTEXT
      *    U:Pay Cat O De-Regs
           MOVE ZEROS TO YL0139 OF WORK-CONTEXT
      *    Setup key
      *    CONCES PROPRIETAIRE
           MOVE WUTOCF OF WORK-CONTEXT TO OSNECO OF KPSSG9
      *    De-reg Date NBR
           MOVE WUXBDX OF WORK-CONTEXT TO OSZXNU OF KPSSG9
           MOVE CORRESPONDING KPSSG9 TO KRSSG9
      *    Initialise Full Externally Described Keylist
      *    CONCES PROPRIETAIRE
           MOVE LOW-VALUES TO OSNECO OF EXTSG9
      *    De-reg Date NBR
           MOVE -99999999 TO OSZXNU OF EXTSG9
           MOVE CORRESPONDING
             EXTSG9 TO
             FDOTEGM OF SBDOTEXTL8-R
           MOVE CORRESPONDING
             KPSSG9 TO
             FDOTEGM OF SBDOTEXTL8-R
           START SBDOTEXTL8 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'FDOTEGM'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ SBDOTEXTL8 NEXT
             FORMAT IS 'FDOTEGM'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     FDOTEGM OF SBDOTEXTL8-R TO
                     EXTSG9
                   MOVE EXTSG9 TO KRSSG9-TMP
                   IF (KRSSG9 NOT = KRSSG9-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    CONCES PROPRIETAIRE
           MOVE LOW-VALUES TO OSNECO OF EXTSG9
      *    De-reg Date NBR
           MOVE -99999999 TO OSZXNU OF EXTSG9
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR5554' TO W0RTN
           END-IF
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        Count number of de-regs for the Model
      *        CASE: DB1.De-reg Date NBR LE PAR.U:Number (8.0)
      *        *IF
               IF (OSZXNU OF FDOTEGM OF SBDOTEXTL8-R NOT > WUXCDX OF
                 WORK-CONTEXT) THEN
      *            Include this one?
      *            CASE: DB1.De-reg Date NBR is NE Zero
      *            *IF
                   IF (OSZXNU OF FDOTEGM OF SBDOTEXTL8-R NOT = 0) THEN
      *                Car/Van Indicator
                       MOVE ' ' TO YL0140 OF WORK-CONTEXT
      *                OBT Count Target Status
                       MOVE ' ' TO YL0141 OF WORK-CONTEXT
      *                Rtv Car or Van SCP Mdl - Vehicle Model Bonus
      *                  Atr  *
                       PERFORM SH1RVGN
      *                Rtv Rtn Latest Brand Mdl - Bonus Sls-RIC Mdl
      *                  Dsp Seq  *
                       PERFORM SH2RVGN
      *                Fleet Programmes Code
                       MOVE SPACES TO YL0143 OF WORK-CONTEXT
                       MOVE ' ' TO YL0143 OF WORK-CONTEXT
      *                U:Continue
                       MOVE 'Y' TO YL0144 OF WORK-CONTEXT
      *                Rtv First Dtls for Chass - OBT Extract  *
                       PERFORM SH3RVGN
      *                Check Target Type Deselection
      *                CASE: PAR.U:Target Prefix is Target total
      *                *IF
                       IF ('TT' = 'TT') THEN
                           CONTINUE
                       ELSE
      *                    CASE: PAR.U:Target Prefix is Target Local
      *                      Market
      *                    *IF
                           IF ('TT' = 'TL') THEN
      *                        CASE: LCL.Target Market is Local Market
      *                          Target List
      *                        *IF
                               IF (YL0147 OF WORK-CONTEXT = 'L' OR
                                   YL0147 OF WORK-CONTEXT = 'W' OR
                                   YL0147 OF WORK-CONTEXT = 'R') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0144 OF WORK-CONTEXT
                               END-IF
                           ELSE
      *                        CASE: PAR.U:Target Prefix is Target
      *                          Major Fleet
      *                        *IF
                               IF ('TT' = 'TM') THEN
      *                        CASE: LCL.Target Market is Major Fleet
      *                          Target
      *                        *IF
                               IF (YL0147 OF WORK-CONTEXT = 'M') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0144 OF WORK-CONTEXT
                               END-IF
                               ELSE
      *                        CASE: PAR.U:Target Prefix is Target not
      *                          fleet
      *                        *IF
                               IF ('TT' = 'TN') THEN
      *                        CASE:
      *                        - c1 OR c2
      *                        |- c1    : LCL.Fleet Programmes Code is
      *                          *Blank
      *                        |- c2    : LCL.Fleet Programmes Code is
      *                          UNS - Unsupported (30286)
      *                        '-
      *                        *IF
                               IF (YL0143 OF WORK-CONTEXT = ' ' OR
                                   YL0143 OF WORK-CONTEXT = 'UNS') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0144 OF WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
      *                If O.K. to Continue - Following Record
      *                  Deselection
      *                CASE: LCL.U:Continue is Yes
      *                *IF
                       IF (YL0144 OF WORK-CONTEXT = 'Y') THEN
      *                    CASE: LCL.OBT Count Target Status is
      *                      Payment Category 1
      *                    *IF
                           IF (YL0141 OF WORK-CONTEXT = '1') THEN
      *                        U:Pay Cat 1 De-Regs
                               ADD YL0133 OF WORK-CONTEXT, 1 GIVING
                                 YL0133 OF WORK-CONTEXT
                           ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 2
      *                        *IF
                               IF (YL0141 OF WORK-CONTEXT = '2') THEN
      *                        U:Pay Cat 2 De-Regs
                               ADD YL0134 OF WORK-CONTEXT, 1 GIVING
                                 YL0134 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 3
      *                        *IF
                               IF (YL0141 OF WORK-CONTEXT = '3') THEN
      *                        U:Pay Cat 3 De-Regs
                               ADD YL0135 OF WORK-CONTEXT, 1 GIVING
                                 YL0135 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 4
      *                        *IF
                               IF (YL0141 OF WORK-CONTEXT = '4') THEN
      *                        U:Pay Cat 4 De-Regs
                               ADD YL0136 OF WORK-CONTEXT, 1 GIVING
                                 YL0136 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 5
      *                        *IF
                               IF (YL0141 OF WORK-CONTEXT = '5') THEN
      *                        U:Pay Cat 5 De-Regs
                               ADD YL0137 OF WORK-CONTEXT, 1 GIVING
                                 YL0137 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category N - New
      *                        *IF
                               IF (YL0141 OF WORK-CONTEXT = 'N') THEN
      *                        U:Pay Cat N De-Regs
                               ADD YL0138 OF WORK-CONTEXT, 1 GIVING
                                 YL0138 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
      *                        CASE: LCL.Bns Brand Name is RENAULT
      *                        *IF
                               IF (YL0142 OF WORK-CONTEXT = 'RENAULT')
                                 THEN
      *                        U:Pay Cat 5 De-Regs
                               ADD YL0137 OF WORK-CONTEXT, 1 GIVING
                                 YL0137 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Pay Cat O De-Regs
                               ADD YL0139 OF WORK-CONTEXT, 1 GIVING
                                 YL0139 OF WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
                   END-IF
               END-IF
               SET C-INDICATOR-OFF(90) TO TRUE
               READ SBDOTEXTL8 NEXT
                 FORMAT IS 'FDOTEGM'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         FDOTEGM OF SBDOTEXTL8-R TO
                         EXTSG9
                       MOVE EXTSG9 TO KRSSG9-TMP
                       IF (KRSSG9 NOT = KRSSG9-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        CONCES PROPRIETAIRE
               MOVE LOW-VALUES TO OSNECO OF EXTSG9
      *        De-reg Date NBR
               MOVE -99999999 TO OSZXNU OF EXTSG9
           END-PERFORM
      *    USER: Exit processing
      *    U:Pay Cat 1 De-Regs
           MOVE YL0133 OF WORK-CONTEXT TO YL0155 OF WORK-CONTEXT
      *    U:Pay Cat 2 De-Regs
           MOVE YL0134 OF WORK-CONTEXT TO YL0156 OF WORK-CONTEXT
      *    U:Pay Cat 3 De-Regs
           MOVE YL0135 OF WORK-CONTEXT TO YL0157 OF WORK-CONTEXT
      *    U:Pay Cat 4 De-Regs
           MOVE YL0136 OF WORK-CONTEXT TO YL0158 OF WORK-CONTEXT
      *    U:Pay Cat 5 De-Regs
           MOVE YL0137 OF WORK-CONTEXT TO YL0159 OF WORK-CONTEXT
      *    U:Pay Cat N De-Regs
           MOVE YL0138 OF WORK-CONTEXT TO YL0160 OF WORK-CONTEXT
      *    U:Pay Cat O De-Regs
           MOVE YL0139 OF WORK-CONTEXT TO YL0161 OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       SG9EXIT.
           EXIT.
      /EJECT
       SH1RVGN SECTION.
      *==============================================================
      *    Rtv Car or Van SCP Mdl - Vehicle Model Bonus Atr  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    USER: Initialize routine
      *    Car/Van Indicator
           MOVE 'C' TO YL0140 OF WORK-CONTEXT
      *    Setup key
      *    Model Application Code
           MOVE 'RIC' TO LLMDLAPPCD OF KRSSH1
      *    SCP Model Code
           MOVE OSSTMDLSCP OF FDOTEGM OF SBDOTEXTL8-R TO LLSCMDLCDE OF
             KRSSH1
      *    Initialise Full Externally Described Keylist
      *    Model Application Code
           MOVE LOW-VALUES TO LLMDLAPPCD OF EXTSH1
      *    SCP Model Code
           MOVE LOW-VALUES TO LLSCMDLCDE OF EXTSH1
           MOVE CORRESPONDING
             KRSSH1 TO
             VAMDLBNSF1 OF VAMDLBNSL1-R
           SET C-INDICATOR-OFF(90) TO TRUE
           READ VAMDLBNSL1
             FORMAT IS 'VAMDLBNSF1'
           END-READ
           IF (C-NO-RECORD) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               END-IF
           END-IF
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR7127' TO W0RTN
      *        USER: Processing if Data record not found
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SH1EXIT
           END-IF
      *
           IF (C-INDICATOR-OFF(90)) THEN
      *        USER: Process Data record
      *        Car/Van Indicator
               MOVE LLCORV OF VAMDLBNSF1 OF VAMDLBNSL1-R TO YL0140 OF
                 WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
           END-IF
      *==============================================================
           CONTINUE.
       SH1EXIT.
           EXIT.
      /EJECT
       SH2RVGN SECTION.
      *==============================================================
      *    Rtv Rtn Latest Brand Mdl - Bonus Sls-RIC Mdl Dsp Seq  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    SCP Model Code
           MOVE OSSTMDLSCP OF FDOTEGM OF SBDOTEXTL8-R TO O9SCMDLCDE OF
             KRSSH2
      *    Initialise Full Externally Described Keylist
      *    SCP Model Code
           MOVE LOW-VALUES TO O9SCMDLCDE OF EXTSH2
      *    Bns RIC Config Year
           MOVE 9999 TO O9BNSRICYR OF EXTSH2
      *    Bns RIC Display Sequence
           MOVE -999 TO O9BNSRICSQ OF EXTSH2
           MOVE CORRESPONDING
             EXTSH2 TO
             SBRICDSQF4 OF SBRICDSQL4-R
           MOVE CORRESPONDING
             KRSSH2 TO
             SBRICDSQF4 OF SBRICDSQL4-R
           START SBRICDSQL4 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'SBRICDSQF4'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ SBRICDSQL4 NEXT
             FORMAT IS 'SBRICDSQF4'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     SBRICDSQF4 OF SBRICDSQL4-R TO
                     EXTSH2
                   MOVE EXTSH2 TO KRSSH2-TMP
                   IF (KRSSH2 NOT = KRSSH2-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    SCP Model Code
           MOVE LOW-VALUES TO O9SCMDLCDE OF EXTSH2
      *    Bns RIC Config Year
           MOVE 9999 TO O9BNSRICYR OF EXTSH2
      *    Bns RIC Display Sequence
           MOVE -999 TO O9BNSRICSQ OF EXTSH2
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR7404' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Bns Brand Name
               MOVE SPACES TO YL0142 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SH2EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Bns Brand Name
               MOVE O9BNSBRNDD OF SBRICDSQF4 OF SBRICDSQL4-R TO YL0142
                 OF WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
      *        *QUIT
               GO SH2EXIT
               SET C-INDICATOR-OFF(90) TO TRUE
               READ SBRICDSQL4 NEXT
                 FORMAT IS 'SBRICDSQF4'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         SBRICDSQF4 OF SBRICDSQL4-R TO
                         EXTSH2
                       MOVE EXTSH2 TO KRSSH2-TMP
                       IF (KRSSH2 NOT = KRSSH2-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        SCP Model Code
               MOVE LOW-VALUES TO O9SCMDLCDE OF EXTSH2
      *        Bns RIC Config Year
               MOVE 9999 TO O9BNSRICYR OF EXTSH2
      *        Bns RIC Display Sequence
               MOVE -999 TO O9BNSRICSQ OF EXTSH2
           END-PERFORM
      *==============================================================
           CONTINUE.
       SH2EXIT.
           EXIT.
      /EJECT
       SH3RVGN SECTION.
      *==============================================================
      *    Rtv First Dtls for Chass - OBT Extract  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    Chassis number
           MOVE OSYPTX OF FDOTEGM OF SBDOTEXTL8-R TO Q2ASXX OF KRSSH3
      *    Initialise Full Externally Described Keylist
      *    Chassis number
           MOVE LOW-VALUES TO Q2ASXX OF EXTSH3
           MOVE CORRESPONDING
             EXTSH3 TO
             RAOBEXTRF4 OF RAOBEXTRL4-R
           MOVE CORRESPONDING
             KRSSH3 TO
             RAOBEXTRF4 OF RAOBEXTRL4-R
           START RAOBEXTRL4 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'RAOBEXTRF4'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ RAOBEXTRL4 NEXT
             FORMAT IS 'RAOBEXTRF4'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     RAOBEXTRF4 OF RAOBEXTRL4-R TO
                     EXTSH3
                   MOVE EXTSH3 TO KRSSH3-TMP
                   IF (KRSSH3 NOT = KRSSH3-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    Chassis number
           MOVE LOW-VALUES TO Q2ASXX OF EXTSH3
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR5706' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Fleet Operator Number
               MOVE SPACES TO YL0145 OF WORK-CONTEXT
      *        BDC Payment Term
               MOVE SPACES TO YL0146 OF WORK-CONTEXT
      *        OBT Count Target Status
               MOVE SPACES TO YL0141 OF WORK-CONTEXT
      *        Fleet Programmes Code
               MOVE SPACES TO YL0143 OF WORK-CONTEXT
      *        Target Market
               MOVE SPACES TO YL0147 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SH3EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Fleet Operator Number
               MOVE Q2FLOPNO OF RAOBEXTRF4 OF RAOBEXTRL4-R TO YL0145 OF
                 WORK-CONTEXT
      *        BDC Payment Term
               MOVE Q2BDCPTRM OF RAOBEXTRF4 OF RAOBEXTRL4-R TO YL0146
                 OF WORK-CONTEXT
      *        OBT Count Target Status
               MOVE Q2CNTTARG OF RAOBEXTRF4 OF RAOBEXTRL4-R TO YL0141
                 OF WORK-CONTEXT
      *        Fleet Programmes Code
               MOVE Q2FLPGMCDE OF RAOBEXTRF4 OF RAOBEXTRL4-R TO YL0143
                 OF WORK-CONTEXT
      *        Target Market
               MOVE Q2TGTMRKET OF RAOBEXTRF4 OF RAOBEXTRL4-R TO YL0147
                 OF WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
      *        *QUIT
               GO SH3EXIT
               SET C-INDICATOR-OFF(90) TO TRUE
               READ RAOBEXTRL4 NEXT
                 FORMAT IS 'RAOBEXTRF4'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         RAOBEXTRF4 OF RAOBEXTRL4-R TO
                         EXTSH3
                       MOVE EXTSH3 TO KRSSH3-TMP
                       IF (KRSSH3 NOT = KRSSH3-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        Chassis number
               MOVE LOW-VALUES TO Q2ASXX OF EXTSH3
           END-PERFORM
      *==============================================================
           CONTINUE.
       SH3EXIT.
           EXIT.
      /EJECT
       SH4RVGN SECTION.
      *==============================================================
      *    Rtv Target Value (Single) - Target Information  * Car
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    Level Code
           MOVE 00030 TO S9LVLCDE OF KRSSH4
      *    Dealer Number
           MOVE WUDLRNO OF WORK-CONTEXT TO S9DLRNBR OF KRSSH4
      *    Dealer Number Suffix
           MOVE WUUDLRSFX OF WORK-CONTEXT TO S9DLRSFX OF KRSSH4
      *    Target Period Code
           MOVE WUUTGTPRDA OF WORK-CONTEXT TO S9PERCDE OF KRSSH4
      *    Object Code
           MOVE 'CAR' TO S9OBJCDE OF KRSSH4
      *    Initialise Full Externally Described Keylist
      *    Level Code
           MOVE -99999 TO S9LVLCDE OF EXTSH4
      *    Dealer Number
           MOVE LOW-VALUES TO S9DLRNBR OF EXTSH4
      *    Dealer Number Suffix
           MOVE LOW-VALUES TO S9DLRSFX OF EXTSH4
      *    Target Period Code
           MOVE LOW-VALUES TO S9PERCDE OF EXTSH4
      *    Object Code
           MOVE LOW-VALUES TO S9OBJCDE OF EXTSH4
           MOVE CORRESPONDING
             EXTSH4 TO
             FTGTDSK OF AMTGTDTAL7-R
           MOVE CORRESPONDING
             KRSSH4 TO
             FTGTDSK OF AMTGTDTAL7-R
           START AMTGTDTAL7 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'FTGTDSK'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ AMTGTDTAL7 NEXT
             FORMAT IS 'FTGTDSK'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     FTGTDSK OF AMTGTDTAL7-R TO
                     EXTSH4
                   MOVE EXTSH4 TO KRSSH4-TMP
                   IF (KRSSH4 NOT = KRSSH4-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    Level Code
           MOVE -99999 TO S9LVLCDE OF EXTSH4
      *    Dealer Number
           MOVE LOW-VALUES TO S9DLRNBR OF EXTSH4
      *    Dealer Number Suffix
           MOVE LOW-VALUES TO S9DLRSFX OF EXTSH4
      *    Target Period Code
           MOVE LOW-VALUES TO S9PERCDE OF EXTSH4
      *    Object Code
           MOVE LOW-VALUES TO S9OBJCDE OF EXTSH4
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR2873' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Target Value
               MOVE ZEROS TO YL0097 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SH4EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Target Value
               MOVE S9TGOVAL OF FTGTDSK OF AMTGTDTAL7-R TO YL0097 OF
                 WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
               SET C-INDICATOR-OFF(90) TO TRUE
               READ AMTGTDTAL7 NEXT
                 FORMAT IS 'FTGTDSK'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         FTGTDSK OF AMTGTDTAL7-R TO
                         EXTSH4
                       MOVE EXTSH4 TO KRSSH4-TMP
                       IF (KRSSH4 NOT = KRSSH4-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        Level Code
               MOVE -99999 TO S9LVLCDE OF EXTSH4
      *        Dealer Number
               MOVE LOW-VALUES TO S9DLRNBR OF EXTSH4
      *        Dealer Number Suffix
               MOVE LOW-VALUES TO S9DLRSFX OF EXTSH4
      *        Target Period Code
               MOVE LOW-VALUES TO S9PERCDE OF EXTSH4
      *        Object Code
               MOVE LOW-VALUES TO S9OBJCDE OF EXTSH4
           END-PERFORM
      *==============================================================
           CONTINUE.
       SH4EXIT.
           EXIT.
      /EJECT
       SH5RVGN SECTION.
      *==============================================================
      *    Rtv Target Value (Single) - Target Information  * Van
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    Level Code
           MOVE 00030 TO S9LVLCDE OF KRSSH5
      *    Dealer Number
           MOVE WUDLRNO OF WORK-CONTEXT TO S9DLRNBR OF KRSSH5
      *    Dealer Number Suffix
           MOVE WUUDLRSFX OF WORK-CONTEXT TO S9DLRSFX OF KRSSH5
      *    Target Period Code
           MOVE WUUTGTPRDA OF WORK-CONTEXT TO S9PERCDE OF KRSSH5
      *    Object Code
           MOVE 'VAN' TO S9OBJCDE OF KRSSH5
      *    Initialise Full Externally Described Keylist
      *    Level Code
           MOVE -99999 TO S9LVLCDE OF EXTSH5
      *    Dealer Number
           MOVE LOW-VALUES TO S9DLRNBR OF EXTSH5
      *    Dealer Number Suffix
           MOVE LOW-VALUES TO S9DLRSFX OF EXTSH5
      *    Target Period Code
           MOVE LOW-VALUES TO S9PERCDE OF EXTSH5
      *    Object Code
           MOVE LOW-VALUES TO S9OBJCDE OF EXTSH5
           MOVE CORRESPONDING
             EXTSH5 TO
             FTGTDSK OF AMTGTDTAL7-R
           MOVE CORRESPONDING
             KRSSH5 TO
             FTGTDSK OF AMTGTDTAL7-R
           START AMTGTDTAL7 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'FTGTDSK'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ AMTGTDTAL7 NEXT
             FORMAT IS 'FTGTDSK'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     FTGTDSK OF AMTGTDTAL7-R TO
                     EXTSH5
                   MOVE EXTSH5 TO KRSSH5-TMP
                   IF (KRSSH5 NOT = KRSSH5-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    Level Code
           MOVE -99999 TO S9LVLCDE OF EXTSH5
      *    Dealer Number
           MOVE LOW-VALUES TO S9DLRNBR OF EXTSH5
      *    Dealer Number Suffix
           MOVE LOW-VALUES TO S9DLRSFX OF EXTSH5
      *    Target Period Code
           MOVE LOW-VALUES TO S9PERCDE OF EXTSH5
      *    Object Code
           MOVE LOW-VALUES TO S9OBJCDE OF EXTSH5
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR2873' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Target Value
               MOVE ZEROS TO YL0097 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SH5EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Target Value
               MOVE S9TGOVAL OF FTGTDSK OF AMTGTDTAL7-R TO YL0097 OF
                 WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
               SET C-INDICATOR-OFF(90) TO TRUE
               READ AMTGTDTAL7 NEXT
                 FORMAT IS 'FTGTDSK'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         FTGTDSK OF AMTGTDTAL7-R TO
                         EXTSH5
                       MOVE EXTSH5 TO KRSSH5-TMP
                       IF (KRSSH5 NOT = KRSSH5-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        Level Code
               MOVE -99999 TO S9LVLCDE OF EXTSH5
      *        Dealer Number
               MOVE LOW-VALUES TO S9DLRNBR OF EXTSH5
      *        Dealer Number Suffix
               MOVE LOW-VALUES TO S9DLRSFX OF EXTSH5
      *        Target Period Code
               MOVE LOW-VALUES TO S9PERCDE OF EXTSH5
      *        Object Code
               MOVE LOW-VALUES TO S9OBJCDE OF EXTSH5
           END-PERFORM
      *==============================================================
           CONTINUE.
       SH5EXIT.
           EXIT.
      /EJECT
       SH6RVGN SECTION.
      *==============================================================
      *    Rtv Target Value (Single) - Target Information  * Dacia car
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    Level Code
           MOVE 00030 TO S9LVLCDE OF KRSSH6
      *    Dealer Number
           MOVE WUWECF OF WORK-CONTEXT TO S9DLRNBR OF KRSSH6
      *    Dealer Number Suffix
           MOVE WUWFCF OF WORK-CONTEXT TO S9DLRSFX OF KRSSH6
      *    Target Period Code
           MOVE WUUTGTPRDA OF WORK-CONTEXT TO S9PERCDE OF KRSSH6
      *    Object Code
           MOVE 'CAR' TO S9OBJCDE OF KRSSH6
      *    Initialise Full Externally Described Keylist
      *    Level Code
           MOVE -99999 TO S9LVLCDE OF EXTSH6
      *    Dealer Number
           MOVE LOW-VALUES TO S9DLRNBR OF EXTSH6
      *    Dealer Number Suffix
           MOVE LOW-VALUES TO S9DLRSFX OF EXTSH6
      *    Target Period Code
           MOVE LOW-VALUES TO S9PERCDE OF EXTSH6
      *    Object Code
           MOVE LOW-VALUES TO S9OBJCDE OF EXTSH6
           MOVE CORRESPONDING
             EXTSH6 TO
             FTGTDSK OF AMTGTDTAL7-R
           MOVE CORRESPONDING
             KRSSH6 TO
             FTGTDSK OF AMTGTDTAL7-R
           START AMTGTDTAL7 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'FTGTDSK'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ AMTGTDTAL7 NEXT
             FORMAT IS 'FTGTDSK'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     FTGTDSK OF AMTGTDTAL7-R TO
                     EXTSH6
                   MOVE EXTSH6 TO KRSSH6-TMP
                   IF (KRSSH6 NOT = KRSSH6-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    Level Code
           MOVE -99999 TO S9LVLCDE OF EXTSH6
      *    Dealer Number
           MOVE LOW-VALUES TO S9DLRNBR OF EXTSH6
      *    Dealer Number Suffix
           MOVE LOW-VALUES TO S9DLRSFX OF EXTSH6
      *    Target Period Code
           MOVE LOW-VALUES TO S9PERCDE OF EXTSH6
      *    Object Code
           MOVE LOW-VALUES TO S9OBJCDE OF EXTSH6
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR2873' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Target Value
               MOVE ZEROS TO YL0098 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SH6EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Target Value
               MOVE S9TGOVAL OF FTGTDSK OF AMTGTDTAL7-R TO YL0098 OF
                 WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
               SET C-INDICATOR-OFF(90) TO TRUE
               READ AMTGTDTAL7 NEXT
                 FORMAT IS 'FTGTDSK'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         FTGTDSK OF AMTGTDTAL7-R TO
                         EXTSH6
                       MOVE EXTSH6 TO KRSSH6-TMP
                       IF (KRSSH6 NOT = KRSSH6-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        Level Code
               MOVE -99999 TO S9LVLCDE OF EXTSH6
      *        Dealer Number
               MOVE LOW-VALUES TO S9DLRNBR OF EXTSH6
      *        Dealer Number Suffix
               MOVE LOW-VALUES TO S9DLRSFX OF EXTSH6
      *        Target Period Code
               MOVE LOW-VALUES TO S9PERCDE OF EXTSH6
      *        Object Code
               MOVE LOW-VALUES TO S9OBJCDE OF EXTSH6
           END-PERFORM
      *==============================================================
           CONTINUE.
       SH6EXIT.
           EXIT.
      /EJECT
       SH7RVGN SECTION.
      *==============================================================
      *    Rtv Target Value (Single) - Target Information  * Van
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    Level Code
           MOVE 00030 TO S9LVLCDE OF KRSSH7
      *    Dealer Number
           MOVE WUWECF OF WORK-CONTEXT TO S9DLRNBR OF KRSSH7
      *    Dealer Number Suffix
           MOVE YL0099 OF WORK-CONTEXT TO S9DLRSFX OF KRSSH7
      *    Target Period Code
           MOVE WUUTGTPRDA OF WORK-CONTEXT TO S9PERCDE OF KRSSH7
      *    Object Code
           MOVE 'VAN' TO S9OBJCDE OF KRSSH7
      *    Initialise Full Externally Described Keylist
      *    Level Code
           MOVE -99999 TO S9LVLCDE OF EXTSH7
      *    Dealer Number
           MOVE LOW-VALUES TO S9DLRNBR OF EXTSH7
      *    Dealer Number Suffix
           MOVE LOW-VALUES TO S9DLRSFX OF EXTSH7
      *    Target Period Code
           MOVE LOW-VALUES TO S9PERCDE OF EXTSH7
      *    Object Code
           MOVE LOW-VALUES TO S9OBJCDE OF EXTSH7
           MOVE CORRESPONDING
             EXTSH7 TO
             FTGTDSK OF AMTGTDTAL7-R
           MOVE CORRESPONDING
             KRSSH7 TO
             FTGTDSK OF AMTGTDTAL7-R
           START AMTGTDTAL7 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'FTGTDSK'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ AMTGTDTAL7 NEXT
             FORMAT IS 'FTGTDSK'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     FTGTDSK OF AMTGTDTAL7-R TO
                     EXTSH7
                   MOVE EXTSH7 TO KRSSH7-TMP
                   IF (KRSSH7 NOT = KRSSH7-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    Level Code
           MOVE -99999 TO S9LVLCDE OF EXTSH7
      *    Dealer Number
           MOVE LOW-VALUES TO S9DLRNBR OF EXTSH7
      *    Dealer Number Suffix
           MOVE LOW-VALUES TO S9DLRSFX OF EXTSH7
      *    Target Period Code
           MOVE LOW-VALUES TO S9PERCDE OF EXTSH7
      *    Object Code
           MOVE LOW-VALUES TO S9OBJCDE OF EXTSH7
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR2873' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Target Value
               MOVE ZEROS TO YL0098 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SH7EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Target Value
               MOVE S9TGOVAL OF FTGTDSK OF AMTGTDTAL7-R TO YL0098 OF
                 WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
               SET C-INDICATOR-OFF(90) TO TRUE
               READ AMTGTDTAL7 NEXT
                 FORMAT IS 'FTGTDSK'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         FTGTDSK OF AMTGTDTAL7-R TO
                         EXTSH7
                       MOVE EXTSH7 TO KRSSH7-TMP
                       IF (KRSSH7 NOT = KRSSH7-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        Level Code
               MOVE -99999 TO S9LVLCDE OF EXTSH7
      *        Dealer Number
               MOVE LOW-VALUES TO S9DLRNBR OF EXTSH7
      *        Dealer Number Suffix
               MOVE LOW-VALUES TO S9DLRSFX OF EXTSH7
      *        Target Period Code
               MOVE LOW-VALUES TO S9PERCDE OF EXTSH7
      *        Object Code
               MOVE LOW-VALUES TO S9OBJCDE OF EXTSH7
           END-PERFORM
      *==============================================================
           CONTINUE.
       SH7EXIT.
           EXIT.
      /EJECT
       SH8RVGN SECTION.
      *==============================================================
      *    Rtv No of Regs TCTT - BDC.-.SEDRE DOT Extract  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    USER: Initialize routine
      *    Cvt *Job date to DTX
      *    * Job date contains a leading 1 when the year is 2000 or
      *      greater
      *    U:Job Date DTX
           ADD ZZJDT OF JOB-CONTEXT, 19000000 GIVING YL0107 OF
             WORK-CONTEXT
      *    Utl Cvt Dealer 6 to 5N
           MOVE 5 TO YRSW03
           MOVE 2 TO YRSW02
           IF (YRSW02 NOT > 0 OR
               YRSW03 NOT > 0 OR
               YRSW02 > 00006 OR
               YRSW03 > 00006) THEN
               MOVE 'Y2U0510' TO W0RTN
           ELSE
               MOVE WUNECO OF WORK-CONTEXT TO W0STRNG
               MOVE W0STRNG(YRSW02:YRSW03) TO WUUCODE5 OF WORK-CONTEXT
           END-IF
           IF (WUUCODE5 OF WORK-CONTEXT = SPACES) THEN
               MOVE ZERO TO YL0108 OF WORK-CONTEXT
           ELSE
               MOVE WUUCODE5 OF WORK-CONTEXT TO YL0108 OF WORK-CONTEXT
           END-IF
      *    U:Pay Cat 1 Regs
           MOVE ZEROS TO YL0100 OF WORK-CONTEXT
      *    U:Pay Cat 1 Regs
           MOVE ZEROS TO YL0109 OF WORK-CONTEXT
      *    U:Pay Cat 2 Regs
           MOVE ZEROS TO YL0101 OF WORK-CONTEXT
      *    U:Pay Cat 2 Regs
           MOVE ZEROS TO YL0110 OF WORK-CONTEXT
      *    U:Pay Cat 3 Regs
           MOVE ZEROS TO YL0102 OF WORK-CONTEXT
      *    U:Pay Cat 3 Regs
           MOVE ZEROS TO YL0111 OF WORK-CONTEXT
      *    U:Pay Cat 4 Regs
           MOVE ZEROS TO YL0103 OF WORK-CONTEXT
      *    U:Pay Cat 4 Regs
           MOVE ZEROS TO YL0112 OF WORK-CONTEXT
      *    U:Pay Cat 5 Regs
           MOVE ZEROS TO YL0104 OF WORK-CONTEXT
      *    U:Pay Cat 5 Regs
           MOVE ZEROS TO YL0113 OF WORK-CONTEXT
      *    U:Pay Cat N Regs
           MOVE ZEROS TO YL0105 OF WORK-CONTEXT
      *    U:Pay Cat N Regs
           MOVE ZEROS TO YL0114 OF WORK-CONTEXT
      *    U:Pay Cat O Regs
           MOVE ZEROS TO YL0106 OF WORK-CONTEXT
      *    U:Pay Cat O Regs
           MOVE ZEROS TO YL0115 OF WORK-CONTEXT
      *    Setup key
      *    CONCES PROPRIETAIRE
           MOVE WUNECO OF WORK-CONTEXT TO OSNECO OF KPSSH8
      *    DATE 58 IMMATRICULATION
           MOVE WUUFRMDTXA OF WORK-CONTEXT TO OSW0NB OF KPSSH8
           MOVE CORRESPONDING KPSSH8 TO KRSSH8
      *    Initialise Full Externally Described Keylist
      *    CONCES PROPRIETAIRE
           MOVE LOW-VALUES TO OSNECO OF EXTSH8
      *    DATE 58 IMMATRICULATION
           MOVE -99999999 TO OSW0NB OF EXTSH8
      *    COMMANDE CLIENT
           MOVE LOW-VALUES TO OSNUCO OF EXTSH8
           MOVE CORRESPONDING
             EXTSH8 TO
             FDOTEGL OF SBDOTEXTL7-R
           MOVE CORRESPONDING
             KPSSH8 TO
             FDOTEGL OF SBDOTEXTL7-R
           START SBDOTEXTL7 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'FDOTEGL'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ SBDOTEXTL7 NEXT
             FORMAT IS 'FDOTEGL'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     FDOTEGL OF SBDOTEXTL7-R TO
                     EXTSH8
                   MOVE EXTSH8 TO KRSSH8-TMP
                   IF (KRSSH8 NOT = KRSSH8-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    CONCES PROPRIETAIRE
           MOVE LOW-VALUES TO OSNECO OF EXTSH8
      *    DATE 58 IMMATRICULATION
           MOVE -99999999 TO OSW0NB OF EXTSH8
      *    COMMANDE CLIENT
           MOVE LOW-VALUES TO OSNUCO OF EXTSH8
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR5554' TO W0RTN
           END-IF
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        Count number of registrations for the Model
      *        CASE: DB1.DATE 58 IMMATRICULATION LE PAR.U:Number (8.0)
      *        *IF
               IF (OSW0NB OF FDOTEGL OF SBDOTEXTL7-R NOT > WUUTODTXA OF
                 WORK-CONTEXT) THEN
      *            Include this one?
      *            CASE: DB1.DATE 58 IMMATRICULATION is NE Zero
      *            *IF
                   IF (OSW0NB OF FDOTEGL OF SBDOTEXTL7-R NOT = 0) THEN
      *                Car/Van Indicator
                       MOVE ' ' TO YL0116 OF WORK-CONTEXT
      *                OBT Count Target Status
                       MOVE ' ' TO YL0117 OF WORK-CONTEXT
      *                Rtv Car or Van SCP Mdl - Vehicle Model Bonus
      *                  Atr  *
                       PERFORM SH9RVGN
      *                Rtv Rtn Latest Brand Mdl - Bonus Sls-RIC Mdl
      *                  Dsp Seq  *
                       PERFORM SI1RVGN
      *                Fleet Programmes Code
                       MOVE SPACES TO YL0119 OF WORK-CONTEXT
                       MOVE ' ' TO YL0119 OF WORK-CONTEXT
      *                U:Continue
                       MOVE 'Y' TO YL0120 OF WORK-CONTEXT
      *                Rtv All Dtl by Dlr/Mdl/ON - OBT Extract  *
                       PERFORM SI2RVGN
      *                Check Target Type Deselection
      *                CASE: PAR.U:Target Prefix is Target total
      *                *IF
                       IF ('TT' = 'TT') THEN
                           CONTINUE
                       ELSE
      *                    CASE: PAR.U:Target Prefix is Target Local
      *                      Market
      *                    *IF
                           IF ('TT' = 'TL') THEN
      *                        CASE: LCL.Target Market is Local Market
      *                          Target List
      *                        *IF
                               IF (YL0123 OF WORK-CONTEXT = 'L' OR
                                   YL0123 OF WORK-CONTEXT = 'W' OR
                                   YL0123 OF WORK-CONTEXT = 'R') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0120 OF WORK-CONTEXT
                               END-IF
                           ELSE
      *                        CASE: PAR.U:Target Prefix is Target
      *                          Major Fleet
      *                        *IF
                               IF ('TT' = 'TM') THEN
      *                        CASE: LCL.Target Market is Major Fleet
      *                          Target
      *                        *IF
                               IF (YL0123 OF WORK-CONTEXT = 'M') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0120 OF WORK-CONTEXT
                               END-IF
                               ELSE
      *                        CASE: PAR.U:Target Prefix is Target not
      *                          fleet
      *                        *IF
                               IF ('TT' = 'TN') THEN
      *                        CASE:
      *                        - c1 OR c2
      *                        |- c1    : LCL.Fleet Programmes Code is
      *                          *Blank
      *                        |- c2    : LCL.Fleet Programmes Code is
      *                          UNS - Unsupported (30286)
      *                        '-
      *                        *IF
                               IF (YL0119 OF WORK-CONTEXT = ' ' OR
                                   YL0119 OF WORK-CONTEXT = 'UNS') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0120 OF WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
      *                If O.K. to Continue - Following Record
      *                  Deselection
      *                CASE: LCL.U:Continue is Yes
      *                *IF
                       IF (YL0120 OF WORK-CONTEXT = 'Y') THEN
      *                    CASE: DB1.De-reg Date NBR is NE Zero
      *                    *IF
                           IF (OSZXNU OF FDOTEGL OF SBDOTEXTL7-R NOT =
                             0) THEN
      *                        For De-Regs
      *                        CASE:
      *                        - c1 OR c2
      *                        |- c1    : LCL.OBT Count Target Status
      *                          is In Target List
      *                        |- c2    : LCL.Bns Brand Name is RENAULT
      *                        '-
      *                        *IF
                               IF ((YL0117 OF WORK-CONTEXT = 'I' OR
                                    YL0117 OF WORK-CONTEXT = '1' OR
                                    YL0117 OF WORK-CONTEXT = '2' OR
                                    YL0117 OF WORK-CONTEXT = '3' OR
                                    YL0117 OF WORK-CONTEXT = '4' OR
                                    YL0117 OF WORK-CONTEXT = '5' OR
                                    YL0117 OF WORK-CONTEXT = 'N') OR
                                   YL0118 OF WORK-CONTEXT = 'RENAULT')
                                 THEN
      *                        U:Pay Cat 5 Regs
                               ADD YL0113 OF WORK-CONTEXT, 1 GIVING
                                 YL0113 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Pay Cat O Regs
                               ADD YL0115 OF WORK-CONTEXT, 1 GIVING
                                 YL0115 OF WORK-CONTEXT
                               END-IF
                           ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 1
      *                        *IF
                               IF (YL0117 OF WORK-CONTEXT = '1') THEN
      *                        U:Pay Cat 1 Regs
                               ADD YL0109 OF WORK-CONTEXT, 1 GIVING
                                 YL0109 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 2
      *                        *IF
                               IF (YL0117 OF WORK-CONTEXT = '2') THEN
      *                        U:Pay Cat 2 Regs
                               ADD YL0110 OF WORK-CONTEXT, 1 GIVING
                                 YL0110 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 3
      *                        *IF
                               IF (YL0117 OF WORK-CONTEXT = '3') THEN
      *                        U:Pay Cat 3 Regs
                               ADD YL0111 OF WORK-CONTEXT, 1 GIVING
                                 YL0111 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 4
      *                        *IF
                               IF (YL0117 OF WORK-CONTEXT = '4') THEN
      *                        U:Pay Cat 4 Regs
                               ADD YL0112 OF WORK-CONTEXT, 1 GIVING
                                 YL0112 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 5
      *                        *IF
                               IF (YL0117 OF WORK-CONTEXT = '5') THEN
      *                        U:Pay Cat 5 Regs
                               ADD YL0113 OF WORK-CONTEXT, 1 GIVING
                                 YL0113 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category N - New
      *                        *IF
                               IF (YL0117 OF WORK-CONTEXT = 'N') THEN
      *                        U:Pay Cat N Regs
                               ADD YL0114 OF WORK-CONTEXT, 1 GIVING
                                 YL0114 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Pay Cat O Regs
                               ADD YL0115 OF WORK-CONTEXT, 1 GIVING
                                 YL0115 OF WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
                   END-IF
               END-IF
               SET C-INDICATOR-OFF(90) TO TRUE
               READ SBDOTEXTL7 NEXT
                 FORMAT IS 'FDOTEGL'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         FDOTEGL OF SBDOTEXTL7-R TO
                         EXTSH8
                       MOVE EXTSH8 TO KRSSH8-TMP
                       IF (KRSSH8 NOT = KRSSH8-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        CONCES PROPRIETAIRE
               MOVE LOW-VALUES TO OSNECO OF EXTSH8
      *        DATE 58 IMMATRICULATION
               MOVE -99999999 TO OSW0NB OF EXTSH8
      *        COMMANDE CLIENT
               MOVE LOW-VALUES TO OSNUCO OF EXTSH8
           END-PERFORM
      *    USER: Exit processing
      *    U:Pay Cat 1 Regs
           MOVE YL0109 OF WORK-CONTEXT TO YL0100 OF WORK-CONTEXT
      *    U:Pay Cat 2 Regs
           MOVE YL0110 OF WORK-CONTEXT TO YL0101 OF WORK-CONTEXT
      *    U:Pay Cat 3 Regs
           MOVE YL0111 OF WORK-CONTEXT TO YL0102 OF WORK-CONTEXT
      *    U:Pay Cat 4 Regs
           MOVE YL0112 OF WORK-CONTEXT TO YL0103 OF WORK-CONTEXT
      *    U:Pay Cat 5 Regs
           MOVE YL0113 OF WORK-CONTEXT TO YL0104 OF WORK-CONTEXT
      *    U:Pay Cat N Regs
           MOVE YL0114 OF WORK-CONTEXT TO YL0105 OF WORK-CONTEXT
      *    U:Pay Cat O Regs
           MOVE YL0115 OF WORK-CONTEXT TO YL0106 OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       SH8EXIT.
           EXIT.
      /EJECT
       SH9RVGN SECTION.
      *==============================================================
      *    Rtv Car or Van SCP Mdl - Vehicle Model Bonus Atr  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    USER: Initialize routine
      *    Car/Van Indicator
           MOVE 'C' TO YL0116 OF WORK-CONTEXT
      *    Setup key
      *    Model Application Code
           MOVE 'RIC' TO LLMDLAPPCD OF KRSSH9
      *    SCP Model Code
           MOVE OSSTMDLSCP OF FDOTEGL OF SBDOTEXTL7-R TO LLSCMDLCDE OF
             KRSSH9
      *    Initialise Full Externally Described Keylist
      *    Model Application Code
           MOVE LOW-VALUES TO LLMDLAPPCD OF EXTSH9
      *    SCP Model Code
           MOVE LOW-VALUES TO LLSCMDLCDE OF EXTSH9
           MOVE CORRESPONDING
             KRSSH9 TO
             VAMDLBNSF1 OF VAMDLBNSL1-R
           SET C-INDICATOR-OFF(90) TO TRUE
           READ VAMDLBNSL1
             FORMAT IS 'VAMDLBNSF1'
           END-READ
           IF (C-NO-RECORD) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               END-IF
           END-IF
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR7127' TO W0RTN
      *        USER: Processing if Data record not found
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SH9EXIT
           END-IF
      *
           IF (C-INDICATOR-OFF(90)) THEN
      *        USER: Process Data record
      *        Car/Van Indicator
               MOVE LLCORV OF VAMDLBNSF1 OF VAMDLBNSL1-R TO YL0116 OF
                 WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
           END-IF
      *==============================================================
           CONTINUE.
       SH9EXIT.
           EXIT.
      /EJECT
       SI1RVGN SECTION.
      *==============================================================
      *    Rtv Rtn Latest Brand Mdl - Bonus Sls-RIC Mdl Dsp Seq  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    SCP Model Code
           MOVE OSSTMDLSCP OF FDOTEGL OF SBDOTEXTL7-R TO O9SCMDLCDE OF
             KRSSI1
      *    Initialise Full Externally Described Keylist
      *    SCP Model Code
           MOVE LOW-VALUES TO O9SCMDLCDE OF EXTSI1
      *    Bns RIC Config Year
           MOVE 9999 TO O9BNSRICYR OF EXTSI1
      *    Bns RIC Display Sequence
           MOVE -999 TO O9BNSRICSQ OF EXTSI1
           MOVE CORRESPONDING
             EXTSI1 TO
             SBRICDSQF4 OF SBRICDSQL4-R
           MOVE CORRESPONDING
             KRSSI1 TO
             SBRICDSQF4 OF SBRICDSQL4-R
           START SBRICDSQL4 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'SBRICDSQF4'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ SBRICDSQL4 NEXT
             FORMAT IS 'SBRICDSQF4'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     SBRICDSQF4 OF SBRICDSQL4-R TO
                     EXTSI1
                   MOVE EXTSI1 TO KRSSI1-TMP
                   IF (KRSSI1 NOT = KRSSI1-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    SCP Model Code
           MOVE LOW-VALUES TO O9SCMDLCDE OF EXTSI1
      *    Bns RIC Config Year
           MOVE 9999 TO O9BNSRICYR OF EXTSI1
      *    Bns RIC Display Sequence
           MOVE -999 TO O9BNSRICSQ OF EXTSI1
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR7404' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Bns Brand Name
               MOVE SPACES TO YL0118 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SI1EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Bns Brand Name
               MOVE O9BNSBRNDD OF SBRICDSQF4 OF SBRICDSQL4-R TO YL0118
                 OF WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
      *        *QUIT
               GO SI1EXIT
               SET C-INDICATOR-OFF(90) TO TRUE
               READ SBRICDSQL4 NEXT
                 FORMAT IS 'SBRICDSQF4'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         SBRICDSQF4 OF SBRICDSQL4-R TO
                         EXTSI1
                       MOVE EXTSI1 TO KRSSI1-TMP
                       IF (KRSSI1 NOT = KRSSI1-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        SCP Model Code
               MOVE LOW-VALUES TO O9SCMDLCDE OF EXTSI1
      *        Bns RIC Config Year
               MOVE 9999 TO O9BNSRICYR OF EXTSI1
      *        Bns RIC Display Sequence
               MOVE -999 TO O9BNSRICSQ OF EXTSI1
           END-PERFORM
      *==============================================================
           CONTINUE.
       SI1EXIT.
           EXIT.
      /EJECT
       SI2RVGN SECTION.
      *==============================================================
      *    Rtv All Dtl by Dlr/Mdl/ON - OBT Extract  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    Dealer number (Num key)
           MOVE YL0108 OF WORK-CONTEXT TO Q2DLRNOKEY OF KRSSI2
      *    BDC Model
           MOVE OSSTMDLSCP OF FDOTEGL OF SBDOTEXTL7-R TO Q2BDCM OF
             KRSSI2
      *    BDC Customer Order Number
           MOVE OSNUCO OF FDOTEGL OF SBDOTEXTL7-R TO Q2BDCCON OF KRSSI2
      *    Initialise Full Externally Described Keylist
      *    Dealer number (Num key)
           MOVE -99999 TO Q2DLRNOKEY OF EXTSI2
      *    BDC Model
           MOVE LOW-VALUES TO Q2BDCM OF EXTSI2
      *    BDC Customer Order Number
           MOVE LOW-VALUES TO Q2BDCCON OF EXTSI2
           MOVE CORRESPONDING
             EXTSI2 TO
             FOBEXCB OF RAOBEXTRL2-R
           MOVE CORRESPONDING
             KRSSI2 TO
             FOBEXCB OF RAOBEXTRL2-R
           START RAOBEXTRL2 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'FOBEXCB'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ RAOBEXTRL2 NEXT
             FORMAT IS 'FOBEXCB'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     FOBEXCB OF RAOBEXTRL2-R TO
                     EXTSI2
                   MOVE EXTSI2 TO KRSSI2-TMP
                   IF (KRSSI2 NOT = KRSSI2-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    Dealer number (Num key)
           MOVE -99999 TO Q2DLRNOKEY OF EXTSI2
      *    BDC Model
           MOVE LOW-VALUES TO Q2BDCM OF EXTSI2
      *    BDC Customer Order Number
           MOVE LOW-VALUES TO Q2BDCCON OF EXTSI2
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR5706' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Fleet Operator Number
               MOVE SPACES TO YL0121 OF WORK-CONTEXT
      *        BDC Payment Term
               MOVE SPACES TO YL0122 OF WORK-CONTEXT
      *        OBT Count Target Status
               MOVE SPACES TO YL0117 OF WORK-CONTEXT
      *        Fleet Programmes Code
               MOVE SPACES TO YL0119 OF WORK-CONTEXT
      *        Target Market
               MOVE SPACES TO YL0123 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SI2EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Fleet Operator Number
               MOVE Q2FLOPNO OF FOBEXCB OF RAOBEXTRL2-R TO YL0121 OF
                 WORK-CONTEXT
      *        BDC Payment Term
               MOVE Q2BDCPTRM OF FOBEXCB OF RAOBEXTRL2-R TO YL0122 OF
                 WORK-CONTEXT
      *        OBT Count Target Status
               MOVE Q2CNTTARG OF FOBEXCB OF RAOBEXTRL2-R TO YL0117 OF
                 WORK-CONTEXT
      *        Fleet Programmes Code
               MOVE Q2FLPGMCDE OF FOBEXCB OF RAOBEXTRL2-R TO YL0119 OF
                 WORK-CONTEXT
      *        Target Market
               MOVE Q2TGTMRKET OF FOBEXCB OF RAOBEXTRL2-R TO YL0123 OF
                 WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
      *        *QUIT
               GO SI2EXIT
               SET C-INDICATOR-OFF(90) TO TRUE
               READ RAOBEXTRL2 NEXT
                 FORMAT IS 'FOBEXCB'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         FOBEXCB OF RAOBEXTRL2-R TO
                         EXTSI2
                       MOVE EXTSI2 TO KRSSI2-TMP
                       IF (KRSSI2 NOT = KRSSI2-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        Dealer number (Num key)
               MOVE -99999 TO Q2DLRNOKEY OF EXTSI2
      *        BDC Model
               MOVE LOW-VALUES TO Q2BDCM OF EXTSI2
      *        BDC Customer Order Number
               MOVE LOW-VALUES TO Q2BDCCON OF EXTSI2
           END-PERFORM
      *==============================================================
           CONTINUE.
       SI2EXIT.
           EXIT.
      /EJECT
       SI3RVGN SECTION.
      *==============================================================
      *    Rtv No of Regs Derg TCTT - BDC.-.SEDRE DOT Extract  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    USER: Initialize routine
      *    Cvt *Job date to DTX
      *    * Job date contains a leading 1 when the year is 2000 or
      *      greater
      *    U:Job Date DTX
           ADD ZZJDT OF JOB-CONTEXT, 19000000 GIVING YL0131 OF
             WORK-CONTEXT
      *    Utl Cvt Dealer 6 to 5N
           MOVE 5 TO YRSW03
           MOVE 2 TO YRSW02
           IF (YRSW02 NOT > 0 OR
               YRSW03 NOT > 0 OR
               YRSW02 > 00006 OR
               YRSW03 > 00006) THEN
               MOVE 'Y2U0510' TO W0RTN
           ELSE
               MOVE WUNECO OF WORK-CONTEXT TO W0STRNG
               MOVE W0STRNG(YRSW02:YRSW03) TO WUUCODE5 OF WORK-CONTEXT
           END-IF
           IF (WUUCODE5 OF WORK-CONTEXT = SPACES) THEN
               MOVE ZERO TO YL0132 OF WORK-CONTEXT
           ELSE
               MOVE WUUCODE5 OF WORK-CONTEXT TO YL0132 OF WORK-CONTEXT
           END-IF
      *    U:Pay Cat 1 De-Regs
           MOVE ZEROS TO YL0124 OF WORK-CONTEXT
      *    U:Pay Cat 1 De-Regs
           MOVE ZEROS TO YL0133 OF WORK-CONTEXT
      *    U:Pay Cat 2 De-Regs
           MOVE ZEROS TO YL0125 OF WORK-CONTEXT
      *    U:Pay Cat 2 De-Regs
           MOVE ZEROS TO YL0134 OF WORK-CONTEXT
      *    U:Pay Cat 3 De-Regs
           MOVE ZEROS TO YL0126 OF WORK-CONTEXT
      *    U:Pay Cat 3 De-Regs
           MOVE ZEROS TO YL0135 OF WORK-CONTEXT
      *    U:Pay Cat 4 De-Regs
           MOVE ZEROS TO YL0127 OF WORK-CONTEXT
      *    U:Pay Cat 4 De-Regs
           MOVE ZEROS TO YL0136 OF WORK-CONTEXT
      *    U:Pay Cat 5 De-Regs
           MOVE ZEROS TO YL0128 OF WORK-CONTEXT
      *    U:Pay Cat 5 De-Regs
           MOVE ZEROS TO YL0137 OF WORK-CONTEXT
      *    U:Pay Cat N De-Regs
           MOVE ZEROS TO YL0129 OF WORK-CONTEXT
      *    U:Pay Cat N De-Regs
           MOVE ZEROS TO YL0138 OF WORK-CONTEXT
      *    U:Pay Cat O De-Regs
           MOVE ZEROS TO YL0130 OF WORK-CONTEXT
      *    U:Pay Cat O De-Regs
           MOVE ZEROS TO YL0139 OF WORK-CONTEXT
      *    Setup key
      *    CONCES PROPRIETAIRE
           MOVE WUNECO OF WORK-CONTEXT TO OSNECO OF KPSSI3
      *    De-reg Date NBR
           MOVE WUUFRMDTXA OF WORK-CONTEXT TO OSZXNU OF KPSSI3
           MOVE CORRESPONDING KPSSI3 TO KRSSI3
      *    Initialise Full Externally Described Keylist
      *    CONCES PROPRIETAIRE
           MOVE LOW-VALUES TO OSNECO OF EXTSI3
      *    De-reg Date NBR
           MOVE -99999999 TO OSZXNU OF EXTSI3
           MOVE CORRESPONDING
             EXTSI3 TO
             FDOTEGM OF SBDOTEXTL8-R
           MOVE CORRESPONDING
             KPSSI3 TO
             FDOTEGM OF SBDOTEXTL8-R
           START SBDOTEXTL8 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'FDOTEGM'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ SBDOTEXTL8 NEXT
             FORMAT IS 'FDOTEGM'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     FDOTEGM OF SBDOTEXTL8-R TO
                     EXTSI3
                   MOVE EXTSI3 TO KRSSI3-TMP
                   IF (KRSSI3 NOT = KRSSI3-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    CONCES PROPRIETAIRE
           MOVE LOW-VALUES TO OSNECO OF EXTSI3
      *    De-reg Date NBR
           MOVE -99999999 TO OSZXNU OF EXTSI3
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR5554' TO W0RTN
           END-IF
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        Count number of de-regs for the Model
      *        CASE: DB1.De-reg Date NBR LE PAR.U:Number (8.0)
      *        *IF
               IF (OSZXNU OF FDOTEGM OF SBDOTEXTL8-R NOT > WUUTODTXA OF
                 WORK-CONTEXT) THEN
      *            Include this one?
      *            CASE: DB1.De-reg Date NBR is NE Zero
      *            *IF
                   IF (OSZXNU OF FDOTEGM OF SBDOTEXTL8-R NOT = 0) THEN
      *                Car/Van Indicator
                       MOVE ' ' TO YL0140 OF WORK-CONTEXT
      *                OBT Count Target Status
                       MOVE ' ' TO YL0141 OF WORK-CONTEXT
      *                Rtv Car or Van SCP Mdl - Vehicle Model Bonus
      *                  Atr  *
                       PERFORM SI4RVGN
      *                Rtv Rtn Latest Brand Mdl - Bonus Sls-RIC Mdl
      *                  Dsp Seq  *
                       PERFORM SI5RVGN
      *                Fleet Programmes Code
                       MOVE SPACES TO YL0143 OF WORK-CONTEXT
                       MOVE ' ' TO YL0143 OF WORK-CONTEXT
      *                U:Continue
                       MOVE 'Y' TO YL0144 OF WORK-CONTEXT
      *                Rtv First Dtls for Chass - OBT Extract  *
                       PERFORM SI6RVGN
      *                Check Target Type Deselection
      *                CASE: PAR.U:Target Prefix is Target total
      *                *IF
                       IF ('TT' = 'TT') THEN
                           CONTINUE
                       ELSE
      *                    CASE: PAR.U:Target Prefix is Target Local
      *                      Market
      *                    *IF
                           IF ('TT' = 'TL') THEN
      *                        CASE: LCL.Target Market is Local Market
      *                          Target List
      *                        *IF
                               IF (YL0147 OF WORK-CONTEXT = 'L' OR
                                   YL0147 OF WORK-CONTEXT = 'W' OR
                                   YL0147 OF WORK-CONTEXT = 'R') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0144 OF WORK-CONTEXT
                               END-IF
                           ELSE
      *                        CASE: PAR.U:Target Prefix is Target
      *                          Major Fleet
      *                        *IF
                               IF ('TT' = 'TM') THEN
      *                        CASE: LCL.Target Market is Major Fleet
      *                          Target
      *                        *IF
                               IF (YL0147 OF WORK-CONTEXT = 'M') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0144 OF WORK-CONTEXT
                               END-IF
                               ELSE
      *                        CASE: PAR.U:Target Prefix is Target not
      *                          fleet
      *                        *IF
                               IF ('TT' = 'TN') THEN
      *                        CASE:
      *                        - c1 OR c2
      *                        |- c1    : LCL.Fleet Programmes Code is
      *                          *Blank
      *                        |- c2    : LCL.Fleet Programmes Code is
      *                          UNS - Unsupported (30286)
      *                        '-
      *                        *IF
                               IF (YL0143 OF WORK-CONTEXT = ' ' OR
                                   YL0143 OF WORK-CONTEXT = 'UNS') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0144 OF WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
      *                If O.K. to Continue - Following Record
      *                  Deselection
      *                CASE: LCL.U:Continue is Yes
      *                *IF
                       IF (YL0144 OF WORK-CONTEXT = 'Y') THEN
      *                    CASE: LCL.OBT Count Target Status is
      *                      Payment Category 1
      *                    *IF
                           IF (YL0141 OF WORK-CONTEXT = '1') THEN
      *                        U:Pay Cat 1 De-Regs
                               ADD YL0133 OF WORK-CONTEXT, 1 GIVING
                                 YL0133 OF WORK-CONTEXT
                           ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 2
      *                        *IF
                               IF (YL0141 OF WORK-CONTEXT = '2') THEN
      *                        U:Pay Cat 2 De-Regs
                               ADD YL0134 OF WORK-CONTEXT, 1 GIVING
                                 YL0134 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 3
      *                        *IF
                               IF (YL0141 OF WORK-CONTEXT = '3') THEN
      *                        U:Pay Cat 3 De-Regs
                               ADD YL0135 OF WORK-CONTEXT, 1 GIVING
                                 YL0135 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 4
      *                        *IF
                               IF (YL0141 OF WORK-CONTEXT = '4') THEN
      *                        U:Pay Cat 4 De-Regs
                               ADD YL0136 OF WORK-CONTEXT, 1 GIVING
                                 YL0136 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 5
      *                        *IF
                               IF (YL0141 OF WORK-CONTEXT = '5') THEN
      *                        U:Pay Cat 5 De-Regs
                               ADD YL0137 OF WORK-CONTEXT, 1 GIVING
                                 YL0137 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category N - New
      *                        *IF
                               IF (YL0141 OF WORK-CONTEXT = 'N') THEN
      *                        U:Pay Cat N De-Regs
                               ADD YL0138 OF WORK-CONTEXT, 1 GIVING
                                 YL0138 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
      *                        CASE: LCL.Bns Brand Name is RENAULT
      *                        *IF
                               IF (YL0142 OF WORK-CONTEXT = 'RENAULT')
                                 THEN
      *                        U:Pay Cat 5 De-Regs
                               ADD YL0137 OF WORK-CONTEXT, 1 GIVING
                                 YL0137 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Pay Cat O De-Regs
                               ADD YL0139 OF WORK-CONTEXT, 1 GIVING
                                 YL0139 OF WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
                   END-IF
               END-IF
               SET C-INDICATOR-OFF(90) TO TRUE
               READ SBDOTEXTL8 NEXT
                 FORMAT IS 'FDOTEGM'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         FDOTEGM OF SBDOTEXTL8-R TO
                         EXTSI3
                       MOVE EXTSI3 TO KRSSI3-TMP
                       IF (KRSSI3 NOT = KRSSI3-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        CONCES PROPRIETAIRE
               MOVE LOW-VALUES TO OSNECO OF EXTSI3
      *        De-reg Date NBR
               MOVE -99999999 TO OSZXNU OF EXTSI3
           END-PERFORM
      *    USER: Exit processing
      *    U:Pay Cat 1 De-Regs
           MOVE YL0133 OF WORK-CONTEXT TO YL0124 OF WORK-CONTEXT
      *    U:Pay Cat 2 De-Regs
           MOVE YL0134 OF WORK-CONTEXT TO YL0125 OF WORK-CONTEXT
      *    U:Pay Cat 3 De-Regs
           MOVE YL0135 OF WORK-CONTEXT TO YL0126 OF WORK-CONTEXT
      *    U:Pay Cat 4 De-Regs
           MOVE YL0136 OF WORK-CONTEXT TO YL0127 OF WORK-CONTEXT
      *    U:Pay Cat 5 De-Regs
           MOVE YL0137 OF WORK-CONTEXT TO YL0128 OF WORK-CONTEXT
      *    U:Pay Cat N De-Regs
           MOVE YL0138 OF WORK-CONTEXT TO YL0129 OF WORK-CONTEXT
      *    U:Pay Cat O De-Regs
           MOVE YL0139 OF WORK-CONTEXT TO YL0130 OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       SI3EXIT.
           EXIT.
      /EJECT
       SI4RVGN SECTION.
      *==============================================================
      *    Rtv Car or Van SCP Mdl - Vehicle Model Bonus Atr  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    USER: Initialize routine
      *    Car/Van Indicator
           MOVE 'C' TO YL0140 OF WORK-CONTEXT
      *    Setup key
      *    Model Application Code
           MOVE 'RIC' TO LLMDLAPPCD OF KRSSI4
      *    SCP Model Code
           MOVE OSSTMDLSCP OF FDOTEGM OF SBDOTEXTL8-R TO LLSCMDLCDE OF
             KRSSI4
      *    Initialise Full Externally Described Keylist
      *    Model Application Code
           MOVE LOW-VALUES TO LLMDLAPPCD OF EXTSI4
      *    SCP Model Code
           MOVE LOW-VALUES TO LLSCMDLCDE OF EXTSI4
           MOVE CORRESPONDING
             KRSSI4 TO
             VAMDLBNSF1 OF VAMDLBNSL1-R
           SET C-INDICATOR-OFF(90) TO TRUE
           READ VAMDLBNSL1
             FORMAT IS 'VAMDLBNSF1'
           END-READ
           IF (C-NO-RECORD) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               END-IF
           END-IF
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR7127' TO W0RTN
      *        USER: Processing if Data record not found
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SI4EXIT
           END-IF
      *
           IF (C-INDICATOR-OFF(90)) THEN
      *        USER: Process Data record
      *        Car/Van Indicator
               MOVE LLCORV OF VAMDLBNSF1 OF VAMDLBNSL1-R TO YL0140 OF
                 WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
           END-IF
      *==============================================================
           CONTINUE.
       SI4EXIT.
           EXIT.
      /EJECT
       SI5RVGN SECTION.
      *==============================================================
      *    Rtv Rtn Latest Brand Mdl - Bonus Sls-RIC Mdl Dsp Seq  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    SCP Model Code
           MOVE OSSTMDLSCP OF FDOTEGM OF SBDOTEXTL8-R TO O9SCMDLCDE OF
             KRSSI5
      *    Initialise Full Externally Described Keylist
      *    SCP Model Code
           MOVE LOW-VALUES TO O9SCMDLCDE OF EXTSI5
      *    Bns RIC Config Year
           MOVE 9999 TO O9BNSRICYR OF EXTSI5
      *    Bns RIC Display Sequence
           MOVE -999 TO O9BNSRICSQ OF EXTSI5
           MOVE CORRESPONDING
             EXTSI5 TO
             SBRICDSQF4 OF SBRICDSQL4-R
           MOVE CORRESPONDING
             KRSSI5 TO
             SBRICDSQF4 OF SBRICDSQL4-R
           START SBRICDSQL4 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'SBRICDSQF4'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ SBRICDSQL4 NEXT
             FORMAT IS 'SBRICDSQF4'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     SBRICDSQF4 OF SBRICDSQL4-R TO
                     EXTSI5
                   MOVE EXTSI5 TO KRSSI5-TMP
                   IF (KRSSI5 NOT = KRSSI5-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    SCP Model Code
           MOVE LOW-VALUES TO O9SCMDLCDE OF EXTSI5
      *    Bns RIC Config Year
           MOVE 9999 TO O9BNSRICYR OF EXTSI5
      *    Bns RIC Display Sequence
           MOVE -999 TO O9BNSRICSQ OF EXTSI5
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR7404' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Bns Brand Name
               MOVE SPACES TO YL0142 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SI5EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Bns Brand Name
               MOVE O9BNSBRNDD OF SBRICDSQF4 OF SBRICDSQL4-R TO YL0142
                 OF WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
      *        *QUIT
               GO SI5EXIT
               SET C-INDICATOR-OFF(90) TO TRUE
               READ SBRICDSQL4 NEXT
                 FORMAT IS 'SBRICDSQF4'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         SBRICDSQF4 OF SBRICDSQL4-R TO
                         EXTSI5
                       MOVE EXTSI5 TO KRSSI5-TMP
                       IF (KRSSI5 NOT = KRSSI5-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        SCP Model Code
               MOVE LOW-VALUES TO O9SCMDLCDE OF EXTSI5
      *        Bns RIC Config Year
               MOVE 9999 TO O9BNSRICYR OF EXTSI5
      *        Bns RIC Display Sequence
               MOVE -999 TO O9BNSRICSQ OF EXTSI5
           END-PERFORM
      *==============================================================
           CONTINUE.
       SI5EXIT.
           EXIT.
      /EJECT
       SI6RVGN SECTION.
      *==============================================================
      *    Rtv First Dtls for Chass - OBT Extract  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    Chassis number
           MOVE OSYPTX OF FDOTEGM OF SBDOTEXTL8-R TO Q2ASXX OF KRSSI6
      *    Initialise Full Externally Described Keylist
      *    Chassis number
           MOVE LOW-VALUES TO Q2ASXX OF EXTSI6
           MOVE CORRESPONDING
             EXTSI6 TO
             RAOBEXTRF4 OF RAOBEXTRL4-R
           MOVE CORRESPONDING
             KRSSI6 TO
             RAOBEXTRF4 OF RAOBEXTRL4-R
           START RAOBEXTRL4 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'RAOBEXTRF4'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ RAOBEXTRL4 NEXT
             FORMAT IS 'RAOBEXTRF4'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     RAOBEXTRF4 OF RAOBEXTRL4-R TO
                     EXTSI6
                   MOVE EXTSI6 TO KRSSI6-TMP
                   IF (KRSSI6 NOT = KRSSI6-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    Chassis number
           MOVE LOW-VALUES TO Q2ASXX OF EXTSI6
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR5706' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Fleet Operator Number
               MOVE SPACES TO YL0145 OF WORK-CONTEXT
      *        BDC Payment Term
               MOVE SPACES TO YL0146 OF WORK-CONTEXT
      *        OBT Count Target Status
               MOVE SPACES TO YL0141 OF WORK-CONTEXT
      *        Fleet Programmes Code
               MOVE SPACES TO YL0143 OF WORK-CONTEXT
      *        Target Market
               MOVE SPACES TO YL0147 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SI6EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Fleet Operator Number
               MOVE Q2FLOPNO OF RAOBEXTRF4 OF RAOBEXTRL4-R TO YL0145 OF
                 WORK-CONTEXT
      *        BDC Payment Term
               MOVE Q2BDCPTRM OF RAOBEXTRF4 OF RAOBEXTRL4-R TO YL0146
                 OF WORK-CONTEXT
      *        OBT Count Target Status
               MOVE Q2CNTTARG OF RAOBEXTRF4 OF RAOBEXTRL4-R TO YL0141
                 OF WORK-CONTEXT
      *        Fleet Programmes Code
               MOVE Q2FLPGMCDE OF RAOBEXTRF4 OF RAOBEXTRL4-R TO YL0143
                 OF WORK-CONTEXT
      *        Target Market
               MOVE Q2TGTMRKET OF RAOBEXTRF4 OF RAOBEXTRL4-R TO YL0147
                 OF WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
      *        *QUIT
               GO SI6EXIT
               SET C-INDICATOR-OFF(90) TO TRUE
               READ RAOBEXTRL4 NEXT
                 FORMAT IS 'RAOBEXTRF4'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         RAOBEXTRF4 OF RAOBEXTRL4-R TO
                         EXTSI6
                       MOVE EXTSI6 TO KRSSI6-TMP
                       IF (KRSSI6 NOT = KRSSI6-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        Chassis number
               MOVE LOW-VALUES TO Q2ASXX OF EXTSI6
           END-PERFORM
      *==============================================================
           CONTINUE.
       SI6EXIT.
           EXIT.
      /EJECT
       SI7RVGN SECTION.
      *==============================================================
      *    Rtv No of Regs TCTT - BDC.-.SEDRE DOT Extract  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    USER: Initialize routine
      *    Cvt *Job date to DTX
      *    * Job date contains a leading 1 when the year is 2000 or
      *      greater
      *    U:Job Date DTX
           ADD ZZJDT OF JOB-CONTEXT, 19000000 GIVING YL0107 OF
             WORK-CONTEXT
      *    Utl Cvt Dealer 6 to 5N
           MOVE 5 TO YRSW03
           MOVE 2 TO YRSW02
           IF (YRSW02 NOT > 0 OR
               YRSW03 NOT > 0 OR
               YRSW02 > 00006 OR
               YRSW03 > 00006) THEN
               MOVE 'Y2U0510' TO W0RTN
           ELSE
               MOVE WUTOCF OF WORK-CONTEXT TO W0STRNG
               MOVE W0STRNG(YRSW02:YRSW03) TO WUUCODE5 OF WORK-CONTEXT
           END-IF
           IF (WUUCODE5 OF WORK-CONTEXT = SPACES) THEN
               MOVE ZERO TO YL0108 OF WORK-CONTEXT
           ELSE
               MOVE WUUCODE5 OF WORK-CONTEXT TO YL0108 OF WORK-CONTEXT
           END-IF
      *    U:Pay Cat 1 Regs
           MOVE ZEROS TO YL0148 OF WORK-CONTEXT
      *    U:Pay Cat 1 Regs
           MOVE ZEROS TO YL0109 OF WORK-CONTEXT
      *    U:Pay Cat 2 Regs
           MOVE ZEROS TO YL0149 OF WORK-CONTEXT
      *    U:Pay Cat 2 Regs
           MOVE ZEROS TO YL0110 OF WORK-CONTEXT
      *    U:Pay Cat 3 Regs
           MOVE ZEROS TO YL0150 OF WORK-CONTEXT
      *    U:Pay Cat 3 Regs
           MOVE ZEROS TO YL0111 OF WORK-CONTEXT
      *    U:Pay Cat 4 Regs
           MOVE ZEROS TO YL0151 OF WORK-CONTEXT
      *    U:Pay Cat 4 Regs
           MOVE ZEROS TO YL0112 OF WORK-CONTEXT
      *    U:Pay Cat 5 Regs
           MOVE ZEROS TO YL0152 OF WORK-CONTEXT
      *    U:Pay Cat 5 Regs
           MOVE ZEROS TO YL0113 OF WORK-CONTEXT
      *    U:Pay Cat N Regs
           MOVE ZEROS TO YL0153 OF WORK-CONTEXT
      *    U:Pay Cat N Regs
           MOVE ZEROS TO YL0114 OF WORK-CONTEXT
      *    U:Pay Cat O Regs
           MOVE ZEROS TO YL0154 OF WORK-CONTEXT
      *    U:Pay Cat O Regs
           MOVE ZEROS TO YL0115 OF WORK-CONTEXT
      *    Setup key
      *    CONCES PROPRIETAIRE
           MOVE WUTOCF OF WORK-CONTEXT TO OSNECO OF KPSSI7
      *    DATE 58 IMMATRICULATION
           MOVE WUUFRMDTXA OF WORK-CONTEXT TO OSW0NB OF KPSSI7
           MOVE CORRESPONDING KPSSI7 TO KRSSI7
      *    Initialise Full Externally Described Keylist
      *    CONCES PROPRIETAIRE
           MOVE LOW-VALUES TO OSNECO OF EXTSI7
      *    DATE 58 IMMATRICULATION
           MOVE -99999999 TO OSW0NB OF EXTSI7
      *    COMMANDE CLIENT
           MOVE LOW-VALUES TO OSNUCO OF EXTSI7
           MOVE CORRESPONDING
             EXTSI7 TO
             FDOTEGL OF SBDOTEXTL7-R
           MOVE CORRESPONDING
             KPSSI7 TO
             FDOTEGL OF SBDOTEXTL7-R
           START SBDOTEXTL7 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'FDOTEGL'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ SBDOTEXTL7 NEXT
             FORMAT IS 'FDOTEGL'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     FDOTEGL OF SBDOTEXTL7-R TO
                     EXTSI7
                   MOVE EXTSI7 TO KRSSI7-TMP
                   IF (KRSSI7 NOT = KRSSI7-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    CONCES PROPRIETAIRE
           MOVE LOW-VALUES TO OSNECO OF EXTSI7
      *    DATE 58 IMMATRICULATION
           MOVE -99999999 TO OSW0NB OF EXTSI7
      *    COMMANDE CLIENT
           MOVE LOW-VALUES TO OSNUCO OF EXTSI7
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR5554' TO W0RTN
           END-IF
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        Count number of registrations for the Model
      *        CASE: DB1.DATE 58 IMMATRICULATION LE PAR.U:Number (8.0)
      *        *IF
               IF (OSW0NB OF FDOTEGL OF SBDOTEXTL7-R NOT > WUUTODTXA OF
                 WORK-CONTEXT) THEN
      *            Include this one?
      *            CASE: DB1.DATE 58 IMMATRICULATION is NE Zero
      *            *IF
                   IF (OSW0NB OF FDOTEGL OF SBDOTEXTL7-R NOT = 0) THEN
      *                Car/Van Indicator
                       MOVE ' ' TO YL0116 OF WORK-CONTEXT
      *                OBT Count Target Status
                       MOVE ' ' TO YL0117 OF WORK-CONTEXT
      *                Rtv Car or Van SCP Mdl - Vehicle Model Bonus
      *                  Atr  *
                       PERFORM SI8RVGN
      *                Rtv Rtn Latest Brand Mdl - Bonus Sls-RIC Mdl
      *                  Dsp Seq  *
                       PERFORM SI9RVGN
      *                Fleet Programmes Code
                       MOVE SPACES TO YL0119 OF WORK-CONTEXT
                       MOVE ' ' TO YL0119 OF WORK-CONTEXT
      *                U:Continue
                       MOVE 'Y' TO YL0120 OF WORK-CONTEXT
      *                Rtv All Dtl by Dlr/Mdl/ON - OBT Extract  *
                       PERFORM SJ1RVGN
      *                Check Target Type Deselection
      *                CASE: PAR.U:Target Prefix is Target total
      *                *IF
                       IF ('TT' = 'TT') THEN
                           CONTINUE
                       ELSE
      *                    CASE: PAR.U:Target Prefix is Target Local
      *                      Market
      *                    *IF
                           IF ('TT' = 'TL') THEN
      *                        CASE: LCL.Target Market is Local Market
      *                          Target List
      *                        *IF
                               IF (YL0123 OF WORK-CONTEXT = 'L' OR
                                   YL0123 OF WORK-CONTEXT = 'W' OR
                                   YL0123 OF WORK-CONTEXT = 'R') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0120 OF WORK-CONTEXT
                               END-IF
                           ELSE
      *                        CASE: PAR.U:Target Prefix is Target
      *                          Major Fleet
      *                        *IF
                               IF ('TT' = 'TM') THEN
      *                        CASE: LCL.Target Market is Major Fleet
      *                          Target
      *                        *IF
                               IF (YL0123 OF WORK-CONTEXT = 'M') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0120 OF WORK-CONTEXT
                               END-IF
                               ELSE
      *                        CASE: PAR.U:Target Prefix is Target not
      *                          fleet
      *                        *IF
                               IF ('TT' = 'TN') THEN
      *                        CASE:
      *                        - c1 OR c2
      *                        |- c1    : LCL.Fleet Programmes Code is
      *                          *Blank
      *                        |- c2    : LCL.Fleet Programmes Code is
      *                          UNS - Unsupported (30286)
      *                        '-
      *                        *IF
                               IF (YL0119 OF WORK-CONTEXT = ' ' OR
                                   YL0119 OF WORK-CONTEXT = 'UNS') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0120 OF WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
      *                If O.K. to Continue - Following Record
      *                  Deselection
      *                CASE: LCL.U:Continue is Yes
      *                *IF
                       IF (YL0120 OF WORK-CONTEXT = 'Y') THEN
      *                    CASE: DB1.De-reg Date NBR is NE Zero
      *                    *IF
                           IF (OSZXNU OF FDOTEGL OF SBDOTEXTL7-R NOT =
                             0) THEN
      *                        For De-Regs
      *                        CASE:
      *                        - c1 OR c2
      *                        |- c1    : LCL.OBT Count Target Status
      *                          is In Target List
      *                        |- c2    : LCL.Bns Brand Name is RENAULT
      *                        '-
      *                        *IF
                               IF ((YL0117 OF WORK-CONTEXT = 'I' OR
                                    YL0117 OF WORK-CONTEXT = '1' OR
                                    YL0117 OF WORK-CONTEXT = '2' OR
                                    YL0117 OF WORK-CONTEXT = '3' OR
                                    YL0117 OF WORK-CONTEXT = '4' OR
                                    YL0117 OF WORK-CONTEXT = '5' OR
                                    YL0117 OF WORK-CONTEXT = 'N') OR
                                   YL0118 OF WORK-CONTEXT = 'RENAULT')
                                 THEN
      *                        U:Pay Cat 5 Regs
                               ADD YL0113 OF WORK-CONTEXT, 1 GIVING
                                 YL0113 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Pay Cat O Regs
                               ADD YL0115 OF WORK-CONTEXT, 1 GIVING
                                 YL0115 OF WORK-CONTEXT
                               END-IF
                           ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 1
      *                        *IF
                               IF (YL0117 OF WORK-CONTEXT = '1') THEN
      *                        U:Pay Cat 1 Regs
                               ADD YL0109 OF WORK-CONTEXT, 1 GIVING
                                 YL0109 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 2
      *                        *IF
                               IF (YL0117 OF WORK-CONTEXT = '2') THEN
      *                        U:Pay Cat 2 Regs
                               ADD YL0110 OF WORK-CONTEXT, 1 GIVING
                                 YL0110 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 3
      *                        *IF
                               IF (YL0117 OF WORK-CONTEXT = '3') THEN
      *                        U:Pay Cat 3 Regs
                               ADD YL0111 OF WORK-CONTEXT, 1 GIVING
                                 YL0111 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 4
      *                        *IF
                               IF (YL0117 OF WORK-CONTEXT = '4') THEN
      *                        U:Pay Cat 4 Regs
                               ADD YL0112 OF WORK-CONTEXT, 1 GIVING
                                 YL0112 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 5
      *                        *IF
                               IF (YL0117 OF WORK-CONTEXT = '5') THEN
      *                        U:Pay Cat 5 Regs
                               ADD YL0113 OF WORK-CONTEXT, 1 GIVING
                                 YL0113 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category N - New
      *                        *IF
                               IF (YL0117 OF WORK-CONTEXT = 'N') THEN
      *                        U:Pay Cat N Regs
                               ADD YL0114 OF WORK-CONTEXT, 1 GIVING
                                 YL0114 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Pay Cat O Regs
                               ADD YL0115 OF WORK-CONTEXT, 1 GIVING
                                 YL0115 OF WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
                   END-IF
               END-IF
               SET C-INDICATOR-OFF(90) TO TRUE
               READ SBDOTEXTL7 NEXT
                 FORMAT IS 'FDOTEGL'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         FDOTEGL OF SBDOTEXTL7-R TO
                         EXTSI7
                       MOVE EXTSI7 TO KRSSI7-TMP
                       IF (KRSSI7 NOT = KRSSI7-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        CONCES PROPRIETAIRE
               MOVE LOW-VALUES TO OSNECO OF EXTSI7
      *        DATE 58 IMMATRICULATION
               MOVE -99999999 TO OSW0NB OF EXTSI7
      *        COMMANDE CLIENT
               MOVE LOW-VALUES TO OSNUCO OF EXTSI7
           END-PERFORM
      *    USER: Exit processing
      *    U:Pay Cat 1 Regs
           MOVE YL0109 OF WORK-CONTEXT TO YL0148 OF WORK-CONTEXT
      *    U:Pay Cat 2 Regs
           MOVE YL0110 OF WORK-CONTEXT TO YL0149 OF WORK-CONTEXT
      *    U:Pay Cat 3 Regs
           MOVE YL0111 OF WORK-CONTEXT TO YL0150 OF WORK-CONTEXT
      *    U:Pay Cat 4 Regs
           MOVE YL0112 OF WORK-CONTEXT TO YL0151 OF WORK-CONTEXT
      *    U:Pay Cat 5 Regs
           MOVE YL0113 OF WORK-CONTEXT TO YL0152 OF WORK-CONTEXT
      *    U:Pay Cat N Regs
           MOVE YL0114 OF WORK-CONTEXT TO YL0153 OF WORK-CONTEXT
      *    U:Pay Cat O Regs
           MOVE YL0115 OF WORK-CONTEXT TO YL0154 OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       SI7EXIT.
           EXIT.
      /EJECT
       SI8RVGN SECTION.
      *==============================================================
      *    Rtv Car or Van SCP Mdl - Vehicle Model Bonus Atr  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    USER: Initialize routine
      *    Car/Van Indicator
           MOVE 'C' TO YL0116 OF WORK-CONTEXT
      *    Setup key
      *    Model Application Code
           MOVE 'RIC' TO LLMDLAPPCD OF KRSSI8
      *    SCP Model Code
           MOVE OSSTMDLSCP OF FDOTEGL OF SBDOTEXTL7-R TO LLSCMDLCDE OF
             KRSSI8
      *    Initialise Full Externally Described Keylist
      *    Model Application Code
           MOVE LOW-VALUES TO LLMDLAPPCD OF EXTSI8
      *    SCP Model Code
           MOVE LOW-VALUES TO LLSCMDLCDE OF EXTSI8
           MOVE CORRESPONDING
             KRSSI8 TO
             VAMDLBNSF1 OF VAMDLBNSL1-R
           SET C-INDICATOR-OFF(90) TO TRUE
           READ VAMDLBNSL1
             FORMAT IS 'VAMDLBNSF1'
           END-READ
           IF (C-NO-RECORD) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               END-IF
           END-IF
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR7127' TO W0RTN
      *        USER: Processing if Data record not found
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SI8EXIT
           END-IF
      *
           IF (C-INDICATOR-OFF(90)) THEN
      *        USER: Process Data record
      *        Car/Van Indicator
               MOVE LLCORV OF VAMDLBNSF1 OF VAMDLBNSL1-R TO YL0116 OF
                 WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
           END-IF
      *==============================================================
           CONTINUE.
       SI8EXIT.
           EXIT.
      /EJECT
       SI9RVGN SECTION.
      *==============================================================
      *    Rtv Rtn Latest Brand Mdl - Bonus Sls-RIC Mdl Dsp Seq  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    SCP Model Code
           MOVE OSSTMDLSCP OF FDOTEGL OF SBDOTEXTL7-R TO O9SCMDLCDE OF
             KRSSI9
      *    Initialise Full Externally Described Keylist
      *    SCP Model Code
           MOVE LOW-VALUES TO O9SCMDLCDE OF EXTSI9
      *    Bns RIC Config Year
           MOVE 9999 TO O9BNSRICYR OF EXTSI9
      *    Bns RIC Display Sequence
           MOVE -999 TO O9BNSRICSQ OF EXTSI9
           MOVE CORRESPONDING
             EXTSI9 TO
             SBRICDSQF4 OF SBRICDSQL4-R
           MOVE CORRESPONDING
             KRSSI9 TO
             SBRICDSQF4 OF SBRICDSQL4-R
           START SBRICDSQL4 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'SBRICDSQF4'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ SBRICDSQL4 NEXT
             FORMAT IS 'SBRICDSQF4'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     SBRICDSQF4 OF SBRICDSQL4-R TO
                     EXTSI9
                   MOVE EXTSI9 TO KRSSI9-TMP
                   IF (KRSSI9 NOT = KRSSI9-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    SCP Model Code
           MOVE LOW-VALUES TO O9SCMDLCDE OF EXTSI9
      *    Bns RIC Config Year
           MOVE 9999 TO O9BNSRICYR OF EXTSI9
      *    Bns RIC Display Sequence
           MOVE -999 TO O9BNSRICSQ OF EXTSI9
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR7404' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Bns Brand Name
               MOVE SPACES TO YL0118 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SI9EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Bns Brand Name
               MOVE O9BNSBRNDD OF SBRICDSQF4 OF SBRICDSQL4-R TO YL0118
                 OF WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
      *        *QUIT
               GO SI9EXIT
               SET C-INDICATOR-OFF(90) TO TRUE
               READ SBRICDSQL4 NEXT
                 FORMAT IS 'SBRICDSQF4'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         SBRICDSQF4 OF SBRICDSQL4-R TO
                         EXTSI9
                       MOVE EXTSI9 TO KRSSI9-TMP
                       IF (KRSSI9 NOT = KRSSI9-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        SCP Model Code
               MOVE LOW-VALUES TO O9SCMDLCDE OF EXTSI9
      *        Bns RIC Config Year
               MOVE 9999 TO O9BNSRICYR OF EXTSI9
      *        Bns RIC Display Sequence
               MOVE -999 TO O9BNSRICSQ OF EXTSI9
           END-PERFORM
      *==============================================================
           CONTINUE.
       SI9EXIT.
           EXIT.
      /EJECT
       SJ1RVGN SECTION.
      *==============================================================
      *    Rtv All Dtl by Dlr/Mdl/ON - OBT Extract  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    Dealer number (Num key)
           MOVE YL0108 OF WORK-CONTEXT TO Q2DLRNOKEY OF KRSSJ1
      *    BDC Model
           MOVE OSSTMDLSCP OF FDOTEGL OF SBDOTEXTL7-R TO Q2BDCM OF
             KRSSJ1
      *    BDC Customer Order Number
           MOVE OSNUCO OF FDOTEGL OF SBDOTEXTL7-R TO Q2BDCCON OF KRSSJ1
      *    Initialise Full Externally Described Keylist
      *    Dealer number (Num key)
           MOVE -99999 TO Q2DLRNOKEY OF EXTSJ1
      *    BDC Model
           MOVE LOW-VALUES TO Q2BDCM OF EXTSJ1
      *    BDC Customer Order Number
           MOVE LOW-VALUES TO Q2BDCCON OF EXTSJ1
           MOVE CORRESPONDING
             EXTSJ1 TO
             FOBEXCB OF RAOBEXTRL2-R
           MOVE CORRESPONDING
             KRSSJ1 TO
             FOBEXCB OF RAOBEXTRL2-R
           START RAOBEXTRL2 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'FOBEXCB'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ RAOBEXTRL2 NEXT
             FORMAT IS 'FOBEXCB'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     FOBEXCB OF RAOBEXTRL2-R TO
                     EXTSJ1
                   MOVE EXTSJ1 TO KRSSJ1-TMP
                   IF (KRSSJ1 NOT = KRSSJ1-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    Dealer number (Num key)
           MOVE -99999 TO Q2DLRNOKEY OF EXTSJ1
      *    BDC Model
           MOVE LOW-VALUES TO Q2BDCM OF EXTSJ1
      *    BDC Customer Order Number
           MOVE LOW-VALUES TO Q2BDCCON OF EXTSJ1
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR5706' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Fleet Operator Number
               MOVE SPACES TO YL0121 OF WORK-CONTEXT
      *        BDC Payment Term
               MOVE SPACES TO YL0122 OF WORK-CONTEXT
      *        OBT Count Target Status
               MOVE SPACES TO YL0117 OF WORK-CONTEXT
      *        Fleet Programmes Code
               MOVE SPACES TO YL0119 OF WORK-CONTEXT
      *        Target Market
               MOVE SPACES TO YL0123 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SJ1EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Fleet Operator Number
               MOVE Q2FLOPNO OF FOBEXCB OF RAOBEXTRL2-R TO YL0121 OF
                 WORK-CONTEXT
      *        BDC Payment Term
               MOVE Q2BDCPTRM OF FOBEXCB OF RAOBEXTRL2-R TO YL0122 OF
                 WORK-CONTEXT
      *        OBT Count Target Status
               MOVE Q2CNTTARG OF FOBEXCB OF RAOBEXTRL2-R TO YL0117 OF
                 WORK-CONTEXT
      *        Fleet Programmes Code
               MOVE Q2FLPGMCDE OF FOBEXCB OF RAOBEXTRL2-R TO YL0119 OF
                 WORK-CONTEXT
      *        Target Market
               MOVE Q2TGTMRKET OF FOBEXCB OF RAOBEXTRL2-R TO YL0123 OF
                 WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
      *        *QUIT
               GO SJ1EXIT
               SET C-INDICATOR-OFF(90) TO TRUE
               READ RAOBEXTRL2 NEXT
                 FORMAT IS 'FOBEXCB'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         FOBEXCB OF RAOBEXTRL2-R TO
                         EXTSJ1
                       MOVE EXTSJ1 TO KRSSJ1-TMP
                       IF (KRSSJ1 NOT = KRSSJ1-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        Dealer number (Num key)
               MOVE -99999 TO Q2DLRNOKEY OF EXTSJ1
      *        BDC Model
               MOVE LOW-VALUES TO Q2BDCM OF EXTSJ1
      *        BDC Customer Order Number
               MOVE LOW-VALUES TO Q2BDCCON OF EXTSJ1
           END-PERFORM
      *==============================================================
           CONTINUE.
       SJ1EXIT.
           EXIT.
      /EJECT
       SJ2RVGN SECTION.
      *==============================================================
      *    Rtv No of Regs Derg TCTT - BDC.-.SEDRE DOT Extract  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    USER: Initialize routine
      *    Cvt *Job date to DTX
      *    * Job date contains a leading 1 when the year is 2000 or
      *      greater
      *    U:Job Date DTX
           ADD ZZJDT OF JOB-CONTEXT, 19000000 GIVING YL0131 OF
             WORK-CONTEXT
      *    Utl Cvt Dealer 6 to 5N
           MOVE 5 TO YRSW03
           MOVE 2 TO YRSW02
           IF (YRSW02 NOT > 0 OR
               YRSW03 NOT > 0 OR
               YRSW02 > 00006 OR
               YRSW03 > 00006) THEN
               MOVE 'Y2U0510' TO W0RTN
           ELSE
               MOVE WUTOCF OF WORK-CONTEXT TO W0STRNG
               MOVE W0STRNG(YRSW02:YRSW03) TO WUUCODE5 OF WORK-CONTEXT
           END-IF
           IF (WUUCODE5 OF WORK-CONTEXT = SPACES) THEN
               MOVE ZERO TO YL0132 OF WORK-CONTEXT
           ELSE
               MOVE WUUCODE5 OF WORK-CONTEXT TO YL0132 OF WORK-CONTEXT
           END-IF
      *    U:Pay Cat 1 De-Regs
           MOVE ZEROS TO YL0155 OF WORK-CONTEXT
      *    U:Pay Cat 1 De-Regs
           MOVE ZEROS TO YL0133 OF WORK-CONTEXT
      *    U:Pay Cat 2 De-Regs
           MOVE ZEROS TO YL0156 OF WORK-CONTEXT
      *    U:Pay Cat 2 De-Regs
           MOVE ZEROS TO YL0134 OF WORK-CONTEXT
      *    U:Pay Cat 3 De-Regs
           MOVE ZEROS TO YL0157 OF WORK-CONTEXT
      *    U:Pay Cat 3 De-Regs
           MOVE ZEROS TO YL0135 OF WORK-CONTEXT
      *    U:Pay Cat 4 De-Regs
           MOVE ZEROS TO YL0158 OF WORK-CONTEXT
      *    U:Pay Cat 4 De-Regs
           MOVE ZEROS TO YL0136 OF WORK-CONTEXT
      *    U:Pay Cat 5 De-Regs
           MOVE ZEROS TO YL0159 OF WORK-CONTEXT
      *    U:Pay Cat 5 De-Regs
           MOVE ZEROS TO YL0137 OF WORK-CONTEXT
      *    U:Pay Cat N De-Regs
           MOVE ZEROS TO YL0160 OF WORK-CONTEXT
      *    U:Pay Cat N De-Regs
           MOVE ZEROS TO YL0138 OF WORK-CONTEXT
      *    U:Pay Cat O De-Regs
           MOVE ZEROS TO YL0161 OF WORK-CONTEXT
      *    U:Pay Cat O De-Regs
           MOVE ZEROS TO YL0139 OF WORK-CONTEXT
      *    Setup key
      *    CONCES PROPRIETAIRE
           MOVE WUTOCF OF WORK-CONTEXT TO OSNECO OF KPSSJ2
      *    De-reg Date NBR
           MOVE WUUFRMDTXA OF WORK-CONTEXT TO OSZXNU OF KPSSJ2
           MOVE CORRESPONDING KPSSJ2 TO KRSSJ2
      *    Initialise Full Externally Described Keylist
      *    CONCES PROPRIETAIRE
           MOVE LOW-VALUES TO OSNECO OF EXTSJ2
      *    De-reg Date NBR
           MOVE -99999999 TO OSZXNU OF EXTSJ2
           MOVE CORRESPONDING
             EXTSJ2 TO
             FDOTEGM OF SBDOTEXTL8-R
           MOVE CORRESPONDING
             KPSSJ2 TO
             FDOTEGM OF SBDOTEXTL8-R
           START SBDOTEXTL8 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'FDOTEGM'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ SBDOTEXTL8 NEXT
             FORMAT IS 'FDOTEGM'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     FDOTEGM OF SBDOTEXTL8-R TO
                     EXTSJ2
                   MOVE EXTSJ2 TO KRSSJ2-TMP
                   IF (KRSSJ2 NOT = KRSSJ2-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    CONCES PROPRIETAIRE
           MOVE LOW-VALUES TO OSNECO OF EXTSJ2
      *    De-reg Date NBR
           MOVE -99999999 TO OSZXNU OF EXTSJ2
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR5554' TO W0RTN
           END-IF
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        Count number of de-regs for the Model
      *        CASE: DB1.De-reg Date NBR LE PAR.U:Number (8.0)
      *        *IF
               IF (OSZXNU OF FDOTEGM OF SBDOTEXTL8-R NOT > WUUTODTXA OF
                 WORK-CONTEXT) THEN
      *            Include this one?
      *            CASE: DB1.De-reg Date NBR is NE Zero
      *            *IF
                   IF (OSZXNU OF FDOTEGM OF SBDOTEXTL8-R NOT = 0) THEN
      *                Car/Van Indicator
                       MOVE ' ' TO YL0140 OF WORK-CONTEXT
      *                OBT Count Target Status
                       MOVE ' ' TO YL0141 OF WORK-CONTEXT
      *                Rtv Car or Van SCP Mdl - Vehicle Model Bonus
      *                  Atr  *
                       PERFORM SJ3RVGN
      *                Rtv Rtn Latest Brand Mdl - Bonus Sls-RIC Mdl
      *                  Dsp Seq  *
                       PERFORM SJ4RVGN
      *                Fleet Programmes Code
                       MOVE SPACES TO YL0143 OF WORK-CONTEXT
                       MOVE ' ' TO YL0143 OF WORK-CONTEXT
      *                U:Continue
                       MOVE 'Y' TO YL0144 OF WORK-CONTEXT
      *                Rtv First Dtls for Chass - OBT Extract  *
                       PERFORM SJ5RVGN
      *                Check Target Type Deselection
      *                CASE: PAR.U:Target Prefix is Target total
      *                *IF
                       IF ('TT' = 'TT') THEN
                           CONTINUE
                       ELSE
      *                    CASE: PAR.U:Target Prefix is Target Local
      *                      Market
      *                    *IF
                           IF ('TT' = 'TL') THEN
      *                        CASE: LCL.Target Market is Local Market
      *                          Target List
      *                        *IF
                               IF (YL0147 OF WORK-CONTEXT = 'L' OR
                                   YL0147 OF WORK-CONTEXT = 'W' OR
                                   YL0147 OF WORK-CONTEXT = 'R') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0144 OF WORK-CONTEXT
                               END-IF
                           ELSE
      *                        CASE: PAR.U:Target Prefix is Target
      *                          Major Fleet
      *                        *IF
                               IF ('TT' = 'TM') THEN
      *                        CASE: LCL.Target Market is Major Fleet
      *                          Target
      *                        *IF
                               IF (YL0147 OF WORK-CONTEXT = 'M') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0144 OF WORK-CONTEXT
                               END-IF
                               ELSE
      *                        CASE: PAR.U:Target Prefix is Target not
      *                          fleet
      *                        *IF
                               IF ('TT' = 'TN') THEN
      *                        CASE:
      *                        - c1 OR c2
      *                        |- c1    : LCL.Fleet Programmes Code is
      *                          *Blank
      *                        |- c2    : LCL.Fleet Programmes Code is
      *                          UNS - Unsupported (30286)
      *                        '-
      *                        *IF
                               IF (YL0143 OF WORK-CONTEXT = ' ' OR
                                   YL0143 OF WORK-CONTEXT = 'UNS') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0144 OF WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
      *                If O.K. to Continue - Following Record
      *                  Deselection
      *                CASE: LCL.U:Continue is Yes
      *                *IF
                       IF (YL0144 OF WORK-CONTEXT = 'Y') THEN
      *                    CASE: LCL.OBT Count Target Status is
      *                      Payment Category 1
      *                    *IF
                           IF (YL0141 OF WORK-CONTEXT = '1') THEN
      *                        U:Pay Cat 1 De-Regs
                               ADD YL0133 OF WORK-CONTEXT, 1 GIVING
                                 YL0133 OF WORK-CONTEXT
                           ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 2
      *                        *IF
                               IF (YL0141 OF WORK-CONTEXT = '2') THEN
      *                        U:Pay Cat 2 De-Regs
                               ADD YL0134 OF WORK-CONTEXT, 1 GIVING
                                 YL0134 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 3
      *                        *IF
                               IF (YL0141 OF WORK-CONTEXT = '3') THEN
      *                        U:Pay Cat 3 De-Regs
                               ADD YL0135 OF WORK-CONTEXT, 1 GIVING
                                 YL0135 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 4
      *                        *IF
                               IF (YL0141 OF WORK-CONTEXT = '4') THEN
      *                        U:Pay Cat 4 De-Regs
                               ADD YL0136 OF WORK-CONTEXT, 1 GIVING
                                 YL0136 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 5
      *                        *IF
                               IF (YL0141 OF WORK-CONTEXT = '5') THEN
      *                        U:Pay Cat 5 De-Regs
                               ADD YL0137 OF WORK-CONTEXT, 1 GIVING
                                 YL0137 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category N - New
      *                        *IF
                               IF (YL0141 OF WORK-CONTEXT = 'N') THEN
      *                        U:Pay Cat N De-Regs
                               ADD YL0138 OF WORK-CONTEXT, 1 GIVING
                                 YL0138 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
      *                        CASE: LCL.Bns Brand Name is RENAULT
      *                        *IF
                               IF (YL0142 OF WORK-CONTEXT = 'RENAULT')
                                 THEN
      *                        U:Pay Cat 5 De-Regs
                               ADD YL0137 OF WORK-CONTEXT, 1 GIVING
                                 YL0137 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Pay Cat O De-Regs
                               ADD YL0139 OF WORK-CONTEXT, 1 GIVING
                                 YL0139 OF WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
                   END-IF
               END-IF
               SET C-INDICATOR-OFF(90) TO TRUE
               READ SBDOTEXTL8 NEXT
                 FORMAT IS 'FDOTEGM'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         FDOTEGM OF SBDOTEXTL8-R TO
                         EXTSJ2
                       MOVE EXTSJ2 TO KRSSJ2-TMP
                       IF (KRSSJ2 NOT = KRSSJ2-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        CONCES PROPRIETAIRE
               MOVE LOW-VALUES TO OSNECO OF EXTSJ2
      *        De-reg Date NBR
               MOVE -99999999 TO OSZXNU OF EXTSJ2
           END-PERFORM
      *    USER: Exit processing
      *    U:Pay Cat 1 De-Regs
           MOVE YL0133 OF WORK-CONTEXT TO YL0155 OF WORK-CONTEXT
      *    U:Pay Cat 2 De-Regs
           MOVE YL0134 OF WORK-CONTEXT TO YL0156 OF WORK-CONTEXT
      *    U:Pay Cat 3 De-Regs
           MOVE YL0135 OF WORK-CONTEXT TO YL0157 OF WORK-CONTEXT
      *    U:Pay Cat 4 De-Regs
           MOVE YL0136 OF WORK-CONTEXT TO YL0158 OF WORK-CONTEXT
      *    U:Pay Cat 5 De-Regs
           MOVE YL0137 OF WORK-CONTEXT TO YL0159 OF WORK-CONTEXT
      *    U:Pay Cat N De-Regs
           MOVE YL0138 OF WORK-CONTEXT TO YL0160 OF WORK-CONTEXT
      *    U:Pay Cat O De-Regs
           MOVE YL0139 OF WORK-CONTEXT TO YL0161 OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       SJ2EXIT.
           EXIT.
      /EJECT
       SJ3RVGN SECTION.
      *==============================================================
      *    Rtv Car or Van SCP Mdl - Vehicle Model Bonus Atr  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    USER: Initialize routine
      *    Car/Van Indicator
           MOVE 'C' TO YL0140 OF WORK-CONTEXT
      *    Setup key
      *    Model Application Code
           MOVE 'RIC' TO LLMDLAPPCD OF KRSSJ3
      *    SCP Model Code
           MOVE OSSTMDLSCP OF FDOTEGM OF SBDOTEXTL8-R TO LLSCMDLCDE OF
             KRSSJ3
      *    Initialise Full Externally Described Keylist
      *    Model Application Code
           MOVE LOW-VALUES TO LLMDLAPPCD OF EXTSJ3
      *    SCP Model Code
           MOVE LOW-VALUES TO LLSCMDLCDE OF EXTSJ3
           MOVE CORRESPONDING
             KRSSJ3 TO
             VAMDLBNSF1 OF VAMDLBNSL1-R
           SET C-INDICATOR-OFF(90) TO TRUE
           READ VAMDLBNSL1
             FORMAT IS 'VAMDLBNSF1'
           END-READ
           IF (C-NO-RECORD) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               END-IF
           END-IF
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR7127' TO W0RTN
      *        USER: Processing if Data record not found
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SJ3EXIT
           END-IF
      *
           IF (C-INDICATOR-OFF(90)) THEN
      *        USER: Process Data record
      *        Car/Van Indicator
               MOVE LLCORV OF VAMDLBNSF1 OF VAMDLBNSL1-R TO YL0140 OF
                 WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
           END-IF
      *==============================================================
           CONTINUE.
       SJ3EXIT.
           EXIT.
      /EJECT
       SJ4RVGN SECTION.
      *==============================================================
      *    Rtv Rtn Latest Brand Mdl - Bonus Sls-RIC Mdl Dsp Seq  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    SCP Model Code
           MOVE OSSTMDLSCP OF FDOTEGM OF SBDOTEXTL8-R TO O9SCMDLCDE OF
             KRSSJ4
      *    Initialise Full Externally Described Keylist
      *    SCP Model Code
           MOVE LOW-VALUES TO O9SCMDLCDE OF EXTSJ4
      *    Bns RIC Config Year
           MOVE 9999 TO O9BNSRICYR OF EXTSJ4
      *    Bns RIC Display Sequence
           MOVE -999 TO O9BNSRICSQ OF EXTSJ4
           MOVE CORRESPONDING
             EXTSJ4 TO
             SBRICDSQF4 OF SBRICDSQL4-R
           MOVE CORRESPONDING
             KRSSJ4 TO
             SBRICDSQF4 OF SBRICDSQL4-R
           START SBRICDSQL4 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'SBRICDSQF4'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ SBRICDSQL4 NEXT
             FORMAT IS 'SBRICDSQF4'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     SBRICDSQF4 OF SBRICDSQL4-R TO
                     EXTSJ4
                   MOVE EXTSJ4 TO KRSSJ4-TMP
                   IF (KRSSJ4 NOT = KRSSJ4-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    SCP Model Code
           MOVE LOW-VALUES TO O9SCMDLCDE OF EXTSJ4
      *    Bns RIC Config Year
           MOVE 9999 TO O9BNSRICYR OF EXTSJ4
      *    Bns RIC Display Sequence
           MOVE -999 TO O9BNSRICSQ OF EXTSJ4
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR7404' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Bns Brand Name
               MOVE SPACES TO YL0142 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SJ4EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Bns Brand Name
               MOVE O9BNSBRNDD OF SBRICDSQF4 OF SBRICDSQL4-R TO YL0142
                 OF WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
      *        *QUIT
               GO SJ4EXIT
               SET C-INDICATOR-OFF(90) TO TRUE
               READ SBRICDSQL4 NEXT
                 FORMAT IS 'SBRICDSQF4'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         SBRICDSQF4 OF SBRICDSQL4-R TO
                         EXTSJ4
                       MOVE EXTSJ4 TO KRSSJ4-TMP
                       IF (KRSSJ4 NOT = KRSSJ4-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        SCP Model Code
               MOVE LOW-VALUES TO O9SCMDLCDE OF EXTSJ4
      *        Bns RIC Config Year
               MOVE 9999 TO O9BNSRICYR OF EXTSJ4
      *        Bns RIC Display Sequence
               MOVE -999 TO O9BNSRICSQ OF EXTSJ4
           END-PERFORM
      *==============================================================
           CONTINUE.
       SJ4EXIT.
           EXIT.
      /EJECT
       SJ5RVGN SECTION.
      *==============================================================
      *    Rtv First Dtls for Chass - OBT Extract  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    Chassis number
           MOVE OSYPTX OF FDOTEGM OF SBDOTEXTL8-R TO Q2ASXX OF KRSSJ5
      *    Initialise Full Externally Described Keylist
      *    Chassis number
           MOVE LOW-VALUES TO Q2ASXX OF EXTSJ5
           MOVE CORRESPONDING
             EXTSJ5 TO
             RAOBEXTRF4 OF RAOBEXTRL4-R
           MOVE CORRESPONDING
             KRSSJ5 TO
             RAOBEXTRF4 OF RAOBEXTRL4-R
           START RAOBEXTRL4 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'RAOBEXTRF4'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ RAOBEXTRL4 NEXT
             FORMAT IS 'RAOBEXTRF4'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     RAOBEXTRF4 OF RAOBEXTRL4-R TO
                     EXTSJ5
                   MOVE EXTSJ5 TO KRSSJ5-TMP
                   IF (KRSSJ5 NOT = KRSSJ5-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    Chassis number
           MOVE LOW-VALUES TO Q2ASXX OF EXTSJ5
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR5706' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Fleet Operator Number
               MOVE SPACES TO YL0145 OF WORK-CONTEXT
      *        BDC Payment Term
               MOVE SPACES TO YL0146 OF WORK-CONTEXT
      *        OBT Count Target Status
               MOVE SPACES TO YL0141 OF WORK-CONTEXT
      *        Fleet Programmes Code
               MOVE SPACES TO YL0143 OF WORK-CONTEXT
      *        Target Market
               MOVE SPACES TO YL0147 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SJ5EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Fleet Operator Number
               MOVE Q2FLOPNO OF RAOBEXTRF4 OF RAOBEXTRL4-R TO YL0145 OF
                 WORK-CONTEXT
      *        BDC Payment Term
               MOVE Q2BDCPTRM OF RAOBEXTRF4 OF RAOBEXTRL4-R TO YL0146
                 OF WORK-CONTEXT
      *        OBT Count Target Status
               MOVE Q2CNTTARG OF RAOBEXTRF4 OF RAOBEXTRL4-R TO YL0141
                 OF WORK-CONTEXT
      *        Fleet Programmes Code
               MOVE Q2FLPGMCDE OF RAOBEXTRF4 OF RAOBEXTRL4-R TO YL0143
                 OF WORK-CONTEXT
      *        Target Market
               MOVE Q2TGTMRKET OF RAOBEXTRF4 OF RAOBEXTRL4-R TO YL0147
                 OF WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
      *        *QUIT
               GO SJ5EXIT
               SET C-INDICATOR-OFF(90) TO TRUE
               READ RAOBEXTRL4 NEXT
                 FORMAT IS 'RAOBEXTRF4'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         RAOBEXTRF4 OF RAOBEXTRL4-R TO
                         EXTSJ5
                       MOVE EXTSJ5 TO KRSSJ5-TMP
                       IF (KRSSJ5 NOT = KRSSJ5-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        Chassis number
               MOVE LOW-VALUES TO Q2ASXX OF EXTSJ5
           END-PERFORM
      *==============================================================
           CONTINUE.
       SJ5EXIT.
           EXIT.
      /EJECT
       SJ6RVGN SECTION.
      *==============================================================
      *    Rtv Target Value (Single) - Target Information  * Car
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    Level Code
           MOVE 00030 TO S9LVLCDE OF KRSSJ6
      *    Dealer Number
           MOVE WUDLRNO OF WORK-CONTEXT TO S9DLRNBR OF KRSSJ6
      *    Dealer Number Suffix
           MOVE WUUDLRSFX OF WORK-CONTEXT TO S9DLRSFX OF KRSSJ6
      *    Target Period Code
           MOVE WUUTGTPRDD OF WORK-CONTEXT TO S9PERCDE OF KRSSJ6
      *    Object Code
           MOVE 'CAR' TO S9OBJCDE OF KRSSJ6
      *    Initialise Full Externally Described Keylist
      *    Level Code
           MOVE -99999 TO S9LVLCDE OF EXTSJ6
      *    Dealer Number
           MOVE LOW-VALUES TO S9DLRNBR OF EXTSJ6
      *    Dealer Number Suffix
           MOVE LOW-VALUES TO S9DLRSFX OF EXTSJ6
      *    Target Period Code
           MOVE LOW-VALUES TO S9PERCDE OF EXTSJ6
      *    Object Code
           MOVE LOW-VALUES TO S9OBJCDE OF EXTSJ6
           MOVE CORRESPONDING
             EXTSJ6 TO
             FTGTDSK OF AMTGTDTAL7-R
           MOVE CORRESPONDING
             KRSSJ6 TO
             FTGTDSK OF AMTGTDTAL7-R
           START AMTGTDTAL7 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'FTGTDSK'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ AMTGTDTAL7 NEXT
             FORMAT IS 'FTGTDSK'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     FTGTDSK OF AMTGTDTAL7-R TO
                     EXTSJ6
                   MOVE EXTSJ6 TO KRSSJ6-TMP
                   IF (KRSSJ6 NOT = KRSSJ6-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    Level Code
           MOVE -99999 TO S9LVLCDE OF EXTSJ6
      *    Dealer Number
           MOVE LOW-VALUES TO S9DLRNBR OF EXTSJ6
      *    Dealer Number Suffix
           MOVE LOW-VALUES TO S9DLRSFX OF EXTSJ6
      *    Target Period Code
           MOVE LOW-VALUES TO S9PERCDE OF EXTSJ6
      *    Object Code
           MOVE LOW-VALUES TO S9OBJCDE OF EXTSJ6
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR2873' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Target Value
               MOVE ZEROS TO YL0097 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SJ6EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Target Value
               MOVE S9TGOVAL OF FTGTDSK OF AMTGTDTAL7-R TO YL0097 OF
                 WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
               SET C-INDICATOR-OFF(90) TO TRUE
               READ AMTGTDTAL7 NEXT
                 FORMAT IS 'FTGTDSK'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         FTGTDSK OF AMTGTDTAL7-R TO
                         EXTSJ6
                       MOVE EXTSJ6 TO KRSSJ6-TMP
                       IF (KRSSJ6 NOT = KRSSJ6-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        Level Code
               MOVE -99999 TO S9LVLCDE OF EXTSJ6
      *        Dealer Number
               MOVE LOW-VALUES TO S9DLRNBR OF EXTSJ6
      *        Dealer Number Suffix
               MOVE LOW-VALUES TO S9DLRSFX OF EXTSJ6
      *        Target Period Code
               MOVE LOW-VALUES TO S9PERCDE OF EXTSJ6
      *        Object Code
               MOVE LOW-VALUES TO S9OBJCDE OF EXTSJ6
           END-PERFORM
      *==============================================================
           CONTINUE.
       SJ6EXIT.
           EXIT.
      /EJECT
       SJ7RVGN SECTION.
      *==============================================================
      *    Rtv Target Value (Single) - Target Information  * Van
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    Level Code
           MOVE 00030 TO S9LVLCDE OF KRSSJ7
      *    Dealer Number
           MOVE WUDLRNO OF WORK-CONTEXT TO S9DLRNBR OF KRSSJ7
      *    Dealer Number Suffix
           MOVE WUUDLRSFX OF WORK-CONTEXT TO S9DLRSFX OF KRSSJ7
      *    Target Period Code
           MOVE WUUTGTPRDD OF WORK-CONTEXT TO S9PERCDE OF KRSSJ7
      *    Object Code
           MOVE 'VAN' TO S9OBJCDE OF KRSSJ7
      *    Initialise Full Externally Described Keylist
      *    Level Code
           MOVE -99999 TO S9LVLCDE OF EXTSJ7
      *    Dealer Number
           MOVE LOW-VALUES TO S9DLRNBR OF EXTSJ7
      *    Dealer Number Suffix
           MOVE LOW-VALUES TO S9DLRSFX OF EXTSJ7
      *    Target Period Code
           MOVE LOW-VALUES TO S9PERCDE OF EXTSJ7
      *    Object Code
           MOVE LOW-VALUES TO S9OBJCDE OF EXTSJ7
           MOVE CORRESPONDING
             EXTSJ7 TO
             FTGTDSK OF AMTGTDTAL7-R
           MOVE CORRESPONDING
             KRSSJ7 TO
             FTGTDSK OF AMTGTDTAL7-R
           START AMTGTDTAL7 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'FTGTDSK'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ AMTGTDTAL7 NEXT
             FORMAT IS 'FTGTDSK'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     FTGTDSK OF AMTGTDTAL7-R TO
                     EXTSJ7
                   MOVE EXTSJ7 TO KRSSJ7-TMP
                   IF (KRSSJ7 NOT = KRSSJ7-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    Level Code
           MOVE -99999 TO S9LVLCDE OF EXTSJ7
      *    Dealer Number
           MOVE LOW-VALUES TO S9DLRNBR OF EXTSJ7
      *    Dealer Number Suffix
           MOVE LOW-VALUES TO S9DLRSFX OF EXTSJ7
      *    Target Period Code
           MOVE LOW-VALUES TO S9PERCDE OF EXTSJ7
      *    Object Code
           MOVE LOW-VALUES TO S9OBJCDE OF EXTSJ7
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR2873' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Target Value
               MOVE ZEROS TO YL0097 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SJ7EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Target Value
               MOVE S9TGOVAL OF FTGTDSK OF AMTGTDTAL7-R TO YL0097 OF
                 WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
               SET C-INDICATOR-OFF(90) TO TRUE
               READ AMTGTDTAL7 NEXT
                 FORMAT IS 'FTGTDSK'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         FTGTDSK OF AMTGTDTAL7-R TO
                         EXTSJ7
                       MOVE EXTSJ7 TO KRSSJ7-TMP
                       IF (KRSSJ7 NOT = KRSSJ7-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        Level Code
               MOVE -99999 TO S9LVLCDE OF EXTSJ7
      *        Dealer Number
               MOVE LOW-VALUES TO S9DLRNBR OF EXTSJ7
      *        Dealer Number Suffix
               MOVE LOW-VALUES TO S9DLRSFX OF EXTSJ7
      *        Target Period Code
               MOVE LOW-VALUES TO S9PERCDE OF EXTSJ7
      *        Object Code
               MOVE LOW-VALUES TO S9OBJCDE OF EXTSJ7
           END-PERFORM
      *==============================================================
           CONTINUE.
       SJ7EXIT.
           EXIT.
      /EJECT
       SJ8RVGN SECTION.
      *==============================================================
      *    Rtv Target Value (Single) - Target Information  * Dacia car
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    Level Code
           MOVE 00030 TO S9LVLCDE OF KRSSJ8
      *    Dealer Number
           MOVE WUWECF OF WORK-CONTEXT TO S9DLRNBR OF KRSSJ8
      *    Dealer Number Suffix
           MOVE WUWFCF OF WORK-CONTEXT TO S9DLRSFX OF KRSSJ8
      *    Target Period Code
           MOVE WUUTGTPRDD OF WORK-CONTEXT TO S9PERCDE OF KRSSJ8
      *    Object Code
           MOVE 'CAR' TO S9OBJCDE OF KRSSJ8
      *    Initialise Full Externally Described Keylist
      *    Level Code
           MOVE -99999 TO S9LVLCDE OF EXTSJ8
      *    Dealer Number
           MOVE LOW-VALUES TO S9DLRNBR OF EXTSJ8
      *    Dealer Number Suffix
           MOVE LOW-VALUES TO S9DLRSFX OF EXTSJ8
      *    Target Period Code
           MOVE LOW-VALUES TO S9PERCDE OF EXTSJ8
      *    Object Code
           MOVE LOW-VALUES TO S9OBJCDE OF EXTSJ8
           MOVE CORRESPONDING
             EXTSJ8 TO
             FTGTDSK OF AMTGTDTAL7-R
           MOVE CORRESPONDING
             KRSSJ8 TO
             FTGTDSK OF AMTGTDTAL7-R
           START AMTGTDTAL7 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'FTGTDSK'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ AMTGTDTAL7 NEXT
             FORMAT IS 'FTGTDSK'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     FTGTDSK OF AMTGTDTAL7-R TO
                     EXTSJ8
                   MOVE EXTSJ8 TO KRSSJ8-TMP
                   IF (KRSSJ8 NOT = KRSSJ8-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    Level Code
           MOVE -99999 TO S9LVLCDE OF EXTSJ8
      *    Dealer Number
           MOVE LOW-VALUES TO S9DLRNBR OF EXTSJ8
      *    Dealer Number Suffix
           MOVE LOW-VALUES TO S9DLRSFX OF EXTSJ8
      *    Target Period Code
           MOVE LOW-VALUES TO S9PERCDE OF EXTSJ8
      *    Object Code
           MOVE LOW-VALUES TO S9OBJCDE OF EXTSJ8
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR2873' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Target Value
               MOVE ZEROS TO YL0098 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SJ8EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Target Value
               MOVE S9TGOVAL OF FTGTDSK OF AMTGTDTAL7-R TO YL0098 OF
                 WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
               SET C-INDICATOR-OFF(90) TO TRUE
               READ AMTGTDTAL7 NEXT
                 FORMAT IS 'FTGTDSK'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         FTGTDSK OF AMTGTDTAL7-R TO
                         EXTSJ8
                       MOVE EXTSJ8 TO KRSSJ8-TMP
                       IF (KRSSJ8 NOT = KRSSJ8-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        Level Code
               MOVE -99999 TO S9LVLCDE OF EXTSJ8
      *        Dealer Number
               MOVE LOW-VALUES TO S9DLRNBR OF EXTSJ8
      *        Dealer Number Suffix
               MOVE LOW-VALUES TO S9DLRSFX OF EXTSJ8
      *        Target Period Code
               MOVE LOW-VALUES TO S9PERCDE OF EXTSJ8
      *        Object Code
               MOVE LOW-VALUES TO S9OBJCDE OF EXTSJ8
           END-PERFORM
      *==============================================================
           CONTINUE.
       SJ8EXIT.
           EXIT.
      /EJECT
       SJ9RVGN SECTION.
      *==============================================================
      *    Rtv Target Value (Single) - Target Information  * Van
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    Level Code
           MOVE 00030 TO S9LVLCDE OF KRSSJ9
      *    Dealer Number
           MOVE WUWECF OF WORK-CONTEXT TO S9DLRNBR OF KRSSJ9
      *    Dealer Number Suffix
           MOVE YL0099 OF WORK-CONTEXT TO S9DLRSFX OF KRSSJ9
      *    Target Period Code
           MOVE WUUTGTPRDD OF WORK-CONTEXT TO S9PERCDE OF KRSSJ9
      *    Object Code
           MOVE 'VAN' TO S9OBJCDE OF KRSSJ9
      *    Initialise Full Externally Described Keylist
      *    Level Code
           MOVE -99999 TO S9LVLCDE OF EXTSJ9
      *    Dealer Number
           MOVE LOW-VALUES TO S9DLRNBR OF EXTSJ9
      *    Dealer Number Suffix
           MOVE LOW-VALUES TO S9DLRSFX OF EXTSJ9
      *    Target Period Code
           MOVE LOW-VALUES TO S9PERCDE OF EXTSJ9
      *    Object Code
           MOVE LOW-VALUES TO S9OBJCDE OF EXTSJ9
           MOVE CORRESPONDING
             EXTSJ9 TO
             FTGTDSK OF AMTGTDTAL7-R
           MOVE CORRESPONDING
             KRSSJ9 TO
             FTGTDSK OF AMTGTDTAL7-R
           START AMTGTDTAL7 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'FTGTDSK'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ AMTGTDTAL7 NEXT
             FORMAT IS 'FTGTDSK'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     FTGTDSK OF AMTGTDTAL7-R TO
                     EXTSJ9
                   MOVE EXTSJ9 TO KRSSJ9-TMP
                   IF (KRSSJ9 NOT = KRSSJ9-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    Level Code
           MOVE -99999 TO S9LVLCDE OF EXTSJ9
      *    Dealer Number
           MOVE LOW-VALUES TO S9DLRNBR OF EXTSJ9
      *    Dealer Number Suffix
           MOVE LOW-VALUES TO S9DLRSFX OF EXTSJ9
      *    Target Period Code
           MOVE LOW-VALUES TO S9PERCDE OF EXTSJ9
      *    Object Code
           MOVE LOW-VALUES TO S9OBJCDE OF EXTSJ9
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR2873' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Target Value
               MOVE ZEROS TO YL0098 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SJ9EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Target Value
               MOVE S9TGOVAL OF FTGTDSK OF AMTGTDTAL7-R TO YL0098 OF
                 WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
               SET C-INDICATOR-OFF(90) TO TRUE
               READ AMTGTDTAL7 NEXT
                 FORMAT IS 'FTGTDSK'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         FTGTDSK OF AMTGTDTAL7-R TO
                         EXTSJ9
                       MOVE EXTSJ9 TO KRSSJ9-TMP
                       IF (KRSSJ9 NOT = KRSSJ9-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        Level Code
               MOVE -99999 TO S9LVLCDE OF EXTSJ9
      *        Dealer Number
               MOVE LOW-VALUES TO S9DLRNBR OF EXTSJ9
      *        Dealer Number Suffix
               MOVE LOW-VALUES TO S9DLRSFX OF EXTSJ9
      *        Target Period Code
               MOVE LOW-VALUES TO S9PERCDE OF EXTSJ9
      *        Object Code
               MOVE LOW-VALUES TO S9OBJCDE OF EXTSJ9
           END-PERFORM
      *==============================================================
           CONTINUE.
       SJ9EXIT.
           EXIT.
      /EJECT
       SK1RVGN SECTION.
      *==============================================================
      *    Rtv Num of Order - Customer Order  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    USER: Initialize routine
      *    Cvt *Job date to DTX
      *    * Job date contains a leading 1 when the year is 2000 or
      *      greater
      *    U:Job Date DTX
           ADD ZZJDT OF JOB-CONTEXT, 19000000 GIVING YL0202 OF
             WORK-CONTEXT
      *    Utl Cvt Dealer 6 to 5N
           MOVE 5 TO YRSW03
           MOVE 2 TO YRSW02
           IF (YRSW02 NOT > 0 OR
               YRSW03 NOT > 0 OR
               YRSW02 > 00006 OR
               YRSW03 > 00006) THEN
               MOVE 'Y2U0510' TO W0RTN
           ELSE
               MOVE WUNECO OF WORK-CONTEXT TO W0STRNG
               MOVE W0STRNG(YRSW02:YRSW03) TO WUUCODE5 OF WORK-CONTEXT
           END-IF
           IF (WUUCODE5 OF WORK-CONTEXT = SPACES) THEN
               MOVE ZERO TO YL0203 OF WORK-CONTEXT
           ELSE
               MOVE WUUCODE5 OF WORK-CONTEXT TO YL0203 OF WORK-CONTEXT
           END-IF
      *    U:Pay Cat 1 Order
           MOVE ZEROS TO YL0195 OF WORK-CONTEXT
      *    U:Pay Cat 2 Order
           MOVE ZEROS TO YL0196 OF WORK-CONTEXT
      *    U:Pay Cat 3 Order
           MOVE ZEROS TO YL0197 OF WORK-CONTEXT
      *    U:Pay Cat 4 Order
           MOVE ZEROS TO YL0198 OF WORK-CONTEXT
      *    U:Pay Cat 5 Order
           MOVE ZEROS TO YL0199 OF WORK-CONTEXT
      *    U:Pay Cat N Order
           MOVE ZEROS TO YL0200 OF WORK-CONTEXT
      *    U:Pay Cat O Order
           MOVE ZEROS TO YL0201 OF WORK-CONTEXT
      *    U:Pay Cat 1 Order
           MOVE ZEROS TO YL0204 OF WORK-CONTEXT
      *    U:Pay Cat 2 Order
           MOVE ZEROS TO YL0205 OF WORK-CONTEXT
      *    U:Pay Cat 3 Order
           MOVE ZEROS TO YL0206 OF WORK-CONTEXT
      *    U:Pay Cat 4 Order
           MOVE ZEROS TO YL0207 OF WORK-CONTEXT
      *    U:Pay Cat 5 Order
           MOVE ZEROS TO YL0208 OF WORK-CONTEXT
      *    U:Pay Cat N Order
           MOVE ZEROS TO YL0209 OF WORK-CONTEXT
      *    U:Pay Cat O Order
           MOVE ZEROS TO YL0210 OF WORK-CONTEXT
      *    Setup key
      *    Owning Account
           MOVE WUNECO OF WORK-CONTEXT TO C5OWNACC OF KPSSK1
      *    Customer Order Date #
           MOVE WUCUSORDD8 OF WORK-CONTEXT TO C5CUSORDD8 OF KPSSK1
           MOVE CORRESPONDING KPSSK1 TO KRSSK1
      *    Initialise Full Externally Described Keylist
      *    Owning Account
           MOVE LOW-VALUES TO C5OWNACC OF EXTSK1
      *    Customer Order Date #
           MOVE -99999999 TO C5CUSORDD8 OF EXTSK1
      *    Customer Ord Number
           MOVE LOW-VALUES TO C5CUSORDNB OF EXTSK1
           MOVE CORRESPONDING
             EXTSK1 TO
             COORDDTAF8 OF COORDDTAL8-R
           MOVE CORRESPONDING
             KPSSK1 TO
             COORDDTAF8 OF COORDDTAL8-R
           START COORDDTAL8 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'COORDDTAF8'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ COORDDTAL8 NEXT
             FORMAT IS 'COORDDTAF8'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     COORDDTAF8 OF COORDDTAL8-R TO
                     EXTSK1
                   MOVE EXTSK1 TO KRSSK1-TMP
                   IF (KRSSK1 NOT = KRSSK1-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    Owning Account
           MOVE LOW-VALUES TO C5OWNACC OF EXTSK1
      *    Customer Order Date #
           MOVE -99999999 TO C5CUSORDD8 OF EXTSK1
      *    Customer Ord Number
           MOVE LOW-VALUES TO C5CUSORDNB OF EXTSK1
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR6221' TO W0RTN
           END-IF
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        ...Count number of Order
      *        CASE: DB1.Customer Order Date # LE PAR.U:To Date YYYYMMDD
      *        *IF
               IF (C5CUSORDD8 OF COORDDTAF8 OF COORDDTAL8-R NOT >
                 WUUTODTXD OF WORK-CONTEXT) THEN
      *            Include this one?
      *            CASE: DB1.Customer Ord Number is Not Blank
      *            *IF
                   IF (C5CUSORDNB OF COORDDTAF8 OF COORDDTAL8-R NOT = '
      -             '') THEN
      *                Car/Van Indicator
                       MOVE ' ' TO YL0211 OF WORK-CONTEXT
      *                OBT Count Target Status
                       MOVE ' ' TO YL0212 OF WORK-CONTEXT
      *                Rtv Car or Van SCP Mdl - Vehicle Model Bonus
      *                  Atr  *
                       PERFORM SK2RVGN
      *                Rtv Rtn Latest Brand Mdl - Bonus Sls-RIC Mdl
      *                  Dsp Seq  *
                       PERFORM SK3RVGN
      *                Fleet Programmes Code
                       MOVE SPACES TO YL0214 OF WORK-CONTEXT
                       MOVE ' ' TO YL0214 OF WORK-CONTEXT
      *                U:Continue
                       MOVE 'Y' TO YL0215 OF WORK-CONTEXT
      *                Rtv All Dtl by Dlr/Mdl/ON - OBT Extract  *
                       PERFORM SK4RVGN
      *                If Record Not Found in OBT and Cancelled Try
      *                  Order Deduction
      *                CASE: PGM.*Return code is *Normal
      *                *IF
                       IF (W0RTN = ' ') THEN
                           CONTINUE
                       ELSE
      *                    CASE: *OTHERWISE
      *                    Cancelled After 01/10/2017 Try COORDDEDP
      *                    CASE: DB1.Order Cancelled Date is GE 20171001
      *                    *IF
                           IF (C5ORDCANDT OF COORDDTAF8 OF COORDDTAL8-R
                             NOT < 20171001) THEN
      *                        Rtv All Details - Customer Order Deduct
      *                          VB  *
                               PERFORM SK5RVGN
                           ELSE
      *                        CASE: *OTHERWISE
      *                        Ext Simulate OBT Rtv - Customer Order  *
                               SET C-INDICATOR-OFF(90) TO TRUE
                               MOVE C5OWNACC OF COORDDTAF8 OF
                                 COORDDTAL8-R TO WQ0085
                               MOVE C5CUSORDNB OF COORDDTAF8 OF
                                 COORDDTAL8-R TO WQ0086
                               MOVE C5CUSORDD8 OF COORDDTAF8 OF
                                 COORDDTAL8-R TO WQ0087
                               MOVE C5ORDTYPCN OF COORDDTAF8 OF
                                 COORDDTAL8-R TO WQ0088
                               MOVE C5SDSCHNCD OF COORDDTAF8 OF
                                 COORDDTAL8-R TO WQ0089
                               MOVE C5TCCSTTYP OF COORDDTAF8 OF
                                 COORDDTAL8-R TO WQ0090
                               MOVE C5SCMDLCDE OF COORDDTAF8 OF
                                 COORDDTAL8-R TO WQ0091
                               MOVE C5PHASE OF COORDDTAF8 OF
                                 COORDDTAL8-R TO WQ0092
                               MOVE C5SCVERCDE OF COORDDTAF8 OF
                                 COORDDTAL8-R TO WQ0093
                               MOVE C5ORDCANDT OF COORDDTAF8 OF
                                 COORDDTAL8-R TO WQ0094
                               MOVE C5ORDCANRS OF COORDDTAF8 OF
                                 COORDDTAL8-R TO WQ0095
                               MOVE C5FLOPNO OF COORDDTAF8 OF
                                 COORDDTAL8-R TO WQ0096
                               MOVE YL0217 OF WORK-CONTEXT TO WQ0097
                               MOVE YL0212 OF WORK-CONTEXT TO WQ0098
                               MOVE YL0214 OF WORK-CONTEXT TO WQ0099
                               MOVE YL0218 OF WORK-CONTEXT TO WQ0100
                               MOVE 'O' TO WQ0101
      *
                               CALL 'RAASIMOBTS' USING
      *                        Return code
                                 W0RTN
      *                        Owning Account
                                 WQ0085
      *                        Customer Ord Number
                                 WQ0086
      *                        Customer Order Date #
                                 WQ0087
      *                        Order Type(Central)
                                 WQ0088
      *                        SD Sales Channel Code
                                 WQ0089
      *                        SEDRE Customer Type
                                 WQ0090
      *                        SCP Model Code
                                 WQ0091
      *                        Model Phase
                                 WQ0092
      *                        SCP Model Version Code
                                 WQ0093
      *                        Order Cancelled Date
                                 WQ0094
      *                        Order Cancellation Reason
                                 WQ0095
      *                        Fleet Operator Number
                                 WQ0096
      *                        BDC Payment Term
                                 WQ0097
      *                        OBT Count Target Status
                                 WQ0098
      *                        Fleet Programmes Code
                                 WQ0099
      *                        Target Market
                                 WQ0100
      *                        U:Date Type
                                 WQ0101
                                        ON OVERFLOW
                                        SET C-INDICATOR-ON(90) TO TRUE
                               END-CALL
      *
                               MOVE WQ0097 TO YL0217 OF WORK-CONTEXT
                               MOVE WQ0098 TO YL0212 OF WORK-CONTEXT
                               MOVE WQ0099 TO YL0214 OF WORK-CONTEXT
                               MOVE WQ0100 TO YL0218 OF WORK-CONTEXT
      *
      *                        Error on program call will terminate
      *                          run unit
                               IF (C-INDICATOR-ON(90)) THEN
                               MOVE 'Y2U0032' TO W0RTN
                               MOVE 'RAASIMOBTS' TO W0CLPG
      *                        Send message '*Error occured on CALL...'
      *                        Message ID
                               MOVE 'Y2U0032' TO ZAMSID
      *                        Message file
                               MOVE 'Y2USRMSG' TO ZAMSGF
      *                        Message data
                               MOVE W0CLPG TO ZAMSDA
                               PERFORM ZASNMS
                               END-IF
      *                        Error detected?
                               IF (W0RTN        NOT = SPACES) THEN
                               SET C-INDICATOR-ON(99) TO TRUE
                               END-IF
                           END-IF
                       END-IF
      *                Check Target Type Deselection
      *                CASE: PAR.U:Target Prefix is Target total
      *                *IF
                       IF ('TT' = 'TT') THEN
                           CONTINUE
                       ELSE
      *                    CASE: PAR.U:Target Prefix is Target Local
      *                      Market
      *                    *IF
                           IF ('TT' = 'TL') THEN
      *                        CASE: LCL.Target Market is Local Market
      *                          Target List
      *                        *IF
                               IF (YL0218 OF WORK-CONTEXT = 'L' OR
                                   YL0218 OF WORK-CONTEXT = 'W' OR
                                   YL0218 OF WORK-CONTEXT = 'R') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0215 OF WORK-CONTEXT
                               END-IF
                           ELSE
      *                        CASE: PAR.U:Target Prefix is Target
      *                          Major Fleet
      *                        *IF
                               IF ('TT' = 'TM') THEN
      *                        CASE: LCL.Target Market is Major Fleet
      *                          Target
      *                        *IF
                               IF (YL0218 OF WORK-CONTEXT = 'M') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0215 OF WORK-CONTEXT
                               END-IF
                               ELSE
      *                        CASE: PAR.U:Target Prefix is Target not
      *                          fleet
      *                        *IF
                               IF ('TT' = 'TN') THEN
      *                        CASE:
      *                        - c1 OR c2
      *                        |- c1    : LCL.Fleet Programmes Code is
      *                          *Blank
      *                        |- c2    : LCL.Fleet Programmes Code is
      *                          UNS - Unsupported (30286)
      *                        '-
      *                        *IF
                               IF (YL0214 OF WORK-CONTEXT = ' ' OR
                                   YL0214 OF WORK-CONTEXT = 'UNS') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0215 OF WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
      *                cont yes
      *                CASE: LCL.U:Continue is Yes
      *                *IF
                       IF (YL0215 OF WORK-CONTEXT = 'Y') THEN
      *                    CASE:
      *                    - NOTc1
      *                    |- c1    : DB1.Order Cancelled Date is Zero
      *                    '-
      *                    *IF
                           IF (NOT (C5ORDCANDT OF COORDDTAF8 OF
                             COORDDTAL8-R = 0)) THEN
      *                        CASE:
      *                        - c1 OR c2
      *                        |- c1    : LCL.OBT Count Target Status
      *                          is In Target List
      *                        |- c2    : LCL.Bns Brand Name is RENAULT
      *                        '-
      *                        *IF
                               IF ((YL0212 OF WORK-CONTEXT = 'I' OR
                                    YL0212 OF WORK-CONTEXT = '1' OR
                                    YL0212 OF WORK-CONTEXT = '2' OR
                                    YL0212 OF WORK-CONTEXT = '3' OR
                                    YL0212 OF WORK-CONTEXT = '4' OR
                                    YL0212 OF WORK-CONTEXT = '5' OR
                                    YL0212 OF WORK-CONTEXT = 'N') OR
                                   YL0213 OF WORK-CONTEXT = 'RENAULT')
                                 THEN
      *                        U:Pay Cat 5 Order
                               ADD YL0208 OF WORK-CONTEXT, 1 GIVING
                                 YL0208 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Pay Cat O Order
                               ADD YL0210 OF WORK-CONTEXT, 1 GIVING
                                 YL0210 OF WORK-CONTEXT
                               END-IF
                           ELSE
      *                        CASE: *OTHERWISE
      *                        count
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 1
      *                        *IF
                               IF (YL0212 OF WORK-CONTEXT = '1') THEN
      *                        U:Pay Cat 1 Order
                               ADD YL0204 OF WORK-CONTEXT, 1 GIVING
                                 YL0204 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 2
      *                        *IF
                               IF (YL0212 OF WORK-CONTEXT = '2') THEN
      *                        U:Pay Cat 2 Order
                               ADD YL0205 OF WORK-CONTEXT, 1 GIVING
                                 YL0205 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 3
      *                        *IF
                               IF (YL0212 OF WORK-CONTEXT = '3') THEN
      *                        U:Pay Cat 3 Order
                               ADD YL0206 OF WORK-CONTEXT, 1 GIVING
                                 YL0206 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 4
      *                        *IF
                               IF (YL0212 OF WORK-CONTEXT = '4') THEN
      *                        U:Pay Cat 4 Order
                               ADD YL0207 OF WORK-CONTEXT, 1 GIVING
                                 YL0207 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 5
      *                        *IF
                               IF (YL0212 OF WORK-CONTEXT = '5') THEN
      *                        U:Pay Cat 5 Order
                               ADD YL0208 OF WORK-CONTEXT, 1 GIVING
                                 YL0208 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category N - New
      *                        *IF
                               IF (YL0212 OF WORK-CONTEXT = 'N') THEN
      *                        U:Pay Cat N Order
                               ADD YL0209 OF WORK-CONTEXT, 1 GIVING
                                 YL0209 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Pay Cat O Order
                               ADD YL0210 OF WORK-CONTEXT, 1 GIVING
                                 YL0210 OF WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
                   END-IF
               END-IF
               SET C-INDICATOR-OFF(90) TO TRUE
               READ COORDDTAL8 NEXT
                 FORMAT IS 'COORDDTAF8'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         COORDDTAF8 OF COORDDTAL8-R TO
                         EXTSK1
                       MOVE EXTSK1 TO KRSSK1-TMP
                       IF (KRSSK1 NOT = KRSSK1-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        Owning Account
               MOVE LOW-VALUES TO C5OWNACC OF EXTSK1
      *        Customer Order Date #
               MOVE -99999999 TO C5CUSORDD8 OF EXTSK1
      *        Customer Ord Number
               MOVE LOW-VALUES TO C5CUSORDNB OF EXTSK1
           END-PERFORM
      *    USER: Exit processing
      *    U:Pay Cat 1 Order
           MOVE YL0204 OF WORK-CONTEXT TO YL0195 OF WORK-CONTEXT
      *    U:Pay Cat 2 Order
           MOVE YL0205 OF WORK-CONTEXT TO YL0196 OF WORK-CONTEXT
      *    U:Pay Cat 3 Order
           MOVE YL0206 OF WORK-CONTEXT TO YL0197 OF WORK-CONTEXT
      *    U:Pay Cat 4 Order
           MOVE YL0207 OF WORK-CONTEXT TO YL0198 OF WORK-CONTEXT
      *    U:Pay Cat 5 Order
           MOVE YL0208 OF WORK-CONTEXT TO YL0199 OF WORK-CONTEXT
      *    U:Pay Cat N Order
           MOVE YL0209 OF WORK-CONTEXT TO YL0200 OF WORK-CONTEXT
      *    U:Pay Cat O Order
           MOVE YL0210 OF WORK-CONTEXT TO YL0201 OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       SK1EXIT.
           EXIT.
      /EJECT
       SK2RVGN SECTION.
      *==============================================================
      *    Rtv Car or Van SCP Mdl - Vehicle Model Bonus Atr  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    USER: Initialize routine
      *    Car/Van Indicator
           MOVE 'C' TO YL0211 OF WORK-CONTEXT
      *    Setup key
      *    Model Application Code
           MOVE 'RIC' TO LLMDLAPPCD OF KRSSK2
      *    SCP Model Code
           MOVE C5SCMDLCDE OF COORDDTAF8 OF COORDDTAL8-R TO LLSCMDLCDE
             OF KRSSK2
      *    Initialise Full Externally Described Keylist
      *    Model Application Code
           MOVE LOW-VALUES TO LLMDLAPPCD OF EXTSK2
      *    SCP Model Code
           MOVE LOW-VALUES TO LLSCMDLCDE OF EXTSK2
           MOVE CORRESPONDING
             KRSSK2 TO
             VAMDLBNSF1 OF VAMDLBNSL1-R
           SET C-INDICATOR-OFF(90) TO TRUE
           READ VAMDLBNSL1
             FORMAT IS 'VAMDLBNSF1'
           END-READ
           IF (C-NO-RECORD) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               END-IF
           END-IF
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR7127' TO W0RTN
      *        USER: Processing if Data record not found
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SK2EXIT
           END-IF
      *
           IF (C-INDICATOR-OFF(90)) THEN
      *        USER: Process Data record
      *        Car/Van Indicator
               MOVE LLCORV OF VAMDLBNSF1 OF VAMDLBNSL1-R TO YL0211 OF
                 WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
           END-IF
      *==============================================================
           CONTINUE.
       SK2EXIT.
           EXIT.
      /EJECT
       SK3RVGN SECTION.
      *==============================================================
      *    Rtv Rtn Latest Brand Mdl - Bonus Sls-RIC Mdl Dsp Seq  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    SCP Model Code
           MOVE C5SCMDLCDE OF COORDDTAF8 OF COORDDTAL8-R TO O9SCMDLCDE
             OF KRSSK3
      *    Initialise Full Externally Described Keylist
      *    SCP Model Code
           MOVE LOW-VALUES TO O9SCMDLCDE OF EXTSK3
      *    Bns RIC Config Year
           MOVE 9999 TO O9BNSRICYR OF EXTSK3
      *    Bns RIC Display Sequence
           MOVE -999 TO O9BNSRICSQ OF EXTSK3
           MOVE CORRESPONDING
             EXTSK3 TO
             SBRICDSQF4 OF SBRICDSQL4-R
           MOVE CORRESPONDING
             KRSSK3 TO
             SBRICDSQF4 OF SBRICDSQL4-R
           START SBRICDSQL4 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'SBRICDSQF4'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ SBRICDSQL4 NEXT
             FORMAT IS 'SBRICDSQF4'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     SBRICDSQF4 OF SBRICDSQL4-R TO
                     EXTSK3
                   MOVE EXTSK3 TO KRSSK3-TMP
                   IF (KRSSK3 NOT = KRSSK3-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    SCP Model Code
           MOVE LOW-VALUES TO O9SCMDLCDE OF EXTSK3
      *    Bns RIC Config Year
           MOVE 9999 TO O9BNSRICYR OF EXTSK3
      *    Bns RIC Display Sequence
           MOVE -999 TO O9BNSRICSQ OF EXTSK3
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR7404' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Bns Brand Name
               MOVE SPACES TO YL0213 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SK3EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Bns Brand Name
               MOVE O9BNSBRNDD OF SBRICDSQF4 OF SBRICDSQL4-R TO YL0213
                 OF WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
      *        *QUIT
               GO SK3EXIT
               SET C-INDICATOR-OFF(90) TO TRUE
               READ SBRICDSQL4 NEXT
                 FORMAT IS 'SBRICDSQF4'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         SBRICDSQF4 OF SBRICDSQL4-R TO
                         EXTSK3
                       MOVE EXTSK3 TO KRSSK3-TMP
                       IF (KRSSK3 NOT = KRSSK3-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        SCP Model Code
               MOVE LOW-VALUES TO O9SCMDLCDE OF EXTSK3
      *        Bns RIC Config Year
               MOVE 9999 TO O9BNSRICYR OF EXTSK3
      *        Bns RIC Display Sequence
               MOVE -999 TO O9BNSRICSQ OF EXTSK3
           END-PERFORM
      *==============================================================
           CONTINUE.
       SK3EXIT.
           EXIT.
      /EJECT
       SK4RVGN SECTION.
      *==============================================================
      *    Rtv All Dtl by Dlr/Mdl/ON - OBT Extract  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    Dealer number (Num key)
           MOVE YL0203 OF WORK-CONTEXT TO Q2DLRNOKEY OF KRSSK4
      *    BDC Model
           MOVE C5SCMDLCDE OF COORDDTAF8 OF COORDDTAL8-R TO Q2BDCM OF
             KRSSK4
      *    BDC Customer Order Number
           MOVE C5CUSORDNB OF COORDDTAF8 OF COORDDTAL8-R TO Q2BDCCON OF
             KRSSK4
      *    Initialise Full Externally Described Keylist
      *    Dealer number (Num key)
           MOVE -99999 TO Q2DLRNOKEY OF EXTSK4
      *    BDC Model
           MOVE LOW-VALUES TO Q2BDCM OF EXTSK4
      *    BDC Customer Order Number
           MOVE LOW-VALUES TO Q2BDCCON OF EXTSK4
           MOVE CORRESPONDING
             EXTSK4 TO
             FOBEXCB OF RAOBEXTRL2-R
           MOVE CORRESPONDING
             KRSSK4 TO
             FOBEXCB OF RAOBEXTRL2-R
           START RAOBEXTRL2 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'FOBEXCB'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ RAOBEXTRL2 NEXT
             FORMAT IS 'FOBEXCB'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     FOBEXCB OF RAOBEXTRL2-R TO
                     EXTSK4
                   MOVE EXTSK4 TO KRSSK4-TMP
                   IF (KRSSK4 NOT = KRSSK4-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    Dealer number (Num key)
           MOVE -99999 TO Q2DLRNOKEY OF EXTSK4
      *    BDC Model
           MOVE LOW-VALUES TO Q2BDCM OF EXTSK4
      *    BDC Customer Order Number
           MOVE LOW-VALUES TO Q2BDCCON OF EXTSK4
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR5706' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Fleet Operator Number
               MOVE SPACES TO YL0216 OF WORK-CONTEXT
      *        BDC Payment Term
               MOVE SPACES TO YL0217 OF WORK-CONTEXT
      *        OBT Count Target Status
               MOVE SPACES TO YL0212 OF WORK-CONTEXT
      *        Fleet Programmes Code
               MOVE SPACES TO YL0214 OF WORK-CONTEXT
      *        Target Market
               MOVE SPACES TO YL0218 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SK4EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Fleet Operator Number
               MOVE Q2FLOPNO OF FOBEXCB OF RAOBEXTRL2-R TO YL0216 OF
                 WORK-CONTEXT
      *        BDC Payment Term
               MOVE Q2BDCPTRM OF FOBEXCB OF RAOBEXTRL2-R TO YL0217 OF
                 WORK-CONTEXT
      *        OBT Count Target Status
               MOVE Q2CNTTARG OF FOBEXCB OF RAOBEXTRL2-R TO YL0212 OF
                 WORK-CONTEXT
      *        Fleet Programmes Code
               MOVE Q2FLPGMCDE OF FOBEXCB OF RAOBEXTRL2-R TO YL0214 OF
                 WORK-CONTEXT
      *        Target Market
               MOVE Q2TGTMRKET OF FOBEXCB OF RAOBEXTRL2-R TO YL0218 OF
                 WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
      *        *QUIT
               GO SK4EXIT
               SET C-INDICATOR-OFF(90) TO TRUE
               READ RAOBEXTRL2 NEXT
                 FORMAT IS 'FOBEXCB'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         FOBEXCB OF RAOBEXTRL2-R TO
                         EXTSK4
                       MOVE EXTSK4 TO KRSSK4-TMP
                       IF (KRSSK4 NOT = KRSSK4-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        Dealer number (Num key)
               MOVE -99999 TO Q2DLRNOKEY OF EXTSK4
      *        BDC Model
               MOVE LOW-VALUES TO Q2BDCM OF EXTSK4
      *        BDC Customer Order Number
               MOVE LOW-VALUES TO Q2BDCCON OF EXTSK4
           END-PERFORM
      *==============================================================
           CONTINUE.
       SK4EXIT.
           EXIT.
      /EJECT
       SK5RVGN SECTION.
      *==============================================================
      *    Rtv All Details - Customer Order Deduct VB  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    Owning Account
           MOVE C5OWNACC OF COORDDTAF8 OF COORDDTAL8-R TO BBOWNACC OF
             KRSSK5
      *    Customer Ord Number
           MOVE C5CUSORDNB OF COORDDTAF8 OF COORDDTAL8-R TO BBCUSORDNB
             OF KRSSK5
      *    Customer Order Deduct Typ
           MOVE 'C' TO BBCODEDTYP OF KRSSK5
      *    Invariant BCV
           MOVE ' ' TO BBINVBCV OF KRSSK5
      *    Order Deduct Sequence Nbr
           MOVE 1 TO BBCODEDSEQ OF KRSSK5
      *    Initialise Full Externally Described Keylist
      *    Owning Account
           MOVE LOW-VALUES TO BBOWNACC OF EXTSK5
      *    Customer Ord Number
           MOVE LOW-VALUES TO BBCUSORDNB OF EXTSK5
      *    Customer Order Deduct Typ
           MOVE LOW-VALUES TO BBCODEDTYP OF EXTSK5
      *    Invariant BCV
           MOVE LOW-VALUES TO BBINVBCV OF EXTSK5
      *    Order Deduct Sequence Nbr
           MOVE -999 TO BBCODEDSEQ OF EXTSK5
           MOVE CORRESPONDING
             KRSSK5 TO
             COORDDEDF1 OF COORDDEDL1-R
           SET C-INDICATOR-OFF(90) TO TRUE
           READ COORDDEDL1
             FORMAT IS 'COORDDEDF1'
           END-READ
           IF (C-NO-RECORD) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               END-IF
           END-IF
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR7843' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Order Deduct Date Action
               MOVE ZEROS TO YL0219 OF WORK-CONTEXT
      *        Bonus Payment Status
               MOVE SPACES TO YL0217 OF WORK-CONTEXT
      *        OBT Count Target Status
               MOVE SPACES TO YL0212 OF WORK-CONTEXT
      *        Target Market
               MOVE SPACES TO YL0218 OF WORK-CONTEXT
      *        Fleet Operator Number
               MOVE SPACES TO YL0216 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SK5EXIT
           END-IF
      *
           IF (C-INDICATOR-OFF(90)) THEN
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Order Deduct Date Action
               MOVE BBCUSDEDAC OF COORDDEDF1 OF COORDDEDL1-R TO YL0219
                 OF WORK-CONTEXT
      *        Bonus Payment Status
               MOVE BBBNSPAYST OF COORDDEDF1 OF COORDDEDL1-R TO YL0217
                 OF WORK-CONTEXT
      *        OBT Count Target Status
               MOVE BBCNTTARG OF COORDDEDF1 OF COORDDEDL1-R TO YL0212
                 OF WORK-CONTEXT
      *        Target Market
               MOVE BBTGTMRKET OF COORDDEDF1 OF COORDDEDL1-R TO YL0218
                 OF WORK-CONTEXT
      *        Fleet Operator Number
               MOVE BBFLOPNO OF COORDDEDF1 OF COORDDEDL1-R TO YL0216 OF
                 WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
           END-IF
      *==============================================================
           CONTINUE.
       SK5EXIT.
           EXIT.
      /EJECT
       SK6RVGN SECTION.
      *==============================================================
      *    Rtv Num of Deductions - Customer Order Deduct VB  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    USER: Initialize routine
      *    Cvt *Job date to DTX
      *    * Job date contains a leading 1 when the year is 2000 or
      *      greater
      *    U:Job Date DTX
           ADD ZZJDT OF JOB-CONTEXT, 19000000 GIVING YL0227 OF
             WORK-CONTEXT
      *    U:Pay Cat 1 De-Order
           MOVE ZEROS TO YL0220 OF WORK-CONTEXT
      *    U:Pay Cat 2 De-Order
           MOVE ZEROS TO YL0221 OF WORK-CONTEXT
      *    U:Pay Cat 3 De-Order
           MOVE ZEROS TO YL0222 OF WORK-CONTEXT
      *    U:Pay Cat 4 De-Order
           MOVE ZEROS TO YL0223 OF WORK-CONTEXT
      *    U:Pay Cat 5 De-Order
           MOVE ZEROS TO YL0224 OF WORK-CONTEXT
      *    U:Pay Cat N De-Order
           MOVE ZEROS TO YL0226 OF WORK-CONTEXT
      *    U:Pay Cat O De-Order
           MOVE ZEROS TO YL0225 OF WORK-CONTEXT
      *    U:Pay Cat 1 De-Order
           MOVE ZEROS TO YL0228 OF WORK-CONTEXT
      *    U:Pay Cat 2 De-Order
           MOVE ZEROS TO YL0229 OF WORK-CONTEXT
      *    U:Pay Cat 3 De-Order
           MOVE ZEROS TO YL0230 OF WORK-CONTEXT
      *    U:Pay Cat 4 De-Order
           MOVE ZEROS TO YL0231 OF WORK-CONTEXT
      *    U:Pay Cat 5 De-Order
           MOVE ZEROS TO YL0232 OF WORK-CONTEXT
      *    U:Pay Cat N De-Order
           MOVE ZEROS TO YL0233 OF WORK-CONTEXT
      *    U:Pay Cat O De-Order
           MOVE ZEROS TO YL0234 OF WORK-CONTEXT
      *    Setup key
      *    Owning Account
           MOVE WUNECO OF WORK-CONTEXT TO BBOWNACC OF KPSSK6
      *    Order Deduct Date Effect
           MOVE WUCUSORDD8 OF WORK-CONTEXT TO BBCUSDEDEF OF KPSSK6
           MOVE CORRESPONDING KPSSK6 TO KRSSK6
      *    Initialise Full Externally Described Keylist
      *    Owning Account
           MOVE LOW-VALUES TO BBOWNACC OF EXTSK6
      *    Order Deduct Date Effect
           MOVE -99999999 TO BBCUSDEDEF OF EXTSK6
      *    SCP Model Code
           MOVE LOW-VALUES TO BBSCMDLCDE OF EXTSK6
      *    Count to Deduction Status
           MOVE -9 TO BBCNTDEDUC OF EXTSK6
           MOVE CORRESPONDING
             EXTSK6 TO
             COORDDEDF2 OF COORDDEDL2-R
           MOVE CORRESPONDING
             KPSSK6 TO
             COORDDEDF2 OF COORDDEDL2-R
           START COORDDEDL2 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'COORDDEDF2'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ COORDDEDL2 NEXT
             FORMAT IS 'COORDDEDF2'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     COORDDEDF2 OF COORDDEDL2-R TO
                     EXTSK6
                   MOVE EXTSK6 TO KRSSK6-TMP
                   IF (KRSSK6 NOT = KRSSK6-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    Owning Account
           MOVE LOW-VALUES TO BBOWNACC OF EXTSK6
      *    Order Deduct Date Effect
           MOVE -99999999 TO BBCUSDEDEF OF EXTSK6
      *    SCP Model Code
           MOVE LOW-VALUES TO BBSCMDLCDE OF EXTSK6
      *    Count to Deduction Status
           MOVE -9 TO BBCNTDEDUC OF EXTSK6
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR7843' TO W0RTN
           END-IF
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        CASE: DB1.Order Deduct Date Effect LT PAR.U:To Date
      *          YYYYMMDD
      *        *IF
               IF (BBCUSDEDEF OF COORDDEDF2 OF COORDDEDL2-R < WUUTODTXD
                 OF WORK-CONTEXT) THEN
      *            Count Number of Deductions
      *            CASE:
      *            - NOTc1
      *            |- c1    : DB1.Count to Deduction Status is *Do Not
      *              Count
      *            '-
      *            *IF
                   IF (NOT (BBCNTDEDUC OF COORDDEDF2 OF COORDDEDL2-R =
                     0)) THEN
      *                U:Continue
                       MOVE 'Y' TO YL0235 OF WORK-CONTEXT
      *                Check Target Type Deselection
      *                CASE: PAR.U:Target Prefix is Target total
      *                *IF
                       IF ('TT' = 'TT') THEN
                           CONTINUE
                       ELSE
      *                    CASE: PAR.U:Target Prefix is Target Local
      *                      Market
      *                    *IF
                           IF ('TT' = 'TL') THEN
      *                        CASE: DB1.Target Market is Local Market
      *                          Target List
      *                        *IF
                               IF (BBTGTMRKET OF COORDDEDF2 OF
                                 COORDDEDL2-R = 'L' OR
                                   BBTGTMRKET OF COORDDEDF2 OF
                                 COORDDEDL2-R = 'W' OR
                                   BBTGTMRKET OF COORDDEDF2 OF
                                 COORDDEDL2-R = 'R') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0235 OF WORK-CONTEXT
                               END-IF
                           ELSE
      *                        CASE: PAR.U:Target Prefix is Target
      *                          Major Fleet
      *                        *IF
                               IF ('TT' = 'TM') THEN
      *                        CASE: DB1.Target Market is Major Fleet
      *                          Target
      *                        *IF
                               IF (BBTGTMRKET OF COORDDEDF2 OF
                                 COORDDEDL2-R = 'M') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0235 OF WORK-CONTEXT
                               END-IF
                               END-IF
                           END-IF
                       END-IF
      *                Check Run Mode Count Type
      *                CASE: LCL.U:Continue is Yes
      *                *IF
                       IF (YL0235 OF WORK-CONTEXT = 'Y') THEN
      *                    CASE: PAR.U:Run Mode is *1
      *                    *IF
                           IF (YL0085 OF WORK-CONTEXT = '1') THEN
                               CONTINUE
                           ELSE
      *                        CASE: PAR.U:Run Mode is *2
      *                        *IF
                               IF (YL0085 OF WORK-CONTEXT = '2') THEN
      *                        CASE: DB1.Order Deduct Date Action LE
      *                          PAR.U:To Date YYYYMMDD
      *                        *IF
                               IF (BBCUSDEDAC OF COORDDEDF2 OF
                                 COORDDEDL2-R NOT > WUUTODTXD OF
                                 WORK-CONTEXT) THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0235 OF WORK-CONTEXT
                               END-IF
                               ELSE
      *                        CASE: PAR.U:Run Mode is *3
      *                        *IF
                               IF (YL0085 OF WORK-CONTEXT = '3') THEN
      *                        CASE: DB1.Order Deduct Date Action LE
      *                          PAR.U:To Date YYYYMMDD
      *                        *IF
                               IF (BBCUSDEDAC OF COORDDEDF2 OF
                                 COORDDEDL2-R NOT > WUUTODTXD OF
                                 WORK-CONTEXT) THEN
      *                        U:Continue
                               MOVE 'N' TO YL0235 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
                               CONTINUE
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
      *                Count
      *                CASE: LCL.U:Continue is Yes
      *                *IF
                       IF (YL0235 OF WORK-CONTEXT = 'Y') THEN
      *                    count
      *                    CASE: DB1.OBT Count Target Status is
      *                      Payment Category 1
      *                    *IF
                           IF (BBCNTTARG OF COORDDEDF2 OF COORDDEDL2-R
                             = '1') THEN
      *                        U:Pay Cat 1 De-Order
                               ADD YL0228 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0228 OF WORK-CONTEXT
                           ELSE
      *                        CASE: DB1.OBT Count Target Status is
      *                          Payment Category 2
      *                        *IF
                               IF (BBCNTTARG OF COORDDEDF2 OF
                                 COORDDEDL2-R = '2') THEN
      *                        U:Pay Cat 2 De-Order
                               ADD YL0229 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0229 OF WORK-CONTEXT
                               ELSE
      *                        CASE: DB1.OBT Count Target Status is
      *                          Payment Category 3
      *                        *IF
                               IF (BBCNTTARG OF COORDDEDF2 OF
                                 COORDDEDL2-R = '3') THEN
      *                        U:Pay Cat 3 De-Order
                               ADD YL0230 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0230 OF WORK-CONTEXT
                               ELSE
      *                        CASE: DB1.OBT Count Target Status is
      *                          Payment Category 4
      *                        *IF
                               IF (BBCNTTARG OF COORDDEDF2 OF
                                 COORDDEDL2-R = '4') THEN
      *                        U:Pay Cat 4 De-Order
                               ADD YL0231 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0231 OF WORK-CONTEXT
                               ELSE
      *                        CASE: DB1.OBT Count Target Status is
      *                          Payment Category 5
      *                        *IF
                               IF (BBCNTTARG OF COORDDEDF2 OF
                                 COORDDEDL2-R = '5') THEN
      *                        U:Pay Cat 5 De-Order
                               ADD YL0232 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0232 OF WORK-CONTEXT
                               ELSE
      *                        CASE: DB1.OBT Count Target Status is
      *                          Payment Category N - New
      *                        *IF
                               IF (BBCNTTARG OF COORDDEDF2 OF
                                 COORDDEDL2-R = 'N') THEN
      *                        U:Pay Cat N De-Order
                               ADD YL0233 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0233 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Pay Cat O De-Order
                               ADD YL0234 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0234 OF WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
                   END-IF
               ELSE
      *            CASE: *OTHERWISE
      *            U:Pay Cat 1 De-Order
                   MOVE YL0228 OF WORK-CONTEXT TO YL0220 OF WORK-CONTEXT
      *            U:Pay Cat 2 De-Order
                   MOVE YL0229 OF WORK-CONTEXT TO YL0221 OF WORK-CONTEXT
      *            U:Pay Cat 3 De-Order
                   MOVE YL0230 OF WORK-CONTEXT TO YL0222 OF WORK-CONTEXT
      *            U:Pay Cat 4 De-Order
                   MOVE YL0231 OF WORK-CONTEXT TO YL0223 OF WORK-CONTEXT
      *            U:Pay Cat 5 De-Order
                   MOVE YL0232 OF WORK-CONTEXT TO YL0224 OF WORK-CONTEXT
      *            U:Pay Cat N De-Order
                   MOVE YL0233 OF WORK-CONTEXT TO YL0226 OF WORK-CONTEXT
      *            U:Pay Cat O De-Order
                   MOVE YL0234 OF WORK-CONTEXT TO YL0225 OF WORK-CONTEXT
      *            *QUIT
                   GO SK6EXIT
               END-IF
               SET C-INDICATOR-OFF(90) TO TRUE
               READ COORDDEDL2 NEXT
                 FORMAT IS 'COORDDEDF2'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         COORDDEDF2 OF COORDDEDL2-R TO
                         EXTSK6
                       MOVE EXTSK6 TO KRSSK6-TMP
                       IF (KRSSK6 NOT = KRSSK6-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        Owning Account
               MOVE LOW-VALUES TO BBOWNACC OF EXTSK6
      *        Order Deduct Date Effect
               MOVE -99999999 TO BBCUSDEDEF OF EXTSK6
      *        SCP Model Code
               MOVE LOW-VALUES TO BBSCMDLCDE OF EXTSK6
      *        Count to Deduction Status
               MOVE -9 TO BBCNTDEDUC OF EXTSK6
           END-PERFORM
      *    USER: Exit processing
      *    U:Pay Cat 1 De-Order
           MOVE YL0228 OF WORK-CONTEXT TO YL0220 OF WORK-CONTEXT
      *    U:Pay Cat 2 De-Order
           MOVE YL0229 OF WORK-CONTEXT TO YL0221 OF WORK-CONTEXT
      *    U:Pay Cat 3 De-Order
           MOVE YL0230 OF WORK-CONTEXT TO YL0222 OF WORK-CONTEXT
      *    U:Pay Cat 4 De-Order
           MOVE YL0231 OF WORK-CONTEXT TO YL0223 OF WORK-CONTEXT
      *    U:Pay Cat 5 De-Order
           MOVE YL0232 OF WORK-CONTEXT TO YL0224 OF WORK-CONTEXT
      *    U:Pay Cat N De-Order
           MOVE YL0233 OF WORK-CONTEXT TO YL0226 OF WORK-CONTEXT
      *    U:Pay Cat O De-Order
           MOVE YL0234 OF WORK-CONTEXT TO YL0225 OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       SK6EXIT.
           EXIT.
      /EJECT
       SK7RVGN SECTION.
      *==============================================================
      *    Rtv Num of Deductions C/D - Customer Order Deduct VB  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    USER: Initialize routine
      *    Cvt *Job date to DTX
      *    * Job date contains a leading 1 when the year is 2000 or
      *      greater
      *    U:Job Date DTX
           ADD ZZJDT OF JOB-CONTEXT, 19000000 GIVING YL0236 OF
             WORK-CONTEXT
      *    U:Pay Cat 1 De-Order
           MOVE ZEROS TO YL0220 OF WORK-CONTEXT
      *    U:Pay Cat 2 De-Order
           MOVE ZEROS TO YL0221 OF WORK-CONTEXT
      *    U:Pay Cat 3 De-Order
           MOVE ZEROS TO YL0222 OF WORK-CONTEXT
      *    U:Pay Cat 4 De-Order
           MOVE ZEROS TO YL0223 OF WORK-CONTEXT
      *    U:Pay Cat 5 De-Order
           MOVE ZEROS TO YL0224 OF WORK-CONTEXT
      *    U:Pay Cat N De-Order
           MOVE ZEROS TO YL0226 OF WORK-CONTEXT
      *    U:Pay Cat O De-Order
           MOVE ZEROS TO YL0225 OF WORK-CONTEXT
      *    U:Pay Cat 1 De-Order
           MOVE ZEROS TO YL0237 OF WORK-CONTEXT
      *    U:Pay Cat 2 De-Order
           MOVE ZEROS TO YL0238 OF WORK-CONTEXT
      *    U:Pay Cat 3 De-Order
           MOVE ZEROS TO YL0239 OF WORK-CONTEXT
      *    U:Pay Cat 4 De-Order
           MOVE ZEROS TO YL0240 OF WORK-CONTEXT
      *    U:Pay Cat 5 De-Order
           MOVE ZEROS TO YL0241 OF WORK-CONTEXT
      *    U:Pay Cat N De-Order
           MOVE ZEROS TO YL0242 OF WORK-CONTEXT
      *    U:Pay Cat O De-Order
           MOVE ZEROS TO YL0243 OF WORK-CONTEXT
      *    Setup key
      *    Owning Account
           MOVE WUNECO OF WORK-CONTEXT TO BBOWNACC OF KPSSK7
      *    Order Deduct Date Effect
           MOVE WUCUSORDD8 OF WORK-CONTEXT TO BBCUSDEDEF OF KPSSK7
           MOVE CORRESPONDING KPSSK7 TO KRSSK7
      *    Initialise Full Externally Described Keylist
      *    Owning Account
           MOVE LOW-VALUES TO BBOWNACC OF EXTSK7
      *    Order Deduct Date Effect
           MOVE -99999999 TO BBCUSDEDEF OF EXTSK7
      *    SCP Model Code
           MOVE LOW-VALUES TO BBSCMDLCDE OF EXTSK7
      *    Count to Deduction Status
           MOVE -9 TO BBCNTDEDUC OF EXTSK7
           MOVE CORRESPONDING
             EXTSK7 TO
             COORDDEDF2 OF COORDDEDL2-R
           MOVE CORRESPONDING
             KPSSK7 TO
             COORDDEDF2 OF COORDDEDL2-R
           START COORDDEDL2 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'COORDDEDF2'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ COORDDEDL2 NEXT
             FORMAT IS 'COORDDEDF2'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     COORDDEDF2 OF COORDDEDL2-R TO
                     EXTSK7
                   MOVE EXTSK7 TO KRSSK7-TMP
                   IF (KRSSK7 NOT = KRSSK7-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    Owning Account
           MOVE LOW-VALUES TO BBOWNACC OF EXTSK7
      *    Order Deduct Date Effect
           MOVE -99999999 TO BBCUSDEDEF OF EXTSK7
      *    SCP Model Code
           MOVE LOW-VALUES TO BBSCMDLCDE OF EXTSK7
      *    Count to Deduction Status
           MOVE -9 TO BBCNTDEDUC OF EXTSK7
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR7843' TO W0RTN
           END-IF
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        CASE: DB1.Order Deduct Date Effect LT PAR.U:To Date
      *          YYYYMMDD
      *        *IF
               IF (BBCUSDEDEF OF COORDDEDF2 OF COORDDEDL2-R < WUUTODTXD
                 OF WORK-CONTEXT) THEN
      *            Count Number of Deductions
      *            CASE:
      *            - NOTc1 AND c2
      *            |- c1    : DB1.Count to Deduction Status is *Do Not
      *              Count
      *            |- c2    : PAR.Customer Order Deduct Typ EQ
      *              DB1.Customer Order Deduct Typ
      *            '-
      *            *IF
                   IF (NOT (BBCNTDEDUC OF COORDDEDF2 OF COORDDEDL2-R =
                     0) AND
                       'D' = BBCODEDTYP OF COORDDEDF2 OF COORDDEDL2-R)
                     THEN
      *                U:Continue
                       MOVE 'Y' TO YL0244 OF WORK-CONTEXT
      *                Payment Status not NCNP
      *                CASE: DB1.Bonus Payment Status is NCNP
      *                *IF
                       IF (BBBNSPAYST OF COORDDEDF2 OF COORDDEDL2-R = 'N
      -                 'CNP') THEN
      *                    U:Continue
                           MOVE 'N' TO YL0244 OF WORK-CONTEXT
                       END-IF
      *                Check Target Type Deselection
      *                CASE: PAR.U:Target Prefix is Target total
      *                *IF
                       IF ('TT' = 'TT') THEN
                           CONTINUE
                       ELSE
      *                    CASE: PAR.U:Target Prefix is Target Local
      *                      Market
      *                    *IF
                           IF ('TT' = 'TL') THEN
      *                        CASE: DB1.Target Market is Local Market
      *                          Target List
      *                        *IF
                               IF (BBTGTMRKET OF COORDDEDF2 OF
                                 COORDDEDL2-R = 'L' OR
                                   BBTGTMRKET OF COORDDEDF2 OF
                                 COORDDEDL2-R = 'W' OR
                                   BBTGTMRKET OF COORDDEDF2 OF
                                 COORDDEDL2-R = 'R') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0244 OF WORK-CONTEXT
                               END-IF
                           ELSE
      *                        CASE: PAR.U:Target Prefix is Target
      *                          Major Fleet
      *                        *IF
                               IF ('TT' = 'TM') THEN
      *                        CASE: DB1.Target Market is Major Fleet
      *                          Target
      *                        *IF
                               IF (BBTGTMRKET OF COORDDEDF2 OF
                                 COORDDEDL2-R = 'M') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0244 OF WORK-CONTEXT
                               END-IF
                               END-IF
                           END-IF
                       END-IF
      *                Check Run Mode Count Type
      *                CASE: LCL.U:Continue is Yes
      *                *IF
                       IF (YL0244 OF WORK-CONTEXT = 'Y') THEN
      *                    CASE: PAR.U:Run Mode is *1
      *                    *IF
                           IF (YL0085 OF WORK-CONTEXT = '1') THEN
                               CONTINUE
                           ELSE
      *                        CASE: PAR.U:Run Mode is *2
      *                        *IF
                               IF (YL0085 OF WORK-CONTEXT = '2') THEN
      *                        CASE: DB1.Order Deduct Date Action LE
      *                          PAR.U:To Date YYYYMMDD
      *                        *IF
                               IF (BBCUSDEDAC OF COORDDEDF2 OF
                                 COORDDEDL2-R NOT > WUUTODTXD OF
                                 WORK-CONTEXT) THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0244 OF WORK-CONTEXT
                               END-IF
                               ELSE
      *                        CASE: PAR.U:Run Mode is *3
      *                        *IF
                               IF (YL0085 OF WORK-CONTEXT = '3') THEN
      *                        CASE: DB1.Order Deduct Date Action LE
      *                          PAR.U:To Date YYYYMMDD
      *                        *IF
                               IF (BBCUSDEDAC OF COORDDEDF2 OF
                                 COORDDEDL2-R NOT > WUUTODTXD OF
                                 WORK-CONTEXT) THEN
      *                        U:Continue
                               MOVE 'N' TO YL0244 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
                               CONTINUE
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
      *                Count
      *                CASE: LCL.U:Continue is Yes
      *                *IF
                       IF (YL0244 OF WORK-CONTEXT = 'Y') THEN
      *                    count
      *                    CASE: DB1.OBT Count Target Status is
      *                      Payment Category 1
      *                    *IF
                           IF (BBCNTTARG OF COORDDEDF2 OF COORDDEDL2-R
                             = '1') THEN
      *                        U:Pay Cat 1 De-Order
                               ADD YL0237 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0237 OF WORK-CONTEXT
                           ELSE
      *                        CASE: DB1.OBT Count Target Status is
      *                          Payment Category 2
      *                        *IF
                               IF (BBCNTTARG OF COORDDEDF2 OF
                                 COORDDEDL2-R = '2') THEN
      *                        U:Pay Cat 2 De-Order
                               ADD YL0238 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0238 OF WORK-CONTEXT
                               ELSE
      *                        CASE: DB1.OBT Count Target Status is
      *                          Payment Category 3
      *                        *IF
                               IF (BBCNTTARG OF COORDDEDF2 OF
                                 COORDDEDL2-R = '3') THEN
      *                        U:Pay Cat 3 De-Order
                               ADD YL0239 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0239 OF WORK-CONTEXT
                               ELSE
      *                        CASE: DB1.OBT Count Target Status is
      *                          Payment Category 4
      *                        *IF
                               IF (BBCNTTARG OF COORDDEDF2 OF
                                 COORDDEDL2-R = '4') THEN
      *                        U:Pay Cat 4 De-Order
                               ADD YL0240 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0240 OF WORK-CONTEXT
                               ELSE
      *                        CASE: DB1.OBT Count Target Status is
      *                          Payment Category 5
      *                        *IF
                               IF (BBCNTTARG OF COORDDEDF2 OF
                                 COORDDEDL2-R = '5') THEN
      *                        U:Pay Cat 5 De-Order
                               ADD YL0241 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0241 OF WORK-CONTEXT
                               ELSE
      *                        CASE: DB1.OBT Count Target Status is
      *                          Payment Category N - New
      *                        *IF
                               IF (BBCNTTARG OF COORDDEDF2 OF
                                 COORDDEDL2-R = 'N') THEN
      *                        U:Pay Cat N De-Order
                               ADD YL0242 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0242 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Pay Cat O De-Order
                               ADD YL0243 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0243 OF WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
                   END-IF
               ELSE
      *            CASE: *OTHERWISE
      *            U:Pay Cat 1 De-Order
                   MOVE YL0237 OF WORK-CONTEXT TO YL0220 OF WORK-CONTEXT
      *            U:Pay Cat 2 De-Order
                   MOVE YL0238 OF WORK-CONTEXT TO YL0221 OF WORK-CONTEXT
      *            U:Pay Cat 3 De-Order
                   MOVE YL0239 OF WORK-CONTEXT TO YL0222 OF WORK-CONTEXT
      *            U:Pay Cat 4 De-Order
                   MOVE YL0240 OF WORK-CONTEXT TO YL0223 OF WORK-CONTEXT
      *            U:Pay Cat 5 De-Order
                   MOVE YL0241 OF WORK-CONTEXT TO YL0224 OF WORK-CONTEXT
      *            U:Pay Cat N De-Order
                   MOVE YL0242 OF WORK-CONTEXT TO YL0226 OF WORK-CONTEXT
      *            U:Pay Cat O De-Order
                   MOVE YL0243 OF WORK-CONTEXT TO YL0225 OF WORK-CONTEXT
      *            *QUIT
                   GO SK7EXIT
               END-IF
               SET C-INDICATOR-OFF(90) TO TRUE
               READ COORDDEDL2 NEXT
                 FORMAT IS 'COORDDEDF2'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         COORDDEDF2 OF COORDDEDL2-R TO
                         EXTSK7
                       MOVE EXTSK7 TO KRSSK7-TMP
                       IF (KRSSK7 NOT = KRSSK7-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        Owning Account
               MOVE LOW-VALUES TO BBOWNACC OF EXTSK7
      *        Order Deduct Date Effect
               MOVE -99999999 TO BBCUSDEDEF OF EXTSK7
      *        SCP Model Code
               MOVE LOW-VALUES TO BBSCMDLCDE OF EXTSK7
      *        Count to Deduction Status
               MOVE -9 TO BBCNTDEDUC OF EXTSK7
           END-PERFORM
      *    USER: Exit processing
      *    U:Pay Cat 1 De-Order
           MOVE YL0237 OF WORK-CONTEXT TO YL0220 OF WORK-CONTEXT
      *    U:Pay Cat 2 De-Order
           MOVE YL0238 OF WORK-CONTEXT TO YL0221 OF WORK-CONTEXT
      *    U:Pay Cat 3 De-Order
           MOVE YL0239 OF WORK-CONTEXT TO YL0222 OF WORK-CONTEXT
      *    U:Pay Cat 4 De-Order
           MOVE YL0240 OF WORK-CONTEXT TO YL0223 OF WORK-CONTEXT
      *    U:Pay Cat 5 De-Order
           MOVE YL0241 OF WORK-CONTEXT TO YL0224 OF WORK-CONTEXT
      *    U:Pay Cat N De-Order
           MOVE YL0242 OF WORK-CONTEXT TO YL0226 OF WORK-CONTEXT
      *    U:Pay Cat O De-Order
           MOVE YL0243 OF WORK-CONTEXT TO YL0225 OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       SK7EXIT.
           EXIT.
      /EJECT
       SK8RVGN SECTION.
      *==============================================================
      *    Rtv Num of Deductions C/D - Customer Order Deduct VB  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    USER: Initialize routine
      *    Cvt *Job date to DTX
      *    * Job date contains a leading 1 when the year is 2000 or
      *      greater
      *    U:Job Date DTX
           ADD ZZJDT OF JOB-CONTEXT, 19000000 GIVING YL0236 OF
             WORK-CONTEXT
      *    U:Pay Cat 1 De-Order
           MOVE ZEROS TO YL0220 OF WORK-CONTEXT
      *    U:Pay Cat 2 De-Order
           MOVE ZEROS TO YL0221 OF WORK-CONTEXT
      *    U:Pay Cat 3 De-Order
           MOVE ZEROS TO YL0222 OF WORK-CONTEXT
      *    U:Pay Cat 4 De-Order
           MOVE ZEROS TO YL0223 OF WORK-CONTEXT
      *    U:Pay Cat 5 De-Order
           MOVE ZEROS TO YL0224 OF WORK-CONTEXT
      *    U:Pay Cat N De-Order
           MOVE ZEROS TO YL0226 OF WORK-CONTEXT
      *    U:Pay Cat O De-Order
           MOVE ZEROS TO YL0225 OF WORK-CONTEXT
      *    U:Pay Cat 1 De-Order
           MOVE ZEROS TO YL0237 OF WORK-CONTEXT
      *    U:Pay Cat 2 De-Order
           MOVE ZEROS TO YL0238 OF WORK-CONTEXT
      *    U:Pay Cat 3 De-Order
           MOVE ZEROS TO YL0239 OF WORK-CONTEXT
      *    U:Pay Cat 4 De-Order
           MOVE ZEROS TO YL0240 OF WORK-CONTEXT
      *    U:Pay Cat 5 De-Order
           MOVE ZEROS TO YL0241 OF WORK-CONTEXT
      *    U:Pay Cat N De-Order
           MOVE ZEROS TO YL0242 OF WORK-CONTEXT
      *    U:Pay Cat O De-Order
           MOVE ZEROS TO YL0243 OF WORK-CONTEXT
      *    Setup key
      *    Owning Account
           MOVE WUNECO OF WORK-CONTEXT TO BBOWNACC OF KPSSK8
      *    Order Deduct Date Effect
           MOVE WUCUSORDD8 OF WORK-CONTEXT TO BBCUSDEDEF OF KPSSK8
           MOVE CORRESPONDING KPSSK8 TO KRSSK8
      *    Initialise Full Externally Described Keylist
      *    Owning Account
           MOVE LOW-VALUES TO BBOWNACC OF EXTSK8
      *    Order Deduct Date Effect
           MOVE -99999999 TO BBCUSDEDEF OF EXTSK8
      *    SCP Model Code
           MOVE LOW-VALUES TO BBSCMDLCDE OF EXTSK8
      *    Count to Deduction Status
           MOVE -9 TO BBCNTDEDUC OF EXTSK8
           MOVE CORRESPONDING
             EXTSK8 TO
             COORDDEDF2 OF COORDDEDL2-R
           MOVE CORRESPONDING
             KPSSK8 TO
             COORDDEDF2 OF COORDDEDL2-R
           START COORDDEDL2 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'COORDDEDF2'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ COORDDEDL2 NEXT
             FORMAT IS 'COORDDEDF2'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     COORDDEDF2 OF COORDDEDL2-R TO
                     EXTSK8
                   MOVE EXTSK8 TO KRSSK8-TMP
                   IF (KRSSK8 NOT = KRSSK8-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    Owning Account
           MOVE LOW-VALUES TO BBOWNACC OF EXTSK8
      *    Order Deduct Date Effect
           MOVE -99999999 TO BBCUSDEDEF OF EXTSK8
      *    SCP Model Code
           MOVE LOW-VALUES TO BBSCMDLCDE OF EXTSK8
      *    Count to Deduction Status
           MOVE -9 TO BBCNTDEDUC OF EXTSK8
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR7843' TO W0RTN
           END-IF
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        CASE: DB1.Order Deduct Date Effect LT PAR.U:To Date
      *          YYYYMMDD
      *        *IF
               IF (BBCUSDEDEF OF COORDDEDF2 OF COORDDEDL2-R < WUUTODTXD
                 OF WORK-CONTEXT) THEN
      *            Count Number of Deductions
      *            CASE:
      *            - NOTc1 AND c2
      *            |- c1    : DB1.Count to Deduction Status is *Do Not
      *              Count
      *            |- c2    : PAR.Customer Order Deduct Typ EQ
      *              DB1.Customer Order Deduct Typ
      *            '-
      *            *IF
                   IF (NOT (BBCNTDEDUC OF COORDDEDF2 OF COORDDEDL2-R =
                     0) AND
                       'C' = BBCODEDTYP OF COORDDEDF2 OF COORDDEDL2-R)
                     THEN
      *                U:Continue
                       MOVE 'Y' TO YL0244 OF WORK-CONTEXT
      *                Payment Status not NCNP
      *                CASE: DB1.Bonus Payment Status is NCNP
      *                *IF
                       IF (BBBNSPAYST OF COORDDEDF2 OF COORDDEDL2-R = 'N
      -                 'CNP') THEN
      *                    U:Continue
                           MOVE 'N' TO YL0244 OF WORK-CONTEXT
                       END-IF
      *                Check Target Type Deselection
      *                CASE: PAR.U:Target Prefix is Target total
      *                *IF
                       IF ('TT' = 'TT') THEN
                           CONTINUE
                       ELSE
      *                    CASE: PAR.U:Target Prefix is Target Local
      *                      Market
      *                    *IF
                           IF ('TT' = 'TL') THEN
      *                        CASE: DB1.Target Market is Local Market
      *                          Target List
      *                        *IF
                               IF (BBTGTMRKET OF COORDDEDF2 OF
                                 COORDDEDL2-R = 'L' OR
                                   BBTGTMRKET OF COORDDEDF2 OF
                                 COORDDEDL2-R = 'W' OR
                                   BBTGTMRKET OF COORDDEDF2 OF
                                 COORDDEDL2-R = 'R') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0244 OF WORK-CONTEXT
                               END-IF
                           ELSE
      *                        CASE: PAR.U:Target Prefix is Target
      *                          Major Fleet
      *                        *IF
                               IF ('TT' = 'TM') THEN
      *                        CASE: DB1.Target Market is Major Fleet
      *                          Target
      *                        *IF
                               IF (BBTGTMRKET OF COORDDEDF2 OF
                                 COORDDEDL2-R = 'M') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0244 OF WORK-CONTEXT
                               END-IF
                               END-IF
                           END-IF
                       END-IF
      *                Check Run Mode Count Type
      *                CASE: LCL.U:Continue is Yes
      *                *IF
                       IF (YL0244 OF WORK-CONTEXT = 'Y') THEN
      *                    CASE: PAR.U:Run Mode is *1
      *                    *IF
                           IF (YL0085 OF WORK-CONTEXT = '1') THEN
                               CONTINUE
                           ELSE
      *                        CASE: PAR.U:Run Mode is *2
      *                        *IF
                               IF (YL0085 OF WORK-CONTEXT = '2') THEN
      *                        CASE: DB1.Order Deduct Date Action LE
      *                          PAR.U:To Date YYYYMMDD
      *                        *IF
                               IF (BBCUSDEDAC OF COORDDEDF2 OF
                                 COORDDEDL2-R NOT > WUUTODTXD OF
                                 WORK-CONTEXT) THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0244 OF WORK-CONTEXT
                               END-IF
                               ELSE
      *                        CASE: PAR.U:Run Mode is *3
      *                        *IF
                               IF (YL0085 OF WORK-CONTEXT = '3') THEN
      *                        CASE: DB1.Order Deduct Date Action LE
      *                          PAR.U:To Date YYYYMMDD
      *                        *IF
                               IF (BBCUSDEDAC OF COORDDEDF2 OF
                                 COORDDEDL2-R NOT > WUUTODTXD OF
                                 WORK-CONTEXT) THEN
      *                        U:Continue
                               MOVE 'N' TO YL0244 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
                               CONTINUE
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
      *                Count
      *                CASE: LCL.U:Continue is Yes
      *                *IF
                       IF (YL0244 OF WORK-CONTEXT = 'Y') THEN
      *                    count
      *                    CASE: DB1.OBT Count Target Status is
      *                      Payment Category 1
      *                    *IF
                           IF (BBCNTTARG OF COORDDEDF2 OF COORDDEDL2-R
                             = '1') THEN
      *                        U:Pay Cat 1 De-Order
                               ADD YL0237 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0237 OF WORK-CONTEXT
                           ELSE
      *                        CASE: DB1.OBT Count Target Status is
      *                          Payment Category 2
      *                        *IF
                               IF (BBCNTTARG OF COORDDEDF2 OF
                                 COORDDEDL2-R = '2') THEN
      *                        U:Pay Cat 2 De-Order
                               ADD YL0238 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0238 OF WORK-CONTEXT
                               ELSE
      *                        CASE: DB1.OBT Count Target Status is
      *                          Payment Category 3
      *                        *IF
                               IF (BBCNTTARG OF COORDDEDF2 OF
                                 COORDDEDL2-R = '3') THEN
      *                        U:Pay Cat 3 De-Order
                               ADD YL0239 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0239 OF WORK-CONTEXT
                               ELSE
      *                        CASE: DB1.OBT Count Target Status is
      *                          Payment Category 4
      *                        *IF
                               IF (BBCNTTARG OF COORDDEDF2 OF
                                 COORDDEDL2-R = '4') THEN
      *                        U:Pay Cat 4 De-Order
                               ADD YL0240 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0240 OF WORK-CONTEXT
                               ELSE
      *                        CASE: DB1.OBT Count Target Status is
      *                          Payment Category 5
      *                        *IF
                               IF (BBCNTTARG OF COORDDEDF2 OF
                                 COORDDEDL2-R = '5') THEN
      *                        U:Pay Cat 5 De-Order
                               ADD YL0241 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0241 OF WORK-CONTEXT
                               ELSE
      *                        CASE: DB1.OBT Count Target Status is
      *                          Payment Category N - New
      *                        *IF
                               IF (BBCNTTARG OF COORDDEDF2 OF
                                 COORDDEDL2-R = 'N') THEN
      *                        U:Pay Cat N De-Order
                               ADD YL0242 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0242 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Pay Cat O De-Order
                               ADD YL0243 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0243 OF WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
                   END-IF
               ELSE
      *            CASE: *OTHERWISE
      *            U:Pay Cat 1 De-Order
                   MOVE YL0237 OF WORK-CONTEXT TO YL0220 OF WORK-CONTEXT
      *            U:Pay Cat 2 De-Order
                   MOVE YL0238 OF WORK-CONTEXT TO YL0221 OF WORK-CONTEXT
      *            U:Pay Cat 3 De-Order
                   MOVE YL0239 OF WORK-CONTEXT TO YL0222 OF WORK-CONTEXT
      *            U:Pay Cat 4 De-Order
                   MOVE YL0240 OF WORK-CONTEXT TO YL0223 OF WORK-CONTEXT
      *            U:Pay Cat 5 De-Order
                   MOVE YL0241 OF WORK-CONTEXT TO YL0224 OF WORK-CONTEXT
      *            U:Pay Cat N De-Order
                   MOVE YL0242 OF WORK-CONTEXT TO YL0226 OF WORK-CONTEXT
      *            U:Pay Cat O De-Order
                   MOVE YL0243 OF WORK-CONTEXT TO YL0225 OF WORK-CONTEXT
      *            *QUIT
                   GO SK8EXIT
               END-IF
               SET C-INDICATOR-OFF(90) TO TRUE
               READ COORDDEDL2 NEXT
                 FORMAT IS 'COORDDEDF2'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         COORDDEDF2 OF COORDDEDL2-R TO
                         EXTSK8
                       MOVE EXTSK8 TO KRSSK8-TMP
                       IF (KRSSK8 NOT = KRSSK8-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        Owning Account
               MOVE LOW-VALUES TO BBOWNACC OF EXTSK8
      *        Order Deduct Date Effect
               MOVE -99999999 TO BBCUSDEDEF OF EXTSK8
      *        SCP Model Code
               MOVE LOW-VALUES TO BBSCMDLCDE OF EXTSK8
      *        Count to Deduction Status
               MOVE -9 TO BBCNTDEDUC OF EXTSK8
           END-PERFORM
      *    USER: Exit processing
      *    U:Pay Cat 1 De-Order
           MOVE YL0237 OF WORK-CONTEXT TO YL0220 OF WORK-CONTEXT
      *    U:Pay Cat 2 De-Order
           MOVE YL0238 OF WORK-CONTEXT TO YL0221 OF WORK-CONTEXT
      *    U:Pay Cat 3 De-Order
           MOVE YL0239 OF WORK-CONTEXT TO YL0222 OF WORK-CONTEXT
      *    U:Pay Cat 4 De-Order
           MOVE YL0240 OF WORK-CONTEXT TO YL0223 OF WORK-CONTEXT
      *    U:Pay Cat 5 De-Order
           MOVE YL0241 OF WORK-CONTEXT TO YL0224 OF WORK-CONTEXT
      *    U:Pay Cat N De-Order
           MOVE YL0242 OF WORK-CONTEXT TO YL0226 OF WORK-CONTEXT
      *    U:Pay Cat O De-Order
           MOVE YL0243 OF WORK-CONTEXT TO YL0225 OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       SK8EXIT.
           EXIT.
      /EJECT
       SK9RVGN SECTION.
      *==============================================================
      *    Rtv Num of Order - Customer Order  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    USER: Initialize routine
      *    Cvt *Job date to DTX
      *    * Job date contains a leading 1 when the year is 2000 or
      *      greater
      *    U:Job Date DTX
           ADD ZZJDT OF JOB-CONTEXT, 19000000 GIVING YL0202 OF
             WORK-CONTEXT
      *    Utl Cvt Dealer 6 to 5N
           MOVE 5 TO YRSW03
           MOVE 2 TO YRSW02
           IF (YRSW02 NOT > 0 OR
               YRSW03 NOT > 0 OR
               YRSW02 > 00006 OR
               YRSW03 > 00006) THEN
               MOVE 'Y2U0510' TO W0RTN
           ELSE
               MOVE WUTOCF OF WORK-CONTEXT TO W0STRNG
               MOVE W0STRNG(YRSW02:YRSW03) TO WUUCODE5 OF WORK-CONTEXT
           END-IF
           IF (WUUCODE5 OF WORK-CONTEXT = SPACES) THEN
               MOVE ZERO TO YL0203 OF WORK-CONTEXT
           ELSE
               MOVE WUUCODE5 OF WORK-CONTEXT TO YL0203 OF WORK-CONTEXT
           END-IF
      *    U:Pay Cat 1 Order
           MOVE ZEROS TO YL0195 OF WORK-CONTEXT
      *    U:Pay Cat 2 Order
           MOVE ZEROS TO YL0196 OF WORK-CONTEXT
      *    U:Pay Cat 3 Order
           MOVE ZEROS TO YL0197 OF WORK-CONTEXT
      *    U:Pay Cat 4 Order
           MOVE ZEROS TO YL0198 OF WORK-CONTEXT
      *    U:Pay Cat 5 Order
           MOVE ZEROS TO YL0199 OF WORK-CONTEXT
      *    U:Pay Cat N Order
           MOVE ZEROS TO YL0200 OF WORK-CONTEXT
      *    U:Pay Cat O Order
           MOVE ZEROS TO YL0201 OF WORK-CONTEXT
      *    U:Pay Cat 1 Order
           MOVE ZEROS TO YL0204 OF WORK-CONTEXT
      *    U:Pay Cat 2 Order
           MOVE ZEROS TO YL0205 OF WORK-CONTEXT
      *    U:Pay Cat 3 Order
           MOVE ZEROS TO YL0206 OF WORK-CONTEXT
      *    U:Pay Cat 4 Order
           MOVE ZEROS TO YL0207 OF WORK-CONTEXT
      *    U:Pay Cat 5 Order
           MOVE ZEROS TO YL0208 OF WORK-CONTEXT
      *    U:Pay Cat N Order
           MOVE ZEROS TO YL0209 OF WORK-CONTEXT
      *    U:Pay Cat O Order
           MOVE ZEROS TO YL0210 OF WORK-CONTEXT
      *    Setup key
      *    Owning Account
           MOVE WUTOCF OF WORK-CONTEXT TO C5OWNACC OF KPSSK9
      *    Customer Order Date #
           MOVE WUCUSORDD8 OF WORK-CONTEXT TO C5CUSORDD8 OF KPSSK9
           MOVE CORRESPONDING KPSSK9 TO KRSSK9
      *    Initialise Full Externally Described Keylist
      *    Owning Account
           MOVE LOW-VALUES TO C5OWNACC OF EXTSK9
      *    Customer Order Date #
           MOVE -99999999 TO C5CUSORDD8 OF EXTSK9
      *    Customer Ord Number
           MOVE LOW-VALUES TO C5CUSORDNB OF EXTSK9
           MOVE CORRESPONDING
             EXTSK9 TO
             COORDDTAF8 OF COORDDTAL8-R
           MOVE CORRESPONDING
             KPSSK9 TO
             COORDDTAF8 OF COORDDTAL8-R
           START COORDDTAL8 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'COORDDTAF8'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ COORDDTAL8 NEXT
             FORMAT IS 'COORDDTAF8'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     COORDDTAF8 OF COORDDTAL8-R TO
                     EXTSK9
                   MOVE EXTSK9 TO KRSSK9-TMP
                   IF (KRSSK9 NOT = KRSSK9-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    Owning Account
           MOVE LOW-VALUES TO C5OWNACC OF EXTSK9
      *    Customer Order Date #
           MOVE -99999999 TO C5CUSORDD8 OF EXTSK9
      *    Customer Ord Number
           MOVE LOW-VALUES TO C5CUSORDNB OF EXTSK9
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR6221' TO W0RTN
           END-IF
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        ...Count number of Order
      *        CASE: DB1.Customer Order Date # LE PAR.U:To Date YYYYMMDD
      *        *IF
               IF (C5CUSORDD8 OF COORDDTAF8 OF COORDDTAL8-R NOT >
                 WUUTODTXD OF WORK-CONTEXT) THEN
      *            Include this one?
      *            CASE: DB1.Customer Ord Number is Not Blank
      *            *IF
                   IF (C5CUSORDNB OF COORDDTAF8 OF COORDDTAL8-R NOT = '
      -             '') THEN
      *                Car/Van Indicator
                       MOVE ' ' TO YL0211 OF WORK-CONTEXT
      *                OBT Count Target Status
                       MOVE ' ' TO YL0212 OF WORK-CONTEXT
      *                Rtv Car or Van SCP Mdl - Vehicle Model Bonus
      *                  Atr  *
                       PERFORM SL1RVGN
      *                Rtv Rtn Latest Brand Mdl - Bonus Sls-RIC Mdl
      *                  Dsp Seq  *
                       PERFORM SL2RVGN
      *                Fleet Programmes Code
                       MOVE SPACES TO YL0214 OF WORK-CONTEXT
                       MOVE ' ' TO YL0214 OF WORK-CONTEXT
      *                U:Continue
                       MOVE 'Y' TO YL0215 OF WORK-CONTEXT
      *                Rtv All Dtl by Dlr/Mdl/ON - OBT Extract  *
                       PERFORM SL3RVGN
      *                If Record Not Found in OBT and Cancelled Try
      *                  Order Deduction
      *                CASE: PGM.*Return code is *Normal
      *                *IF
                       IF (W0RTN = ' ') THEN
                           CONTINUE
                       ELSE
      *                    CASE: *OTHERWISE
      *                    Cancelled After 01/10/2017 Try COORDDEDP
      *                    CASE: DB1.Order Cancelled Date is GE 20171001
      *                    *IF
                           IF (C5ORDCANDT OF COORDDTAF8 OF COORDDTAL8-R
                             NOT < 20171001) THEN
      *                        Rtv All Details - Customer Order Deduct
      *                          VB  *
                               PERFORM SL4RVGN
                           ELSE
      *                        CASE: *OTHERWISE
      *                        Ext Simulate OBT Rtv - Customer Order  *
                               SET C-INDICATOR-OFF(90) TO TRUE
                               MOVE C5OWNACC OF COORDDTAF8 OF
                                 COORDDTAL8-R TO WQ0102
                               MOVE C5CUSORDNB OF COORDDTAF8 OF
                                 COORDDTAL8-R TO WQ0103
                               MOVE C5CUSORDD8 OF COORDDTAF8 OF
                                 COORDDTAL8-R TO WQ0104
                               MOVE C5ORDTYPCN OF COORDDTAF8 OF
                                 COORDDTAL8-R TO WQ0105
                               MOVE C5SDSCHNCD OF COORDDTAF8 OF
                                 COORDDTAL8-R TO WQ0106
                               MOVE C5TCCSTTYP OF COORDDTAF8 OF
                                 COORDDTAL8-R TO WQ0107
                               MOVE C5SCMDLCDE OF COORDDTAF8 OF
                                 COORDDTAL8-R TO WQ0108
                               MOVE C5PHASE OF COORDDTAF8 OF
                                 COORDDTAL8-R TO WQ0109
                               MOVE C5SCVERCDE OF COORDDTAF8 OF
                                 COORDDTAL8-R TO WQ0110
                               MOVE C5ORDCANDT OF COORDDTAF8 OF
                                 COORDDTAL8-R TO WQ0111
                               MOVE C5ORDCANRS OF COORDDTAF8 OF
                                 COORDDTAL8-R TO WQ0112
                               MOVE C5FLOPNO OF COORDDTAF8 OF
                                 COORDDTAL8-R TO WQ0113
                               MOVE YL0217 OF WORK-CONTEXT TO WQ0114
                               MOVE YL0212 OF WORK-CONTEXT TO WQ0115
                               MOVE YL0214 OF WORK-CONTEXT TO WQ0116
                               MOVE YL0218 OF WORK-CONTEXT TO WQ0117
                               MOVE 'O' TO WQ0118
      *
                               CALL 'RAASIMOBTS' USING
      *                        Return code
                                 W0RTN
      *                        Owning Account
                                 WQ0102
      *                        Customer Ord Number
                                 WQ0103
      *                        Customer Order Date #
                                 WQ0104
      *                        Order Type(Central)
                                 WQ0105
      *                        SD Sales Channel Code
                                 WQ0106
      *                        SEDRE Customer Type
                                 WQ0107
      *                        SCP Model Code
                                 WQ0108
      *                        Model Phase
                                 WQ0109
      *                        SCP Model Version Code
                                 WQ0110
      *                        Order Cancelled Date
                                 WQ0111
      *                        Order Cancellation Reason
                                 WQ0112
      *                        Fleet Operator Number
                                 WQ0113
      *                        BDC Payment Term
                                 WQ0114
      *                        OBT Count Target Status
                                 WQ0115
      *                        Fleet Programmes Code
                                 WQ0116
      *                        Target Market
                                 WQ0117
      *                        U:Date Type
                                 WQ0118
                                        ON OVERFLOW
                                        SET C-INDICATOR-ON(90) TO TRUE
                               END-CALL
      *
                               MOVE WQ0114 TO YL0217 OF WORK-CONTEXT
                               MOVE WQ0115 TO YL0212 OF WORK-CONTEXT
                               MOVE WQ0116 TO YL0214 OF WORK-CONTEXT
                               MOVE WQ0117 TO YL0218 OF WORK-CONTEXT
      *
      *                        Error on program call will terminate
      *                          run unit
                               IF (C-INDICATOR-ON(90)) THEN
                               MOVE 'Y2U0032' TO W0RTN
                               MOVE 'RAASIMOBTS' TO W0CLPG
      *                        Send message '*Error occured on CALL...'
      *                        Message ID
                               MOVE 'Y2U0032' TO ZAMSID
      *                        Message file
                               MOVE 'Y2USRMSG' TO ZAMSGF
      *                        Message data
                               MOVE W0CLPG TO ZAMSDA
                               PERFORM ZASNMS
                               END-IF
      *                        Error detected?
                               IF (W0RTN        NOT = SPACES) THEN
                               SET C-INDICATOR-ON(99) TO TRUE
                               END-IF
                           END-IF
                       END-IF
      *                Check Target Type Deselection
      *                CASE: PAR.U:Target Prefix is Target total
      *                *IF
                       IF ('OT' = 'TT') THEN
                           CONTINUE
                       ELSE
      *                    CASE: PAR.U:Target Prefix is Target Local
      *                      Market
      *                    *IF
                           IF ('OT' = 'TL') THEN
      *                        CASE: LCL.Target Market is Local Market
      *                          Target List
      *                        *IF
                               IF (YL0218 OF WORK-CONTEXT = 'L' OR
                                   YL0218 OF WORK-CONTEXT = 'W' OR
                                   YL0218 OF WORK-CONTEXT = 'R') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0215 OF WORK-CONTEXT
                               END-IF
                           ELSE
      *                        CASE: PAR.U:Target Prefix is Target
      *                          Major Fleet
      *                        *IF
                               IF ('OT' = 'TM') THEN
      *                        CASE: LCL.Target Market is Major Fleet
      *                          Target
      *                        *IF
                               IF (YL0218 OF WORK-CONTEXT = 'M') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0215 OF WORK-CONTEXT
                               END-IF
                               ELSE
      *                        CASE: PAR.U:Target Prefix is Target not
      *                          fleet
      *                        *IF
                               IF ('OT' = 'TN') THEN
      *                        CASE:
      *                        - c1 OR c2
      *                        |- c1    : LCL.Fleet Programmes Code is
      *                          *Blank
      *                        |- c2    : LCL.Fleet Programmes Code is
      *                          UNS - Unsupported (30286)
      *                        '-
      *                        *IF
                               IF (YL0214 OF WORK-CONTEXT = ' ' OR
                                   YL0214 OF WORK-CONTEXT = 'UNS') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0215 OF WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
      *                cont yes
      *                CASE: LCL.U:Continue is Yes
      *                *IF
                       IF (YL0215 OF WORK-CONTEXT = 'Y') THEN
      *                    CASE:
      *                    - NOTc1
      *                    |- c1    : DB1.Order Cancelled Date is Zero
      *                    '-
      *                    *IF
                           IF (NOT (C5ORDCANDT OF COORDDTAF8 OF
                             COORDDTAL8-R = 0)) THEN
      *                        CASE:
      *                        - c1 OR c2
      *                        |- c1    : LCL.OBT Count Target Status
      *                          is In Target List
      *                        |- c2    : LCL.Bns Brand Name is RENAULT
      *                        '-
      *                        *IF
                               IF ((YL0212 OF WORK-CONTEXT = 'I' OR
                                    YL0212 OF WORK-CONTEXT = '1' OR
                                    YL0212 OF WORK-CONTEXT = '2' OR
                                    YL0212 OF WORK-CONTEXT = '3' OR
                                    YL0212 OF WORK-CONTEXT = '4' OR
                                    YL0212 OF WORK-CONTEXT = '5' OR
                                    YL0212 OF WORK-CONTEXT = 'N') OR
                                   YL0213 OF WORK-CONTEXT = 'RENAULT')
                                 THEN
      *                        U:Pay Cat 5 Order
                               ADD YL0208 OF WORK-CONTEXT, 1 GIVING
                                 YL0208 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Pay Cat O Order
                               ADD YL0210 OF WORK-CONTEXT, 1 GIVING
                                 YL0210 OF WORK-CONTEXT
                               END-IF
                           ELSE
      *                        CASE: *OTHERWISE
      *                        count
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 1
      *                        *IF
                               IF (YL0212 OF WORK-CONTEXT = '1') THEN
      *                        U:Pay Cat 1 Order
                               ADD YL0204 OF WORK-CONTEXT, 1 GIVING
                                 YL0204 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 2
      *                        *IF
                               IF (YL0212 OF WORK-CONTEXT = '2') THEN
      *                        U:Pay Cat 2 Order
                               ADD YL0205 OF WORK-CONTEXT, 1 GIVING
                                 YL0205 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 3
      *                        *IF
                               IF (YL0212 OF WORK-CONTEXT = '3') THEN
      *                        U:Pay Cat 3 Order
                               ADD YL0206 OF WORK-CONTEXT, 1 GIVING
                                 YL0206 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 4
      *                        *IF
                               IF (YL0212 OF WORK-CONTEXT = '4') THEN
      *                        U:Pay Cat 4 Order
                               ADD YL0207 OF WORK-CONTEXT, 1 GIVING
                                 YL0207 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category 5
      *                        *IF
                               IF (YL0212 OF WORK-CONTEXT = '5') THEN
      *                        U:Pay Cat 5 Order
                               ADD YL0208 OF WORK-CONTEXT, 1 GIVING
                                 YL0208 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.OBT Count Target Status is
      *                          Payment Category N - New
      *                        *IF
                               IF (YL0212 OF WORK-CONTEXT = 'N') THEN
      *                        U:Pay Cat N Order
                               ADD YL0209 OF WORK-CONTEXT, 1 GIVING
                                 YL0209 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Pay Cat O Order
                               ADD YL0210 OF WORK-CONTEXT, 1 GIVING
                                 YL0210 OF WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
                   END-IF
               END-IF
               SET C-INDICATOR-OFF(90) TO TRUE
               READ COORDDTAL8 NEXT
                 FORMAT IS 'COORDDTAF8'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         COORDDTAF8 OF COORDDTAL8-R TO
                         EXTSK9
                       MOVE EXTSK9 TO KRSSK9-TMP
                       IF (KRSSK9 NOT = KRSSK9-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        Owning Account
               MOVE LOW-VALUES TO C5OWNACC OF EXTSK9
      *        Customer Order Date #
               MOVE -99999999 TO C5CUSORDD8 OF EXTSK9
      *        Customer Ord Number
               MOVE LOW-VALUES TO C5CUSORDNB OF EXTSK9
           END-PERFORM
      *    USER: Exit processing
      *    U:Pay Cat 1 Order
           MOVE YL0204 OF WORK-CONTEXT TO YL0195 OF WORK-CONTEXT
      *    U:Pay Cat 2 Order
           MOVE YL0205 OF WORK-CONTEXT TO YL0196 OF WORK-CONTEXT
      *    U:Pay Cat 3 Order
           MOVE YL0206 OF WORK-CONTEXT TO YL0197 OF WORK-CONTEXT
      *    U:Pay Cat 4 Order
           MOVE YL0207 OF WORK-CONTEXT TO YL0198 OF WORK-CONTEXT
      *    U:Pay Cat 5 Order
           MOVE YL0208 OF WORK-CONTEXT TO YL0199 OF WORK-CONTEXT
      *    U:Pay Cat N Order
           MOVE YL0209 OF WORK-CONTEXT TO YL0200 OF WORK-CONTEXT
      *    U:Pay Cat O Order
           MOVE YL0210 OF WORK-CONTEXT TO YL0201 OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       SK9EXIT.
           EXIT.
      /EJECT
       SL1RVGN SECTION.
      *==============================================================
      *    Rtv Car or Van SCP Mdl - Vehicle Model Bonus Atr  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    USER: Initialize routine
      *    Car/Van Indicator
           MOVE 'C' TO YL0211 OF WORK-CONTEXT
      *    Setup key
      *    Model Application Code
           MOVE 'RIC' TO LLMDLAPPCD OF KRSSL1
      *    SCP Model Code
           MOVE C5SCMDLCDE OF COORDDTAF8 OF COORDDTAL8-R TO LLSCMDLCDE
             OF KRSSL1
      *    Initialise Full Externally Described Keylist
      *    Model Application Code
           MOVE LOW-VALUES TO LLMDLAPPCD OF EXTSL1
      *    SCP Model Code
           MOVE LOW-VALUES TO LLSCMDLCDE OF EXTSL1
           MOVE CORRESPONDING
             KRSSL1 TO
             VAMDLBNSF1 OF VAMDLBNSL1-R
           SET C-INDICATOR-OFF(90) TO TRUE
           READ VAMDLBNSL1
             FORMAT IS 'VAMDLBNSF1'
           END-READ
           IF (C-NO-RECORD) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               END-IF
           END-IF
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR7127' TO W0RTN
      *        USER: Processing if Data record not found
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SL1EXIT
           END-IF
      *
           IF (C-INDICATOR-OFF(90)) THEN
      *        USER: Process Data record
      *        Car/Van Indicator
               MOVE LLCORV OF VAMDLBNSF1 OF VAMDLBNSL1-R TO YL0211 OF
                 WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
           END-IF
      *==============================================================
           CONTINUE.
       SL1EXIT.
           EXIT.
      /EJECT
       SL2RVGN SECTION.
      *==============================================================
      *    Rtv Rtn Latest Brand Mdl - Bonus Sls-RIC Mdl Dsp Seq  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    SCP Model Code
           MOVE C5SCMDLCDE OF COORDDTAF8 OF COORDDTAL8-R TO O9SCMDLCDE
             OF KRSSL2
      *    Initialise Full Externally Described Keylist
      *    SCP Model Code
           MOVE LOW-VALUES TO O9SCMDLCDE OF EXTSL2
      *    Bns RIC Config Year
           MOVE 9999 TO O9BNSRICYR OF EXTSL2
      *    Bns RIC Display Sequence
           MOVE -999 TO O9BNSRICSQ OF EXTSL2
           MOVE CORRESPONDING
             EXTSL2 TO
             SBRICDSQF4 OF SBRICDSQL4-R
           MOVE CORRESPONDING
             KRSSL2 TO
             SBRICDSQF4 OF SBRICDSQL4-R
           START SBRICDSQL4 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'SBRICDSQF4'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ SBRICDSQL4 NEXT
             FORMAT IS 'SBRICDSQF4'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     SBRICDSQF4 OF SBRICDSQL4-R TO
                     EXTSL2
                   MOVE EXTSL2 TO KRSSL2-TMP
                   IF (KRSSL2 NOT = KRSSL2-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    SCP Model Code
           MOVE LOW-VALUES TO O9SCMDLCDE OF EXTSL2
      *    Bns RIC Config Year
           MOVE 9999 TO O9BNSRICYR OF EXTSL2
      *    Bns RIC Display Sequence
           MOVE -999 TO O9BNSRICSQ OF EXTSL2
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR7404' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Bns Brand Name
               MOVE SPACES TO YL0213 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SL2EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Bns Brand Name
               MOVE O9BNSBRNDD OF SBRICDSQF4 OF SBRICDSQL4-R TO YL0213
                 OF WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
      *        *QUIT
               GO SL2EXIT
               SET C-INDICATOR-OFF(90) TO TRUE
               READ SBRICDSQL4 NEXT
                 FORMAT IS 'SBRICDSQF4'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         SBRICDSQF4 OF SBRICDSQL4-R TO
                         EXTSL2
                       MOVE EXTSL2 TO KRSSL2-TMP
                       IF (KRSSL2 NOT = KRSSL2-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        SCP Model Code
               MOVE LOW-VALUES TO O9SCMDLCDE OF EXTSL2
      *        Bns RIC Config Year
               MOVE 9999 TO O9BNSRICYR OF EXTSL2
      *        Bns RIC Display Sequence
               MOVE -999 TO O9BNSRICSQ OF EXTSL2
           END-PERFORM
      *==============================================================
           CONTINUE.
       SL2EXIT.
           EXIT.
      /EJECT
       SL3RVGN SECTION.
      *==============================================================
      *    Rtv All Dtl by Dlr/Mdl/ON - OBT Extract  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    Dealer number (Num key)
           MOVE YL0203 OF WORK-CONTEXT TO Q2DLRNOKEY OF KRSSL3
      *    BDC Model
           MOVE C5SCMDLCDE OF COORDDTAF8 OF COORDDTAL8-R TO Q2BDCM OF
             KRSSL3
      *    BDC Customer Order Number
           MOVE C5CUSORDNB OF COORDDTAF8 OF COORDDTAL8-R TO Q2BDCCON OF
             KRSSL3
      *    Initialise Full Externally Described Keylist
      *    Dealer number (Num key)
           MOVE -99999 TO Q2DLRNOKEY OF EXTSL3
      *    BDC Model
           MOVE LOW-VALUES TO Q2BDCM OF EXTSL3
      *    BDC Customer Order Number
           MOVE LOW-VALUES TO Q2BDCCON OF EXTSL3
           MOVE CORRESPONDING
             EXTSL3 TO
             FOBEXCB OF RAOBEXTRL2-R
           MOVE CORRESPONDING
             KRSSL3 TO
             FOBEXCB OF RAOBEXTRL2-R
           START RAOBEXTRL2 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'FOBEXCB'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ RAOBEXTRL2 NEXT
             FORMAT IS 'FOBEXCB'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     FOBEXCB OF RAOBEXTRL2-R TO
                     EXTSL3
                   MOVE EXTSL3 TO KRSSL3-TMP
                   IF (KRSSL3 NOT = KRSSL3-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    Dealer number (Num key)
           MOVE -99999 TO Q2DLRNOKEY OF EXTSL3
      *    BDC Model
           MOVE LOW-VALUES TO Q2BDCM OF EXTSL3
      *    BDC Customer Order Number
           MOVE LOW-VALUES TO Q2BDCCON OF EXTSL3
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR5706' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Fleet Operator Number
               MOVE SPACES TO YL0216 OF WORK-CONTEXT
      *        BDC Payment Term
               MOVE SPACES TO YL0217 OF WORK-CONTEXT
      *        OBT Count Target Status
               MOVE SPACES TO YL0212 OF WORK-CONTEXT
      *        Fleet Programmes Code
               MOVE SPACES TO YL0214 OF WORK-CONTEXT
      *        Target Market
               MOVE SPACES TO YL0218 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SL3EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Fleet Operator Number
               MOVE Q2FLOPNO OF FOBEXCB OF RAOBEXTRL2-R TO YL0216 OF
                 WORK-CONTEXT
      *        BDC Payment Term
               MOVE Q2BDCPTRM OF FOBEXCB OF RAOBEXTRL2-R TO YL0217 OF
                 WORK-CONTEXT
      *        OBT Count Target Status
               MOVE Q2CNTTARG OF FOBEXCB OF RAOBEXTRL2-R TO YL0212 OF
                 WORK-CONTEXT
      *        Fleet Programmes Code
               MOVE Q2FLPGMCDE OF FOBEXCB OF RAOBEXTRL2-R TO YL0214 OF
                 WORK-CONTEXT
      *        Target Market
               MOVE Q2TGTMRKET OF FOBEXCB OF RAOBEXTRL2-R TO YL0218 OF
                 WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
      *        *QUIT
               GO SL3EXIT
               SET C-INDICATOR-OFF(90) TO TRUE
               READ RAOBEXTRL2 NEXT
                 FORMAT IS 'FOBEXCB'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         FOBEXCB OF RAOBEXTRL2-R TO
                         EXTSL3
                       MOVE EXTSL3 TO KRSSL3-TMP
                       IF (KRSSL3 NOT = KRSSL3-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        Dealer number (Num key)
               MOVE -99999 TO Q2DLRNOKEY OF EXTSL3
      *        BDC Model
               MOVE LOW-VALUES TO Q2BDCM OF EXTSL3
      *        BDC Customer Order Number
               MOVE LOW-VALUES TO Q2BDCCON OF EXTSL3
           END-PERFORM
      *==============================================================
           CONTINUE.
       SL3EXIT.
           EXIT.
      /EJECT
       SL4RVGN SECTION.
      *==============================================================
      *    Rtv All Details - Customer Order Deduct VB  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    Owning Account
           MOVE C5OWNACC OF COORDDTAF8 OF COORDDTAL8-R TO BBOWNACC OF
             KRSSL4
      *    Customer Ord Number
           MOVE C5CUSORDNB OF COORDDTAF8 OF COORDDTAL8-R TO BBCUSORDNB
             OF KRSSL4
      *    Customer Order Deduct Typ
           MOVE 'C' TO BBCODEDTYP OF KRSSL4
      *    Invariant BCV
           MOVE ' ' TO BBINVBCV OF KRSSL4
      *    Order Deduct Sequence Nbr
           MOVE 1 TO BBCODEDSEQ OF KRSSL4
      *    Initialise Full Externally Described Keylist
      *    Owning Account
           MOVE LOW-VALUES TO BBOWNACC OF EXTSL4
      *    Customer Ord Number
           MOVE LOW-VALUES TO BBCUSORDNB OF EXTSL4
      *    Customer Order Deduct Typ
           MOVE LOW-VALUES TO BBCODEDTYP OF EXTSL4
      *    Invariant BCV
           MOVE LOW-VALUES TO BBINVBCV OF EXTSL4
      *    Order Deduct Sequence Nbr
           MOVE -999 TO BBCODEDSEQ OF EXTSL4
           MOVE CORRESPONDING
             KRSSL4 TO
             COORDDEDF1 OF COORDDEDL1-R
           SET C-INDICATOR-OFF(90) TO TRUE
           READ COORDDEDL1
             FORMAT IS 'COORDDEDF1'
           END-READ
           IF (C-NO-RECORD) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               END-IF
           END-IF
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR7843' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Order Deduct Date Action
               MOVE ZEROS TO YL0219 OF WORK-CONTEXT
      *        Bonus Payment Status
               MOVE SPACES TO YL0217 OF WORK-CONTEXT
      *        OBT Count Target Status
               MOVE SPACES TO YL0212 OF WORK-CONTEXT
      *        Target Market
               MOVE SPACES TO YL0218 OF WORK-CONTEXT
      *        Fleet Operator Number
               MOVE SPACES TO YL0216 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SL4EXIT
           END-IF
      *
           IF (C-INDICATOR-OFF(90)) THEN
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Order Deduct Date Action
               MOVE BBCUSDEDAC OF COORDDEDF1 OF COORDDEDL1-R TO YL0219
                 OF WORK-CONTEXT
      *        Bonus Payment Status
               MOVE BBBNSPAYST OF COORDDEDF1 OF COORDDEDL1-R TO YL0217
                 OF WORK-CONTEXT
      *        OBT Count Target Status
               MOVE BBCNTTARG OF COORDDEDF1 OF COORDDEDL1-R TO YL0212
                 OF WORK-CONTEXT
      *        Target Market
               MOVE BBTGTMRKET OF COORDDEDF1 OF COORDDEDL1-R TO YL0218
                 OF WORK-CONTEXT
      *        Fleet Operator Number
               MOVE BBFLOPNO OF COORDDEDF1 OF COORDDEDL1-R TO YL0216 OF
                 WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
           END-IF
      *==============================================================
           CONTINUE.
       SL4EXIT.
           EXIT.
      /EJECT
       SL5RVGN SECTION.
      *==============================================================
      *    Rtv Num of Deductions - Customer Order Deduct VB  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    USER: Initialize routine
      *    Cvt *Job date to DTX
      *    * Job date contains a leading 1 when the year is 2000 or
      *      greater
      *    U:Job Date DTX
           ADD ZZJDT OF JOB-CONTEXT, 19000000 GIVING YL0227 OF
             WORK-CONTEXT
      *    U:Pay Cat 1 De-Order
           MOVE ZEROS TO YL0220 OF WORK-CONTEXT
      *    U:Pay Cat 2 De-Order
           MOVE ZEROS TO YL0221 OF WORK-CONTEXT
      *    U:Pay Cat 3 De-Order
           MOVE ZEROS TO YL0222 OF WORK-CONTEXT
      *    U:Pay Cat 4 De-Order
           MOVE ZEROS TO YL0223 OF WORK-CONTEXT
      *    U:Pay Cat 5 De-Order
           MOVE ZEROS TO YL0224 OF WORK-CONTEXT
      *    U:Pay Cat N De-Order
           MOVE ZEROS TO YL0226 OF WORK-CONTEXT
      *    U:Pay Cat O De-Order
           MOVE ZEROS TO YL0225 OF WORK-CONTEXT
      *    U:Pay Cat 1 De-Order
           MOVE ZEROS TO YL0228 OF WORK-CONTEXT
      *    U:Pay Cat 2 De-Order
           MOVE ZEROS TO YL0229 OF WORK-CONTEXT
      *    U:Pay Cat 3 De-Order
           MOVE ZEROS TO YL0230 OF WORK-CONTEXT
      *    U:Pay Cat 4 De-Order
           MOVE ZEROS TO YL0231 OF WORK-CONTEXT
      *    U:Pay Cat 5 De-Order
           MOVE ZEROS TO YL0232 OF WORK-CONTEXT
      *    U:Pay Cat N De-Order
           MOVE ZEROS TO YL0233 OF WORK-CONTEXT
      *    U:Pay Cat O De-Order
           MOVE ZEROS TO YL0234 OF WORK-CONTEXT
      *    Setup key
      *    Owning Account
           MOVE WUTOCF OF WORK-CONTEXT TO BBOWNACC OF KPSSL5
      *    Order Deduct Date Effect
           MOVE WUCUSORDD8 OF WORK-CONTEXT TO BBCUSDEDEF OF KPSSL5
           MOVE CORRESPONDING KPSSL5 TO KRSSL5
      *    Initialise Full Externally Described Keylist
      *    Owning Account
           MOVE LOW-VALUES TO BBOWNACC OF EXTSL5
      *    Order Deduct Date Effect
           MOVE -99999999 TO BBCUSDEDEF OF EXTSL5
      *    SCP Model Code
           MOVE LOW-VALUES TO BBSCMDLCDE OF EXTSL5
      *    Count to Deduction Status
           MOVE -9 TO BBCNTDEDUC OF EXTSL5
           MOVE CORRESPONDING
             EXTSL5 TO
             COORDDEDF2 OF COORDDEDL2-R
           MOVE CORRESPONDING
             KPSSL5 TO
             COORDDEDF2 OF COORDDEDL2-R
           START COORDDEDL2 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'COORDDEDF2'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ COORDDEDL2 NEXT
             FORMAT IS 'COORDDEDF2'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     COORDDEDF2 OF COORDDEDL2-R TO
                     EXTSL5
                   MOVE EXTSL5 TO KRSSL5-TMP
                   IF (KRSSL5 NOT = KRSSL5-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    Owning Account
           MOVE LOW-VALUES TO BBOWNACC OF EXTSL5
      *    Order Deduct Date Effect
           MOVE -99999999 TO BBCUSDEDEF OF EXTSL5
      *    SCP Model Code
           MOVE LOW-VALUES TO BBSCMDLCDE OF EXTSL5
      *    Count to Deduction Status
           MOVE -9 TO BBCNTDEDUC OF EXTSL5
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR7843' TO W0RTN
           END-IF
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        CASE: DB1.Order Deduct Date Effect LT PAR.U:To Date
      *          YYYYMMDD
      *        *IF
               IF (BBCUSDEDEF OF COORDDEDF2 OF COORDDEDL2-R < WUUTODTXD
                 OF WORK-CONTEXT) THEN
      *            Count Number of Deductions
      *            CASE:
      *            - NOTc1
      *            |- c1    : DB1.Count to Deduction Status is *Do Not
      *              Count
      *            '-
      *            *IF
                   IF (NOT (BBCNTDEDUC OF COORDDEDF2 OF COORDDEDL2-R =
                     0)) THEN
      *                U:Continue
                       MOVE 'Y' TO YL0235 OF WORK-CONTEXT
      *                Check Target Type Deselection
      *                CASE: PAR.U:Target Prefix is Target total
      *                *IF
                       IF ('TT' = 'TT') THEN
                           CONTINUE
                       ELSE
      *                    CASE: PAR.U:Target Prefix is Target Local
      *                      Market
      *                    *IF
                           IF ('TT' = 'TL') THEN
      *                        CASE: DB1.Target Market is Local Market
      *                          Target List
      *                        *IF
                               IF (BBTGTMRKET OF COORDDEDF2 OF
                                 COORDDEDL2-R = 'L' OR
                                   BBTGTMRKET OF COORDDEDF2 OF
                                 COORDDEDL2-R = 'W' OR
                                   BBTGTMRKET OF COORDDEDF2 OF
                                 COORDDEDL2-R = 'R') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0235 OF WORK-CONTEXT
                               END-IF
                           ELSE
      *                        CASE: PAR.U:Target Prefix is Target
      *                          Major Fleet
      *                        *IF
                               IF ('TT' = 'TM') THEN
      *                        CASE: DB1.Target Market is Major Fleet
      *                          Target
      *                        *IF
                               IF (BBTGTMRKET OF COORDDEDF2 OF
                                 COORDDEDL2-R = 'M') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0235 OF WORK-CONTEXT
                               END-IF
                               END-IF
                           END-IF
                       END-IF
      *                Check Run Mode Count Type
      *                CASE: LCL.U:Continue is Yes
      *                *IF
                       IF (YL0235 OF WORK-CONTEXT = 'Y') THEN
      *                    CASE: PAR.U:Run Mode is *1
      *                    *IF
                           IF (YL0085 OF WORK-CONTEXT = '1') THEN
                               CONTINUE
                           ELSE
      *                        CASE: PAR.U:Run Mode is *2
      *                        *IF
                               IF (YL0085 OF WORK-CONTEXT = '2') THEN
      *                        CASE: DB1.Order Deduct Date Action LE
      *                          PAR.U:To Date YYYYMMDD
      *                        *IF
                               IF (BBCUSDEDAC OF COORDDEDF2 OF
                                 COORDDEDL2-R NOT > WUUTODTXD OF
                                 WORK-CONTEXT) THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0235 OF WORK-CONTEXT
                               END-IF
                               ELSE
      *                        CASE: PAR.U:Run Mode is *3
      *                        *IF
                               IF (YL0085 OF WORK-CONTEXT = '3') THEN
      *                        CASE: DB1.Order Deduct Date Action LE
      *                          PAR.U:To Date YYYYMMDD
      *                        *IF
                               IF (BBCUSDEDAC OF COORDDEDF2 OF
                                 COORDDEDL2-R NOT > WUUTODTXD OF
                                 WORK-CONTEXT) THEN
      *                        U:Continue
                               MOVE 'N' TO YL0235 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
                               CONTINUE
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
      *                Count
      *                CASE: LCL.U:Continue is Yes
      *                *IF
                       IF (YL0235 OF WORK-CONTEXT = 'Y') THEN
      *                    count
      *                    CASE: DB1.OBT Count Target Status is
      *                      Payment Category 1
      *                    *IF
                           IF (BBCNTTARG OF COORDDEDF2 OF COORDDEDL2-R
                             = '1') THEN
      *                        U:Pay Cat 1 De-Order
                               ADD YL0228 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0228 OF WORK-CONTEXT
                           ELSE
      *                        CASE: DB1.OBT Count Target Status is
      *                          Payment Category 2
      *                        *IF
                               IF (BBCNTTARG OF COORDDEDF2 OF
                                 COORDDEDL2-R = '2') THEN
      *                        U:Pay Cat 2 De-Order
                               ADD YL0229 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0229 OF WORK-CONTEXT
                               ELSE
      *                        CASE: DB1.OBT Count Target Status is
      *                          Payment Category 3
      *                        *IF
                               IF (BBCNTTARG OF COORDDEDF2 OF
                                 COORDDEDL2-R = '3') THEN
      *                        U:Pay Cat 3 De-Order
                               ADD YL0230 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0230 OF WORK-CONTEXT
                               ELSE
      *                        CASE: DB1.OBT Count Target Status is
      *                          Payment Category 4
      *                        *IF
                               IF (BBCNTTARG OF COORDDEDF2 OF
                                 COORDDEDL2-R = '4') THEN
      *                        U:Pay Cat 4 De-Order
                               ADD YL0231 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0231 OF WORK-CONTEXT
                               ELSE
      *                        CASE: DB1.OBT Count Target Status is
      *                          Payment Category 5
      *                        *IF
                               IF (BBCNTTARG OF COORDDEDF2 OF
                                 COORDDEDL2-R = '5') THEN
      *                        U:Pay Cat 5 De-Order
                               ADD YL0232 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0232 OF WORK-CONTEXT
                               ELSE
      *                        CASE: DB1.OBT Count Target Status is
      *                          Payment Category N - New
      *                        *IF
                               IF (BBCNTTARG OF COORDDEDF2 OF
                                 COORDDEDL2-R = 'N') THEN
      *                        U:Pay Cat N De-Order
                               ADD YL0233 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0233 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Pay Cat O De-Order
                               ADD YL0234 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0234 OF WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
                   END-IF
               ELSE
      *            CASE: *OTHERWISE
      *            U:Pay Cat 1 De-Order
                   MOVE YL0228 OF WORK-CONTEXT TO YL0220 OF WORK-CONTEXT
      *            U:Pay Cat 2 De-Order
                   MOVE YL0229 OF WORK-CONTEXT TO YL0221 OF WORK-CONTEXT
      *            U:Pay Cat 3 De-Order
                   MOVE YL0230 OF WORK-CONTEXT TO YL0222 OF WORK-CONTEXT
      *            U:Pay Cat 4 De-Order
                   MOVE YL0231 OF WORK-CONTEXT TO YL0223 OF WORK-CONTEXT
      *            U:Pay Cat 5 De-Order
                   MOVE YL0232 OF WORK-CONTEXT TO YL0224 OF WORK-CONTEXT
      *            U:Pay Cat N De-Order
                   MOVE YL0233 OF WORK-CONTEXT TO YL0226 OF WORK-CONTEXT
      *            U:Pay Cat O De-Order
                   MOVE YL0234 OF WORK-CONTEXT TO YL0225 OF WORK-CONTEXT
      *            *QUIT
                   GO SL5EXIT
               END-IF
               SET C-INDICATOR-OFF(90) TO TRUE
               READ COORDDEDL2 NEXT
                 FORMAT IS 'COORDDEDF2'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         COORDDEDF2 OF COORDDEDL2-R TO
                         EXTSL5
                       MOVE EXTSL5 TO KRSSL5-TMP
                       IF (KRSSL5 NOT = KRSSL5-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        Owning Account
               MOVE LOW-VALUES TO BBOWNACC OF EXTSL5
      *        Order Deduct Date Effect
               MOVE -99999999 TO BBCUSDEDEF OF EXTSL5
      *        SCP Model Code
               MOVE LOW-VALUES TO BBSCMDLCDE OF EXTSL5
      *        Count to Deduction Status
               MOVE -9 TO BBCNTDEDUC OF EXTSL5
           END-PERFORM
      *    USER: Exit processing
      *    U:Pay Cat 1 De-Order
           MOVE YL0228 OF WORK-CONTEXT TO YL0220 OF WORK-CONTEXT
      *    U:Pay Cat 2 De-Order
           MOVE YL0229 OF WORK-CONTEXT TO YL0221 OF WORK-CONTEXT
      *    U:Pay Cat 3 De-Order
           MOVE YL0230 OF WORK-CONTEXT TO YL0222 OF WORK-CONTEXT
      *    U:Pay Cat 4 De-Order
           MOVE YL0231 OF WORK-CONTEXT TO YL0223 OF WORK-CONTEXT
      *    U:Pay Cat 5 De-Order
           MOVE YL0232 OF WORK-CONTEXT TO YL0224 OF WORK-CONTEXT
      *    U:Pay Cat N De-Order
           MOVE YL0233 OF WORK-CONTEXT TO YL0226 OF WORK-CONTEXT
      *    U:Pay Cat O De-Order
           MOVE YL0234 OF WORK-CONTEXT TO YL0225 OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       SL5EXIT.
           EXIT.
      /EJECT
       SL6RVGN SECTION.
      *==============================================================
      *    Rtv Num of Deductions C/D - Customer Order Deduct VB  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    USER: Initialize routine
      *    Cvt *Job date to DTX
      *    * Job date contains a leading 1 when the year is 2000 or
      *      greater
      *    U:Job Date DTX
           ADD ZZJDT OF JOB-CONTEXT, 19000000 GIVING YL0236 OF
             WORK-CONTEXT
      *    U:Pay Cat 1 De-Order
           MOVE ZEROS TO YL0220 OF WORK-CONTEXT
      *    U:Pay Cat 2 De-Order
           MOVE ZEROS TO YL0221 OF WORK-CONTEXT
      *    U:Pay Cat 3 De-Order
           MOVE ZEROS TO YL0222 OF WORK-CONTEXT
      *    U:Pay Cat 4 De-Order
           MOVE ZEROS TO YL0223 OF WORK-CONTEXT
      *    U:Pay Cat 5 De-Order
           MOVE ZEROS TO YL0224 OF WORK-CONTEXT
      *    U:Pay Cat N De-Order
           MOVE ZEROS TO YL0226 OF WORK-CONTEXT
      *    U:Pay Cat O De-Order
           MOVE ZEROS TO YL0225 OF WORK-CONTEXT
      *    U:Pay Cat 1 De-Order
           MOVE ZEROS TO YL0237 OF WORK-CONTEXT
      *    U:Pay Cat 2 De-Order
           MOVE ZEROS TO YL0238 OF WORK-CONTEXT
      *    U:Pay Cat 3 De-Order
           MOVE ZEROS TO YL0239 OF WORK-CONTEXT
      *    U:Pay Cat 4 De-Order
           MOVE ZEROS TO YL0240 OF WORK-CONTEXT
      *    U:Pay Cat 5 De-Order
           MOVE ZEROS TO YL0241 OF WORK-CONTEXT
      *    U:Pay Cat N De-Order
           MOVE ZEROS TO YL0242 OF WORK-CONTEXT
      *    U:Pay Cat O De-Order
           MOVE ZEROS TO YL0243 OF WORK-CONTEXT
      *    Setup key
      *    Owning Account
           MOVE WUTOCF OF WORK-CONTEXT TO BBOWNACC OF KPSSL6
      *    Order Deduct Date Effect
           MOVE WUCUSORDD8 OF WORK-CONTEXT TO BBCUSDEDEF OF KPSSL6
           MOVE CORRESPONDING KPSSL6 TO KRSSL6
      *    Initialise Full Externally Described Keylist
      *    Owning Account
           MOVE LOW-VALUES TO BBOWNACC OF EXTSL6
      *    Order Deduct Date Effect
           MOVE -99999999 TO BBCUSDEDEF OF EXTSL6
      *    SCP Model Code
           MOVE LOW-VALUES TO BBSCMDLCDE OF EXTSL6
      *    Count to Deduction Status
           MOVE -9 TO BBCNTDEDUC OF EXTSL6
           MOVE CORRESPONDING
             EXTSL6 TO
             COORDDEDF2 OF COORDDEDL2-R
           MOVE CORRESPONDING
             KPSSL6 TO
             COORDDEDF2 OF COORDDEDL2-R
           START COORDDEDL2 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'COORDDEDF2'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ COORDDEDL2 NEXT
             FORMAT IS 'COORDDEDF2'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     COORDDEDF2 OF COORDDEDL2-R TO
                     EXTSL6
                   MOVE EXTSL6 TO KRSSL6-TMP
                   IF (KRSSL6 NOT = KRSSL6-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    Owning Account
           MOVE LOW-VALUES TO BBOWNACC OF EXTSL6
      *    Order Deduct Date Effect
           MOVE -99999999 TO BBCUSDEDEF OF EXTSL6
      *    SCP Model Code
           MOVE LOW-VALUES TO BBSCMDLCDE OF EXTSL6
      *    Count to Deduction Status
           MOVE -9 TO BBCNTDEDUC OF EXTSL6
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR7843' TO W0RTN
           END-IF
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        CASE: DB1.Order Deduct Date Effect LT PAR.U:To Date
      *          YYYYMMDD
      *        *IF
               IF (BBCUSDEDEF OF COORDDEDF2 OF COORDDEDL2-R < WUUTODTXD
                 OF WORK-CONTEXT) THEN
      *            Count Number of Deductions
      *            CASE:
      *            - NOTc1 AND c2
      *            |- c1    : DB1.Count to Deduction Status is *Do Not
      *              Count
      *            |- c2    : PAR.Customer Order Deduct Typ EQ
      *              DB1.Customer Order Deduct Typ
      *            '-
      *            *IF
                   IF (NOT (BBCNTDEDUC OF COORDDEDF2 OF COORDDEDL2-R =
                     0) AND
                       'D' = BBCODEDTYP OF COORDDEDF2 OF COORDDEDL2-R)
                     THEN
      *                U:Continue
                       MOVE 'Y' TO YL0244 OF WORK-CONTEXT
      *                Payment Status not NCNP
      *                CASE: DB1.Bonus Payment Status is NCNP
      *                *IF
                       IF (BBBNSPAYST OF COORDDEDF2 OF COORDDEDL2-R = 'N
      -                 'CNP') THEN
      *                    U:Continue
                           MOVE 'N' TO YL0244 OF WORK-CONTEXT
                       END-IF
      *                Check Target Type Deselection
      *                CASE: PAR.U:Target Prefix is Target total
      *                *IF
                       IF ('TT' = 'TT') THEN
                           CONTINUE
                       ELSE
      *                    CASE: PAR.U:Target Prefix is Target Local
      *                      Market
      *                    *IF
                           IF ('TT' = 'TL') THEN
      *                        CASE: DB1.Target Market is Local Market
      *                          Target List
      *                        *IF
                               IF (BBTGTMRKET OF COORDDEDF2 OF
                                 COORDDEDL2-R = 'L' OR
                                   BBTGTMRKET OF COORDDEDF2 OF
                                 COORDDEDL2-R = 'W' OR
                                   BBTGTMRKET OF COORDDEDF2 OF
                                 COORDDEDL2-R = 'R') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0244 OF WORK-CONTEXT
                               END-IF
                           ELSE
      *                        CASE: PAR.U:Target Prefix is Target
      *                          Major Fleet
      *                        *IF
                               IF ('TT' = 'TM') THEN
      *                        CASE: DB1.Target Market is Major Fleet
      *                          Target
      *                        *IF
                               IF (BBTGTMRKET OF COORDDEDF2 OF
                                 COORDDEDL2-R = 'M') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0244 OF WORK-CONTEXT
                               END-IF
                               END-IF
                           END-IF
                       END-IF
      *                Check Run Mode Count Type
      *                CASE: LCL.U:Continue is Yes
      *                *IF
                       IF (YL0244 OF WORK-CONTEXT = 'Y') THEN
      *                    CASE: PAR.U:Run Mode is *1
      *                    *IF
                           IF (YL0085 OF WORK-CONTEXT = '1') THEN
                               CONTINUE
                           ELSE
      *                        CASE: PAR.U:Run Mode is *2
      *                        *IF
                               IF (YL0085 OF WORK-CONTEXT = '2') THEN
      *                        CASE: DB1.Order Deduct Date Action LE
      *                          PAR.U:To Date YYYYMMDD
      *                        *IF
                               IF (BBCUSDEDAC OF COORDDEDF2 OF
                                 COORDDEDL2-R NOT > WUUTODTXD OF
                                 WORK-CONTEXT) THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0244 OF WORK-CONTEXT
                               END-IF
                               ELSE
      *                        CASE: PAR.U:Run Mode is *3
      *                        *IF
                               IF (YL0085 OF WORK-CONTEXT = '3') THEN
      *                        CASE: DB1.Order Deduct Date Action LE
      *                          PAR.U:To Date YYYYMMDD
      *                        *IF
                               IF (BBCUSDEDAC OF COORDDEDF2 OF
                                 COORDDEDL2-R NOT > WUUTODTXD OF
                                 WORK-CONTEXT) THEN
      *                        U:Continue
                               MOVE 'N' TO YL0244 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
                               CONTINUE
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
      *                Count
      *                CASE: LCL.U:Continue is Yes
      *                *IF
                       IF (YL0244 OF WORK-CONTEXT = 'Y') THEN
      *                    count
      *                    CASE: DB1.OBT Count Target Status is
      *                      Payment Category 1
      *                    *IF
                           IF (BBCNTTARG OF COORDDEDF2 OF COORDDEDL2-R
                             = '1') THEN
      *                        U:Pay Cat 1 De-Order
                               ADD YL0237 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0237 OF WORK-CONTEXT
                           ELSE
      *                        CASE: DB1.OBT Count Target Status is
      *                          Payment Category 2
      *                        *IF
                               IF (BBCNTTARG OF COORDDEDF2 OF
                                 COORDDEDL2-R = '2') THEN
      *                        U:Pay Cat 2 De-Order
                               ADD YL0238 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0238 OF WORK-CONTEXT
                               ELSE
      *                        CASE: DB1.OBT Count Target Status is
      *                          Payment Category 3
      *                        *IF
                               IF (BBCNTTARG OF COORDDEDF2 OF
                                 COORDDEDL2-R = '3') THEN
      *                        U:Pay Cat 3 De-Order
                               ADD YL0239 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0239 OF WORK-CONTEXT
                               ELSE
      *                        CASE: DB1.OBT Count Target Status is
      *                          Payment Category 4
      *                        *IF
                               IF (BBCNTTARG OF COORDDEDF2 OF
                                 COORDDEDL2-R = '4') THEN
      *                        U:Pay Cat 4 De-Order
                               ADD YL0240 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0240 OF WORK-CONTEXT
                               ELSE
      *                        CASE: DB1.OBT Count Target Status is
      *                          Payment Category 5
      *                        *IF
                               IF (BBCNTTARG OF COORDDEDF2 OF
                                 COORDDEDL2-R = '5') THEN
      *                        U:Pay Cat 5 De-Order
                               ADD YL0241 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0241 OF WORK-CONTEXT
                               ELSE
      *                        CASE: DB1.OBT Count Target Status is
      *                          Payment Category N - New
      *                        *IF
                               IF (BBCNTTARG OF COORDDEDF2 OF
                                 COORDDEDL2-R = 'N') THEN
      *                        U:Pay Cat N De-Order
                               ADD YL0242 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0242 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Pay Cat O De-Order
                               ADD YL0243 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0243 OF WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
                   END-IF
               ELSE
      *            CASE: *OTHERWISE
      *            U:Pay Cat 1 De-Order
                   MOVE YL0237 OF WORK-CONTEXT TO YL0220 OF WORK-CONTEXT
      *            U:Pay Cat 2 De-Order
                   MOVE YL0238 OF WORK-CONTEXT TO YL0221 OF WORK-CONTEXT
      *            U:Pay Cat 3 De-Order
                   MOVE YL0239 OF WORK-CONTEXT TO YL0222 OF WORK-CONTEXT
      *            U:Pay Cat 4 De-Order
                   MOVE YL0240 OF WORK-CONTEXT TO YL0223 OF WORK-CONTEXT
      *            U:Pay Cat 5 De-Order
                   MOVE YL0241 OF WORK-CONTEXT TO YL0224 OF WORK-CONTEXT
      *            U:Pay Cat N De-Order
                   MOVE YL0242 OF WORK-CONTEXT TO YL0226 OF WORK-CONTEXT
      *            U:Pay Cat O De-Order
                   MOVE YL0243 OF WORK-CONTEXT TO YL0225 OF WORK-CONTEXT
      *            *QUIT
                   GO SL6EXIT
               END-IF
               SET C-INDICATOR-OFF(90) TO TRUE
               READ COORDDEDL2 NEXT
                 FORMAT IS 'COORDDEDF2'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         COORDDEDF2 OF COORDDEDL2-R TO
                         EXTSL6
                       MOVE EXTSL6 TO KRSSL6-TMP
                       IF (KRSSL6 NOT = KRSSL6-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        Owning Account
               MOVE LOW-VALUES TO BBOWNACC OF EXTSL6
      *        Order Deduct Date Effect
               MOVE -99999999 TO BBCUSDEDEF OF EXTSL6
      *        SCP Model Code
               MOVE LOW-VALUES TO BBSCMDLCDE OF EXTSL6
      *        Count to Deduction Status
               MOVE -9 TO BBCNTDEDUC OF EXTSL6
           END-PERFORM
      *    USER: Exit processing
      *    U:Pay Cat 1 De-Order
           MOVE YL0237 OF WORK-CONTEXT TO YL0220 OF WORK-CONTEXT
      *    U:Pay Cat 2 De-Order
           MOVE YL0238 OF WORK-CONTEXT TO YL0221 OF WORK-CONTEXT
      *    U:Pay Cat 3 De-Order
           MOVE YL0239 OF WORK-CONTEXT TO YL0222 OF WORK-CONTEXT
      *    U:Pay Cat 4 De-Order
           MOVE YL0240 OF WORK-CONTEXT TO YL0223 OF WORK-CONTEXT
      *    U:Pay Cat 5 De-Order
           MOVE YL0241 OF WORK-CONTEXT TO YL0224 OF WORK-CONTEXT
      *    U:Pay Cat N De-Order
           MOVE YL0242 OF WORK-CONTEXT TO YL0226 OF WORK-CONTEXT
      *    U:Pay Cat O De-Order
           MOVE YL0243 OF WORK-CONTEXT TO YL0225 OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       SL6EXIT.
           EXIT.
      /EJECT
       SL7RVGN SECTION.
      *==============================================================
      *    Rtv Num of Deductions C/D - Customer Order Deduct VB  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    USER: Initialize routine
      *    Cvt *Job date to DTX
      *    * Job date contains a leading 1 when the year is 2000 or
      *      greater
      *    U:Job Date DTX
           ADD ZZJDT OF JOB-CONTEXT, 19000000 GIVING YL0236 OF
             WORK-CONTEXT
      *    U:Pay Cat 1 De-Order
           MOVE ZEROS TO YL0220 OF WORK-CONTEXT
      *    U:Pay Cat 2 De-Order
           MOVE ZEROS TO YL0221 OF WORK-CONTEXT
      *    U:Pay Cat 3 De-Order
           MOVE ZEROS TO YL0222 OF WORK-CONTEXT
      *    U:Pay Cat 4 De-Order
           MOVE ZEROS TO YL0223 OF WORK-CONTEXT
      *    U:Pay Cat 5 De-Order
           MOVE ZEROS TO YL0224 OF WORK-CONTEXT
      *    U:Pay Cat N De-Order
           MOVE ZEROS TO YL0226 OF WORK-CONTEXT
      *    U:Pay Cat O De-Order
           MOVE ZEROS TO YL0225 OF WORK-CONTEXT
      *    U:Pay Cat 1 De-Order
           MOVE ZEROS TO YL0237 OF WORK-CONTEXT
      *    U:Pay Cat 2 De-Order
           MOVE ZEROS TO YL0238 OF WORK-CONTEXT
      *    U:Pay Cat 3 De-Order
           MOVE ZEROS TO YL0239 OF WORK-CONTEXT
      *    U:Pay Cat 4 De-Order
           MOVE ZEROS TO YL0240 OF WORK-CONTEXT
      *    U:Pay Cat 5 De-Order
           MOVE ZEROS TO YL0241 OF WORK-CONTEXT
      *    U:Pay Cat N De-Order
           MOVE ZEROS TO YL0242 OF WORK-CONTEXT
      *    U:Pay Cat O De-Order
           MOVE ZEROS TO YL0243 OF WORK-CONTEXT
      *    Setup key
      *    Owning Account
           MOVE WUTOCF OF WORK-CONTEXT TO BBOWNACC OF KPSSL7
      *    Order Deduct Date Effect
           MOVE WUCUSORDD8 OF WORK-CONTEXT TO BBCUSDEDEF OF KPSSL7
           MOVE CORRESPONDING KPSSL7 TO KRSSL7
      *    Initialise Full Externally Described Keylist
      *    Owning Account
           MOVE LOW-VALUES TO BBOWNACC OF EXTSL7
      *    Order Deduct Date Effect
           MOVE -99999999 TO BBCUSDEDEF OF EXTSL7
      *    SCP Model Code
           MOVE LOW-VALUES TO BBSCMDLCDE OF EXTSL7
      *    Count to Deduction Status
           MOVE -9 TO BBCNTDEDUC OF EXTSL7
           MOVE CORRESPONDING
             EXTSL7 TO
             COORDDEDF2 OF COORDDEDL2-R
           MOVE CORRESPONDING
             KPSSL7 TO
             COORDDEDF2 OF COORDDEDL2-R
           START COORDDEDL2 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'COORDDEDF2'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ COORDDEDL2 NEXT
             FORMAT IS 'COORDDEDF2'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     COORDDEDF2 OF COORDDEDL2-R TO
                     EXTSL7
                   MOVE EXTSL7 TO KRSSL7-TMP
                   IF (KRSSL7 NOT = KRSSL7-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    Owning Account
           MOVE LOW-VALUES TO BBOWNACC OF EXTSL7
      *    Order Deduct Date Effect
           MOVE -99999999 TO BBCUSDEDEF OF EXTSL7
      *    SCP Model Code
           MOVE LOW-VALUES TO BBSCMDLCDE OF EXTSL7
      *    Count to Deduction Status
           MOVE -9 TO BBCNTDEDUC OF EXTSL7
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR7843' TO W0RTN
           END-IF
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        CASE: DB1.Order Deduct Date Effect LT PAR.U:To Date
      *          YYYYMMDD
      *        *IF
               IF (BBCUSDEDEF OF COORDDEDF2 OF COORDDEDL2-R < WUUTODTXD
                 OF WORK-CONTEXT) THEN
      *            Count Number of Deductions
      *            CASE:
      *            - NOTc1 AND c2
      *            |- c1    : DB1.Count to Deduction Status is *Do Not
      *              Count
      *            |- c2    : PAR.Customer Order Deduct Typ EQ
      *              DB1.Customer Order Deduct Typ
      *            '-
      *            *IF
                   IF (NOT (BBCNTDEDUC OF COORDDEDF2 OF COORDDEDL2-R =
                     0) AND
                       'C' = BBCODEDTYP OF COORDDEDF2 OF COORDDEDL2-R)
                     THEN
      *                U:Continue
                       MOVE 'Y' TO YL0244 OF WORK-CONTEXT
      *                Payment Status not NCNP
      *                CASE: DB1.Bonus Payment Status is NCNP
      *                *IF
                       IF (BBBNSPAYST OF COORDDEDF2 OF COORDDEDL2-R = 'N
      -                 'CNP') THEN
      *                    U:Continue
                           MOVE 'N' TO YL0244 OF WORK-CONTEXT
                       END-IF
      *                Check Target Type Deselection
      *                CASE: PAR.U:Target Prefix is Target total
      *                *IF
                       IF ('TT' = 'TT') THEN
                           CONTINUE
                       ELSE
      *                    CASE: PAR.U:Target Prefix is Target Local
      *                      Market
      *                    *IF
                           IF ('TT' = 'TL') THEN
      *                        CASE: DB1.Target Market is Local Market
      *                          Target List
      *                        *IF
                               IF (BBTGTMRKET OF COORDDEDF2 OF
                                 COORDDEDL2-R = 'L' OR
                                   BBTGTMRKET OF COORDDEDF2 OF
                                 COORDDEDL2-R = 'W' OR
                                   BBTGTMRKET OF COORDDEDF2 OF
                                 COORDDEDL2-R = 'R') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0244 OF WORK-CONTEXT
                               END-IF
                           ELSE
      *                        CASE: PAR.U:Target Prefix is Target
      *                          Major Fleet
      *                        *IF
                               IF ('TT' = 'TM') THEN
      *                        CASE: DB1.Target Market is Major Fleet
      *                          Target
      *                        *IF
                               IF (BBTGTMRKET OF COORDDEDF2 OF
                                 COORDDEDL2-R = 'M') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0244 OF WORK-CONTEXT
                               END-IF
                               END-IF
                           END-IF
                       END-IF
      *                Check Run Mode Count Type
      *                CASE: LCL.U:Continue is Yes
      *                *IF
                       IF (YL0244 OF WORK-CONTEXT = 'Y') THEN
      *                    CASE: PAR.U:Run Mode is *1
      *                    *IF
                           IF (YL0085 OF WORK-CONTEXT = '1') THEN
                               CONTINUE
                           ELSE
      *                        CASE: PAR.U:Run Mode is *2
      *                        *IF
                               IF (YL0085 OF WORK-CONTEXT = '2') THEN
      *                        CASE: DB1.Order Deduct Date Action LE
      *                          PAR.U:To Date YYYYMMDD
      *                        *IF
                               IF (BBCUSDEDAC OF COORDDEDF2 OF
                                 COORDDEDL2-R NOT > WUUTODTXD OF
                                 WORK-CONTEXT) THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0244 OF WORK-CONTEXT
                               END-IF
                               ELSE
      *                        CASE: PAR.U:Run Mode is *3
      *                        *IF
                               IF (YL0085 OF WORK-CONTEXT = '3') THEN
      *                        CASE: DB1.Order Deduct Date Action LE
      *                          PAR.U:To Date YYYYMMDD
      *                        *IF
                               IF (BBCUSDEDAC OF COORDDEDF2 OF
                                 COORDDEDL2-R NOT > WUUTODTXD OF
                                 WORK-CONTEXT) THEN
      *                        U:Continue
                               MOVE 'N' TO YL0244 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
                               CONTINUE
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
      *                Count
      *                CASE: LCL.U:Continue is Yes
      *                *IF
                       IF (YL0244 OF WORK-CONTEXT = 'Y') THEN
      *                    count
      *                    CASE: DB1.OBT Count Target Status is
      *                      Payment Category 1
      *                    *IF
                           IF (BBCNTTARG OF COORDDEDF2 OF COORDDEDL2-R
                             = '1') THEN
      *                        U:Pay Cat 1 De-Order
                               ADD YL0237 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0237 OF WORK-CONTEXT
                           ELSE
      *                        CASE: DB1.OBT Count Target Status is
      *                          Payment Category 2
      *                        *IF
                               IF (BBCNTTARG OF COORDDEDF2 OF
                                 COORDDEDL2-R = '2') THEN
      *                        U:Pay Cat 2 De-Order
                               ADD YL0238 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0238 OF WORK-CONTEXT
                               ELSE
      *                        CASE: DB1.OBT Count Target Status is
      *                          Payment Category 3
      *                        *IF
                               IF (BBCNTTARG OF COORDDEDF2 OF
                                 COORDDEDL2-R = '3') THEN
      *                        U:Pay Cat 3 De-Order
                               ADD YL0239 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0239 OF WORK-CONTEXT
                               ELSE
      *                        CASE: DB1.OBT Count Target Status is
      *                          Payment Category 4
      *                        *IF
                               IF (BBCNTTARG OF COORDDEDF2 OF
                                 COORDDEDL2-R = '4') THEN
      *                        U:Pay Cat 4 De-Order
                               ADD YL0240 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0240 OF WORK-CONTEXT
                               ELSE
      *                        CASE: DB1.OBT Count Target Status is
      *                          Payment Category 5
      *                        *IF
                               IF (BBCNTTARG OF COORDDEDF2 OF
                                 COORDDEDL2-R = '5') THEN
      *                        U:Pay Cat 5 De-Order
                               ADD YL0241 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0241 OF WORK-CONTEXT
                               ELSE
      *                        CASE: DB1.OBT Count Target Status is
      *                          Payment Category N - New
      *                        *IF
                               IF (BBCNTTARG OF COORDDEDF2 OF
                                 COORDDEDL2-R = 'N') THEN
      *                        U:Pay Cat N De-Order
                               ADD YL0242 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0242 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Pay Cat O De-Order
                               ADD YL0243 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0243 OF WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
                   END-IF
               ELSE
      *            CASE: *OTHERWISE
      *            U:Pay Cat 1 De-Order
                   MOVE YL0237 OF WORK-CONTEXT TO YL0220 OF WORK-CONTEXT
      *            U:Pay Cat 2 De-Order
                   MOVE YL0238 OF WORK-CONTEXT TO YL0221 OF WORK-CONTEXT
      *            U:Pay Cat 3 De-Order
                   MOVE YL0239 OF WORK-CONTEXT TO YL0222 OF WORK-CONTEXT
      *            U:Pay Cat 4 De-Order
                   MOVE YL0240 OF WORK-CONTEXT TO YL0223 OF WORK-CONTEXT
      *            U:Pay Cat 5 De-Order
                   MOVE YL0241 OF WORK-CONTEXT TO YL0224 OF WORK-CONTEXT
      *            U:Pay Cat N De-Order
                   MOVE YL0242 OF WORK-CONTEXT TO YL0226 OF WORK-CONTEXT
      *            U:Pay Cat O De-Order
                   MOVE YL0243 OF WORK-CONTEXT TO YL0225 OF WORK-CONTEXT
      *            *QUIT
                   GO SL7EXIT
               END-IF
               SET C-INDICATOR-OFF(90) TO TRUE
               READ COORDDEDL2 NEXT
                 FORMAT IS 'COORDDEDF2'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         COORDDEDF2 OF COORDDEDL2-R TO
                         EXTSL7
                       MOVE EXTSL7 TO KRSSL7-TMP
                       IF (KRSSL7 NOT = KRSSL7-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        Owning Account
               MOVE LOW-VALUES TO BBOWNACC OF EXTSL7
      *        Order Deduct Date Effect
               MOVE -99999999 TO BBCUSDEDEF OF EXTSL7
      *        SCP Model Code
               MOVE LOW-VALUES TO BBSCMDLCDE OF EXTSL7
      *        Count to Deduction Status
               MOVE -9 TO BBCNTDEDUC OF EXTSL7
           END-PERFORM
      *    USER: Exit processing
      *    U:Pay Cat 1 De-Order
           MOVE YL0237 OF WORK-CONTEXT TO YL0220 OF WORK-CONTEXT
      *    U:Pay Cat 2 De-Order
           MOVE YL0238 OF WORK-CONTEXT TO YL0221 OF WORK-CONTEXT
      *    U:Pay Cat 3 De-Order
           MOVE YL0239 OF WORK-CONTEXT TO YL0222 OF WORK-CONTEXT
      *    U:Pay Cat 4 De-Order
           MOVE YL0240 OF WORK-CONTEXT TO YL0223 OF WORK-CONTEXT
      *    U:Pay Cat 5 De-Order
           MOVE YL0241 OF WORK-CONTEXT TO YL0224 OF WORK-CONTEXT
      *    U:Pay Cat N De-Order
           MOVE YL0242 OF WORK-CONTEXT TO YL0226 OF WORK-CONTEXT
      *    U:Pay Cat O De-Order
           MOVE YL0243 OF WORK-CONTEXT TO YL0225 OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       SL7EXIT.
           EXIT.
      /EJECT
       SL8RVGN SECTION.
      *==============================================================
      *    Rtv Num of Deductions - Customer Order Deduct VB  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    USER: Initialize routine
      *    Cvt *Job date to DTX
      *    * Job date contains a leading 1 when the year is 2000 or
      *      greater
      *    U:Job Date DTX
           ADD ZZJDT OF JOB-CONTEXT, 19000000 GIVING YL0227 OF
             WORK-CONTEXT
      *    U:Pay Cat 1 De-Order
           MOVE ZEROS TO YL0220 OF WORK-CONTEXT
      *    U:Pay Cat 2 De-Order
           MOVE ZEROS TO YL0221 OF WORK-CONTEXT
      *    U:Pay Cat 3 De-Order
           MOVE ZEROS TO YL0222 OF WORK-CONTEXT
      *    U:Pay Cat 4 De-Order
           MOVE ZEROS TO YL0223 OF WORK-CONTEXT
      *    U:Pay Cat 5 De-Order
           MOVE ZEROS TO YL0224 OF WORK-CONTEXT
      *    U:Pay Cat N De-Order
           MOVE ZEROS TO YL0226 OF WORK-CONTEXT
      *    U:Pay Cat O De-Order
           MOVE ZEROS TO YL0225 OF WORK-CONTEXT
      *    U:Pay Cat 1 De-Order
           MOVE ZEROS TO YL0228 OF WORK-CONTEXT
      *    U:Pay Cat 2 De-Order
           MOVE ZEROS TO YL0229 OF WORK-CONTEXT
      *    U:Pay Cat 3 De-Order
           MOVE ZEROS TO YL0230 OF WORK-CONTEXT
      *    U:Pay Cat 4 De-Order
           MOVE ZEROS TO YL0231 OF WORK-CONTEXT
      *    U:Pay Cat 5 De-Order
           MOVE ZEROS TO YL0232 OF WORK-CONTEXT
      *    U:Pay Cat N De-Order
           MOVE ZEROS TO YL0233 OF WORK-CONTEXT
      *    U:Pay Cat O De-Order
           MOVE ZEROS TO YL0234 OF WORK-CONTEXT
      *    Setup key
      *    Owning Account
           MOVE WUNECO OF WORK-CONTEXT TO BBOWNACC OF KPSSL8
      *    Order Deduct Date Effect
           MOVE WUCUSORDD8 OF WORK-CONTEXT TO BBCUSDEDEF OF KPSSL8
           MOVE CORRESPONDING KPSSL8 TO KRSSL8
      *    Initialise Full Externally Described Keylist
      *    Owning Account
           MOVE LOW-VALUES TO BBOWNACC OF EXTSL8
      *    Order Deduct Date Effect
           MOVE -99999999 TO BBCUSDEDEF OF EXTSL8
      *    SCP Model Code
           MOVE LOW-VALUES TO BBSCMDLCDE OF EXTSL8
      *    Count to Deduction Status
           MOVE -9 TO BBCNTDEDUC OF EXTSL8
           MOVE CORRESPONDING
             EXTSL8 TO
             COORDDEDF2 OF COORDDEDL2-R
           MOVE CORRESPONDING
             KPSSL8 TO
             COORDDEDF2 OF COORDDEDL2-R
           START COORDDEDL2 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'COORDDEDF2'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ COORDDEDL2 NEXT
             FORMAT IS 'COORDDEDF2'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     COORDDEDF2 OF COORDDEDL2-R TO
                     EXTSL8
                   MOVE EXTSL8 TO KRSSL8-TMP
                   IF (KRSSL8 NOT = KRSSL8-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    Owning Account
           MOVE LOW-VALUES TO BBOWNACC OF EXTSL8
      *    Order Deduct Date Effect
           MOVE -99999999 TO BBCUSDEDEF OF EXTSL8
      *    SCP Model Code
           MOVE LOW-VALUES TO BBSCMDLCDE OF EXTSL8
      *    Count to Deduction Status
           MOVE -9 TO BBCNTDEDUC OF EXTSL8
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR7843' TO W0RTN
           END-IF
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        CASE: DB1.Order Deduct Date Effect LT PAR.U:To Date
      *          YYYYMMDD
      *        *IF
               IF (BBCUSDEDEF OF COORDDEDF2 OF COORDDEDL2-R < 20171231)
                 THEN
      *            Count Number of Deductions
      *            CASE:
      *            - NOTc1
      *            |- c1    : DB1.Count to Deduction Status is *Do Not
      *              Count
      *            '-
      *            *IF
                   IF (NOT (BBCNTDEDUC OF COORDDEDF2 OF COORDDEDL2-R =
                     0)) THEN
      *                U:Continue
                       MOVE 'Y' TO YL0235 OF WORK-CONTEXT
      *                Check Target Type Deselection
      *                CASE: PAR.U:Target Prefix is Target total
      *                *IF
                       IF ('TT' = 'TT') THEN
                           CONTINUE
                       ELSE
      *                    CASE: PAR.U:Target Prefix is Target Local
      *                      Market
      *                    *IF
                           IF ('TT' = 'TL') THEN
      *                        CASE: DB1.Target Market is Local Market
      *                          Target List
      *                        *IF
                               IF (BBTGTMRKET OF COORDDEDF2 OF
                                 COORDDEDL2-R = 'L' OR
                                   BBTGTMRKET OF COORDDEDF2 OF
                                 COORDDEDL2-R = 'W' OR
                                   BBTGTMRKET OF COORDDEDF2 OF
                                 COORDDEDL2-R = 'R') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0235 OF WORK-CONTEXT
                               END-IF
                           ELSE
      *                        CASE: PAR.U:Target Prefix is Target
      *                          Major Fleet
      *                        *IF
                               IF ('TT' = 'TM') THEN
      *                        CASE: DB1.Target Market is Major Fleet
      *                          Target
      *                        *IF
                               IF (BBTGTMRKET OF COORDDEDF2 OF
                                 COORDDEDL2-R = 'M') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0235 OF WORK-CONTEXT
                               END-IF
                               END-IF
                           END-IF
                       END-IF
      *                Check Run Mode Count Type
      *                CASE: LCL.U:Continue is Yes
      *                *IF
                       IF (YL0235 OF WORK-CONTEXT = 'Y') THEN
      *                    CASE: PAR.U:Run Mode is *1
      *                    *IF
                           IF ('2' = '1') THEN
                               CONTINUE
                           ELSE
      *                        CASE: PAR.U:Run Mode is *2
      *                        *IF
                               IF ('2' = '2') THEN
      *                        CASE: DB1.Order Deduct Date Action LE
      *                          PAR.U:To Date YYYYMMDD
      *                        *IF
                               IF (BBCUSDEDAC OF COORDDEDF2 OF
                                 COORDDEDL2-R NOT > 20171231) THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0235 OF WORK-CONTEXT
                               END-IF
                               ELSE
      *                        CASE: PAR.U:Run Mode is *3
      *                        *IF
                               IF ('2' = '3') THEN
      *                        CASE: DB1.Order Deduct Date Action LE
      *                          PAR.U:To Date YYYYMMDD
      *                        *IF
                               IF (BBCUSDEDAC OF COORDDEDF2 OF
                                 COORDDEDL2-R NOT > 20171231) THEN
      *                        U:Continue
                               MOVE 'N' TO YL0235 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
                               CONTINUE
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
      *                Count
      *                CASE: LCL.U:Continue is Yes
      *                *IF
                       IF (YL0235 OF WORK-CONTEXT = 'Y') THEN
      *                    count
      *                    CASE: DB1.OBT Count Target Status is
      *                      Payment Category 1
      *                    *IF
                           IF (BBCNTTARG OF COORDDEDF2 OF COORDDEDL2-R
                             = '1') THEN
      *                        U:Pay Cat 1 De-Order
                               ADD YL0228 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0228 OF WORK-CONTEXT
                           ELSE
      *                        CASE: DB1.OBT Count Target Status is
      *                          Payment Category 2
      *                        *IF
                               IF (BBCNTTARG OF COORDDEDF2 OF
                                 COORDDEDL2-R = '2') THEN
      *                        U:Pay Cat 2 De-Order
                               ADD YL0229 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0229 OF WORK-CONTEXT
                               ELSE
      *                        CASE: DB1.OBT Count Target Status is
      *                          Payment Category 3
      *                        *IF
                               IF (BBCNTTARG OF COORDDEDF2 OF
                                 COORDDEDL2-R = '3') THEN
      *                        U:Pay Cat 3 De-Order
                               ADD YL0230 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0230 OF WORK-CONTEXT
                               ELSE
      *                        CASE: DB1.OBT Count Target Status is
      *                          Payment Category 4
      *                        *IF
                               IF (BBCNTTARG OF COORDDEDF2 OF
                                 COORDDEDL2-R = '4') THEN
      *                        U:Pay Cat 4 De-Order
                               ADD YL0231 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0231 OF WORK-CONTEXT
                               ELSE
      *                        CASE: DB1.OBT Count Target Status is
      *                          Payment Category 5
      *                        *IF
                               IF (BBCNTTARG OF COORDDEDF2 OF
                                 COORDDEDL2-R = '5') THEN
      *                        U:Pay Cat 5 De-Order
                               ADD YL0232 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0232 OF WORK-CONTEXT
                               ELSE
      *                        CASE: DB1.OBT Count Target Status is
      *                          Payment Category N - New
      *                        *IF
                               IF (BBCNTTARG OF COORDDEDF2 OF
                                 COORDDEDL2-R = 'N') THEN
      *                        U:Pay Cat N De-Order
                               ADD YL0233 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0233 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Pay Cat O De-Order
                               ADD YL0234 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0234 OF WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
                   END-IF
               ELSE
      *            CASE: *OTHERWISE
      *            U:Pay Cat 1 De-Order
                   MOVE YL0228 OF WORK-CONTEXT TO YL0220 OF WORK-CONTEXT
      *            U:Pay Cat 2 De-Order
                   MOVE YL0229 OF WORK-CONTEXT TO YL0221 OF WORK-CONTEXT
      *            U:Pay Cat 3 De-Order
                   MOVE YL0230 OF WORK-CONTEXT TO YL0222 OF WORK-CONTEXT
      *            U:Pay Cat 4 De-Order
                   MOVE YL0231 OF WORK-CONTEXT TO YL0223 OF WORK-CONTEXT
      *            U:Pay Cat 5 De-Order
                   MOVE YL0232 OF WORK-CONTEXT TO YL0224 OF WORK-CONTEXT
      *            U:Pay Cat N De-Order
                   MOVE YL0233 OF WORK-CONTEXT TO YL0226 OF WORK-CONTEXT
      *            U:Pay Cat O De-Order
                   MOVE YL0234 OF WORK-CONTEXT TO YL0225 OF WORK-CONTEXT
      *            *QUIT
                   GO SL8EXIT
               END-IF
               SET C-INDICATOR-OFF(90) TO TRUE
               READ COORDDEDL2 NEXT
                 FORMAT IS 'COORDDEDF2'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         COORDDEDF2 OF COORDDEDL2-R TO
                         EXTSL8
                       MOVE EXTSL8 TO KRSSL8-TMP
                       IF (KRSSL8 NOT = KRSSL8-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        Owning Account
               MOVE LOW-VALUES TO BBOWNACC OF EXTSL8
      *        Order Deduct Date Effect
               MOVE -99999999 TO BBCUSDEDEF OF EXTSL8
      *        SCP Model Code
               MOVE LOW-VALUES TO BBSCMDLCDE OF EXTSL8
      *        Count to Deduction Status
               MOVE -9 TO BBCNTDEDUC OF EXTSL8
           END-PERFORM
      *    USER: Exit processing
      *    U:Pay Cat 1 De-Order
           MOVE YL0228 OF WORK-CONTEXT TO YL0220 OF WORK-CONTEXT
      *    U:Pay Cat 2 De-Order
           MOVE YL0229 OF WORK-CONTEXT TO YL0221 OF WORK-CONTEXT
      *    U:Pay Cat 3 De-Order
           MOVE YL0230 OF WORK-CONTEXT TO YL0222 OF WORK-CONTEXT
      *    U:Pay Cat 4 De-Order
           MOVE YL0231 OF WORK-CONTEXT TO YL0223 OF WORK-CONTEXT
      *    U:Pay Cat 5 De-Order
           MOVE YL0232 OF WORK-CONTEXT TO YL0224 OF WORK-CONTEXT
      *    U:Pay Cat N De-Order
           MOVE YL0233 OF WORK-CONTEXT TO YL0226 OF WORK-CONTEXT
      *    U:Pay Cat O De-Order
           MOVE YL0234 OF WORK-CONTEXT TO YL0225 OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       SL8EXIT.
           EXIT.
      /EJECT
       SL9RVGN SECTION.
      *==============================================================
      *    Rtv Num of Deductions C/D - Customer Order Deduct VB  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    USER: Initialize routine
      *    Cvt *Job date to DTX
      *    * Job date contains a leading 1 when the year is 2000 or
      *      greater
      *    U:Job Date DTX
           ADD ZZJDT OF JOB-CONTEXT, 19000000 GIVING YL0236 OF
             WORK-CONTEXT
      *    U:Pay Cat 1 De-Order
           MOVE ZEROS TO YL0220 OF WORK-CONTEXT
      *    U:Pay Cat 2 De-Order
           MOVE ZEROS TO YL0221 OF WORK-CONTEXT
      *    U:Pay Cat 3 De-Order
           MOVE ZEROS TO YL0222 OF WORK-CONTEXT
      *    U:Pay Cat 4 De-Order
           MOVE ZEROS TO YL0223 OF WORK-CONTEXT
      *    U:Pay Cat 5 De-Order
           MOVE ZEROS TO YL0224 OF WORK-CONTEXT
      *    U:Pay Cat N De-Order
           MOVE ZEROS TO YL0226 OF WORK-CONTEXT
      *    U:Pay Cat O De-Order
           MOVE ZEROS TO YL0225 OF WORK-CONTEXT
      *    U:Pay Cat 1 De-Order
           MOVE ZEROS TO YL0237 OF WORK-CONTEXT
      *    U:Pay Cat 2 De-Order
           MOVE ZEROS TO YL0238 OF WORK-CONTEXT
      *    U:Pay Cat 3 De-Order
           MOVE ZEROS TO YL0239 OF WORK-CONTEXT
      *    U:Pay Cat 4 De-Order
           MOVE ZEROS TO YL0240 OF WORK-CONTEXT
      *    U:Pay Cat 5 De-Order
           MOVE ZEROS TO YL0241 OF WORK-CONTEXT
      *    U:Pay Cat N De-Order
           MOVE ZEROS TO YL0242 OF WORK-CONTEXT
      *    U:Pay Cat O De-Order
           MOVE ZEROS TO YL0243 OF WORK-CONTEXT
      *    Setup key
      *    Owning Account
           MOVE WUNECO OF WORK-CONTEXT TO BBOWNACC OF KPSSL9
      *    Order Deduct Date Effect
           MOVE WUCUSORDD8 OF WORK-CONTEXT TO BBCUSDEDEF OF KPSSL9
           MOVE CORRESPONDING KPSSL9 TO KRSSL9
      *    Initialise Full Externally Described Keylist
      *    Owning Account
           MOVE LOW-VALUES TO BBOWNACC OF EXTSL9
      *    Order Deduct Date Effect
           MOVE -99999999 TO BBCUSDEDEF OF EXTSL9
      *    SCP Model Code
           MOVE LOW-VALUES TO BBSCMDLCDE OF EXTSL9
      *    Count to Deduction Status
           MOVE -9 TO BBCNTDEDUC OF EXTSL9
           MOVE CORRESPONDING
             EXTSL9 TO
             COORDDEDF2 OF COORDDEDL2-R
           MOVE CORRESPONDING
             KPSSL9 TO
             COORDDEDF2 OF COORDDEDL2-R
           START COORDDEDL2 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'COORDDEDF2'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ COORDDEDL2 NEXT
             FORMAT IS 'COORDDEDF2'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     COORDDEDF2 OF COORDDEDL2-R TO
                     EXTSL9
                   MOVE EXTSL9 TO KRSSL9-TMP
                   IF (KRSSL9 NOT = KRSSL9-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    Owning Account
           MOVE LOW-VALUES TO BBOWNACC OF EXTSL9
      *    Order Deduct Date Effect
           MOVE -99999999 TO BBCUSDEDEF OF EXTSL9
      *    SCP Model Code
           MOVE LOW-VALUES TO BBSCMDLCDE OF EXTSL9
      *    Count to Deduction Status
           MOVE -9 TO BBCNTDEDUC OF EXTSL9
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR7843' TO W0RTN
           END-IF
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        CASE: DB1.Order Deduct Date Effect LT PAR.U:To Date
      *          YYYYMMDD
      *        *IF
               IF (BBCUSDEDEF OF COORDDEDF2 OF COORDDEDL2-R < 20171231)
                 THEN
      *            Count Number of Deductions
      *            CASE:
      *            - NOTc1 AND c2
      *            |- c1    : DB1.Count to Deduction Status is *Do Not
      *              Count
      *            |- c2    : PAR.Customer Order Deduct Typ EQ
      *              DB1.Customer Order Deduct Typ
      *            '-
      *            *IF
                   IF (NOT (BBCNTDEDUC OF COORDDEDF2 OF COORDDEDL2-R =
                     0) AND
                       'D' = BBCODEDTYP OF COORDDEDF2 OF COORDDEDL2-R)
                     THEN
      *                U:Continue
                       MOVE 'Y' TO YL0244 OF WORK-CONTEXT
      *                Payment Status not NCNP
      *                CASE: DB1.Bonus Payment Status is NCNP
      *                *IF
                       IF (BBBNSPAYST OF COORDDEDF2 OF COORDDEDL2-R = 'N
      -                 'CNP') THEN
      *                    U:Continue
                           MOVE 'N' TO YL0244 OF WORK-CONTEXT
                       END-IF
      *                Check Target Type Deselection
      *                CASE: PAR.U:Target Prefix is Target total
      *                *IF
                       IF ('TT' = 'TT') THEN
                           CONTINUE
                       ELSE
      *                    CASE: PAR.U:Target Prefix is Target Local
      *                      Market
      *                    *IF
                           IF ('TT' = 'TL') THEN
      *                        CASE: DB1.Target Market is Local Market
      *                          Target List
      *                        *IF
                               IF (BBTGTMRKET OF COORDDEDF2 OF
                                 COORDDEDL2-R = 'L' OR
                                   BBTGTMRKET OF COORDDEDF2 OF
                                 COORDDEDL2-R = 'W' OR
                                   BBTGTMRKET OF COORDDEDF2 OF
                                 COORDDEDL2-R = 'R') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0244 OF WORK-CONTEXT
                               END-IF
                           ELSE
      *                        CASE: PAR.U:Target Prefix is Target
      *                          Major Fleet
      *                        *IF
                               IF ('TT' = 'TM') THEN
      *                        CASE: DB1.Target Market is Major Fleet
      *                          Target
      *                        *IF
                               IF (BBTGTMRKET OF COORDDEDF2 OF
                                 COORDDEDL2-R = 'M') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0244 OF WORK-CONTEXT
                               END-IF
                               END-IF
                           END-IF
                       END-IF
      *                Check Run Mode Count Type
      *                CASE: LCL.U:Continue is Yes
      *                *IF
                       IF (YL0244 OF WORK-CONTEXT = 'Y') THEN
      *                    CASE: PAR.U:Run Mode is *1
      *                    *IF
                           IF ('2' = '1') THEN
                               CONTINUE
                           ELSE
      *                        CASE: PAR.U:Run Mode is *2
      *                        *IF
                               IF ('2' = '2') THEN
      *                        CASE: DB1.Order Deduct Date Action LE
      *                          PAR.U:To Date YYYYMMDD
      *                        *IF
                               IF (BBCUSDEDAC OF COORDDEDF2 OF
                                 COORDDEDL2-R NOT > 20171231) THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0244 OF WORK-CONTEXT
                               END-IF
                               ELSE
      *                        CASE: PAR.U:Run Mode is *3
      *                        *IF
                               IF ('2' = '3') THEN
      *                        CASE: DB1.Order Deduct Date Action LE
      *                          PAR.U:To Date YYYYMMDD
      *                        *IF
                               IF (BBCUSDEDAC OF COORDDEDF2 OF
                                 COORDDEDL2-R NOT > 20171231) THEN
      *                        U:Continue
                               MOVE 'N' TO YL0244 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
                               CONTINUE
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
      *                Count
      *                CASE: LCL.U:Continue is Yes
      *                *IF
                       IF (YL0244 OF WORK-CONTEXT = 'Y') THEN
      *                    count
      *                    CASE: DB1.OBT Count Target Status is
      *                      Payment Category 1
      *                    *IF
                           IF (BBCNTTARG OF COORDDEDF2 OF COORDDEDL2-R
                             = '1') THEN
      *                        U:Pay Cat 1 De-Order
                               ADD YL0237 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0237 OF WORK-CONTEXT
                           ELSE
      *                        CASE: DB1.OBT Count Target Status is
      *                          Payment Category 2
      *                        *IF
                               IF (BBCNTTARG OF COORDDEDF2 OF
                                 COORDDEDL2-R = '2') THEN
      *                        U:Pay Cat 2 De-Order
                               ADD YL0238 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0238 OF WORK-CONTEXT
                               ELSE
      *                        CASE: DB1.OBT Count Target Status is
      *                          Payment Category 3
      *                        *IF
                               IF (BBCNTTARG OF COORDDEDF2 OF
                                 COORDDEDL2-R = '3') THEN
      *                        U:Pay Cat 3 De-Order
                               ADD YL0239 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0239 OF WORK-CONTEXT
                               ELSE
      *                        CASE: DB1.OBT Count Target Status is
      *                          Payment Category 4
      *                        *IF
                               IF (BBCNTTARG OF COORDDEDF2 OF
                                 COORDDEDL2-R = '4') THEN
      *                        U:Pay Cat 4 De-Order
                               ADD YL0240 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0240 OF WORK-CONTEXT
                               ELSE
      *                        CASE: DB1.OBT Count Target Status is
      *                          Payment Category 5
      *                        *IF
                               IF (BBCNTTARG OF COORDDEDF2 OF
                                 COORDDEDL2-R = '5') THEN
      *                        U:Pay Cat 5 De-Order
                               ADD YL0241 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0241 OF WORK-CONTEXT
                               ELSE
      *                        CASE: DB1.OBT Count Target Status is
      *                          Payment Category N - New
      *                        *IF
                               IF (BBCNTTARG OF COORDDEDF2 OF
                                 COORDDEDL2-R = 'N') THEN
      *                        U:Pay Cat N De-Order
                               ADD YL0242 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0242 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Pay Cat O De-Order
                               ADD YL0243 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0243 OF WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
                   END-IF
               ELSE
      *            CASE: *OTHERWISE
      *            U:Pay Cat 1 De-Order
                   MOVE YL0237 OF WORK-CONTEXT TO YL0220 OF WORK-CONTEXT
      *            U:Pay Cat 2 De-Order
                   MOVE YL0238 OF WORK-CONTEXT TO YL0221 OF WORK-CONTEXT
      *            U:Pay Cat 3 De-Order
                   MOVE YL0239 OF WORK-CONTEXT TO YL0222 OF WORK-CONTEXT
      *            U:Pay Cat 4 De-Order
                   MOVE YL0240 OF WORK-CONTEXT TO YL0223 OF WORK-CONTEXT
      *            U:Pay Cat 5 De-Order
                   MOVE YL0241 OF WORK-CONTEXT TO YL0224 OF WORK-CONTEXT
      *            U:Pay Cat N De-Order
                   MOVE YL0242 OF WORK-CONTEXT TO YL0226 OF WORK-CONTEXT
      *            U:Pay Cat O De-Order
                   MOVE YL0243 OF WORK-CONTEXT TO YL0225 OF WORK-CONTEXT
      *            *QUIT
                   GO SL9EXIT
               END-IF
               SET C-INDICATOR-OFF(90) TO TRUE
               READ COORDDEDL2 NEXT
                 FORMAT IS 'COORDDEDF2'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         COORDDEDF2 OF COORDDEDL2-R TO
                         EXTSL9
                       MOVE EXTSL9 TO KRSSL9-TMP
                       IF (KRSSL9 NOT = KRSSL9-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        Owning Account
               MOVE LOW-VALUES TO BBOWNACC OF EXTSL9
      *        Order Deduct Date Effect
               MOVE -99999999 TO BBCUSDEDEF OF EXTSL9
      *        SCP Model Code
               MOVE LOW-VALUES TO BBSCMDLCDE OF EXTSL9
      *        Count to Deduction Status
               MOVE -9 TO BBCNTDEDUC OF EXTSL9
           END-PERFORM
      *    USER: Exit processing
      *    U:Pay Cat 1 De-Order
           MOVE YL0237 OF WORK-CONTEXT TO YL0220 OF WORK-CONTEXT
      *    U:Pay Cat 2 De-Order
           MOVE YL0238 OF WORK-CONTEXT TO YL0221 OF WORK-CONTEXT
      *    U:Pay Cat 3 De-Order
           MOVE YL0239 OF WORK-CONTEXT TO YL0222 OF WORK-CONTEXT
      *    U:Pay Cat 4 De-Order
           MOVE YL0240 OF WORK-CONTEXT TO YL0223 OF WORK-CONTEXT
      *    U:Pay Cat 5 De-Order
           MOVE YL0241 OF WORK-CONTEXT TO YL0224 OF WORK-CONTEXT
      *    U:Pay Cat N De-Order
           MOVE YL0242 OF WORK-CONTEXT TO YL0226 OF WORK-CONTEXT
      *    U:Pay Cat O De-Order
           MOVE YL0243 OF WORK-CONTEXT TO YL0225 OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       SL9EXIT.
           EXIT.
      /EJECT
       SM1RVGN SECTION.
      *==============================================================
      *    Rtv Num of Deductions C/D - Customer Order Deduct VB  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    USER: Initialize routine
      *    Cvt *Job date to DTX
      *    * Job date contains a leading 1 when the year is 2000 or
      *      greater
      *    U:Job Date DTX
           ADD ZZJDT OF JOB-CONTEXT, 19000000 GIVING YL0236 OF
             WORK-CONTEXT
      *    U:Pay Cat 1 De-Order
           MOVE ZEROS TO YL0220 OF WORK-CONTEXT
      *    U:Pay Cat 2 De-Order
           MOVE ZEROS TO YL0221 OF WORK-CONTEXT
      *    U:Pay Cat 3 De-Order
           MOVE ZEROS TO YL0222 OF WORK-CONTEXT
      *    U:Pay Cat 4 De-Order
           MOVE ZEROS TO YL0223 OF WORK-CONTEXT
      *    U:Pay Cat 5 De-Order
           MOVE ZEROS TO YL0224 OF WORK-CONTEXT
      *    U:Pay Cat N De-Order
           MOVE ZEROS TO YL0226 OF WORK-CONTEXT
      *    U:Pay Cat O De-Order
           MOVE ZEROS TO YL0225 OF WORK-CONTEXT
      *    U:Pay Cat 1 De-Order
           MOVE ZEROS TO YL0237 OF WORK-CONTEXT
      *    U:Pay Cat 2 De-Order
           MOVE ZEROS TO YL0238 OF WORK-CONTEXT
      *    U:Pay Cat 3 De-Order
           MOVE ZEROS TO YL0239 OF WORK-CONTEXT
      *    U:Pay Cat 4 De-Order
           MOVE ZEROS TO YL0240 OF WORK-CONTEXT
      *    U:Pay Cat 5 De-Order
           MOVE ZEROS TO YL0241 OF WORK-CONTEXT
      *    U:Pay Cat N De-Order
           MOVE ZEROS TO YL0242 OF WORK-CONTEXT
      *    U:Pay Cat O De-Order
           MOVE ZEROS TO YL0243 OF WORK-CONTEXT
      *    Setup key
      *    Owning Account
           MOVE WUNECO OF WORK-CONTEXT TO BBOWNACC OF KPSSM1
      *    Order Deduct Date Effect
           MOVE WUCUSORDD8 OF WORK-CONTEXT TO BBCUSDEDEF OF KPSSM1
           MOVE CORRESPONDING KPSSM1 TO KRSSM1
      *    Initialise Full Externally Described Keylist
      *    Owning Account
           MOVE LOW-VALUES TO BBOWNACC OF EXTSM1
      *    Order Deduct Date Effect
           MOVE -99999999 TO BBCUSDEDEF OF EXTSM1
      *    SCP Model Code
           MOVE LOW-VALUES TO BBSCMDLCDE OF EXTSM1
      *    Count to Deduction Status
           MOVE -9 TO BBCNTDEDUC OF EXTSM1
           MOVE CORRESPONDING
             EXTSM1 TO
             COORDDEDF2 OF COORDDEDL2-R
           MOVE CORRESPONDING
             KPSSM1 TO
             COORDDEDF2 OF COORDDEDL2-R
           START COORDDEDL2 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'COORDDEDF2'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ COORDDEDL2 NEXT
             FORMAT IS 'COORDDEDF2'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     COORDDEDF2 OF COORDDEDL2-R TO
                     EXTSM1
                   MOVE EXTSM1 TO KRSSM1-TMP
                   IF (KRSSM1 NOT = KRSSM1-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    Owning Account
           MOVE LOW-VALUES TO BBOWNACC OF EXTSM1
      *    Order Deduct Date Effect
           MOVE -99999999 TO BBCUSDEDEF OF EXTSM1
      *    SCP Model Code
           MOVE LOW-VALUES TO BBSCMDLCDE OF EXTSM1
      *    Count to Deduction Status
           MOVE -9 TO BBCNTDEDUC OF EXTSM1
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR7843' TO W0RTN
           END-IF
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        CASE: DB1.Order Deduct Date Effect LT PAR.U:To Date
      *          YYYYMMDD
      *        *IF
               IF (BBCUSDEDEF OF COORDDEDF2 OF COORDDEDL2-R < 20171231)
                 THEN
      *            Count Number of Deductions
      *            CASE:
      *            - NOTc1 AND c2
      *            |- c1    : DB1.Count to Deduction Status is *Do Not
      *              Count
      *            |- c2    : PAR.Customer Order Deduct Typ EQ
      *              DB1.Customer Order Deduct Typ
      *            '-
      *            *IF
                   IF (NOT (BBCNTDEDUC OF COORDDEDF2 OF COORDDEDL2-R =
                     0) AND
                       'C' = BBCODEDTYP OF COORDDEDF2 OF COORDDEDL2-R)
                     THEN
      *                U:Continue
                       MOVE 'Y' TO YL0244 OF WORK-CONTEXT
      *                Payment Status not NCNP
      *                CASE: DB1.Bonus Payment Status is NCNP
      *                *IF
                       IF (BBBNSPAYST OF COORDDEDF2 OF COORDDEDL2-R = 'N
      -                 'CNP') THEN
      *                    U:Continue
                           MOVE 'N' TO YL0244 OF WORK-CONTEXT
                       END-IF
      *                Check Target Type Deselection
      *                CASE: PAR.U:Target Prefix is Target total
      *                *IF
                       IF ('TT' = 'TT') THEN
                           CONTINUE
                       ELSE
      *                    CASE: PAR.U:Target Prefix is Target Local
      *                      Market
      *                    *IF
                           IF ('TT' = 'TL') THEN
      *                        CASE: DB1.Target Market is Local Market
      *                          Target List
      *                        *IF
                               IF (BBTGTMRKET OF COORDDEDF2 OF
                                 COORDDEDL2-R = 'L' OR
                                   BBTGTMRKET OF COORDDEDF2 OF
                                 COORDDEDL2-R = 'W' OR
                                   BBTGTMRKET OF COORDDEDF2 OF
                                 COORDDEDL2-R = 'R') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0244 OF WORK-CONTEXT
                               END-IF
                           ELSE
      *                        CASE: PAR.U:Target Prefix is Target
      *                          Major Fleet
      *                        *IF
                               IF ('TT' = 'TM') THEN
      *                        CASE: DB1.Target Market is Major Fleet
      *                          Target
      *                        *IF
                               IF (BBTGTMRKET OF COORDDEDF2 OF
                                 COORDDEDL2-R = 'M') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0244 OF WORK-CONTEXT
                               END-IF
                               END-IF
                           END-IF
                       END-IF
      *                Check Run Mode Count Type
      *                CASE: LCL.U:Continue is Yes
      *                *IF
                       IF (YL0244 OF WORK-CONTEXT = 'Y') THEN
      *                    CASE: PAR.U:Run Mode is *1
      *                    *IF
                           IF ('2' = '1') THEN
                               CONTINUE
                           ELSE
      *                        CASE: PAR.U:Run Mode is *2
      *                        *IF
                               IF ('2' = '2') THEN
      *                        CASE: DB1.Order Deduct Date Action LE
      *                          PAR.U:To Date YYYYMMDD
      *                        *IF
                               IF (BBCUSDEDAC OF COORDDEDF2 OF
                                 COORDDEDL2-R NOT > 20171231) THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0244 OF WORK-CONTEXT
                               END-IF
                               ELSE
      *                        CASE: PAR.U:Run Mode is *3
      *                        *IF
                               IF ('2' = '3') THEN
      *                        CASE: DB1.Order Deduct Date Action LE
      *                          PAR.U:To Date YYYYMMDD
      *                        *IF
                               IF (BBCUSDEDAC OF COORDDEDF2 OF
                                 COORDDEDL2-R NOT > 20171231) THEN
      *                        U:Continue
                               MOVE 'N' TO YL0244 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
                               CONTINUE
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
      *                Count
      *                CASE: LCL.U:Continue is Yes
      *                *IF
                       IF (YL0244 OF WORK-CONTEXT = 'Y') THEN
      *                    count
      *                    CASE: DB1.OBT Count Target Status is
      *                      Payment Category 1
      *                    *IF
                           IF (BBCNTTARG OF COORDDEDF2 OF COORDDEDL2-R
                             = '1') THEN
      *                        U:Pay Cat 1 De-Order
                               ADD YL0237 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0237 OF WORK-CONTEXT
                           ELSE
      *                        CASE: DB1.OBT Count Target Status is
      *                          Payment Category 2
      *                        *IF
                               IF (BBCNTTARG OF COORDDEDF2 OF
                                 COORDDEDL2-R = '2') THEN
      *                        U:Pay Cat 2 De-Order
                               ADD YL0238 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0238 OF WORK-CONTEXT
                               ELSE
      *                        CASE: DB1.OBT Count Target Status is
      *                          Payment Category 3
      *                        *IF
                               IF (BBCNTTARG OF COORDDEDF2 OF
                                 COORDDEDL2-R = '3') THEN
      *                        U:Pay Cat 3 De-Order
                               ADD YL0239 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0239 OF WORK-CONTEXT
                               ELSE
      *                        CASE: DB1.OBT Count Target Status is
      *                          Payment Category 4
      *                        *IF
                               IF (BBCNTTARG OF COORDDEDF2 OF
                                 COORDDEDL2-R = '4') THEN
      *                        U:Pay Cat 4 De-Order
                               ADD YL0240 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0240 OF WORK-CONTEXT
                               ELSE
      *                        CASE: DB1.OBT Count Target Status is
      *                          Payment Category 5
      *                        *IF
                               IF (BBCNTTARG OF COORDDEDF2 OF
                                 COORDDEDL2-R = '5') THEN
      *                        U:Pay Cat 5 De-Order
                               ADD YL0241 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0241 OF WORK-CONTEXT
                               ELSE
      *                        CASE: DB1.OBT Count Target Status is
      *                          Payment Category N - New
      *                        *IF
                               IF (BBCNTTARG OF COORDDEDF2 OF
                                 COORDDEDL2-R = 'N') THEN
      *                        U:Pay Cat N De-Order
                               ADD YL0242 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0242 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Pay Cat O De-Order
                               ADD YL0243 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0243 OF WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
                   END-IF
               ELSE
      *            CASE: *OTHERWISE
      *            U:Pay Cat 1 De-Order
                   MOVE YL0237 OF WORK-CONTEXT TO YL0220 OF WORK-CONTEXT
      *            U:Pay Cat 2 De-Order
                   MOVE YL0238 OF WORK-CONTEXT TO YL0221 OF WORK-CONTEXT
      *            U:Pay Cat 3 De-Order
                   MOVE YL0239 OF WORK-CONTEXT TO YL0222 OF WORK-CONTEXT
      *            U:Pay Cat 4 De-Order
                   MOVE YL0240 OF WORK-CONTEXT TO YL0223 OF WORK-CONTEXT
      *            U:Pay Cat 5 De-Order
                   MOVE YL0241 OF WORK-CONTEXT TO YL0224 OF WORK-CONTEXT
      *            U:Pay Cat N De-Order
                   MOVE YL0242 OF WORK-CONTEXT TO YL0226 OF WORK-CONTEXT
      *            U:Pay Cat O De-Order
                   MOVE YL0243 OF WORK-CONTEXT TO YL0225 OF WORK-CONTEXT
      *            *QUIT
                   GO SM1EXIT
               END-IF
               SET C-INDICATOR-OFF(90) TO TRUE
               READ COORDDEDL2 NEXT
                 FORMAT IS 'COORDDEDF2'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         COORDDEDF2 OF COORDDEDL2-R TO
                         EXTSM1
                       MOVE EXTSM1 TO KRSSM1-TMP
                       IF (KRSSM1 NOT = KRSSM1-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        Owning Account
               MOVE LOW-VALUES TO BBOWNACC OF EXTSM1
      *        Order Deduct Date Effect
               MOVE -99999999 TO BBCUSDEDEF OF EXTSM1
      *        SCP Model Code
               MOVE LOW-VALUES TO BBSCMDLCDE OF EXTSM1
      *        Count to Deduction Status
               MOVE -9 TO BBCNTDEDUC OF EXTSM1
           END-PERFORM
      *    USER: Exit processing
      *    U:Pay Cat 1 De-Order
           MOVE YL0237 OF WORK-CONTEXT TO YL0220 OF WORK-CONTEXT
      *    U:Pay Cat 2 De-Order
           MOVE YL0238 OF WORK-CONTEXT TO YL0221 OF WORK-CONTEXT
      *    U:Pay Cat 3 De-Order
           MOVE YL0239 OF WORK-CONTEXT TO YL0222 OF WORK-CONTEXT
      *    U:Pay Cat 4 De-Order
           MOVE YL0240 OF WORK-CONTEXT TO YL0223 OF WORK-CONTEXT
      *    U:Pay Cat 5 De-Order
           MOVE YL0241 OF WORK-CONTEXT TO YL0224 OF WORK-CONTEXT
      *    U:Pay Cat N De-Order
           MOVE YL0242 OF WORK-CONTEXT TO YL0226 OF WORK-CONTEXT
      *    U:Pay Cat O De-Order
           MOVE YL0243 OF WORK-CONTEXT TO YL0225 OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       SM1EXIT.
           EXIT.
      /EJECT
       SM2RVGN SECTION.
      *==============================================================
      *    Rtv Num of Deductions - Customer Order Deduct VB  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    USER: Initialize routine
      *    Cvt *Job date to DTX
      *    * Job date contains a leading 1 when the year is 2000 or
      *      greater
      *    U:Job Date DTX
           ADD ZZJDT OF JOB-CONTEXT, 19000000 GIVING YL0227 OF
             WORK-CONTEXT
      *    U:Pay Cat 1 De-Order
           MOVE ZEROS TO YL0220 OF WORK-CONTEXT
      *    U:Pay Cat 2 De-Order
           MOVE ZEROS TO YL0221 OF WORK-CONTEXT
      *    U:Pay Cat 3 De-Order
           MOVE ZEROS TO YL0222 OF WORK-CONTEXT
      *    U:Pay Cat 4 De-Order
           MOVE ZEROS TO YL0223 OF WORK-CONTEXT
      *    U:Pay Cat 5 De-Order
           MOVE ZEROS TO YL0224 OF WORK-CONTEXT
      *    U:Pay Cat N De-Order
           MOVE ZEROS TO YL0226 OF WORK-CONTEXT
      *    U:Pay Cat O De-Order
           MOVE ZEROS TO YL0225 OF WORK-CONTEXT
      *    U:Pay Cat 1 De-Order
           MOVE ZEROS TO YL0228 OF WORK-CONTEXT
      *    U:Pay Cat 2 De-Order
           MOVE ZEROS TO YL0229 OF WORK-CONTEXT
      *    U:Pay Cat 3 De-Order
           MOVE ZEROS TO YL0230 OF WORK-CONTEXT
      *    U:Pay Cat 4 De-Order
           MOVE ZEROS TO YL0231 OF WORK-CONTEXT
      *    U:Pay Cat 5 De-Order
           MOVE ZEROS TO YL0232 OF WORK-CONTEXT
      *    U:Pay Cat N De-Order
           MOVE ZEROS TO YL0233 OF WORK-CONTEXT
      *    U:Pay Cat O De-Order
           MOVE ZEROS TO YL0234 OF WORK-CONTEXT
      *    Setup key
      *    Owning Account
           MOVE WUTOCF OF WORK-CONTEXT TO BBOWNACC OF KPSSM2
      *    Order Deduct Date Effect
           MOVE WUCUSORDD8 OF WORK-CONTEXT TO BBCUSDEDEF OF KPSSM2
           MOVE CORRESPONDING KPSSM2 TO KRSSM2
      *    Initialise Full Externally Described Keylist
      *    Owning Account
           MOVE LOW-VALUES TO BBOWNACC OF EXTSM2
      *    Order Deduct Date Effect
           MOVE -99999999 TO BBCUSDEDEF OF EXTSM2
      *    SCP Model Code
           MOVE LOW-VALUES TO BBSCMDLCDE OF EXTSM2
      *    Count to Deduction Status
           MOVE -9 TO BBCNTDEDUC OF EXTSM2
           MOVE CORRESPONDING
             EXTSM2 TO
             COORDDEDF2 OF COORDDEDL2-R
           MOVE CORRESPONDING
             KPSSM2 TO
             COORDDEDF2 OF COORDDEDL2-R
           START COORDDEDL2 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'COORDDEDF2'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ COORDDEDL2 NEXT
             FORMAT IS 'COORDDEDF2'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     COORDDEDF2 OF COORDDEDL2-R TO
                     EXTSM2
                   MOVE EXTSM2 TO KRSSM2-TMP
                   IF (KRSSM2 NOT = KRSSM2-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    Owning Account
           MOVE LOW-VALUES TO BBOWNACC OF EXTSM2
      *    Order Deduct Date Effect
           MOVE -99999999 TO BBCUSDEDEF OF EXTSM2
      *    SCP Model Code
           MOVE LOW-VALUES TO BBSCMDLCDE OF EXTSM2
      *    Count to Deduction Status
           MOVE -9 TO BBCNTDEDUC OF EXTSM2
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR7843' TO W0RTN
           END-IF
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        CASE: DB1.Order Deduct Date Effect LT PAR.U:To Date
      *          YYYYMMDD
      *        *IF
               IF (BBCUSDEDEF OF COORDDEDF2 OF COORDDEDL2-R < 20171231)
                 THEN
      *            Count Number of Deductions
      *            CASE:
      *            - NOTc1
      *            |- c1    : DB1.Count to Deduction Status is *Do Not
      *              Count
      *            '-
      *            *IF
                   IF (NOT (BBCNTDEDUC OF COORDDEDF2 OF COORDDEDL2-R =
                     0)) THEN
      *                U:Continue
                       MOVE 'Y' TO YL0235 OF WORK-CONTEXT
      *                Check Target Type Deselection
      *                CASE: PAR.U:Target Prefix is Target total
      *                *IF
                       IF ('TT' = 'TT') THEN
                           CONTINUE
                       ELSE
      *                    CASE: PAR.U:Target Prefix is Target Local
      *                      Market
      *                    *IF
                           IF ('TT' = 'TL') THEN
      *                        CASE: DB1.Target Market is Local Market
      *                          Target List
      *                        *IF
                               IF (BBTGTMRKET OF COORDDEDF2 OF
                                 COORDDEDL2-R = 'L' OR
                                   BBTGTMRKET OF COORDDEDF2 OF
                                 COORDDEDL2-R = 'W' OR
                                   BBTGTMRKET OF COORDDEDF2 OF
                                 COORDDEDL2-R = 'R') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0235 OF WORK-CONTEXT
                               END-IF
                           ELSE
      *                        CASE: PAR.U:Target Prefix is Target
      *                          Major Fleet
      *                        *IF
                               IF ('TT' = 'TM') THEN
      *                        CASE: DB1.Target Market is Major Fleet
      *                          Target
      *                        *IF
                               IF (BBTGTMRKET OF COORDDEDF2 OF
                                 COORDDEDL2-R = 'M') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0235 OF WORK-CONTEXT
                               END-IF
                               END-IF
                           END-IF
                       END-IF
      *                Check Run Mode Count Type
      *                CASE: LCL.U:Continue is Yes
      *                *IF
                       IF (YL0235 OF WORK-CONTEXT = 'Y') THEN
      *                    CASE: PAR.U:Run Mode is *1
      *                    *IF
                           IF ('2' = '1') THEN
                               CONTINUE
                           ELSE
      *                        CASE: PAR.U:Run Mode is *2
      *                        *IF
                               IF ('2' = '2') THEN
      *                        CASE: DB1.Order Deduct Date Action LE
      *                          PAR.U:To Date YYYYMMDD
      *                        *IF
                               IF (BBCUSDEDAC OF COORDDEDF2 OF
                                 COORDDEDL2-R NOT > 20171231) THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0235 OF WORK-CONTEXT
                               END-IF
                               ELSE
      *                        CASE: PAR.U:Run Mode is *3
      *                        *IF
                               IF ('2' = '3') THEN
      *                        CASE: DB1.Order Deduct Date Action LE
      *                          PAR.U:To Date YYYYMMDD
      *                        *IF
                               IF (BBCUSDEDAC OF COORDDEDF2 OF
                                 COORDDEDL2-R NOT > 20171231) THEN
      *                        U:Continue
                               MOVE 'N' TO YL0235 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
                               CONTINUE
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
      *                Count
      *                CASE: LCL.U:Continue is Yes
      *                *IF
                       IF (YL0235 OF WORK-CONTEXT = 'Y') THEN
      *                    count
      *                    CASE: DB1.OBT Count Target Status is
      *                      Payment Category 1
      *                    *IF
                           IF (BBCNTTARG OF COORDDEDF2 OF COORDDEDL2-R
                             = '1') THEN
      *                        U:Pay Cat 1 De-Order
                               ADD YL0228 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0228 OF WORK-CONTEXT
                           ELSE
      *                        CASE: DB1.OBT Count Target Status is
      *                          Payment Category 2
      *                        *IF
                               IF (BBCNTTARG OF COORDDEDF2 OF
                                 COORDDEDL2-R = '2') THEN
      *                        U:Pay Cat 2 De-Order
                               ADD YL0229 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0229 OF WORK-CONTEXT
                               ELSE
      *                        CASE: DB1.OBT Count Target Status is
      *                          Payment Category 3
      *                        *IF
                               IF (BBCNTTARG OF COORDDEDF2 OF
                                 COORDDEDL2-R = '3') THEN
      *                        U:Pay Cat 3 De-Order
                               ADD YL0230 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0230 OF WORK-CONTEXT
                               ELSE
      *                        CASE: DB1.OBT Count Target Status is
      *                          Payment Category 4
      *                        *IF
                               IF (BBCNTTARG OF COORDDEDF2 OF
                                 COORDDEDL2-R = '4') THEN
      *                        U:Pay Cat 4 De-Order
                               ADD YL0231 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0231 OF WORK-CONTEXT
                               ELSE
      *                        CASE: DB1.OBT Count Target Status is
      *                          Payment Category 5
      *                        *IF
                               IF (BBCNTTARG OF COORDDEDF2 OF
                                 COORDDEDL2-R = '5') THEN
      *                        U:Pay Cat 5 De-Order
                               ADD YL0232 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0232 OF WORK-CONTEXT
                               ELSE
      *                        CASE: DB1.OBT Count Target Status is
      *                          Payment Category N - New
      *                        *IF
                               IF (BBCNTTARG OF COORDDEDF2 OF
                                 COORDDEDL2-R = 'N') THEN
      *                        U:Pay Cat N De-Order
                               ADD YL0233 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0233 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Pay Cat O De-Order
                               ADD YL0234 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0234 OF WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
                   END-IF
               ELSE
      *            CASE: *OTHERWISE
      *            U:Pay Cat 1 De-Order
                   MOVE YL0228 OF WORK-CONTEXT TO YL0220 OF WORK-CONTEXT
      *            U:Pay Cat 2 De-Order
                   MOVE YL0229 OF WORK-CONTEXT TO YL0221 OF WORK-CONTEXT
      *            U:Pay Cat 3 De-Order
                   MOVE YL0230 OF WORK-CONTEXT TO YL0222 OF WORK-CONTEXT
      *            U:Pay Cat 4 De-Order
                   MOVE YL0231 OF WORK-CONTEXT TO YL0223 OF WORK-CONTEXT
      *            U:Pay Cat 5 De-Order
                   MOVE YL0232 OF WORK-CONTEXT TO YL0224 OF WORK-CONTEXT
      *            U:Pay Cat N De-Order
                   MOVE YL0233 OF WORK-CONTEXT TO YL0226 OF WORK-CONTEXT
      *            U:Pay Cat O De-Order
                   MOVE YL0234 OF WORK-CONTEXT TO YL0225 OF WORK-CONTEXT
      *            *QUIT
                   GO SM2EXIT
               END-IF
               SET C-INDICATOR-OFF(90) TO TRUE
               READ COORDDEDL2 NEXT
                 FORMAT IS 'COORDDEDF2'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         COORDDEDF2 OF COORDDEDL2-R TO
                         EXTSM2
                       MOVE EXTSM2 TO KRSSM2-TMP
                       IF (KRSSM2 NOT = KRSSM2-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        Owning Account
               MOVE LOW-VALUES TO BBOWNACC OF EXTSM2
      *        Order Deduct Date Effect
               MOVE -99999999 TO BBCUSDEDEF OF EXTSM2
      *        SCP Model Code
               MOVE LOW-VALUES TO BBSCMDLCDE OF EXTSM2
      *        Count to Deduction Status
               MOVE -9 TO BBCNTDEDUC OF EXTSM2
           END-PERFORM
      *    USER: Exit processing
      *    U:Pay Cat 1 De-Order
           MOVE YL0228 OF WORK-CONTEXT TO YL0220 OF WORK-CONTEXT
      *    U:Pay Cat 2 De-Order
           MOVE YL0229 OF WORK-CONTEXT TO YL0221 OF WORK-CONTEXT
      *    U:Pay Cat 3 De-Order
           MOVE YL0230 OF WORK-CONTEXT TO YL0222 OF WORK-CONTEXT
      *    U:Pay Cat 4 De-Order
           MOVE YL0231 OF WORK-CONTEXT TO YL0223 OF WORK-CONTEXT
      *    U:Pay Cat 5 De-Order
           MOVE YL0232 OF WORK-CONTEXT TO YL0224 OF WORK-CONTEXT
      *    U:Pay Cat N De-Order
           MOVE YL0233 OF WORK-CONTEXT TO YL0226 OF WORK-CONTEXT
      *    U:Pay Cat O De-Order
           MOVE YL0234 OF WORK-CONTEXT TO YL0225 OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       SM2EXIT.
           EXIT.
      /EJECT
       SM3RVGN SECTION.
      *==============================================================
      *    Rtv Num of Deductions C/D - Customer Order Deduct VB  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    USER: Initialize routine
      *    Cvt *Job date to DTX
      *    * Job date contains a leading 1 when the year is 2000 or
      *      greater
      *    U:Job Date DTX
           ADD ZZJDT OF JOB-CONTEXT, 19000000 GIVING YL0236 OF
             WORK-CONTEXT
      *    U:Pay Cat 1 De-Order
           MOVE ZEROS TO YL0220 OF WORK-CONTEXT
      *    U:Pay Cat 2 De-Order
           MOVE ZEROS TO YL0221 OF WORK-CONTEXT
      *    U:Pay Cat 3 De-Order
           MOVE ZEROS TO YL0222 OF WORK-CONTEXT
      *    U:Pay Cat 4 De-Order
           MOVE ZEROS TO YL0223 OF WORK-CONTEXT
      *    U:Pay Cat 5 De-Order
           MOVE ZEROS TO YL0224 OF WORK-CONTEXT
      *    U:Pay Cat N De-Order
           MOVE ZEROS TO YL0226 OF WORK-CONTEXT
      *    U:Pay Cat O De-Order
           MOVE ZEROS TO YL0225 OF WORK-CONTEXT
      *    U:Pay Cat 1 De-Order
           MOVE ZEROS TO YL0237 OF WORK-CONTEXT
      *    U:Pay Cat 2 De-Order
           MOVE ZEROS TO YL0238 OF WORK-CONTEXT
      *    U:Pay Cat 3 De-Order
           MOVE ZEROS TO YL0239 OF WORK-CONTEXT
      *    U:Pay Cat 4 De-Order
           MOVE ZEROS TO YL0240 OF WORK-CONTEXT
      *    U:Pay Cat 5 De-Order
           MOVE ZEROS TO YL0241 OF WORK-CONTEXT
      *    U:Pay Cat N De-Order
           MOVE ZEROS TO YL0242 OF WORK-CONTEXT
      *    U:Pay Cat O De-Order
           MOVE ZEROS TO YL0243 OF WORK-CONTEXT
      *    Setup key
      *    Owning Account
           MOVE WUTOCF OF WORK-CONTEXT TO BBOWNACC OF KPSSM3
      *    Order Deduct Date Effect
           MOVE WUCUSORDD8 OF WORK-CONTEXT TO BBCUSDEDEF OF KPSSM3
           MOVE CORRESPONDING KPSSM3 TO KRSSM3
      *    Initialise Full Externally Described Keylist
      *    Owning Account
           MOVE LOW-VALUES TO BBOWNACC OF EXTSM3
      *    Order Deduct Date Effect
           MOVE -99999999 TO BBCUSDEDEF OF EXTSM3
      *    SCP Model Code
           MOVE LOW-VALUES TO BBSCMDLCDE OF EXTSM3
      *    Count to Deduction Status
           MOVE -9 TO BBCNTDEDUC OF EXTSM3
           MOVE CORRESPONDING
             EXTSM3 TO
             COORDDEDF2 OF COORDDEDL2-R
           MOVE CORRESPONDING
             KPSSM3 TO
             COORDDEDF2 OF COORDDEDL2-R
           START COORDDEDL2 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'COORDDEDF2'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ COORDDEDL2 NEXT
             FORMAT IS 'COORDDEDF2'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     COORDDEDF2 OF COORDDEDL2-R TO
                     EXTSM3
                   MOVE EXTSM3 TO KRSSM3-TMP
                   IF (KRSSM3 NOT = KRSSM3-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    Owning Account
           MOVE LOW-VALUES TO BBOWNACC OF EXTSM3
      *    Order Deduct Date Effect
           MOVE -99999999 TO BBCUSDEDEF OF EXTSM3
      *    SCP Model Code
           MOVE LOW-VALUES TO BBSCMDLCDE OF EXTSM3
      *    Count to Deduction Status
           MOVE -9 TO BBCNTDEDUC OF EXTSM3
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR7843' TO W0RTN
           END-IF
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        CASE: DB1.Order Deduct Date Effect LT PAR.U:To Date
      *          YYYYMMDD
      *        *IF
               IF (BBCUSDEDEF OF COORDDEDF2 OF COORDDEDL2-R < 20171231)
                 THEN
      *            Count Number of Deductions
      *            CASE:
      *            - NOTc1 AND c2
      *            |- c1    : DB1.Count to Deduction Status is *Do Not
      *              Count
      *            |- c2    : PAR.Customer Order Deduct Typ EQ
      *              DB1.Customer Order Deduct Typ
      *            '-
      *            *IF
                   IF (NOT (BBCNTDEDUC OF COORDDEDF2 OF COORDDEDL2-R =
                     0) AND
                       'D' = BBCODEDTYP OF COORDDEDF2 OF COORDDEDL2-R)
                     THEN
      *                U:Continue
                       MOVE 'Y' TO YL0244 OF WORK-CONTEXT
      *                Payment Status not NCNP
      *                CASE: DB1.Bonus Payment Status is NCNP
      *                *IF
                       IF (BBBNSPAYST OF COORDDEDF2 OF COORDDEDL2-R = 'N
      -                 'CNP') THEN
      *                    U:Continue
                           MOVE 'N' TO YL0244 OF WORK-CONTEXT
                       END-IF
      *                Check Target Type Deselection
      *                CASE: PAR.U:Target Prefix is Target total
      *                *IF
                       IF ('TT' = 'TT') THEN
                           CONTINUE
                       ELSE
      *                    CASE: PAR.U:Target Prefix is Target Local
      *                      Market
      *                    *IF
                           IF ('TT' = 'TL') THEN
      *                        CASE: DB1.Target Market is Local Market
      *                          Target List
      *                        *IF
                               IF (BBTGTMRKET OF COORDDEDF2 OF
                                 COORDDEDL2-R = 'L' OR
                                   BBTGTMRKET OF COORDDEDF2 OF
                                 COORDDEDL2-R = 'W' OR
                                   BBTGTMRKET OF COORDDEDF2 OF
                                 COORDDEDL2-R = 'R') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0244 OF WORK-CONTEXT
                               END-IF
                           ELSE
      *                        CASE: PAR.U:Target Prefix is Target
      *                          Major Fleet
      *                        *IF
                               IF ('TT' = 'TM') THEN
      *                        CASE: DB1.Target Market is Major Fleet
      *                          Target
      *                        *IF
                               IF (BBTGTMRKET OF COORDDEDF2 OF
                                 COORDDEDL2-R = 'M') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0244 OF WORK-CONTEXT
                               END-IF
                               END-IF
                           END-IF
                       END-IF
      *                Check Run Mode Count Type
      *                CASE: LCL.U:Continue is Yes
      *                *IF
                       IF (YL0244 OF WORK-CONTEXT = 'Y') THEN
      *                    CASE: PAR.U:Run Mode is *1
      *                    *IF
                           IF ('2' = '1') THEN
                               CONTINUE
                           ELSE
      *                        CASE: PAR.U:Run Mode is *2
      *                        *IF
                               IF ('2' = '2') THEN
      *                        CASE: DB1.Order Deduct Date Action LE
      *                          PAR.U:To Date YYYYMMDD
      *                        *IF
                               IF (BBCUSDEDAC OF COORDDEDF2 OF
                                 COORDDEDL2-R NOT > 20171231) THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0244 OF WORK-CONTEXT
                               END-IF
                               ELSE
      *                        CASE: PAR.U:Run Mode is *3
      *                        *IF
                               IF ('2' = '3') THEN
      *                        CASE: DB1.Order Deduct Date Action LE
      *                          PAR.U:To Date YYYYMMDD
      *                        *IF
                               IF (BBCUSDEDAC OF COORDDEDF2 OF
                                 COORDDEDL2-R NOT > 20171231) THEN
      *                        U:Continue
                               MOVE 'N' TO YL0244 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
                               CONTINUE
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
      *                Count
      *                CASE: LCL.U:Continue is Yes
      *                *IF
                       IF (YL0244 OF WORK-CONTEXT = 'Y') THEN
      *                    count
      *                    CASE: DB1.OBT Count Target Status is
      *                      Payment Category 1
      *                    *IF
                           IF (BBCNTTARG OF COORDDEDF2 OF COORDDEDL2-R
                             = '1') THEN
      *                        U:Pay Cat 1 De-Order
                               ADD YL0237 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0237 OF WORK-CONTEXT
                           ELSE
      *                        CASE: DB1.OBT Count Target Status is
      *                          Payment Category 2
      *                        *IF
                               IF (BBCNTTARG OF COORDDEDF2 OF
                                 COORDDEDL2-R = '2') THEN
      *                        U:Pay Cat 2 De-Order
                               ADD YL0238 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0238 OF WORK-CONTEXT
                               ELSE
      *                        CASE: DB1.OBT Count Target Status is
      *                          Payment Category 3
      *                        *IF
                               IF (BBCNTTARG OF COORDDEDF2 OF
                                 COORDDEDL2-R = '3') THEN
      *                        U:Pay Cat 3 De-Order
                               ADD YL0239 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0239 OF WORK-CONTEXT
                               ELSE
      *                        CASE: DB1.OBT Count Target Status is
      *                          Payment Category 4
      *                        *IF
                               IF (BBCNTTARG OF COORDDEDF2 OF
                                 COORDDEDL2-R = '4') THEN
      *                        U:Pay Cat 4 De-Order
                               ADD YL0240 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0240 OF WORK-CONTEXT
                               ELSE
      *                        CASE: DB1.OBT Count Target Status is
      *                          Payment Category 5
      *                        *IF
                               IF (BBCNTTARG OF COORDDEDF2 OF
                                 COORDDEDL2-R = '5') THEN
      *                        U:Pay Cat 5 De-Order
                               ADD YL0241 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0241 OF WORK-CONTEXT
                               ELSE
      *                        CASE: DB1.OBT Count Target Status is
      *                          Payment Category N - New
      *                        *IF
                               IF (BBCNTTARG OF COORDDEDF2 OF
                                 COORDDEDL2-R = 'N') THEN
      *                        U:Pay Cat N De-Order
                               ADD YL0242 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0242 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Pay Cat O De-Order
                               ADD YL0243 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0243 OF WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
                   END-IF
               ELSE
      *            CASE: *OTHERWISE
      *            U:Pay Cat 1 De-Order
                   MOVE YL0237 OF WORK-CONTEXT TO YL0220 OF WORK-CONTEXT
      *            U:Pay Cat 2 De-Order
                   MOVE YL0238 OF WORK-CONTEXT TO YL0221 OF WORK-CONTEXT
      *            U:Pay Cat 3 De-Order
                   MOVE YL0239 OF WORK-CONTEXT TO YL0222 OF WORK-CONTEXT
      *            U:Pay Cat 4 De-Order
                   MOVE YL0240 OF WORK-CONTEXT TO YL0223 OF WORK-CONTEXT
      *            U:Pay Cat 5 De-Order
                   MOVE YL0241 OF WORK-CONTEXT TO YL0224 OF WORK-CONTEXT
      *            U:Pay Cat N De-Order
                   MOVE YL0242 OF WORK-CONTEXT TO YL0226 OF WORK-CONTEXT
      *            U:Pay Cat O De-Order
                   MOVE YL0243 OF WORK-CONTEXT TO YL0225 OF WORK-CONTEXT
      *            *QUIT
                   GO SM3EXIT
               END-IF
               SET C-INDICATOR-OFF(90) TO TRUE
               READ COORDDEDL2 NEXT
                 FORMAT IS 'COORDDEDF2'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         COORDDEDF2 OF COORDDEDL2-R TO
                         EXTSM3
                       MOVE EXTSM3 TO KRSSM3-TMP
                       IF (KRSSM3 NOT = KRSSM3-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        Owning Account
               MOVE LOW-VALUES TO BBOWNACC OF EXTSM3
      *        Order Deduct Date Effect
               MOVE -99999999 TO BBCUSDEDEF OF EXTSM3
      *        SCP Model Code
               MOVE LOW-VALUES TO BBSCMDLCDE OF EXTSM3
      *        Count to Deduction Status
               MOVE -9 TO BBCNTDEDUC OF EXTSM3
           END-PERFORM
      *    USER: Exit processing
      *    U:Pay Cat 1 De-Order
           MOVE YL0237 OF WORK-CONTEXT TO YL0220 OF WORK-CONTEXT
      *    U:Pay Cat 2 De-Order
           MOVE YL0238 OF WORK-CONTEXT TO YL0221 OF WORK-CONTEXT
      *    U:Pay Cat 3 De-Order
           MOVE YL0239 OF WORK-CONTEXT TO YL0222 OF WORK-CONTEXT
      *    U:Pay Cat 4 De-Order
           MOVE YL0240 OF WORK-CONTEXT TO YL0223 OF WORK-CONTEXT
      *    U:Pay Cat 5 De-Order
           MOVE YL0241 OF WORK-CONTEXT TO YL0224 OF WORK-CONTEXT
      *    U:Pay Cat N De-Order
           MOVE YL0242 OF WORK-CONTEXT TO YL0226 OF WORK-CONTEXT
      *    U:Pay Cat O De-Order
           MOVE YL0243 OF WORK-CONTEXT TO YL0225 OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       SM3EXIT.
           EXIT.
      /EJECT
       SM4RVGN SECTION.
      *==============================================================
      *    Rtv Num of Deductions C/D - Customer Order Deduct VB  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    USER: Initialize routine
      *    Cvt *Job date to DTX
      *    * Job date contains a leading 1 when the year is 2000 or
      *      greater
      *    U:Job Date DTX
           ADD ZZJDT OF JOB-CONTEXT, 19000000 GIVING YL0236 OF
             WORK-CONTEXT
      *    U:Pay Cat 1 De-Order
           MOVE ZEROS TO YL0220 OF WORK-CONTEXT
      *    U:Pay Cat 2 De-Order
           MOVE ZEROS TO YL0221 OF WORK-CONTEXT
      *    U:Pay Cat 3 De-Order
           MOVE ZEROS TO YL0222 OF WORK-CONTEXT
      *    U:Pay Cat 4 De-Order
           MOVE ZEROS TO YL0223 OF WORK-CONTEXT
      *    U:Pay Cat 5 De-Order
           MOVE ZEROS TO YL0224 OF WORK-CONTEXT
      *    U:Pay Cat N De-Order
           MOVE ZEROS TO YL0226 OF WORK-CONTEXT
      *    U:Pay Cat O De-Order
           MOVE ZEROS TO YL0225 OF WORK-CONTEXT
      *    U:Pay Cat 1 De-Order
           MOVE ZEROS TO YL0237 OF WORK-CONTEXT
      *    U:Pay Cat 2 De-Order
           MOVE ZEROS TO YL0238 OF WORK-CONTEXT
      *    U:Pay Cat 3 De-Order
           MOVE ZEROS TO YL0239 OF WORK-CONTEXT
      *    U:Pay Cat 4 De-Order
           MOVE ZEROS TO YL0240 OF WORK-CONTEXT
      *    U:Pay Cat 5 De-Order
           MOVE ZEROS TO YL0241 OF WORK-CONTEXT
      *    U:Pay Cat N De-Order
           MOVE ZEROS TO YL0242 OF WORK-CONTEXT
      *    U:Pay Cat O De-Order
           MOVE ZEROS TO YL0243 OF WORK-CONTEXT
      *    Setup key
      *    Owning Account
           MOVE WUTOCF OF WORK-CONTEXT TO BBOWNACC OF KPSSM4
      *    Order Deduct Date Effect
           MOVE WUCUSORDD8 OF WORK-CONTEXT TO BBCUSDEDEF OF KPSSM4
           MOVE CORRESPONDING KPSSM4 TO KRSSM4
      *    Initialise Full Externally Described Keylist
      *    Owning Account
           MOVE LOW-VALUES TO BBOWNACC OF EXTSM4
      *    Order Deduct Date Effect
           MOVE -99999999 TO BBCUSDEDEF OF EXTSM4
      *    SCP Model Code
           MOVE LOW-VALUES TO BBSCMDLCDE OF EXTSM4
      *    Count to Deduction Status
           MOVE -9 TO BBCNTDEDUC OF EXTSM4
           MOVE CORRESPONDING
             EXTSM4 TO
             COORDDEDF2 OF COORDDEDL2-R
           MOVE CORRESPONDING
             KPSSM4 TO
             COORDDEDF2 OF COORDDEDL2-R
           START COORDDEDL2 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'COORDDEDF2'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ COORDDEDL2 NEXT
             FORMAT IS 'COORDDEDF2'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     COORDDEDF2 OF COORDDEDL2-R TO
                     EXTSM4
                   MOVE EXTSM4 TO KRSSM4-TMP
                   IF (KRSSM4 NOT = KRSSM4-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    Owning Account
           MOVE LOW-VALUES TO BBOWNACC OF EXTSM4
      *    Order Deduct Date Effect
           MOVE -99999999 TO BBCUSDEDEF OF EXTSM4
      *    SCP Model Code
           MOVE LOW-VALUES TO BBSCMDLCDE OF EXTSM4
      *    Count to Deduction Status
           MOVE -9 TO BBCNTDEDUC OF EXTSM4
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR7843' TO W0RTN
           END-IF
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        CASE: DB1.Order Deduct Date Effect LT PAR.U:To Date
      *          YYYYMMDD
      *        *IF
               IF (BBCUSDEDEF OF COORDDEDF2 OF COORDDEDL2-R < 20171231)
                 THEN
      *            Count Number of Deductions
      *            CASE:
      *            - NOTc1 AND c2
      *            |- c1    : DB1.Count to Deduction Status is *Do Not
      *              Count
      *            |- c2    : PAR.Customer Order Deduct Typ EQ
      *              DB1.Customer Order Deduct Typ
      *            '-
      *            *IF
                   IF (NOT (BBCNTDEDUC OF COORDDEDF2 OF COORDDEDL2-R =
                     0) AND
                       'C' = BBCODEDTYP OF COORDDEDF2 OF COORDDEDL2-R)
                     THEN
      *                U:Continue
                       MOVE 'Y' TO YL0244 OF WORK-CONTEXT
      *                Payment Status not NCNP
      *                CASE: DB1.Bonus Payment Status is NCNP
      *                *IF
                       IF (BBBNSPAYST OF COORDDEDF2 OF COORDDEDL2-R = 'N
      -                 'CNP') THEN
      *                    U:Continue
                           MOVE 'N' TO YL0244 OF WORK-CONTEXT
                       END-IF
      *                Check Target Type Deselection
      *                CASE: PAR.U:Target Prefix is Target total
      *                *IF
                       IF ('TT' = 'TT') THEN
                           CONTINUE
                       ELSE
      *                    CASE: PAR.U:Target Prefix is Target Local
      *                      Market
      *                    *IF
                           IF ('TT' = 'TL') THEN
      *                        CASE: DB1.Target Market is Local Market
      *                          Target List
      *                        *IF
                               IF (BBTGTMRKET OF COORDDEDF2 OF
                                 COORDDEDL2-R = 'L' OR
                                   BBTGTMRKET OF COORDDEDF2 OF
                                 COORDDEDL2-R = 'W' OR
                                   BBTGTMRKET OF COORDDEDF2 OF
                                 COORDDEDL2-R = 'R') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0244 OF WORK-CONTEXT
                               END-IF
                           ELSE
      *                        CASE: PAR.U:Target Prefix is Target
      *                          Major Fleet
      *                        *IF
                               IF ('TT' = 'TM') THEN
      *                        CASE: DB1.Target Market is Major Fleet
      *                          Target
      *                        *IF
                               IF (BBTGTMRKET OF COORDDEDF2 OF
                                 COORDDEDL2-R = 'M') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0244 OF WORK-CONTEXT
                               END-IF
                               END-IF
                           END-IF
                       END-IF
      *                Check Run Mode Count Type
      *                CASE: LCL.U:Continue is Yes
      *                *IF
                       IF (YL0244 OF WORK-CONTEXT = 'Y') THEN
      *                    CASE: PAR.U:Run Mode is *1
      *                    *IF
                           IF ('2' = '1') THEN
                               CONTINUE
                           ELSE
      *                        CASE: PAR.U:Run Mode is *2
      *                        *IF
                               IF ('2' = '2') THEN
      *                        CASE: DB1.Order Deduct Date Action LE
      *                          PAR.U:To Date YYYYMMDD
      *                        *IF
                               IF (BBCUSDEDAC OF COORDDEDF2 OF
                                 COORDDEDL2-R NOT > 20171231) THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue
                               MOVE 'N' TO YL0244 OF WORK-CONTEXT
                               END-IF
                               ELSE
      *                        CASE: PAR.U:Run Mode is *3
      *                        *IF
                               IF ('2' = '3') THEN
      *                        CASE: DB1.Order Deduct Date Action LE
      *                          PAR.U:To Date YYYYMMDD
      *                        *IF
                               IF (BBCUSDEDAC OF COORDDEDF2 OF
                                 COORDDEDL2-R NOT > 20171231) THEN
      *                        U:Continue
                               MOVE 'N' TO YL0244 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
                               CONTINUE
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
      *                Count
      *                CASE: LCL.U:Continue is Yes
      *                *IF
                       IF (YL0244 OF WORK-CONTEXT = 'Y') THEN
      *                    count
      *                    CASE: DB1.OBT Count Target Status is
      *                      Payment Category 1
      *                    *IF
                           IF (BBCNTTARG OF COORDDEDF2 OF COORDDEDL2-R
                             = '1') THEN
      *                        U:Pay Cat 1 De-Order
                               ADD YL0237 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0237 OF WORK-CONTEXT
                           ELSE
      *                        CASE: DB1.OBT Count Target Status is
      *                          Payment Category 2
      *                        *IF
                               IF (BBCNTTARG OF COORDDEDF2 OF
                                 COORDDEDL2-R = '2') THEN
      *                        U:Pay Cat 2 De-Order
                               ADD YL0238 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0238 OF WORK-CONTEXT
                               ELSE
      *                        CASE: DB1.OBT Count Target Status is
      *                          Payment Category 3
      *                        *IF
                               IF (BBCNTTARG OF COORDDEDF2 OF
                                 COORDDEDL2-R = '3') THEN
      *                        U:Pay Cat 3 De-Order
                               ADD YL0239 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0239 OF WORK-CONTEXT
                               ELSE
      *                        CASE: DB1.OBT Count Target Status is
      *                          Payment Category 4
      *                        *IF
                               IF (BBCNTTARG OF COORDDEDF2 OF
                                 COORDDEDL2-R = '4') THEN
      *                        U:Pay Cat 4 De-Order
                               ADD YL0240 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0240 OF WORK-CONTEXT
                               ELSE
      *                        CASE: DB1.OBT Count Target Status is
      *                          Payment Category 5
      *                        *IF
                               IF (BBCNTTARG OF COORDDEDF2 OF
                                 COORDDEDL2-R = '5') THEN
      *                        U:Pay Cat 5 De-Order
                               ADD YL0241 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0241 OF WORK-CONTEXT
                               ELSE
      *                        CASE: DB1.OBT Count Target Status is
      *                          Payment Category N - New
      *                        *IF
                               IF (BBCNTTARG OF COORDDEDF2 OF
                                 COORDDEDL2-R = 'N') THEN
      *                        U:Pay Cat N De-Order
                               ADD YL0242 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0242 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Pay Cat O De-Order
                               ADD YL0243 OF WORK-CONTEXT, BBCNTDEDUC
                                 OF COORDDEDF2 OF COORDDEDL2-R GIVING
                                 YL0243 OF WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
                   END-IF
               ELSE
      *            CASE: *OTHERWISE
      *            U:Pay Cat 1 De-Order
                   MOVE YL0237 OF WORK-CONTEXT TO YL0220 OF WORK-CONTEXT
      *            U:Pay Cat 2 De-Order
                   MOVE YL0238 OF WORK-CONTEXT TO YL0221 OF WORK-CONTEXT
      *            U:Pay Cat 3 De-Order
                   MOVE YL0239 OF WORK-CONTEXT TO YL0222 OF WORK-CONTEXT
      *            U:Pay Cat 4 De-Order
                   MOVE YL0240 OF WORK-CONTEXT TO YL0223 OF WORK-CONTEXT
      *            U:Pay Cat 5 De-Order
                   MOVE YL0241 OF WORK-CONTEXT TO YL0224 OF WORK-CONTEXT
      *            U:Pay Cat N De-Order
                   MOVE YL0242 OF WORK-CONTEXT TO YL0226 OF WORK-CONTEXT
      *            U:Pay Cat O De-Order
                   MOVE YL0243 OF WORK-CONTEXT TO YL0225 OF WORK-CONTEXT
      *            *QUIT
                   GO SM4EXIT
               END-IF
               SET C-INDICATOR-OFF(90) TO TRUE
               READ COORDDEDL2 NEXT
                 FORMAT IS 'COORDDEDF2'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         COORDDEDF2 OF COORDDEDL2-R TO
                         EXTSM4
                       MOVE EXTSM4 TO KRSSM4-TMP
                       IF (KRSSM4 NOT = KRSSM4-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        Owning Account
               MOVE LOW-VALUES TO BBOWNACC OF EXTSM4
      *        Order Deduct Date Effect
               MOVE -99999999 TO BBCUSDEDEF OF EXTSM4
      *        SCP Model Code
               MOVE LOW-VALUES TO BBSCMDLCDE OF EXTSM4
      *        Count to Deduction Status
               MOVE -9 TO BBCNTDEDUC OF EXTSM4
           END-PERFORM
      *    USER: Exit processing
      *    U:Pay Cat 1 De-Order
           MOVE YL0237 OF WORK-CONTEXT TO YL0220 OF WORK-CONTEXT
      *    U:Pay Cat 2 De-Order
           MOVE YL0238 OF WORK-CONTEXT TO YL0221 OF WORK-CONTEXT
      *    U:Pay Cat 3 De-Order
           MOVE YL0239 OF WORK-CONTEXT TO YL0222 OF WORK-CONTEXT
      *    U:Pay Cat 4 De-Order
           MOVE YL0240 OF WORK-CONTEXT TO YL0223 OF WORK-CONTEXT
      *    U:Pay Cat 5 De-Order
           MOVE YL0241 OF WORK-CONTEXT TO YL0224 OF WORK-CONTEXT
      *    U:Pay Cat N De-Order
           MOVE YL0242 OF WORK-CONTEXT TO YL0226 OF WORK-CONTEXT
      *    U:Pay Cat O De-Order
           MOVE YL0243 OF WORK-CONTEXT TO YL0225 OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       SM4EXIT.
           EXIT.
      /EJECT
       SM5RVGN SECTION.
      *==============================================================
      *    Rtv *all - BonusSls-DlrPrm Override2  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    Bonus Scheme (8)
           MOVE QCBNSSCM OF FBNSSX9 OF SBBNSSGWL4-R TO A7BNSSCM OF
             KRSSM5
      *    Dealer to pay Number (Num
           MOVE QCEDNB OF FBNSSX9 OF SBBNSSGWL4-R TO A7EDNB OF KRSSM5
      *    Initialise Full Externally Described Keylist
      *    Bonus Scheme (8)
           MOVE LOW-VALUES TO A7BNSSCM OF EXTSM5
      *    Dealer to pay Number (Num
           MOVE -99999 TO A7EDNB OF EXTSM5
           MOVE CORRESPONDING
             KRSSM5 TO
             FDLRMLB OF SBDLROV2L1-R
           SET C-INDICATOR-OFF(90) TO TRUE
           READ SBDLROV2L1
             FORMAT IS 'FDLRMLB'
           END-READ
           IF (C-NO-RECORD) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               END-IF
           END-IF
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR7835' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        Payment Band Changes
               MOVE SPACES TO YL0254 OF WORK-CONTEXT
      *        Percentage Penalty
               MOVE ZEROS TO YL0255 OF WORK-CONTEXT
      *        Apply Penalty
               MOVE SPACES TO YL0256 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
      *        Apply Penalty
               MOVE 'N' TO YL0256 OF WORK-CONTEXT
               GO SM5EXIT
           END-IF
      *
           IF (C-INDICATOR-OFF(90)) THEN
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        Payment Band Changes
               MOVE A7BANOVR OF FDLRMLB OF SBDLROV2L1-R TO YL0254 OF
                 WORK-CONTEXT
      *        Percentage Penalty
               MOVE A7PERPEN OF FDLRMLB OF SBDLROV2L1-R TO YL0255 OF
                 WORK-CONTEXT
      *        Apply Penalty
               MOVE A7APLP OF FDLRMLB OF SBDLROV2L1-R TO YL0256 OF
                 WORK-CONTEXT
           END-IF
      *==============================================================
           CONTINUE.
       SM5EXIT.
           EXIT.
      /EJECT
       SM6RVGN SECTION.
      *==============================================================
      *    Rtv All Dtl by Dlr/Mdl/ON - OBT Extract  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    Dealer number (Num key)
           MOVE QCDLRNOKEY OF FBNSSX9 OF SBBNSSGWL4-R TO Q2DLRNOKEY OF
             KRSSM6
      *    BDC Model
           MOVE QCBDCM OF FBNSSX9 OF SBBNSSGWL4-R TO Q2BDCM OF KRSSM6
      *    BDC Customer Order Number
           MOVE QCBDCCON OF FBNSSX9 OF SBBNSSGWL4-R TO Q2BDCCON OF
             KRSSM6
      *    Initialise Full Externally Described Keylist
      *    Dealer number (Num key)
           MOVE -99999 TO Q2DLRNOKEY OF EXTSM6
      *    BDC Model
           MOVE LOW-VALUES TO Q2BDCM OF EXTSM6
      *    BDC Customer Order Number
           MOVE LOW-VALUES TO Q2BDCCON OF EXTSM6
           MOVE CORRESPONDING
             EXTSM6 TO
             FOBEXCB OF RAOBEXTRL2-R
           MOVE CORRESPONDING
             KRSSM6 TO
             FOBEXCB OF RAOBEXTRL2-R
           START RAOBEXTRL2 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'FOBEXCB'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ RAOBEXTRL2 NEXT
             FORMAT IS 'FOBEXCB'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     FOBEXCB OF RAOBEXTRL2-R TO
                     EXTSM6
                   MOVE EXTSM6 TO KRSSM6-TMP
                   IF (KRSSM6 NOT = KRSSM6-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    Dealer number (Num key)
           MOVE -99999 TO Q2DLRNOKEY OF EXTSM6
      *    BDC Model
           MOVE LOW-VALUES TO Q2BDCM OF EXTSM6
      *    BDC Customer Order Number
           MOVE LOW-VALUES TO Q2BDCCON OF EXTSM6
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR5706' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        BDC Order Crt Date
               MOVE ZEROS TO YL0269 OF WORK-CONTEXT
      *        SD Sales Channel Code
               MOVE SPACES TO YL0270 OF WORK-CONTEXT
      *        Fleet Report Group Code
               MOVE SPACES TO YL0271 OF WORK-CONTEXT
      *        BDC Payment Term
               MOVE SPACES TO YL0272 OF WORK-CONTEXT
      *        OBT Count Target Status
               MOVE SPACES TO YL0273 OF WORK-CONTEXT
      *        Registration Date 58
               MOVE ZEROS TO YL0274 OF WORK-CONTEXT
      *        Fleet Programmes Code
               MOVE SPACES TO YL0275 OF WORK-CONTEXT
      *        Target Market
               MOVE SPACES TO YL0276 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SM6EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        BDC Order Crt Date
               MOVE Q2OCRTDTE OF FOBEXCB OF RAOBEXTRL2-R TO YL0269 OF
                 WORK-CONTEXT
      *        SD Sales Channel Code
               MOVE Q2SDSCHNCD OF FOBEXCB OF RAOBEXTRL2-R TO YL0270 OF
                 WORK-CONTEXT
      *        Fleet Report Group Code
               MOVE Q2RPGPCD OF FOBEXCB OF RAOBEXTRL2-R TO YL0271 OF
                 WORK-CONTEXT
      *        BDC Payment Term
               MOVE Q2BDCPTRM OF FOBEXCB OF RAOBEXTRL2-R TO YL0272 OF
                 WORK-CONTEXT
      *        OBT Count Target Status
               MOVE Q2CNTTARG OF FOBEXCB OF RAOBEXTRL2-R TO YL0273 OF
                 WORK-CONTEXT
      *        Registration Date 58
               MOVE Q2REGDT58 OF FOBEXCB OF RAOBEXTRL2-R TO YL0274 OF
                 WORK-CONTEXT
      *        Fleet Programmes Code
               MOVE Q2FLPGMCDE OF FOBEXCB OF RAOBEXTRL2-R TO YL0275 OF
                 WORK-CONTEXT
      *        Target Market
               MOVE Q2TGTMRKET OF FOBEXCB OF RAOBEXTRL2-R TO YL0276 OF
                 WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
      *        *QUIT
               GO SM6EXIT
               SET C-INDICATOR-OFF(90) TO TRUE
               READ RAOBEXTRL2 NEXT
                 FORMAT IS 'FOBEXCB'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         FOBEXCB OF RAOBEXTRL2-R TO
                         EXTSM6
                       MOVE EXTSM6 TO KRSSM6-TMP
                       IF (KRSSM6 NOT = KRSSM6-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        Dealer number (Num key)
               MOVE -99999 TO Q2DLRNOKEY OF EXTSM6
      *        BDC Model
               MOVE LOW-VALUES TO Q2BDCM OF EXTSM6
      *        BDC Customer Order Number
               MOVE LOW-VALUES TO Q2BDCCON OF EXTSM6
           END-PERFORM
      *==============================================================
           CONTINUE.
       SM6EXIT.
           EXIT.
      /EJECT
       SM7RVGN SECTION.
      *==============================================================
      *    Rtv Car or Van SCP Mdl - Vehicle Model Bonus Atr  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    USER: Initialize routine
      *    Car/Van Indicator
           MOVE 'C' TO YL0260 OF WORK-CONTEXT
      *    Setup key
      *    Model Application Code
           MOVE 'RIC' TO LLMDLAPPCD OF KRSSM7
      *    SCP Model Code
           MOVE QCBDCM OF FBNSSX9 OF SBBNSSGWL4-R TO LLSCMDLCDE OF
             KRSSM7
      *    Initialise Full Externally Described Keylist
      *    Model Application Code
           MOVE LOW-VALUES TO LLMDLAPPCD OF EXTSM7
      *    SCP Model Code
           MOVE LOW-VALUES TO LLSCMDLCDE OF EXTSM7
           MOVE CORRESPONDING
             KRSSM7 TO
             VAMDLBNSF1 OF VAMDLBNSL1-R
           SET C-INDICATOR-OFF(90) TO TRUE
           READ VAMDLBNSL1
             FORMAT IS 'VAMDLBNSF1'
           END-READ
           IF (C-NO-RECORD) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               END-IF
           END-IF
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'USR7127' TO W0RTN
      *        USER: Processing if Data record not found
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SM7EXIT
           END-IF
      *
           IF (C-INDICATOR-OFF(90)) THEN
      *        USER: Process Data record
      *        Car/Van Indicator
               MOVE LLCORV OF VAMDLBNSF1 OF VAMDLBNSL1-R TO YL0260 OF
                 WORK-CONTEXT
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
           END-IF
      *==============================================================
           CONTINUE.
       SM7EXIT.
           EXIT.
      /EJECT
       SM8CHRC SECTION.
      *==============================================================
      *    #Chg Bonus Suggest Wrk-Sl - Bonus Sls-Suggest Work  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Move key fields to FCHSWT2
      *    Bonus Scheme (8)
           MOVE QCBNSSCM OF FBNSSX9 OF SBBNSSGWL4-R TO QCBNSSCM OF
             SBBNSSGWL0-R
      *    Suggest Run Number
           MOVE QCSUGRNO OF FBNSSX9 OF SBBNSSGWL4-R TO QCSUGRNO OF
             SBBNSSGWL0-R
      *    Dealer number (Num key)
           MOVE QCDLRNOKEY OF FBNSSX9 OF SBBNSSGWL4-R TO QCDLRNOKEY OF
             SBBNSSGWL0-R
      *    BDC Customer Order Number
           MOVE QCBDCCON OF FBNSSX9 OF SBBNSSGWL4-R TO QCBDCCON OF
             SBBNSSGWL0-R
      *    Chassis number
           MOVE QCASXX OF FBNSSX9 OF SBBNSSGWL4-R TO QCASXX OF
             SBBNSSGWL0-R
      *    Dealer to pay Number (Num
           MOVE QCEDNB OF FBNSSX9 OF SBBNSSGWL4-R TO QCEDNB OF
             SBBNSSGWL0-R
      *    Fleet Operator Number
           MOVE QCFLOPNO OF FBNSSX9 OF SBBNSSGWL4-R TO QCFLOPNO OF
             SBBNSSGWL0-R
      *
           READ SBBNSSGWL0 END-READ
           IF (C-NO-RECORD) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               SET C-INDICATOR-OFF(90) TO TRUE
           END-IF
           IF (C-IO-ERR OR
               C-RECORD-LOCKED) THEN
               SET C-INDICATOR-ON(91) TO TRUE
           ELSE
               SET C-INDICATOR-OFF(91) TO TRUE
           END-IF
      *
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'Y2U0009' TO W0RTN
               MOVE ZZPGM  OF JOB-CONTEXT TO MDPGM OF MD0009
               MOVE 'SBBNSSGWL0' TO MDACP OF MD0009
               MOVE 'FCHSWT2' TO MDFMT OF MD0009
               MOVE '*CHG' TO MDACT OF MD0009
      *        Record not found label: LBL001.
               MOVE 'LBL001' TO MDLBL OF MD0009
      *        Send message '*Record no longer on file'
      *        Message ID
               MOVE 'Y2U0009' TO ZAMSID
      *        Message file
               MOVE 'Y2USRMSG' TO ZAMSGF
      *        Message data
               MOVE MD0009 TO ZAMSDA
               PERFORM ZASNMS
               MOVE SPACES TO MD0009
               GO SM8EXIT
           END-IF
      *
           IF (C-INDICATOR-ON(91)) THEN
      *        Record locked
               MOVE 'Y2U0004' TO W0RTN
      *        Send message '*Database operation error'
      *        Message ID
               MOVE 'Y2U0004' TO ZAMSID
      *        Message file
               MOVE 'Y2USRMSG' TO ZAMSGF
               PERFORM ZASNMS
               GO SM8EXIT
           END-IF
      *
      *    Move all fields to FCHSWT2
      *    Fleet Report Group Code
           MOVE QCRPGPCD OF FBNSSX9 OF SBBNSSGWL4-R TO QCRPGPCD OF
             SBBNSSGWL0-R
      *    Registration number
           MOVE QCGNOX OF FBNSSX9 OF SBBNSSGWL4-R TO QCGNOX OF
             SBBNSSGWL0-R
      *    SMMT Reg.Date (Original)
           MOVE QCSMMTRD OF FBNSSX9 OF SBBNSSGWL4-R TO QCSMMTRD OF
             SBBNSSGWL0-R
      *    BDC Model
           MOVE QCBDCM OF FBNSSX9 OF SBBNSSGWL4-R TO QCBDCM OF
             SBBNSSGWL0-R
      *    BDC Model Version
           MOVE QCBDCMV OF FBNSSX9 OF SBBNSSGWL4-R TO QCBDCMV OF
             SBBNSSGWL0-R
      *    BDC Order Crt Date
           MOVE QCOCRTDTE OF FBNSSX9 OF SBBNSSGWL4-R TO QCOCRTDTE OF
             SBBNSSGWL0-R
      *    BDC Order Cnl Date
           MOVE QCOCNLDTE OF FBNSSX9 OF SBBNSSGWL4-R TO QCOCNLDTE OF
             SBBNSSGWL0-R
      *    BDC Client Type
           MOVE QCBDCTCS OF FBNSSX9 OF SBBNSSGWL4-R TO QCBDCTCS OF
             SBBNSSGWL0-R
      *    BDC Payment Method
           MOVE QCBDCPMT OF FBNSSX9 OF SBBNSSGWL4-R TO QCBDCPMT OF
             SBBNSSGWL0-R
      *    BDC Finance Deal Code
           MOVE QCDEALCD OF FBNSSX9 OF SBBNSSGWL4-R TO QCDEALCD OF
             SBBNSSGWL0-R
      *    BDC Vehicle Type
           MOVE QCBDCVTP OF FBNSSX9 OF SBBNSSGWL4-R TO QCBDCVTP OF
             SBBNSSGWL0-R
      *    BDC Salesman PIN
           MOVE WUSLSMNP OF WORK-CONTEXT TO QCSLSMNP OF SBBNSSGWL0-R
      *    BDC Agent (Dealer)
           MOVE QCFBCE OF FBNSSX9 OF SBBNSSGWL4-R TO QCFBCE OF
             SBBNSSGWL0-R
      *    Vehicle Rejection Flag
           MOVE YL0278 OF WORK-CONTEXT TO QCVEHREJF OF SBBNSSGWL0-R
      *    Payable Amount (Dealer)
           MOVE ZEROS TO QCBNSPAM OF SBBNSSGWL0-R
      *    Payable Percent (Dealer)
           MOVE ZEROS TO QCPAYPCTD OF SBBNSSGWL0-R
      *    Bonus Amount (This)
           MOVE WUBNSAMTT OF WORK-CONTEXT TO QCBNSAMTT OF SBBNSSGWL0-R
      *    Bonus amount (Last)
           MOVE ZEROS TO QCBNSAMTL OF SBBNSSGWL0-R
      *    Net Amount-This Run
           MOVE ZEROS TO QCNETAMT OF SBBNSSGWL0-R
      *    *USER
           MOVE ZZUSR OF JOB-CONTEXT TO QCUSR OF SBBNSSGWL0-R
      *    *PROGRAM
           MOVE ZZPGM OF JOB-CONTEXT TO QCPGM OF SBBNSSGWL0-R
      *    *JOB
           MOVE ZZJOB OF JOB-CONTEXT TO QCJOB OF SBBNSSGWL0-R
      *    Job Date (8)
           MOVE WUJOBDTE8 OF WORK-CONTEXT TO QCJOBDTE8 OF SBBNSSGWL0-R
      *    *Job time
           MOVE ZZJTM OF JOB-CONTEXT TO QCJTM OF SBBNSSGWL0-R
      *
           REWRITE SBBNSSGWL0-R END-REWRITE
           IF (NOT C-IO-OK) THEN
               SET C-INDICATOR-ON(91) TO TRUE
           ELSE
               SET C-INDICATOR-OFF(91) TO TRUE
           END-IF
           IF (C-INDICATOR-ON(91)) THEN
      *        Change error detected
               MOVE 'Y2U0004' TO W0RTN
           ELSE
      *        DBF change successful
               CONTINUE
           END-IF
      *==============================================================
           CONTINUE.
       SM8EXIT.
           EXIT.
      /EJECT
       UA1SUBR SECTION.
      *==============================================================
      *    Description note this cheme
      *==============================================================
      *    Business want to pay as the situation with setting Close
      *      Period
      *    After 6 months by Close period business want to Analyse
      *      what Order changes
      *    Bussies set Re-caclulation to Y
      *    After close period Cancellations this is less than 5%
      *      before period close
      *    Dealer keeps all Money
      *    Other wise will claw back on every Cancelled order great by
      *      5%
      *    claw back money From dealer and Pay at a lower
      *==============================================================
           CONTINUE.
       UA1EXIT.
           EXIT.
      /EJECT
       UA2SUBR SECTION.
      *==============================================================
      *    Retrieve Target For Registration
      *==============================================================
      *    U:Target Period Code a
           MOVE 'TTQ417' TO WUUTGTPRDA OF WORK-CONTEXT
      *    Exc Rtv All - Target Period  *
      *    Clear array PARC
           INITIALIZE PARC
      *    Target Period Code
           MOVE WUUTGTPRDA OF WORK-CONTEXT TO PAPERCDE
      *
           SET C-INDICATOR-OFF(90) TO TRUE
      *
           CALL 'RBA000765S' USING
      *    Return code
             W0RTN
      *    RCD : Target Period
             PARC
                    ON OVERFLOW
                    SET C-INDICATOR-ON(90) TO TRUE
           END-CALL
      *
      *
      *    From Date
           MOVE PAPRDFM TO WUUFRMDTXA OF WORK-CONTEXT
      *    To Date
           MOVE PAPRDTO TO WUUTODTXA OF WORK-CONTEXT
      *
      *    Error on program call will terminate run unit
           IF (C-INDICATOR-ON(90)) THEN
               MOVE 'Y2U0032' TO W0RTN
               MOVE 'RBA000765S' TO W0CLPG
      *        Send message '*Error occured on CALL...'
      *        Message ID
               MOVE 'Y2U0032' TO ZAMSID
      *        Message file
               MOVE 'Y2USRMSG' TO ZAMSGF
      *        Message data
               MOVE W0CLPG TO ZAMSDA
               PERFORM ZASNMS
           END-IF
      *    Error detected?
           IF (W0RTN        NOT = SPACES) THEN
               SET C-INDICATOR-ON(99) TO TRUE
           END-IF
      *==============================================================
           CONTINUE.
       UA2EXIT.
           EXIT.
      /EJECT
       UA3SUBR SECTION.
      *==============================================================
      *    Retrieve Target For Registration Milestone Penalty  M1
      *      (1.month)
      *==============================================================
      *    U:Target Period Code b
           MOVE 'TT1017' TO WUUTGTPRDB OF WORK-CONTEXT
      *    * YYYYMMDD
      *    U:From Date (8) b
           MOVE 20171001 TO WUUFRMDTXB OF WORK-CONTEXT
      *    U:To Date (8) b
           MOVE 20171031 TO WUUTODTXB OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       UA3EXIT.
           EXIT.
      /EJECT
       UA4SUBR SECTION.
      *==============================================================
      *    Retrieve Target For Registration Milestone Penalty  M2
      *      (2.month)
      *==============================================================
      *    U:Target Period Code c
           MOVE 'TT1117' TO WUUTGTPRDC OF WORK-CONTEXT
      *    * YYYYMMDD
      *    U:From Date (8) c
           MOVE 20171101 TO WUUFRMDTXC OF WORK-CONTEXT
      *    U:To Date (8) c
           MOVE 20171130 TO WUUTODTXC OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       UA4EXIT.
           EXIT.
      /EJECT
       UA5SUBR SECTION.
      *==============================================================
      *    Retrieve Target For Registration Milestone Penalty
      *      Overachievement
      *==============================================================
      *    Target for October + November
      *    U:Target Period Code e
           MOVE 'TTON17' TO WUUTGTPRDE OF WORK-CONTEXT
      *    * YYYYMMDD
      *    U:From Date (8) e
           MOVE 20171001 TO WUXBDX OF WORK-CONTEXT
      *    U:To Date (8) e
           MOVE 20171130 TO WUXCDX OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       UA5EXIT.
           EXIT.
      /EJECT
       UA6SUBR SECTION.
      *==============================================================
      *    Retrieve Target For Orders
      *==============================================================
      *    U:Target Period Code d
           MOVE 'OTQ417' TO WUUTGTPRDD OF WORK-CONTEXT
      *    Exc Rtv All - Target Period  *
      *    Clear array PARC
           INITIALIZE PARC
      *    Target Period Code
           MOVE WUUTGTPRDD OF WORK-CONTEXT TO PAPERCDE
      *
           SET C-INDICATOR-OFF(90) TO TRUE
      *
           CALL 'RBA000765S' USING
      *    Return code
             W0RTN
      *    RCD : Target Period
             PARC
                    ON OVERFLOW
                    SET C-INDICATOR-ON(90) TO TRUE
           END-CALL
      *
      *
      *    From Date
           MOVE PAPRDFM TO WUUFRMDTXD OF WORK-CONTEXT
      *    To Date
           MOVE PAPRDTO TO WUUTODTXD OF WORK-CONTEXT
      *
      *    Error on program call will terminate run unit
           IF (C-INDICATOR-ON(90)) THEN
               MOVE 'Y2U0032' TO W0RTN
               MOVE 'RBA000765S' TO W0CLPG
      *        Send message '*Error occured on CALL...'
      *        Message ID
               MOVE 'Y2U0032' TO ZAMSID
      *        Message file
               MOVE 'Y2USRMSG' TO ZAMSGF
      *        Message data
               MOVE W0CLPG TO ZAMSDA
               PERFORM ZASNMS
           END-IF
      *    Error detected?
           IF (W0RTN        NOT = SPACES) THEN
               SET C-INDICATOR-ON(99) TO TRUE
           END-IF
           MOVE WUUFRMDTXD OF WORK-CONTEXT TO WUCUSORDD8 OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       UA6EXIT.
           EXIT.
      /EJECT
       UA7SUBR SECTION.
      *==============================================================
      *    Initialization
      *==============================================================
      *    Achievement Band Reg
           MOVE SPACES TO YL0002 OF WORK-CONTEXT
           MOVE ' ' TO YL0002 OF WORK-CONTEXT
      *    U:Achieved Target 1
           MOVE 'N' TO YL0003 OF WORK-CONTEXT
      *    U:Achieved Target 2
           MOVE 'N' TO YL0004 OF WORK-CONTEXT
      *    Achieved Pre-Qualifier R
           MOVE 'N' TO YL0005 OF WORK-CONTEXT
      *    PreQual Net 1 OCTOBER
           MOVE ZEROS TO YL0006 OF WORK-CONTEXT
      *    PreQual Net 1 NOVEMBER
           MOVE ZEROS TO YL0007 OF WORK-CONTEXT
      *    PreQual Net A
           MOVE ZEROS TO YL0008 OF WORK-CONTEXT
      *    PreQual Reg/Ord 7
           MOVE ZEROS TO YL0009 OF WORK-CONTEXT
      *    PreQual De-Reg/Ord 7
           MOVE ZEROS TO YL0010 OF WORK-CONTEXT
      *    PreQual Net Reg/Ord 7
           MOVE ZEROS TO YL0011 OF WORK-CONTEXT
      *    PreQual Target Reg/Ord 7
           MOVE ZEROS TO YL0012 OF WORK-CONTEXT
      *    PreQual Reg/Ord 8
           MOVE ZEROS TO YL0013 OF WORK-CONTEXT
      *    PreQual De-Reg/Ord 8
           MOVE ZEROS TO YL0014 OF WORK-CONTEXT
      *    PreQual Net Reg/Ord 8
           MOVE ZEROS TO YL0015 OF WORK-CONTEXT
      *    PreQual Target Reg/Ord 8
           MOVE ZEROS TO YL0016 OF WORK-CONTEXT
      *    PreQual Reg/Ord 9
           MOVE ZEROS TO YL0017 OF WORK-CONTEXT
      *    PreQual De-Reg/Ord 9
           MOVE ZEROS TO YL0018 OF WORK-CONTEXT
      *    PreQual Net Reg/Ord 9
           MOVE ZEROS TO YL0019 OF WORK-CONTEXT
      *    PreQual Target Reg/Ord 9
           MOVE ZEROS TO YL0020 OF WORK-CONTEXT
      *    PreQual Reg/Ord 10
           MOVE ZEROS TO YL0021 OF WORK-CONTEXT
      *    PreQual De-Reg/Ord 10
           MOVE ZEROS TO YL0022 OF WORK-CONTEXT
      *    PreQual Net Reg/Ord 10
           MOVE ZEROS TO YL0023 OF WORK-CONTEXT
      *    PreQual Target Reg/Ord 10
           MOVE ZEROS TO YL0024 OF WORK-CONTEXT
      *    PreQual Reg/Ord 11
           MOVE ZEROS TO YL0025 OF WORK-CONTEXT
      *    PreQual De-Reg/Ord 11
           MOVE ZEROS TO YL0026 OF WORK-CONTEXT
      *    PreQual Net Reg/Ord 11
           MOVE ZEROS TO YL0027 OF WORK-CONTEXT
      *    PreQual Target Reg/Ord 11
           MOVE ZEROS TO YL0028 OF WORK-CONTEXT
      *    PreQual Reg/Ord 12
           MOVE ZEROS TO YL0029 OF WORK-CONTEXT
      *    PreQual De-Reg/Ord 12
           MOVE ZEROS TO YL0030 OF WORK-CONTEXT
      *    PreQual Net Reg/Ord 12
           MOVE ZEROS TO YL0031 OF WORK-CONTEXT
      *    PreQual Target Reg/Ord 12
           MOVE ZEROS TO YL0032 OF WORK-CONTEXT
      *    PreQual Reg/Ord 13
           MOVE ZEROS TO YL0033 OF WORK-CONTEXT
      *    PreQual De-Reg/Ord 13
           MOVE ZEROS TO YL0034 OF WORK-CONTEXT
      *    PreQual Net Reg/Ord 13
           MOVE ZEROS TO YL0035 OF WORK-CONTEXT
      *    PreQual Target Reg/Ord 13
           MOVE ZEROS TO YL0036 OF WORK-CONTEXT
      *    PreQual Reg/Ord 16
           MOVE ZEROS TO YL0037 OF WORK-CONTEXT
      *    PreQual De-Reg/Ord 16
           MOVE ZEROS TO YL0038 OF WORK-CONTEXT
      *    PreQual Net Reg/Ord 16
           MOVE ZEROS TO YL0039 OF WORK-CONTEXT
      *    PreQual Target Reg/Ord 16
           MOVE ZEROS TO YL0040 OF WORK-CONTEXT
      *    PreQual Reg/Ord 17
           MOVE ZEROS TO YL0041 OF WORK-CONTEXT
      *    PreQual De-Reg/Ord 17
           MOVE ZEROS TO YL0042 OF WORK-CONTEXT
      *    PreQual Net Reg/Ord 17
           MOVE ZEROS TO YL0043 OF WORK-CONTEXT
      *    PreQual Target Reg/Ord 17
           MOVE ZEROS TO YL0044 OF WORK-CONTEXT
      *    PreQual Reg/Ord 18
           MOVE ZEROS TO YL0045 OF WORK-CONTEXT
      *    PreQual De-Reg/Ord 18
           MOVE ZEROS TO YL0046 OF WORK-CONTEXT
      *    PreQual Net Reg/Ord 18
           MOVE ZEROS TO YL0047 OF WORK-CONTEXT
      *    PreQual Target Reg/Ord 18
           MOVE ZEROS TO YL0048 OF WORK-CONTEXT
      *    PreQual Reg/Ord 19
           MOVE ZEROS TO YL0049 OF WORK-CONTEXT
      *    PreQual De-Reg/Ord 19
           MOVE ZEROS TO YL0050 OF WORK-CONTEXT
      *    PreQual Net Reg/Ord 19
           MOVE ZEROS TO YL0051 OF WORK-CONTEXT
      *    PreQual Target Reg/Ord 19
           MOVE ZEROS TO YL0052 OF WORK-CONTEXT
      *    PreQual Reg/Ord 20
           MOVE ZEROS TO YL0053 OF WORK-CONTEXT
      *    PreQual De-Reg/Ord 20
           MOVE ZEROS TO YL0054 OF WORK-CONTEXT
      *    PreQual Net Reg/Ord 20
           MOVE ZEROS TO YL0055 OF WORK-CONTEXT
      *    PreQual Target Reg/Ord 20
           MOVE ZEROS TO YL0056 OF WORK-CONTEXT
      *    U:Payment Band
           MOVE ZEROS TO WUWCNU OF WORK-CONTEXT
      *    U:Payment Band 3
           MOVE ZEROS TO WUUPAYBN3 OF WORK-CONTEXT
      *    U:90% of target -decimal
           MOVE ZEROS TO WUU90TD OF WORK-CONTEXT
      *    U:80% of Target -Decimal
           MOVE ZEROS TO WUU80TD OF WORK-CONTEXT
      *    U:100% of Target -decimal
           MOVE ZEROS TO WUU100PCTD OF WORK-CONTEXT
      *    U:105% of target -decimal
           MOVE ZEROS TO WUU105PCTD OF WORK-CONTEXT
      *    U:110% of target -decimal
           MOVE ZEROS TO WUU110PCTD OF WORK-CONTEXT
      *    U:120% of target -decimal
           MOVE ZEROS TO WUU120PCTD OF WORK-CONTEXT
      *    U:Target Total
           MOVE ZEROS TO WUTGTTOT OF WORK-CONTEXT
      *    Percentage Penalty
           MOVE ZEROS TO YL0001 OF WORK-CONTEXT
      *    U:Clawinging back
           MOVE 'N' TO YL0057 OF WORK-CONTEXT
      *    PreQual Net Previous
           MOVE ZEROS TO YL0058 OF WORK-CONTEXT
      *    PreQual Net Actual
           MOVE ZEROS TO YL0059 OF WORK-CONTEXT
      *    U:Number (8.0)
           MOVE ZEROS TO YL0060 OF WORK-CONTEXT
      *    PreQual Net 5%
           MOVE ZEROS TO YL0061 OF WORK-CONTEXT
      *    * Orders
      *    PreQual Order 1
           MOVE ZEROS TO YL0062 OF WORK-CONTEXT
      *    PreQual Cancel 1
           MOVE ZEROS TO YL0063 OF WORK-CONTEXT
      *    PreQual Target 1
           MOVE ZEROS TO YL0064 OF WORK-CONTEXT
      *    PreQual Order 2
           MOVE ZEROS TO YL0065 OF WORK-CONTEXT
      *    PreQual Cancel 2
           MOVE ZEROS TO YL0066 OF WORK-CONTEXT
      *    PreQual Target 2
           MOVE ZEROS TO YL0067 OF WORK-CONTEXT
      *    PreQual Order 3
           MOVE ZEROS TO YL0068 OF WORK-CONTEXT
      *    PreQual Cancel 3
           MOVE ZEROS TO YL0069 OF WORK-CONTEXT
      *    PreQual Target 3
           MOVE ZEROS TO YL0070 OF WORK-CONTEXT
      *    PreQual Order 4
           MOVE ZEROS TO YL0071 OF WORK-CONTEXT
      *    PreQual Cancel 4
           MOVE ZEROS TO YL0072 OF WORK-CONTEXT
      *    PreQual Target 4
           MOVE ZEROS TO YL0073 OF WORK-CONTEXT
      *    PreQual Order 5
           MOVE ZEROS TO YL0074 OF WORK-CONTEXT
      *    PreQual Cancel 5
           MOVE ZEROS TO YL0075 OF WORK-CONTEXT
      *    PreQual Target 5
           MOVE ZEROS TO YL0076 OF WORK-CONTEXT
      *    PreQual Order 6
           MOVE ZEROS TO YL0077 OF WORK-CONTEXT
      *    PreQual Cancel 6
           MOVE ZEROS TO YL0078 OF WORK-CONTEXT
      *    PreQual Target 6
           MOVE ZEROS TO YL0079 OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       UA7EXIT.
           EXIT.
      /EJECT
       UA8SUBR SECTION.
      *==============================================================
      *    Get Run Mode and Parameter setting an previous run
      *==============================================================
      *    Sequence Number
           MOVE ZEROS TO YL0080 OF WORK-CONTEXT
      *    Rtv parameter by default - Bonus Sls-Scheme Run Parm  *
           PERFORM SA3RVGN
      *    not fount then default seach
      *    CASE:
      *    - NOTc1 OR c2
      *    |- c1    : PGM.*Return code is *Normal
      *    |- c2    : LCL.Record Status is Deactive
      *    '-
      *    *IF
           IF (NOT (W0RTN = ' ') OR
               YL0086 OF WORK-CONTEXT = 'D') THEN
      *        *Return code
               MOVE SPACES TO W0RTN
               MOVE ' ' TO W0RTN
      *        Rtv parameter by default - Bonus Sls-Scheme Run Parm  *
               PERFORM SA4RVGN
      *        not found
      *        CASE:
      *        - NOTc1 OR c2
      *        |- c1    : PGM.*Return code is *Normal
      *        |- c2    : LCL.Record Status is Deactive
      *        '-
      *        *IF
               IF (NOT (W0RTN = ' ') OR
                   YL0086 OF WORK-CONTEXT = 'D') THEN
      *            * Default values
      *            Include Cancelled Orders
                   MOVE 'Y' TO YL0081 OF WORK-CONTEXT
      *            Include Unmatched Orders
                   MOVE 'Y' TO YL0082 OF WORK-CONTEXT
      *            U:Run Mode
                   MOVE '2' TO YL0085 OF WORK-CONTEXT
      *            Recalculate Order Ach Brn
                   MOVE 'Y' TO YL0083 OF WORK-CONTEXT
      *            Recalculate Reg Ach Brnd
                   MOVE 'Y' TO YL0084 OF WORK-CONTEXT
               END-IF
           END-IF
      *    rtv Run first or Previous run
      *    EXC Rtv Previous Run - Bonus Sls-Suggest DlrAch2  *
      *    Clear array PBRC
           INITIALIZE PBRC
      *    Bonus Scheme (8)
           MOVE QCBNSSCM OF FBNSSX9 OF SBBNSSGWL4-R TO PBBNSSCM
      *    Dealer number (Num key)
           ADD QCDLRNOKEY OF FBNSSX9 OF SBBNSSGWL4-R TO PBDLRNOKEY
      *
           SET C-INDICATOR-OFF(90) TO TRUE
           MOVE ZEROS TO WQ0001
           MOVE SPACES TO WQ0002
           MOVE SPACES TO WQ0003
           MOVE ZEROS TO WQ0004
           MOVE ZEROS TO WQ0005
           MOVE ZEROS TO WQ0006
           MOVE ZEROS TO WQ0007
           MOVE ZEROS TO WQ0008
           MOVE ZEROS TO WQ0009
           MOVE ZEROS TO WQ0010
           MOVE ZEROS TO WQ0011
           MOVE SPACES TO WQ0012
           MOVE SPACES TO WQ0013
           MOVE ZEROS TO WQ0014
           MOVE ZEROS TO WQ0015
           MOVE ZEROS TO WQ0016
           MOVE ZEROS TO WQ0017
           MOVE ZEROS TO WQ0018
           MOVE ZEROS TO WQ0019
           MOVE ZEROS TO WQ0020
           MOVE ZEROS TO WQ0021
           MOVE ZEROS TO WQ0022
           MOVE ZEROS TO WQ0023
           MOVE ZEROS TO WQ0024
           MOVE ZEROS TO WQ0025
           MOVE ZEROS TO WQ0026
           MOVE ZEROS TO WQ0027
           MOVE ZEROS TO WQ0028
           MOVE ZEROS TO WQ0029
           MOVE ZEROS TO WQ0030
           MOVE ZEROS TO WQ0031
           MOVE ZEROS TO WQ0032
           MOVE ZEROS TO WQ0033
           MOVE ZEROS TO WQ0034
           MOVE ZEROS TO WQ0035
           MOVE ZEROS TO WQ0036
           MOVE ZEROS TO WQ0037
           MOVE ZEROS TO WQ0038
           MOVE ZEROS TO WQ0039
           MOVE ZEROS TO WQ0040
           MOVE ZEROS TO WQ0041
           MOVE ZEROS TO WQ0042
           MOVE ZEROS TO WQ0043
           MOVE ZEROS TO WQ0044
           MOVE ZEROS TO WQ0045
           MOVE ZEROS TO WQ0046
           MOVE ZEROS TO WQ0047
           MOVE ZEROS TO WQ0048
           MOVE ZEROS TO WQ0049
           MOVE ZEROS TO WQ0050
           MOVE ZEROS TO WQ0051
           MOVE ZEROS TO WQ0052
           MOVE ZEROS TO WQ0053
           MOVE ZEROS TO WQ0054
           MOVE ZEROS TO WQ0055
           MOVE ZEROS TO WQ0056
           MOVE ZEROS TO WQ0057
           MOVE ZEROS TO WQ0058
           MOVE ZEROS TO WQ0059
           MOVE ZEROS TO WQ0060
           MOVE ZEROS TO WQ0061
           MOVE ZEROS TO WQ0062
           MOVE ZEROS TO WQ0063
           MOVE ZEROS TO WQ0064
           MOVE ZEROS TO WQ0065
           MOVE ZEROS TO WQ0066
           MOVE ZEROS TO WQ0067
           MOVE ZEROS TO WQ0068
           MOVE ZEROS TO WQ0069
           MOVE ZEROS TO WQ0070
           MOVE ZEROS TO WQ0071
           MOVE ZEROS TO WQ0072
           MOVE ZEROS TO WQ0073
           MOVE SPACES TO WQ0074
           MOVE ZEROS TO WQ0075
           MOVE ZEROS TO WQ0076
           MOVE ZEROS TO WQ0077
           MOVE ZEROS TO WQ0078
           MOVE ZEROS TO WQ0079
           MOVE ZEROS TO WQ0080
      *
           CALL 'SBA011010S' USING
      *    Return code
             W0RTN
      *    KEY : Bonus Sls-Suggest DlrAch2
             PBRC
      *    Run Number
             WQ0001
      *    Scheme Sequence
             WQ0002
      *    Achievement Band
             WQ0003
      *    No of Registrations
             WQ0004
      *    No of Order
             WQ0005
      *    No of Registrations cancl
             WQ0006
      *    No of Order Canceled
             WQ0007
      *    Target Value Registration
             WQ0008
      *    Target Value Order
             WQ0009
      *    Total Count Registration
             WQ0010
      *    Total Count Order
             WQ0011
      *    Achieved Pre-Qualifier
             WQ0012
      *    Achieved Pre-Qualifier 2
             WQ0013
      *    PreQual Reg/Ord 1
             WQ0014
      *    PreQual Reg/Ord 2
             WQ0015
      *    PreQual Reg/Ord 3
             WQ0016
      *    PreQual Reg/Ord 4
             WQ0017
      *    PreQual Reg/Ord 5
             WQ0018
      *    PreQual Reg/Ord 6
             WQ0019
      *    PreQual Reg/Ord 7
             WQ0020
      *    PreQual Reg/Ord 8
             WQ0021
      *    PreQual Reg/Ord 9
             WQ0022
      *    PreQual Reg/Ord 10
             WQ0023
      *    PreQual Reg/Ord 11
             WQ0024
      *    PreQual Reg/Ord 12
             WQ0025
      *    PreQual Reg/Ord 13
             WQ0026
      *    PreQual Reg/Ord 14
             WQ0027
      *    PreQual Reg/Ord 15
             WQ0028
      *    PreQual Reg/Ord 16
             WQ0029
      *    PreQual Reg/Ord 17
             WQ0030
      *    PreQual Reg/Ord 18
             WQ0031
      *    PreQual Reg/Ord 19
             WQ0032
      *    PreQual Reg/Ord 20
             WQ0033
      *    PreQual De-Reg/Ord 1
             WQ0034
      *    PreQual De-Reg/Ord 2
             WQ0035
      *    PreQual De-Reg/Ord 3
             WQ0036
      *    PreQual De-Reg/Ord 4
             WQ0037
      *    PreQual De-Reg/Ord 5
             WQ0038
      *    PreQual De-Reg/Ord 6
             WQ0039
      *    PreQual De-Reg/Ord 7
             WQ0040
      *    PreQual De-Reg/Ord 8
             WQ0041
      *    PreQual De-Reg/Ord 9
             WQ0042
      *    PreQual De-Reg/Ord 10
             WQ0043
      *    PreQual De-Reg/Ord 11
             WQ0044
      *    PreQual De-Reg/Ord 12
             WQ0045
      *    PreQual De-Reg/Ord 13
             WQ0046
      *    PreQual De-Reg/Ord 14
             WQ0047
      *    PreQual De-Reg/Ord 15
             WQ0048
      *    PreQual De-Reg/Ord 16
             WQ0049
      *    PreQual De-Reg/Ord 17
             WQ0050
      *    PreQual De-Reg/Ord 18
             WQ0051
      *    PreQual De-Reg/Ord 19
             WQ0052
      *    PreQual De-Reg/Ord 20
             WQ0053
      *    PreQual Target Reg/Ord 1
             WQ0054
      *    PreQual Target Reg/Ord 2
             WQ0055
      *    PreQual Target Reg/Ord 3
             WQ0056
      *    PreQual Target Reg/Ord 4
             WQ0057
      *    PreQual Target Reg/Ord 5
             WQ0058
      *    PreQual Target Reg/Ord 6
             WQ0059
      *    PreQual Target Reg/Ord 7
             WQ0060
      *    PreQual Target Reg/Ord 8
             WQ0061
      *    PreQual Target Reg/Ord 9
             WQ0062
      *    PreQual Target Reg/Ord 10
             WQ0063
      *    PreQual Target Reg/Ord 11
             WQ0064
      *    PreQual Target Reg/Ord 12
             WQ0065
      *    PreQual Target Reg/Ord 13
             WQ0066
      *    PreQual Target Reg/Ord 14
             WQ0067
      *    PreQual Target Reg/Ord 15
             WQ0068
      *    PreQual Target Reg/Ord 16
             WQ0069
      *    PreQual Target Reg/Ord 17
             WQ0070
      *    PreQual Target Reg/Ord 18
             WQ0071
      *    PreQual Target Reg/Ord 19
             WQ0072
      *    PreQual Target Reg/Ord 20
             WQ0073
      *    Run Mode
             WQ0074
      *    Order Band Achieved
             WQ0075
      *    Registration Band Ach
             WQ0076
      *    Manual Override Band
             WQ0077
      *    Overall Combined Ach Band
             WQ0078
      *    Manual Override Penalty
             WQ0079
      *    Overall Penalty
             WQ0080
                    ON OVERFLOW
                    SET C-INDICATOR-ON(90) TO TRUE
           END-CALL
      *
           MOVE WQ0014 TO YL0062 OF WORK-CONTEXT
           MOVE WQ0015 TO YL0065 OF WORK-CONTEXT
           MOVE WQ0016 TO YL0068 OF WORK-CONTEXT
           MOVE WQ0017 TO YL0071 OF WORK-CONTEXT
           MOVE WQ0018 TO YL0074 OF WORK-CONTEXT
           MOVE WQ0019 TO YL0077 OF WORK-CONTEXT
           MOVE WQ0034 TO YL0063 OF WORK-CONTEXT
           MOVE WQ0035 TO YL0066 OF WORK-CONTEXT
           MOVE WQ0036 TO YL0069 OF WORK-CONTEXT
           MOVE WQ0037 TO YL0072 OF WORK-CONTEXT
           MOVE WQ0038 TO YL0075 OF WORK-CONTEXT
           MOVE WQ0039 TO YL0078 OF WORK-CONTEXT
           MOVE WQ0054 TO YL0064 OF WORK-CONTEXT
           MOVE WQ0055 TO YL0067 OF WORK-CONTEXT
           MOVE WQ0056 TO YL0070 OF WORK-CONTEXT
           MOVE WQ0057 TO YL0073 OF WORK-CONTEXT
           MOVE WQ0058 TO YL0076 OF WORK-CONTEXT
           MOVE WQ0059 TO YL0079 OF WORK-CONTEXT
           MOVE WQ0075 TO YL0087 OF WORK-CONTEXT
           MOVE WQ0076 TO YL0088 OF WORK-CONTEXT
           MOVE WQ0078 TO YL0089 OF WORK-CONTEXT
           MOVE WQ0080 TO YL0090 OF WORK-CONTEXT
      *
      *    Error on program call will terminate run unit
           IF (C-INDICATOR-ON(90)) THEN
               MOVE 'Y2U0032' TO W0RTN
               MOVE 'SBA011010S' TO W0CLPG
      *        Send message '*Error occured on CALL...'
      *        Message ID
               MOVE 'Y2U0032' TO ZAMSID
      *        Message file
               MOVE 'Y2USRMSG' TO ZAMSGF
      *        Message data
               MOVE W0CLPG TO ZAMSDA
               PERFORM ZASNMS
           END-IF
      *    Error detected?
           IF (W0RTN        NOT = SPACES) THEN
               SET C-INDICATOR-ON(99) TO TRUE
           END-IF
      *    CASE:
      *    - NOTc1
      *    |- c1    : PGM.*Return code is *Normal
      *    '-
      *    *IF
           IF (NOT (W0RTN = ' ')) THEN
      *        Initial Run
               MOVE 'Y' TO YL0091 OF WORK-CONTEXT
           ELSE
      *        CASE: *OTHERWISE
      *        Initial Run
               MOVE 'N' TO YL0091 OF WORK-CONTEXT
           END-IF
      *    Bad data in file parameter
           PERFORM UA9SUBR
      *==============================================================
           CONTINUE.
       UA8EXIT.
           EXIT.
      /EJECT
       UA9SUBR SECTION.
      *==============================================================
      *    Bad data in file parameter
      *==============================================================
      *    CASE: LCL.Include Cancelled Orders is Unknow
      *    *IF
           IF (YL0081 OF WORK-CONTEXT = ' ') THEN
      *        Include Cancelled Orders
               MOVE 'Y' TO YL0081 OF WORK-CONTEXT
           END-IF
      *    CASE: LCL.Include Unmatched Orders is Unknow
      *    *IF
           IF (YL0082 OF WORK-CONTEXT = ' ') THEN
      *        Include Unmatched Orders
               MOVE 'Y' TO YL0082 OF WORK-CONTEXT
           END-IF
      *    CASE: LCL.U:Run Mode is *Blank
      *    *IF
           IF (YL0085 OF WORK-CONTEXT = ' ') THEN
      *        U:Run Mode
               MOVE '2' TO YL0085 OF WORK-CONTEXT
           END-IF
      *    CASE: LCL.Recalculate Order Ach Brn is Unknow
      *    *IF
           IF (YL0083 OF WORK-CONTEXT = ' ') THEN
      *        Recalculate Order Ach Brn
               MOVE 'N' TO YL0083 OF WORK-CONTEXT
           END-IF
      *    CASE: LCL.Recalculate Reg Ach Brnd is Unknow
      *    *IF
           IF (YL0084 OF WORK-CONTEXT = ' ') THEN
      *        Recalculate Reg Ach Brnd
               MOVE 'N' TO YL0084 OF WORK-CONTEXT
           END-IF
      *==============================================================
           CONTINUE.
       UA9EXIT.
           EXIT.
      /EJECT
       UB1SUBR SECTION.
      *==============================================================
      *    Convert dealer to 4+2, get region code etc, get Dacia dealer
      *==============================================================
      *    Renault dealer
      *    Cvt Num Dlr to Dlr/DB cde - #Standard Functions  *
     E* Y2V3114 - Source member UFGDLR2DBS not found.
           MOVE ZEROS TO YRSW03
           MOVE 'T' TO YRSW05
           IF (WUDLRNO OF WORK-CONTEXT = SPACES AND
               YRSW05 = 'T') THEN
               ADD  1 TO ZEROS GIVING YRSW04
           ELSE
               ADD  1 TO 00004 GIVING YRSW04
           END-IF
           MOVE 00004 TO YRSW02
           MOVE WUDLRNO OF WORK-CONTEXT TO YRSW06
           PERFORM ZCATWK
           STRING YRSW06 DELIMITED BY X'FF',
                  WUUDLRSFX OF WORK-CONTEXT DELIMITED BY SIZE
           INTO   YRSW06
           MOVE YRSW06 TO WUNECO OF WORK-CONTEXT
      *    Dacia Dealer
      *    Ext Rtv Dacia Dealer Rlte - #Foreign model access  * Get
      *      Dacia Suffix
           SET C-INDICATOR-OFF(90) TO TRUE
           MOVE SPACES TO WQ0081
           MOVE WUNECO OF WORK-CONTEXT TO WQ0082
           MOVE SPACES TO WQ0083
           MOVE SPACES TO WQ0084
      *
           CALL 'VSD000720S' USING
      *    U:Return Code Id
             WQ0081
      *    SD Relates to Dealer
             WQ0082
      *    SD Dealer Number
             WQ0083
      *    Owning Account
             WQ0084
                    ON OVERFLOW
                    SET C-INDICATOR-ON(90) TO TRUE
           END-CALL
      *
           MOVE WQ0081 TO YL0092 OF WORK-CONTEXT
           MOVE WQ0083 TO YL0093 OF WORK-CONTEXT
           MOVE WQ0084 TO YL0094 OF WORK-CONTEXT
      *
      *    Error on program call will terminate run unit
           IF (C-INDICATOR-ON(90)) THEN
               MOVE 'Y2U0032' TO W0RTN
               MOVE 'VSD000720S' TO W0CLPG
      *        Send message '*Error occured on CALL...'
      *        Message ID
               MOVE 'Y2U0032' TO ZAMSID
      *        Message file
               MOVE 'Y2USRMSG' TO ZAMSGF
      *        Message data
               MOVE W0CLPG TO ZAMSDA
               PERFORM ZASNMS
               SET C-INDICATOR-ON(99) TO TRUE
           END-IF
           IF (YL0093 OF WORK-CONTEXT = SPACES) THEN
               MOVE ZERO TO YL0095 OF WORK-CONTEXT
           ELSE
               MOVE YL0093 OF WORK-CONTEXT TO YL0095 OF WORK-CONTEXT
           END-IF
      *    Cvt Num Dlr to Dlr/DB cde - #Standard Functions  *
     E* Y2V3114 - Source member UFGDLR2DBS not found.
           MOVE ZEROS TO YRSW03
           MOVE 'T' TO YRSW05
           IF (WUWECF OF WORK-CONTEXT = SPACES AND
               YRSW05 = 'T') THEN
               ADD  1 TO ZEROS GIVING YRSW04
           ELSE
               ADD  1 TO 00004 GIVING YRSW04
           END-IF
           MOVE 00004 TO YRSW02
           MOVE WUWECF OF WORK-CONTEXT TO YRSW06
           PERFORM ZCATWK
           STRING YRSW06 DELIMITED BY X'FF',
                  WUWFCF OF WORK-CONTEXT DELIMITED BY SIZE
           INTO   YRSW06
           MOVE YRSW06 TO WUTOCF OF WORK-CONTEXT
      *    Same For both
      *    Rtv Dealer Regn & Zone - Bonus Sls-Dealer Parms  *
           PERFORM SA5RVGN
      *    Rtv Dlr Network Type - Dealer  *
           PERFORM SA6RVGN
      *==============================================================
           CONTINUE.
       UB1EXIT.
           EXIT.
      /EJECT
       UB2SUBR SECTION.
      *==============================================================
      *    Registration
      *==============================================================
      *    Penalty  Registration Milestone
           PERFORM UB3SUBR
      *    Q4 Pay
           PERFORM UE2SUBR
      *    not inital or not Re-calculate  mode
      *    CASE:
      *    - c1 AND c2
      *    |- c1    : LCL.Recalculate Reg Ach Brnd is N
      *    |- c2    : LCL.Initial Run is N
      *    '-
      *    *IF
           IF (YL0084 OF WORK-CONTEXT = 'N' AND
               YL0091 OF WORK-CONTEXT = 'N') THEN
      *        U:Payment Band
               MOVE YL0088 OF WORK-CONTEXT TO WUWCNU OF WORK-CONTEXT
      *        Percentage Penalty
               MOVE YL0090 OF WORK-CONTEXT TO YL0001 OF WORK-CONTEXT
           END-IF
      *==============================================================
           CONTINUE.
       UB2EXIT.
           EXIT.
      /EJECT
       UB3SUBR SECTION.
      *==============================================================
      *    Penalty  Registration Milestone
      *==============================================================
      *    October  (1M)
           PERFORM UB4SUBR
      *    November + Overachievement (2M)
           PERFORM UC4SUBR
      *==============================================================
           CONTINUE.
       UB3EXIT.
           EXIT.
      /EJECT
       UB4SUBR SECTION.
      *==============================================================
      *    October  (1M)
      *==============================================================
      *    Targets for  TT1017  (P11 P12)
           PERFORM UB5SUBR
      *    Registrations for TT1017 (P11 P12)
           PERFORM UB9SUBR
      *    Archivent P13 ,net total
           PERFORM UC3SUBR
      *    Penalty 1M
      *    CASE: LCL.PreQual Net 1 OCTOBER LT LCL.PreQual Target Reg 6
      *    *IF
           IF (YL0006 OF WORK-CONTEXT < YL0162 OF WORK-CONTEXT) THEN
      *        NE 100% = penalty 20%
      *        Percentage Penalty
               ADD YL0001 OF WORK-CONTEXT, 20 GIVING YL0001 OF
                 WORK-CONTEXT
           END-IF
      *==============================================================
           CONTINUE.
       UB4EXIT.
           EXIT.
      /EJECT
       UB5SUBR SECTION.
      *==============================================================
      *    Targets for  TT1017  (P11 P12)
      *==============================================================
      *    Total Targets per Band
           PERFORM UB6SUBR
      *==============================================================
           CONTINUE.
       UB5EXIT.
           EXIT.
      /EJECT
       UB6SUBR SECTION.
      *==============================================================
      *    Total Targets per Band
      *==============================================================
      *    Total Targets for CAR + VAN - Renault
           PERFORM UB7SUBR
      *    Total Targets for CAR + VAN - Dacia
           PERFORM UB8SUBR
      *==============================================================
           CONTINUE.
       UB6EXIT.
           EXIT.
      /EJECT
       UB7SUBR SECTION.
      *==============================================================
      *    Total Targets for CAR + VAN - Renault
      *==============================================================
      *    U:Target Total a
           MOVE ZEROS TO YL0097 OF WORK-CONTEXT
      *    U:Target Total a
           MOVE ZEROS TO WUTGTTOTA OF WORK-CONTEXT
      *    Rtv Target Value (Single) - Target Information  * Car
           PERFORM SA7RVGN
      *    U:Target Total a
           MULTIPLY YL0097 OF WORK-CONTEXT BY 1 GIVING WUTGTTOTA OF
             WORK-CONTEXT
      *    U:Target Total a
           MOVE ZEROS TO YL0097 OF WORK-CONTEXT
      *    Rtv Target Value (Single) - Target Information  * Van
           PERFORM SA8RVGN
      *    U:Target Total a
           ADD WUTGTTOTA OF WORK-CONTEXT, YL0097 OF WORK-CONTEXT GIVING
             WUTGTTOTA OF WORK-CONTEXT
      *    PreQual Target Reg/Ord 11
           MULTIPLY WUTGTTOTA OF WORK-CONTEXT BY 1 GIVING YL0028 OF
             WORK-CONTEXT
      *==============================================================
           CONTINUE.
       UB7EXIT.
           EXIT.
      /EJECT
       UB8SUBR SECTION.
      *==============================================================
      *    Total Targets for CAR + VAN - Dacia
      *==============================================================
      *    U:Target Dacia
           MOVE ZEROS TO WULTVB OF WORK-CONTEXT
      *    U:Target Dacia
           MOVE ZEROS TO YL0098 OF WORK-CONTEXT
      *    U:Target Total DACIA
           MOVE ZEROS TO WUNHVB OF WORK-CONTEXT
      *    Rtv Target Value (Single) - Target Information  * Dacia car
           PERFORM SA9RVGN
      *    U:Target Dacia
           MULTIPLY YL0098 OF WORK-CONTEXT BY 1 GIVING WULTVB OF
             WORK-CONTEXT
      *    U:Target Dacia
           MOVE ZEROS TO YL0098 OF WORK-CONTEXT
      *    Rtv Target Value (Single) - Target Information  * Van
           PERFORM SB1RVGN
      *    U:Target Total DACIA
           ADD WULTVB OF WORK-CONTEXT, YL0098 OF WORK-CONTEXT GIVING
             WUNHVB OF WORK-CONTEXT
      *    PreQual Target Reg/Ord 12
           MULTIPLY WUNHVB OF WORK-CONTEXT BY 1 GIVING YL0032 OF
             WORK-CONTEXT
      *==============================================================
           CONTINUE.
       UB8EXIT.
           EXIT.
      /EJECT
       UB9SUBR SECTION.
      *==============================================================
      *    Registrations for TT1017 (P11 P12)
      *==============================================================
      *    Renault Reg and De-reg
           PERFORM UC1SUBR
      *    Dacia, Reg and De-reg
           PERFORM UC2SUBR
      *==============================================================
           CONTINUE.
       UB9EXIT.
           EXIT.
      /EJECT
       UC1SUBR SECTION.
      *==============================================================
      *    Renault Reg and De-reg
      *==============================================================
      *    Get number of live Registrations
      *    Rtv No of Regs TCTT - BDC.-.SEDRE DOT Extract  *
           PERFORM SB2RVGN
      *    Do the same for Cancelled Registrations
      *    Rtv No of Regs Derg TCTT - BDC.-.SEDRE DOT Extract  *
           PERFORM SB6RVGN
      *    Registrations
      *    LCL.PreQual Reg/Ord 11 =
      *    *COMPUTE (x1 + x2 + x3 + x4 + x5 + x6)
      *    x1    : LCL.U:Pay Cat 1 Regs
      *    +     : PGM.*Synon (17,7) work field
      *    x2    : LCL.U:Pay Cat 2 Regs
      *    +     : PGM.*Synon (17,7) work field
      *    x3    : LCL.U:Pay Cat 3 Regs
      *    +     : PGM.*Synon (17,7) work field
      *    x4    : LCL.U:Pay Cat 4 Regs
      *    +     : PGM.*Synon (17,7) work field
      *    x5    : LCL.U:Pay Cat 5 Regs
      *    +     : PGM.*Synon (17,7) work field
      *    x6    : LCL.U:Pay Cat N Regs
      *    *Synon (17,7) work field
           ADD YL0100 OF WORK-CONTEXT, YL0101 OF WORK-CONTEXT GIVING
             W0WD04
      *    *Synon (17,7) work field
           ADD W0WD04, YL0102 OF WORK-CONTEXT GIVING W0WD03
      *    *Synon (17,7) work field
           ADD W0WD03, YL0103 OF WORK-CONTEXT GIVING W0WD02
      *    *Synon (17,7) work field
           ADD W0WD02, YL0104 OF WORK-CONTEXT GIVING W0WD01
      *    *Synon (17,7) work field
           ADD W0WD01, YL0105 OF WORK-CONTEXT GIVING W0WD00
      *    PreQual Reg/Ord 11
           MOVE W0WD00 TO YL0025 OF WORK-CONTEXT
      *    De-Registrations
      *    LCL.PreQual De-Reg/Ord 11 =
      *    *COMPUTE (x1 + x2 + x3 + x4 + x5 + x6)
      *    x1    : LCL.U:Pay Cat 1 De-Regs
      *    +     : PGM.*Synon (17,7) work field
      *    x2    : LCL.U:Pay Cat 2 De-Regs
      *    +     : PGM.*Synon (17,7) work field
      *    x3    : LCL.U:Pay Cat 3 De-Regs
      *    +     : PGM.*Synon (17,7) work field
      *    x4    : LCL.U:Pay Cat 4 De-Regs
      *    +     : PGM.*Synon (17,7) work field
      *    x5    : LCL.U:Pay Cat 5 De-Regs
      *    +     : PGM.*Synon (17,7) work field
      *    x6    : LCL.U:Pay Cat N De-Regs
      *    *Synon (17,7) work field
           ADD YL0124 OF WORK-CONTEXT, YL0125 OF WORK-CONTEXT GIVING
             W0WD04
      *    *Synon (17,7) work field
           ADD W0WD04, YL0126 OF WORK-CONTEXT GIVING W0WD03
      *    *Synon (17,7) work field
           ADD W0WD03, YL0127 OF WORK-CONTEXT GIVING W0WD02
      *    *Synon (17,7) work field
           ADD W0WD02, YL0128 OF WORK-CONTEXT GIVING W0WD01
      *    *Synon (17,7) work field
           ADD W0WD01, YL0129 OF WORK-CONTEXT GIVING W0WD00
      *    PreQual De-Reg/Ord 11
           MOVE W0WD00 TO YL0026 OF WORK-CONTEXT
      *    PreQual Net Reg/Ord 11
           SUBTRACT YL0026 OF WORK-CONTEXT FROM YL0025 OF WORK-CONTEXT
             GIVING YL0027 OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       UC1EXIT.
           EXIT.
      /EJECT
       UC2SUBR SECTION.
      *==============================================================
      *    Dacia, Reg and De-reg
      *==============================================================
      *    Get number of live Registrations Dacia
      *    Rtv No of Regs TCTT - BDC.-.SEDRE DOT Extract  *
           PERFORM SC1RVGN
      *    Do the same for Cancelled Registrations Dacia
      *    Rtv No of Regs Derg TCTT - BDC.-.SEDRE DOT Extract  *
           PERFORM SC5RVGN
      *    Copute Regs and De-Regs Dacia
      *    Registrations
      *    LCL.PreQual Reg/Ord 12 =
      *    *COMPUTE (x1 + x2 + x3 + x4 + x5 + x6 +
      *    x7)
      *    x1    : LCL.U:Pay Cat 1 Regs DACIA
      *    +     : PGM.*Synon (17,7) work field
      *    x2    : LCL.U:Pay Cat 2 Regs DACIA
      *    +     : PGM.*Synon (17,7) work field
      *    x3    : LCL.U:Pay Cat 3 Regs DACIA
      *    +     : PGM.*Synon (17,7) work field
      *    x4    : LCL.U:Pay Cat 4 Regs DACIA
      *    +     : PGM.*Synon (17,7) work field
      *    x5    : LCL.U:Pay Cat 5 Regs DACIA
      *    +     : PGM.*Synon (17,7) work field
      *    x6    : LCL.U:Pay Cat N Regs DACIA
      *    +     : PGM.*Synon (17,7) work field
      *    x7    : LCL.U:Pay Cat O Regs DACIA
      *    *Synon (17,7) work field
           ADD YL0148 OF WORK-CONTEXT, YL0149 OF WORK-CONTEXT GIVING
             W0WD05
      *    *Synon (17,7) work field
           ADD W0WD05, YL0150 OF WORK-CONTEXT GIVING W0WD04
      *    *Synon (17,7) work field
           ADD W0WD04, YL0151 OF WORK-CONTEXT GIVING W0WD03
      *    *Synon (17,7) work field
           ADD W0WD03, YL0152 OF WORK-CONTEXT GIVING W0WD02
      *    *Synon (17,7) work field
           ADD W0WD02, YL0153 OF WORK-CONTEXT GIVING W0WD01
      *    *Synon (17,7) work field
           ADD W0WD01, YL0154 OF WORK-CONTEXT GIVING W0WD00
      *    PreQual Reg/Ord 12
           MOVE W0WD00 TO YL0029 OF WORK-CONTEXT
      *    De-Registrations
      *    LCL.PreQual De-Reg/Ord 12 =
      *    *COMPUTE (x1 + x2 + x3 + x4 + x5 + x6 +
      *    x7)
      *    x1    : LCL.U:Pay Cat 1 De-Regs DACIA
      *    +     : PGM.*Synon (17,7) work field
      *    x2    : LCL.U:Pay Cat 2 De-Regs DACIA
      *    +     : PGM.*Synon (17,7) work field
      *    x3    : LCL.U:Pay Cat 3 De-Regs DACIA
      *    +     : PGM.*Synon (17,7) work field
      *    x4    : LCL.U:Pay Cat 4 De-Regs DACIA
      *    +     : PGM.*Synon (17,7) work field
      *    x5    : LCL.U:Pay Cat 5 De-Regs DACIA
      *    +     : PGM.*Synon (17,7) work field
      *    x6    : LCL.U:Pay Cat N De-Regs DACIA
      *    +     : PGM.*Synon (17,7) work field
      *    x7    : LCL.U:Pay Cat O De-Regs DACIA
      *    *Synon (17,7) work field
           ADD YL0155 OF WORK-CONTEXT, YL0156 OF WORK-CONTEXT GIVING
             W0WD05
      *    *Synon (17,7) work field
           ADD W0WD05, YL0157 OF WORK-CONTEXT GIVING W0WD04
      *    *Synon (17,7) work field
           ADD W0WD04, YL0158 OF WORK-CONTEXT GIVING W0WD03
      *    *Synon (17,7) work field
           ADD W0WD03, YL0159 OF WORK-CONTEXT GIVING W0WD02
      *    *Synon (17,7) work field
           ADD W0WD02, YL0160 OF WORK-CONTEXT GIVING W0WD01
      *    *Synon (17,7) work field
           ADD W0WD01, YL0161 OF WORK-CONTEXT GIVING W0WD00
      *    PreQual De-Reg/Ord 12
           MOVE W0WD00 TO YL0030 OF WORK-CONTEXT
      *    PreQual Net Reg/Ord 12
           SUBTRACT YL0030 OF WORK-CONTEXT FROM YL0029 OF WORK-CONTEXT
             GIVING YL0031 OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       UC2EXIT.
           EXIT.
      /EJECT
       UC3SUBR SECTION.
      *==============================================================
      *    Archivent P13 ,net total
      *==============================================================
      *    P13 registration Ranault + Dacia
      *    PreQual Reg/Ord 13
           ADD YL0029 OF WORK-CONTEXT, YL0025 OF WORK-CONTEXT GIVING
             YL0033 OF WORK-CONTEXT
      *    P13 De-Reg  Registration Renault + Dacia
      *    PreQual De-Reg/Ord 13
           ADD YL0030 OF WORK-CONTEXT, YL0026 OF WORK-CONTEXT GIVING
             YL0034 OF WORK-CONTEXT
      *    P13 Target - Renault + Dacia
      *    PreQual Target Reg/Ord 13
           ADD YL0032 OF WORK-CONTEXT, YL0028 OF WORK-CONTEXT GIVING
             YL0036 OF WORK-CONTEXT
      *    total Net Target - Renault + Dacia
      *    PreQual Net 1 OCTOBER
           ADD YL0031 OF WORK-CONTEXT, YL0027 OF WORK-CONTEXT GIVING
             YL0006 OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       UC3EXIT.
           EXIT.
      /EJECT
       UC4SUBR SECTION.
      *==============================================================
      *    November + Overachievement (2M)
      *==============================================================
      *    * October
      *    Targets for  TT1117  (P15, P16)
           PERFORM UC5SUBR
      *    Registrations for TT1117 (P15 P16)
           PERFORM UC9SUBR
      *    * October + November for Overachievement
      *    Targets for  TTON17 (P18 P19)
           PERFORM UD3SUBR
      *    Registrations for TTON17 (P18 P19)
           PERFORM UD7SUBR
      *    Archivent P17, P20 ,net total
           PERFORM UE1SUBR
      *    Penalty 2M
      *    CASE: LCL.PreQual Net 1 OCTOBER GT LCL.PreQual Target
      *      Reg/Ord 13
      *    *IF
           IF (YL0006 OF WORK-CONTEXT > YL0036 OF WORK-CONTEXT) THEN
      *        Overachievement penalty
      *        CASE: LCL.PreQual Net A LT LCL.PreQual Target Reg/Ord 20
      *        *IF
               IF (YL0008 OF WORK-CONTEXT < YL0056 OF WORK-CONTEXT) THEN
      *            NE 100% = penalty 20%
      *            Percentage Penalty
                   ADD YL0001 OF WORK-CONTEXT, 20 GIVING YL0001 OF
                     WORK-CONTEXT
               END-IF
           ELSE
      *        CASE: *OTHERWISE
      *        Normal  penalty
      *        CASE: LCL.PreQual Net 1 NOVEMBER LT LCL.PreQual Target
      *          Reg/Ord 17
      *        *IF
               IF (YL0007 OF WORK-CONTEXT < YL0044 OF WORK-CONTEXT) THEN
      *            NE 100% = penalty 20%
      *            Percentage Penalty
                   ADD YL0001 OF WORK-CONTEXT, 20 GIVING YL0001 OF
                     WORK-CONTEXT
               END-IF
           END-IF
      *==============================================================
           CONTINUE.
       UC4EXIT.
           EXIT.
      /EJECT
       UC5SUBR SECTION.
      *==============================================================
      *    Targets for  TT1117  (P15, P16)
      *==============================================================
      *    Total Targets per Band
           PERFORM UC6SUBR
      *==============================================================
           CONTINUE.
       UC5EXIT.
           EXIT.
      /EJECT
       UC6SUBR SECTION.
      *==============================================================
      *    Total Targets per Band
      *==============================================================
      *    Total Targets for CAR + VAN - Renault
           PERFORM UC7SUBR
      *    Total Targets for CAR + VAN - Dacia
           PERFORM UC8SUBR
      *==============================================================
           CONTINUE.
       UC6EXIT.
           EXIT.
      /EJECT
       UC7SUBR SECTION.
      *==============================================================
      *    Total Targets for CAR + VAN - Renault
      *==============================================================
      *    U:Target Total a
           MOVE ZEROS TO YL0097 OF WORK-CONTEXT
      *    U:Target Total a
           MOVE ZEROS TO WUTGTTOTA OF WORK-CONTEXT
      *    Rtv Target Value (Single) - Target Information  * Car
           PERFORM SC9RVGN
      *    U:Target Total a
           MULTIPLY YL0097 OF WORK-CONTEXT BY 1 GIVING WUTGTTOTA OF
             WORK-CONTEXT
      *    U:Target Total a
           MOVE ZEROS TO YL0097 OF WORK-CONTEXT
      *    Rtv Target Value (Single) - Target Information  * Van
           PERFORM SD1RVGN
      *    U:Target Total a
           ADD WUTGTTOTA OF WORK-CONTEXT, YL0097 OF WORK-CONTEXT GIVING
             WUTGTTOTA OF WORK-CONTEXT
      *    PreQual Target Reg/Ord 15
           MULTIPLY WUTGTTOTA OF WORK-CONTEXT BY 1 GIVING YL0163 OF
             WORK-CONTEXT
      *==============================================================
           CONTINUE.
       UC7EXIT.
           EXIT.
      /EJECT
       UC8SUBR SECTION.
      *==============================================================
      *    Total Targets for CAR + VAN - Dacia
      *==============================================================
      *    U:Target Dacia
           MOVE ZEROS TO WULTVB OF WORK-CONTEXT
      *    U:Target Dacia
           MOVE ZEROS TO YL0098 OF WORK-CONTEXT
      *    U:Target Total DACIA
           MOVE ZEROS TO WUNHVB OF WORK-CONTEXT
      *    Rtv Target Value (Single) - Target Information  * Dacia car
           PERFORM SD2RVGN
      *    U:Target Dacia
           MULTIPLY YL0098 OF WORK-CONTEXT BY 1 GIVING WULTVB OF
             WORK-CONTEXT
      *    U:Target Dacia
           MOVE ZEROS TO YL0098 OF WORK-CONTEXT
      *    Rtv Target Value (Single) - Target Information  * Van
           PERFORM SD3RVGN
      *    U:Target Total DACIA
           ADD WULTVB OF WORK-CONTEXT, YL0098 OF WORK-CONTEXT GIVING
             WUNHVB OF WORK-CONTEXT
      *    PreQual Target Reg/Ord 16
           MULTIPLY WUNHVB OF WORK-CONTEXT BY 1 GIVING YL0040 OF
             WORK-CONTEXT
      *==============================================================
           CONTINUE.
       UC8EXIT.
           EXIT.
      /EJECT
       UC9SUBR SECTION.
      *==============================================================
      *    Registrations for TT1117 (P15 P16)
      *==============================================================
      *    Renault Reg and De-reg
           PERFORM UD1SUBR
      *    Dacia, Reg and De-reg
           PERFORM UD2SUBR
      *==============================================================
           CONTINUE.
       UC9EXIT.
           EXIT.
      /EJECT
       UD1SUBR SECTION.
      *==============================================================
      *    Renault Reg and De-reg
      *==============================================================
      *    Get number of live Registrations
      *    Rtv No of Regs TCTT - BDC.-.SEDRE DOT Extract  *
           PERFORM SD4RVGN
      *    Do the same for Cancelled Registrations
      *    Rtv No of Regs Derg TCTT - BDC.-.SEDRE DOT Extract  *
           PERFORM SD8RVGN
      *    Registrations
      *    LCL.PreQual Reg/Ord 15 =
      *    *COMPUTE (x1 + x2 + x3 + x4 + x5 + x6)
      *    x1    : LCL.U:Pay Cat 1 Regs
      *    +     : PGM.*Synon (17,7) work field
      *    x2    : LCL.U:Pay Cat 2 Regs
      *    +     : PGM.*Synon (17,7) work field
      *    x3    : LCL.U:Pay Cat 3 Regs
      *    +     : PGM.*Synon (17,7) work field
      *    x4    : LCL.U:Pay Cat 4 Regs
      *    +     : PGM.*Synon (17,7) work field
      *    x5    : LCL.U:Pay Cat 5 Regs
      *    +     : PGM.*Synon (17,7) work field
      *    x6    : LCL.U:Pay Cat N Regs
      *    *Synon (17,7) work field
           ADD YL0100 OF WORK-CONTEXT, YL0101 OF WORK-CONTEXT GIVING
             W0WD04
      *    *Synon (17,7) work field
           ADD W0WD04, YL0102 OF WORK-CONTEXT GIVING W0WD03
      *    *Synon (17,7) work field
           ADD W0WD03, YL0103 OF WORK-CONTEXT GIVING W0WD02
      *    *Synon (17,7) work field
           ADD W0WD02, YL0104 OF WORK-CONTEXT GIVING W0WD01
      *    *Synon (17,7) work field
           ADD W0WD01, YL0105 OF WORK-CONTEXT GIVING W0WD00
      *    PreQual Reg/Ord 15
           MOVE W0WD00 TO YL0164 OF WORK-CONTEXT
      *    De-Registrations
      *    LCL.PreQual De-Reg/Ord 15 =
      *    *COMPUTE (x1 + x2 + x3 + x4 + x5 + x6)
      *    x1    : LCL.U:Pay Cat 1 De-Regs
      *    +     : PGM.*Synon (17,7) work field
      *    x2    : LCL.U:Pay Cat 2 De-Regs
      *    +     : PGM.*Synon (17,7) work field
      *    x3    : LCL.U:Pay Cat 3 De-Regs
      *    +     : PGM.*Synon (17,7) work field
      *    x4    : LCL.U:Pay Cat 4 De-Regs
      *    +     : PGM.*Synon (17,7) work field
      *    x5    : LCL.U:Pay Cat 5 De-Regs
      *    +     : PGM.*Synon (17,7) work field
      *    x6    : LCL.U:Pay Cat N De-Regs
      *    *Synon (17,7) work field
           ADD YL0124 OF WORK-CONTEXT, YL0125 OF WORK-CONTEXT GIVING
             W0WD04
      *    *Synon (17,7) work field
           ADD W0WD04, YL0126 OF WORK-CONTEXT GIVING W0WD03
      *    *Synon (17,7) work field
           ADD W0WD03, YL0127 OF WORK-CONTEXT GIVING W0WD02
      *    *Synon (17,7) work field
           ADD W0WD02, YL0128 OF WORK-CONTEXT GIVING W0WD01
      *    *Synon (17,7) work field
           ADD W0WD01, YL0129 OF WORK-CONTEXT GIVING W0WD00
      *    PreQual De-Reg/Ord 15
           MOVE W0WD00 TO YL0165 OF WORK-CONTEXT
      *    PreQual Net Reg/Ord 15
           SUBTRACT YL0165 OF WORK-CONTEXT FROM YL0164 OF WORK-CONTEXT
             GIVING YL0166 OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       UD1EXIT.
           EXIT.
      /EJECT
       UD2SUBR SECTION.
      *==============================================================
      *    Dacia, Reg and De-reg
      *==============================================================
      *    Get number of live Registrations Dacia
      *    Rtv No of Regs TCTT - BDC.-.SEDRE DOT Extract  *
           PERFORM SE3RVGN
      *    Do the same for Cancelled Registrations Dacia
      *    Rtv No of Regs Derg TCTT - BDC.-.SEDRE DOT Extract  *
           PERFORM SE7RVGN
      *    Copute Regs and De-Regs Dacia
      *    Registrations
      *    LCL.PreQual Reg/Ord 16 =
      *    *COMPUTE (x1 + x2 + x3 + x4 + x5 + x6 +
      *    x7)
      *    x1    : LCL.U:Pay Cat 1 Regs DACIA
      *    +     : PGM.*Synon (17,7) work field
      *    x2    : LCL.U:Pay Cat 2 Regs DACIA
      *    +     : PGM.*Synon (17,7) work field
      *    x3    : LCL.U:Pay Cat 3 Regs DACIA
      *    +     : PGM.*Synon (17,7) work field
      *    x4    : LCL.U:Pay Cat 4 Regs DACIA
      *    +     : PGM.*Synon (17,7) work field
      *    x5    : LCL.U:Pay Cat 5 Regs DACIA
      *    +     : PGM.*Synon (17,7) work field
      *    x6    : LCL.U:Pay Cat N Regs DACIA
      *    +     : PGM.*Synon (17,7) work field
      *    x7    : LCL.U:Pay Cat O Regs DACIA
      *    *Synon (17,7) work field
           ADD YL0148 OF WORK-CONTEXT, YL0149 OF WORK-CONTEXT GIVING
             W0WD05
      *    *Synon (17,7) work field
           ADD W0WD05, YL0150 OF WORK-CONTEXT GIVING W0WD04
      *    *Synon (17,7) work field
           ADD W0WD04, YL0151 OF WORK-CONTEXT GIVING W0WD03
      *    *Synon (17,7) work field
           ADD W0WD03, YL0152 OF WORK-CONTEXT GIVING W0WD02
      *    *Synon (17,7) work field
           ADD W0WD02, YL0153 OF WORK-CONTEXT GIVING W0WD01
      *    *Synon (17,7) work field
           ADD W0WD01, YL0154 OF WORK-CONTEXT GIVING W0WD00
      *    PreQual Reg/Ord 16
           MOVE W0WD00 TO YL0037 OF WORK-CONTEXT
      *    De-Registrations
      *    LCL.PreQual De-Reg/Ord 16 =
      *    *COMPUTE (x1 + x2 + x3 + x4 + x5 + x6 +
      *    x7)
      *    x1    : LCL.U:Pay Cat 1 De-Regs DACIA
      *    +     : PGM.*Synon (17,7) work field
      *    x2    : LCL.U:Pay Cat 2 De-Regs DACIA
      *    +     : PGM.*Synon (17,7) work field
      *    x3    : LCL.U:Pay Cat 3 De-Regs DACIA
      *    +     : PGM.*Synon (17,7) work field
      *    x4    : LCL.U:Pay Cat 4 De-Regs DACIA
      *    +     : PGM.*Synon (17,7) work field
      *    x5    : LCL.U:Pay Cat 5 De-Regs DACIA
      *    +     : PGM.*Synon (17,7) work field
      *    x6    : LCL.U:Pay Cat N De-Regs DACIA
      *    +     : PGM.*Synon (17,7) work field
      *    x7    : LCL.U:Pay Cat O De-Regs DACIA
      *    *Synon (17,7) work field
           ADD YL0155 OF WORK-CONTEXT, YL0156 OF WORK-CONTEXT GIVING
             W0WD05
      *    *Synon (17,7) work field
           ADD W0WD05, YL0157 OF WORK-CONTEXT GIVING W0WD04
      *    *Synon (17,7) work field
           ADD W0WD04, YL0158 OF WORK-CONTEXT GIVING W0WD03
      *    *Synon (17,7) work field
           ADD W0WD03, YL0159 OF WORK-CONTEXT GIVING W0WD02
      *    *Synon (17,7) work field
           ADD W0WD02, YL0160 OF WORK-CONTEXT GIVING W0WD01
      *    *Synon (17,7) work field
           ADD W0WD01, YL0161 OF WORK-CONTEXT GIVING W0WD00
      *    PreQual De-Reg/Ord 16
           MOVE W0WD00 TO YL0038 OF WORK-CONTEXT
      *    PreQual Net Reg/Ord 16
           SUBTRACT YL0038 OF WORK-CONTEXT FROM YL0037 OF WORK-CONTEXT
             GIVING YL0039 OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       UD2EXIT.
           EXIT.
      /EJECT
       UD3SUBR SECTION.
      *==============================================================
      *    Targets for  TTON17 (P18 P19)
      *==============================================================
      *    Total Targets per Band
           PERFORM UD4SUBR
      *==============================================================
           CONTINUE.
       UD3EXIT.
           EXIT.
      /EJECT
       UD4SUBR SECTION.
      *==============================================================
      *    Total Targets per Band
      *==============================================================
      *    Total Targets for CAR + VAN - Renault
           PERFORM UD5SUBR
      *    Total Targets for CAR + VAN - Dacia
           PERFORM UD6SUBR
      *==============================================================
           CONTINUE.
       UD4EXIT.
           EXIT.
      /EJECT
       UD5SUBR SECTION.
      *==============================================================
      *    Total Targets for CAR + VAN - Renault
      *==============================================================
      *    U:Target Total a
           MOVE ZEROS TO YL0097 OF WORK-CONTEXT
      *    U:Target Total a
           MOVE ZEROS TO WUTGTTOTA OF WORK-CONTEXT
      *    Rtv Target Value (Single) - Target Information  * Car
           PERFORM SF2RVGN
      *    U:Target Total a
           MULTIPLY YL0097 OF WORK-CONTEXT BY 1 GIVING WUTGTTOTA OF
             WORK-CONTEXT
      *    U:Target Total a
           MOVE ZEROS TO YL0097 OF WORK-CONTEXT
      *    Rtv Target Value (Single) - Target Information  * Van
           PERFORM SF3RVGN
      *    U:Target Total a
           ADD WUTGTTOTA OF WORK-CONTEXT, YL0097 OF WORK-CONTEXT GIVING
             WUTGTTOTA OF WORK-CONTEXT
      *    PreQual Target Reg/Ord 18
           MULTIPLY WUTGTTOTA OF WORK-CONTEXT BY 1 GIVING YL0048 OF
             WORK-CONTEXT
      *==============================================================
           CONTINUE.
       UD5EXIT.
           EXIT.
      /EJECT
       UD6SUBR SECTION.
      *==============================================================
      *    Total Targets for CAR + VAN - Dacia
      *==============================================================
      *    U:Target Dacia
           MOVE ZEROS TO WULTVB OF WORK-CONTEXT
      *    U:Target Total DACIA
           MOVE ZEROS TO WUNHVB OF WORK-CONTEXT
      *    U:Target Dacia
           MOVE ZEROS TO YL0098 OF WORK-CONTEXT
      *    Rtv Target Value (Single) - Target Information  * Dacia car
           PERFORM SF4RVGN
      *    U:Target Dacia
           MULTIPLY YL0098 OF WORK-CONTEXT BY 1 GIVING WULTVB OF
             WORK-CONTEXT
      *    U:Target Dacia
           MOVE ZEROS TO YL0098 OF WORK-CONTEXT
      *    Rtv Target Value (Single) - Target Information  * Van
           PERFORM SF5RVGN
      *    U:Target Total DACIA
           ADD WULTVB OF WORK-CONTEXT, YL0098 OF WORK-CONTEXT GIVING
             WUNHVB OF WORK-CONTEXT
      *    PreQual Target Reg/Ord 19
           MULTIPLY WUNHVB OF WORK-CONTEXT BY 1 GIVING YL0052 OF
             WORK-CONTEXT
      *==============================================================
           CONTINUE.
       UD6EXIT.
           EXIT.
      /EJECT
       UD7SUBR SECTION.
      *==============================================================
      *    Registrations for TTON17 (P18 P19)
      *==============================================================
      *    Renault Reg and De-reg
           PERFORM UD8SUBR
      *    Dacia, Reg and De-reg
           PERFORM UD9SUBR
      *==============================================================
           CONTINUE.
       UD7EXIT.
           EXIT.
      /EJECT
       UD8SUBR SECTION.
      *==============================================================
      *    Renault Reg and De-reg
      *==============================================================
      *    Get number of live Registrations
      *    Rtv No of Regs TCTT - BDC.-.SEDRE DOT Extract  *
           PERFORM SF6RVGN
      *    Do the same for Cancelled Registrations
      *    Rtv No of Regs Derg TCTT - BDC.-.SEDRE DOT Extract  *
           PERFORM SG1RVGN
      *    Registrations
      *    LCL.PreQual Reg/Ord 18 =
      *    *COMPUTE (x1 + x2 + x3 + x4 + x5 + x6)
      *    x1    : LCL.U:Pay Cat 1 Regs
      *    +     : PGM.*Synon (17,7) work field
      *    x2    : LCL.U:Pay Cat 2 Regs
      *    +     : PGM.*Synon (17,7) work field
      *    x3    : LCL.U:Pay Cat 3 Regs
      *    +     : PGM.*Synon (17,7) work field
      *    x4    : LCL.U:Pay Cat 4 Regs
      *    +     : PGM.*Synon (17,7) work field
      *    x5    : LCL.U:Pay Cat 5 Regs
      *    +     : PGM.*Synon (17,7) work field
      *    x6    : LCL.U:Pay Cat N Regs
      *    *Synon (17,7) work field
           ADD YL0100 OF WORK-CONTEXT, YL0101 OF WORK-CONTEXT GIVING
             W0WD04
      *    *Synon (17,7) work field
           ADD W0WD04, YL0102 OF WORK-CONTEXT GIVING W0WD03
      *    *Synon (17,7) work field
           ADD W0WD03, YL0103 OF WORK-CONTEXT GIVING W0WD02
      *    *Synon (17,7) work field
           ADD W0WD02, YL0104 OF WORK-CONTEXT GIVING W0WD01
      *    *Synon (17,7) work field
           ADD W0WD01, YL0105 OF WORK-CONTEXT GIVING W0WD00
      *    PreQual Reg/Ord 18
           MOVE W0WD00 TO YL0045 OF WORK-CONTEXT
      *    De-Registrations
      *    LCL.PreQual De-Reg/Ord 18 =
      *    *COMPUTE (x1 + x2 + x3 + x4 + x5 + x6)
      *    x1    : LCL.U:Pay Cat 1 De-Regs
      *    +     : PGM.*Synon (17,7) work field
      *    x2    : LCL.U:Pay Cat 2 De-Regs
      *    +     : PGM.*Synon (17,7) work field
      *    x3    : LCL.U:Pay Cat 3 De-Regs
      *    +     : PGM.*Synon (17,7) work field
      *    x4    : LCL.U:Pay Cat 4 De-Regs
      *    +     : PGM.*Synon (17,7) work field
      *    x5    : LCL.U:Pay Cat 5 De-Regs
      *    +     : PGM.*Synon (17,7) work field
      *    x6    : LCL.U:Pay Cat N De-Regs
      *    *Synon (17,7) work field
           ADD YL0124 OF WORK-CONTEXT, YL0125 OF WORK-CONTEXT GIVING
             W0WD04
      *    *Synon (17,7) work field
           ADD W0WD04, YL0126 OF WORK-CONTEXT GIVING W0WD03
      *    *Synon (17,7) work field
           ADD W0WD03, YL0127 OF WORK-CONTEXT GIVING W0WD02
      *    *Synon (17,7) work field
           ADD W0WD02, YL0128 OF WORK-CONTEXT GIVING W0WD01
      *    *Synon (17,7) work field
           ADD W0WD01, YL0129 OF WORK-CONTEXT GIVING W0WD00
      *    PreQual De-Reg/Ord 18
           MOVE W0WD00 TO YL0046 OF WORK-CONTEXT
      *    PreQual Net Reg/Ord 18
           SUBTRACT YL0046 OF WORK-CONTEXT FROM YL0045 OF WORK-CONTEXT
             GIVING YL0047 OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       UD8EXIT.
           EXIT.
      /EJECT
       UD9SUBR SECTION.
      *==============================================================
      *    Dacia, Reg and De-reg
      *==============================================================
      *    Get number of live Registrations Dacia
      *    Rtv No of Regs TCTT - BDC.-.SEDRE DOT Extract  *
           PERFORM SG5RVGN
      *    Do the same for Cancelled Registrations Dacia
      *    Rtv No of Regs Derg TCTT - BDC.-.SEDRE DOT Extract  *
           PERFORM SG9RVGN
      *    Copute Regs and De-Regs Dacia
      *    Registrations
      *    LCL.PreQual Reg/Ord 19 =
      *    *COMPUTE (x1 + x2 + x3 + x4 + x5 + x6 +
      *    x7)
      *    x1    : LCL.U:Pay Cat 1 Regs DACIA
      *    +     : PGM.*Synon (17,7) work field
      *    x2    : LCL.U:Pay Cat 2 Regs DACIA
      *    +     : PGM.*Synon (17,7) work field
      *    x3    : LCL.U:Pay Cat 3 Regs DACIA
      *    +     : PGM.*Synon (17,7) work field
      *    x4    : LCL.U:Pay Cat 4 Regs DACIA
      *    +     : PGM.*Synon (17,7) work field
      *    x5    : LCL.U:Pay Cat 5 Regs DACIA
      *    +     : PGM.*Synon (17,7) work field
      *    x6    : LCL.U:Pay Cat N Regs DACIA
      *    +     : PGM.*Synon (17,7) work field
      *    x7    : LCL.U:Pay Cat O Regs DACIA
      *    *Synon (17,7) work field
           ADD YL0148 OF WORK-CONTEXT, YL0149 OF WORK-CONTEXT GIVING
             W0WD05
      *    *Synon (17,7) work field
           ADD W0WD05, YL0150 OF WORK-CONTEXT GIVING W0WD04
      *    *Synon (17,7) work field
           ADD W0WD04, YL0151 OF WORK-CONTEXT GIVING W0WD03
      *    *Synon (17,7) work field
           ADD W0WD03, YL0152 OF WORK-CONTEXT GIVING W0WD02
      *    *Synon (17,7) work field
           ADD W0WD02, YL0153 OF WORK-CONTEXT GIVING W0WD01
      *    *Synon (17,7) work field
           ADD W0WD01, YL0154 OF WORK-CONTEXT GIVING W0WD00
      *    PreQual Reg/Ord 19
           MOVE W0WD00 TO YL0049 OF WORK-CONTEXT
      *    De-Registrations
      *    LCL.PreQual De-Reg/Ord 19 =
      *    *COMPUTE (x1 + x2 + x3 + x4 + x5 + x6 +
      *    x7)
      *    x1    : LCL.U:Pay Cat 1 De-Regs DACIA
      *    +     : PGM.*Synon (17,7) work field
      *    x2    : LCL.U:Pay Cat 2 De-Regs DACIA
      *    +     : PGM.*Synon (17,7) work field
      *    x3    : LCL.U:Pay Cat 3 De-Regs DACIA
      *    +     : PGM.*Synon (17,7) work field
      *    x4    : LCL.U:Pay Cat 4 De-Regs DACIA
      *    +     : PGM.*Synon (17,7) work field
      *    x5    : LCL.U:Pay Cat 5 De-Regs DACIA
      *    +     : PGM.*Synon (17,7) work field
      *    x6    : LCL.U:Pay Cat N De-Regs DACIA
      *    +     : PGM.*Synon (17,7) work field
      *    x7    : LCL.U:Pay Cat O De-Regs DACIA
      *    *Synon (17,7) work field
           ADD YL0155 OF WORK-CONTEXT, YL0156 OF WORK-CONTEXT GIVING
             W0WD05
      *    *Synon (17,7) work field
           ADD W0WD05, YL0157 OF WORK-CONTEXT GIVING W0WD04
      *    *Synon (17,7) work field
           ADD W0WD04, YL0158 OF WORK-CONTEXT GIVING W0WD03
      *    *Synon (17,7) work field
           ADD W0WD03, YL0159 OF WORK-CONTEXT GIVING W0WD02
      *    *Synon (17,7) work field
           ADD W0WD02, YL0160 OF WORK-CONTEXT GIVING W0WD01
      *    *Synon (17,7) work field
           ADD W0WD01, YL0161 OF WORK-CONTEXT GIVING W0WD00
      *    PreQual De-Reg/Ord 19
           MOVE W0WD00 TO YL0050 OF WORK-CONTEXT
      *    PreQual Net Reg/Ord 19
           SUBTRACT YL0050 OF WORK-CONTEXT FROM YL0049 OF WORK-CONTEXT
             GIVING YL0051 OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       UD9EXIT.
           EXIT.
      /EJECT
       UE1SUBR SECTION.
      *==============================================================
      *    Archivent P17, P20 ,net total
      *==============================================================
      *    P17 registration Ranault + Dacia for Oct
      *    PreQual Reg/Ord 17
           ADD YL0037 OF WORK-CONTEXT, YL0164 OF WORK-CONTEXT GIVING
             YL0041 OF WORK-CONTEXT
      *    P17 De-Reg  Registration Renault + Dacia for Oct
      *    PreQual De-Reg/Ord 17
           ADD YL0038 OF WORK-CONTEXT, YL0165 OF WORK-CONTEXT GIVING
             YL0042 OF WORK-CONTEXT
      *    P17 Target - Renault + Dacia  for Oct
      *    PreQual Target Reg/Ord 17
           ADD YL0040 OF WORK-CONTEXT, YL0163 OF WORK-CONTEXT GIVING
             YL0044 OF WORK-CONTEXT
      *    P20 registration Ranault + Dacia for Oct + Nov
      *    PreQual Reg/Ord 20
           ADD YL0049 OF WORK-CONTEXT, YL0045 OF WORK-CONTEXT GIVING
             YL0053 OF WORK-CONTEXT
      *    P20 De-Reg  Registration Renault + Dacia for Oct + Nov
      *    PreQual De-Reg/Ord 20
           ADD YL0050 OF WORK-CONTEXT, YL0046 OF WORK-CONTEXT GIVING
             YL0054 OF WORK-CONTEXT
      *    P20 Target - Renault + Dacia for Oct + Nov
      *    PreQual Target Reg/Ord 20
           ADD YL0052 OF WORK-CONTEXT, YL0048 OF WORK-CONTEXT GIVING
             YL0056 OF WORK-CONTEXT
      *    total Net Target - Renault + Dacia for Oct
      *    PreQual Net 1 NOVEMBER
           ADD YL0039 OF WORK-CONTEXT, YL0166 OF WORK-CONTEXT GIVING
             YL0007 OF WORK-CONTEXT
      *    total Net Target - Renault + Dacia for Oct + Nov
      *    PreQual Net A
           ADD YL0047 OF WORK-CONTEXT, YL0051 OF WORK-CONTEXT GIVING
             YL0008 OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       UE1EXIT.
           EXIT.
      /EJECT
       UE2SUBR SECTION.
      *==============================================================
      *    Q4 Pay
      *==============================================================
      *    Targets for  TTQ417  (P8,P9)
           PERFORM UE3SUBR
      *    Registrations for TTQ417    (P8,P9)
           PERFORM UE7SUBR
      *    Archivent P10,  total
           PERFORM UF1SUBR
      *    Calculate Achievement % for this Scheme
           PERFORM UF2SUBR
      *    Achievement , Summary for dealer
           PERFORM UF5SUBR
      *==============================================================
           CONTINUE.
       UE2EXIT.
           EXIT.
      /EJECT
       UE3SUBR SECTION.
      *==============================================================
      *    Targets for  TTQ417  (P8,P9)
      *==============================================================
      *    Total Targets per Band
           PERFORM UE4SUBR
      *==============================================================
           CONTINUE.
       UE3EXIT.
           EXIT.
      /EJECT
       UE4SUBR SECTION.
      *==============================================================
      *    Total Targets per Band
      *==============================================================
      *    Total Targets for CAR + VAN - Renault
           PERFORM UE5SUBR
      *    Total Targets for CAR + VAN - Dacia
           PERFORM UE6SUBR
      *==============================================================
           CONTINUE.
       UE4EXIT.
           EXIT.
      /EJECT
       UE5SUBR SECTION.
      *==============================================================
      *    Total Targets for CAR + VAN - Renault
      *==============================================================
      *    U:Target Total a
           MOVE ZEROS TO YL0097 OF WORK-CONTEXT
      *    U:Target Total a
           MOVE ZEROS TO WUTGTTOTA OF WORK-CONTEXT
      *    Rtv Target Value (Single) - Target Information  * Car
           PERFORM SH4RVGN
      *    U:Target Total a
           MULTIPLY YL0097 OF WORK-CONTEXT BY 1 GIVING WUTGTTOTA OF
             WORK-CONTEXT
      *    U:Target Total a
           MOVE ZEROS TO YL0097 OF WORK-CONTEXT
      *    Rtv Target Value (Single) - Target Information  * Van
           PERFORM SH5RVGN
      *    U:Target Total a
           ADD WUTGTTOTA OF WORK-CONTEXT, YL0097 OF WORK-CONTEXT GIVING
             WUTGTTOTA OF WORK-CONTEXT
      *    PreQual Target Reg/Ord 8
           MULTIPLY WUTGTTOTA OF WORK-CONTEXT BY 1 GIVING YL0016 OF
             WORK-CONTEXT
      *==============================================================
           CONTINUE.
       UE5EXIT.
           EXIT.
      /EJECT
       UE6SUBR SECTION.
      *==============================================================
      *    Total Targets for CAR + VAN - Dacia
      *==============================================================
      *    U:Target Dacia
           MOVE ZEROS TO WULTVB OF WORK-CONTEXT
      *    U:Target Dacia
           MOVE ZEROS TO YL0098 OF WORK-CONTEXT
      *    U:Target Total DACIA
           MOVE ZEROS TO WUNHVB OF WORK-CONTEXT
      *    Rtv Target Value (Single) - Target Information  * Dacia car
           PERFORM SH6RVGN
      *    U:Target Dacia
           MULTIPLY YL0098 OF WORK-CONTEXT BY 1 GIVING WULTVB OF
             WORK-CONTEXT
      *    U:Target Dacia
           MOVE ZEROS TO YL0098 OF WORK-CONTEXT
      *    Rtv Target Value (Single) - Target Information  * Van
           PERFORM SH7RVGN
      *    U:Target Total DACIA
           ADD WULTVB OF WORK-CONTEXT, YL0098 OF WORK-CONTEXT GIVING
             WUNHVB OF WORK-CONTEXT
      *    PreQual Target Reg/Ord 9
           MULTIPLY WUNHVB OF WORK-CONTEXT BY 1 GIVING YL0020 OF
             WORK-CONTEXT
      *==============================================================
           CONTINUE.
       UE6EXIT.
           EXIT.
      /EJECT
       UE7SUBR SECTION.
      *==============================================================
      *    Registrations for TTQ417    (P8,P9)
      *==============================================================
      *    Renault Reg and De-reg
           PERFORM UE8SUBR
      *    Dacia, Reg and De-reg
           PERFORM UE9SUBR
      *==============================================================
           CONTINUE.
       UE7EXIT.
           EXIT.
      /EJECT
       UE8SUBR SECTION.
      *==============================================================
      *    Renault Reg and De-reg
      *==============================================================
      *    Get number of live Registrations
      *    Rtv No of Regs TCTT - BDC.-.SEDRE DOT Extract  *
           PERFORM SH8RVGN
      *    Do the same for Cancelled Registrations
      *    Rtv No of Regs Derg TCTT - BDC.-.SEDRE DOT Extract  *
           PERFORM SI3RVGN
      *    Registrations
      *    LCL.PreQual Reg/Ord 8 =
      *    *COMPUTE (x1 + x2 + x3 + x4 + x5 + x6)
      *    x1    : LCL.U:Pay Cat 1 Regs
      *    +     : PGM.*Synon (17,7) work field
      *    x2    : LCL.U:Pay Cat 2 Regs
      *    +     : PGM.*Synon (17,7) work field
      *    x3    : LCL.U:Pay Cat 3 Regs
      *    +     : PGM.*Synon (17,7) work field
      *    x4    : LCL.U:Pay Cat 4 Regs
      *    +     : PGM.*Synon (17,7) work field
      *    x5    : LCL.U:Pay Cat 5 Regs
      *    +     : PGM.*Synon (17,7) work field
      *    x6    : LCL.U:Pay Cat N Regs
      *    *Synon (17,7) work field
           ADD YL0100 OF WORK-CONTEXT, YL0101 OF WORK-CONTEXT GIVING
             W0WD04
      *    *Synon (17,7) work field
           ADD W0WD04, YL0102 OF WORK-CONTEXT GIVING W0WD03
      *    *Synon (17,7) work field
           ADD W0WD03, YL0103 OF WORK-CONTEXT GIVING W0WD02
      *    *Synon (17,7) work field
           ADD W0WD02, YL0104 OF WORK-CONTEXT GIVING W0WD01
      *    *Synon (17,7) work field
           ADD W0WD01, YL0105 OF WORK-CONTEXT GIVING W0WD00
      *    PreQual Reg/Ord 8
           MOVE W0WD00 TO YL0013 OF WORK-CONTEXT
      *    De-Registrations
      *    LCL.PreQual De-Reg/Ord 8 =
      *    *COMPUTE (x1 + x2 + x3 + x4 + x5 + x6)
      *    x1    : LCL.U:Pay Cat 1 De-Regs
      *    +     : PGM.*Synon (17,7) work field
      *    x2    : LCL.U:Pay Cat 2 De-Regs
      *    +     : PGM.*Synon (17,7) work field
      *    x3    : LCL.U:Pay Cat 3 De-Regs
      *    +     : PGM.*Synon (17,7) work field
      *    x4    : LCL.U:Pay Cat 4 De-Regs
      *    +     : PGM.*Synon (17,7) work field
      *    x5    : LCL.U:Pay Cat 5 De-Regs
      *    +     : PGM.*Synon (17,7) work field
      *    x6    : LCL.U:Pay Cat N De-Regs
      *    *Synon (17,7) work field
           ADD YL0124 OF WORK-CONTEXT, YL0125 OF WORK-CONTEXT GIVING
             W0WD04
      *    *Synon (17,7) work field
           ADD W0WD04, YL0126 OF WORK-CONTEXT GIVING W0WD03
      *    *Synon (17,7) work field
           ADD W0WD03, YL0127 OF WORK-CONTEXT GIVING W0WD02
      *    *Synon (17,7) work field
           ADD W0WD02, YL0128 OF WORK-CONTEXT GIVING W0WD01
      *    *Synon (17,7) work field
           ADD W0WD01, YL0129 OF WORK-CONTEXT GIVING W0WD00
      *    PreQual De-Reg/Ord 8
           MOVE W0WD00 TO YL0014 OF WORK-CONTEXT
      *    PreQual Net Reg/Ord 8
           SUBTRACT YL0014 OF WORK-CONTEXT FROM YL0013 OF WORK-CONTEXT
             GIVING YL0015 OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       UE8EXIT.
           EXIT.
      /EJECT
       UE9SUBR SECTION.
      *==============================================================
      *    Dacia, Reg and De-reg
      *==============================================================
      *    Get number of live Registrations Dacia
      *    Rtv No of Regs TCTT - BDC.-.SEDRE DOT Extract  *
           PERFORM SI7RVGN
      *    Do the same for Cancelled Registrations Dacia
      *    Rtv No of Regs Derg TCTT - BDC.-.SEDRE DOT Extract  *
           PERFORM SJ2RVGN
      *    Copute Regs and De-Regs Dacia
      *    Registrations
      *    LCL.PreQual Reg/Ord 9 =
      *    *COMPUTE (x1 + x2 + x3 + x4 + x5 + x6 +
      *    x7)
      *    x1    : LCL.U:Pay Cat 1 Regs DACIA
      *    +     : PGM.*Synon (17,7) work field
      *    x2    : LCL.U:Pay Cat 2 Regs DACIA
      *    +     : PGM.*Synon (17,7) work field
      *    x3    : LCL.U:Pay Cat 3 Regs DACIA
      *    +     : PGM.*Synon (17,7) work field
      *    x4    : LCL.U:Pay Cat 4 Regs DACIA
      *    +     : PGM.*Synon (17,7) work field
      *    x5    : LCL.U:Pay Cat 5 Regs DACIA
      *    +     : PGM.*Synon (17,7) work field
      *    x6    : LCL.U:Pay Cat N Regs DACIA
      *    +     : PGM.*Synon (17,7) work field
      *    x7    : LCL.U:Pay Cat O Regs DACIA
      *    *Synon (17,7) work field
           ADD YL0148 OF WORK-CONTEXT, YL0149 OF WORK-CONTEXT GIVING
             W0WD05
      *    *Synon (17,7) work field
           ADD W0WD05, YL0150 OF WORK-CONTEXT GIVING W0WD04
      *    *Synon (17,7) work field
           ADD W0WD04, YL0151 OF WORK-CONTEXT GIVING W0WD03
      *    *Synon (17,7) work field
           ADD W0WD03, YL0152 OF WORK-CONTEXT GIVING W0WD02
      *    *Synon (17,7) work field
           ADD W0WD02, YL0153 OF WORK-CONTEXT GIVING W0WD01
      *    *Synon (17,7) work field
           ADD W0WD01, YL0154 OF WORK-CONTEXT GIVING W0WD00
      *    PreQual Reg/Ord 9
           MOVE W0WD00 TO YL0017 OF WORK-CONTEXT
      *    De-Registrations
      *    LCL.PreQual De-Reg/Ord 9 =
      *    *COMPUTE (x1 + x2 + x3 + x4 + x5 + x6 +
      *    x7)
      *    x1    : LCL.U:Pay Cat 1 De-Regs DACIA
      *    +     : PGM.*Synon (17,7) work field
      *    x2    : LCL.U:Pay Cat 2 De-Regs DACIA
      *    +     : PGM.*Synon (17,7) work field
      *    x3    : LCL.U:Pay Cat 3 De-Regs DACIA
      *    +     : PGM.*Synon (17,7) work field
      *    x4    : LCL.U:Pay Cat 4 De-Regs DACIA
      *    +     : PGM.*Synon (17,7) work field
      *    x5    : LCL.U:Pay Cat 5 De-Regs DACIA
      *    +     : PGM.*Synon (17,7) work field
      *    x6    : LCL.U:Pay Cat N De-Regs DACIA
      *    +     : PGM.*Synon (17,7) work field
      *    x7    : LCL.U:Pay Cat O De-Regs DACIA
      *    *Synon (17,7) work field
           ADD YL0155 OF WORK-CONTEXT, YL0156 OF WORK-CONTEXT GIVING
             W0WD05
      *    *Synon (17,7) work field
           ADD W0WD05, YL0157 OF WORK-CONTEXT GIVING W0WD04
      *    *Synon (17,7) work field
           ADD W0WD04, YL0158 OF WORK-CONTEXT GIVING W0WD03
      *    *Synon (17,7) work field
           ADD W0WD03, YL0159 OF WORK-CONTEXT GIVING W0WD02
      *    *Synon (17,7) work field
           ADD W0WD02, YL0160 OF WORK-CONTEXT GIVING W0WD01
      *    *Synon (17,7) work field
           ADD W0WD01, YL0161 OF WORK-CONTEXT GIVING W0WD00
      *    PreQual De-Reg/Ord 9
           MOVE W0WD00 TO YL0018 OF WORK-CONTEXT
      *    PreQual Net Reg/Ord 9
           SUBTRACT YL0018 OF WORK-CONTEXT FROM YL0017 OF WORK-CONTEXT
             GIVING YL0019 OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       UE9EXIT.
           EXIT.
      /EJECT
       UF1SUBR SECTION.
      *==============================================================
      *    Archivent P10,  total
      *==============================================================
      *    P10 registration Ranault + Dacia
      *    PreQual Reg/Ord 10
           ADD YL0017 OF WORK-CONTEXT, YL0013 OF WORK-CONTEXT GIVING
             YL0021 OF WORK-CONTEXT
      *    P10 De-Reg  Registration Renault + Dacia
      *    PreQual De-Reg/Ord 10
           ADD YL0018 OF WORK-CONTEXT, YL0014 OF WORK-CONTEXT GIVING
             YL0022 OF WORK-CONTEXT
      *    P10 Target - Renault + Dacia
      *    PreQual Target Reg/Ord 10
           ADD YL0020 OF WORK-CONTEXT, YL0016 OF WORK-CONTEXT GIVING
             YL0024 OF WORK-CONTEXT
      *    Combination Total Net  (Renault + Dacia)
      *    PreQual Combine Reg Net
           ADD YL0015 OF WORK-CONTEXT, YL0019 OF WORK-CONTEXT GIVING
             YL0167 OF WORK-CONTEXT
      *    Combination Total Target  (Renault + Dacia)
      *    PreQual Combine Target AP
           MOVE YL0024 OF WORK-CONTEXT TO YL0168 OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       UF1EXIT.
           EXIT.
      /EJECT
       UF2SUBR SECTION.
      *==============================================================
      *    Calculate Achievement % for this Scheme
      *==============================================================
      *    Compute Target Total
           PERFORM UF3SUBR
      *    Calc %'s of target Renault + Dacia
           PERFORM UF4SUBR
      *==============================================================
           CONTINUE.
       UF2EXIT.
           EXIT.
      /EJECT
       UF3SUBR SECTION.
      *==============================================================
      *    Compute Target Total
      *==============================================================
      *    Compute combination DACIA + RENAULT
      *    U:Target Total
           MOVE ZEROS TO WUTGTTOT OF WORK-CONTEXT
      *    U:Target Total
           MULTIPLY YL0168 OF WORK-CONTEXT BY 1 GIVING WUTGTTOT OF
             WORK-CONTEXT
      *==============================================================
           CONTINUE.
       UF3EXIT.
           EXIT.
      /EJECT
       UF4SUBR SECTION.
      *==============================================================
      *    Calc %'s of target Renault + Dacia
      *==============================================================
      *    U:80% of Target -Decimal
           MULTIPLY WUTGTTOT OF WORK-CONTEXT BY 0.8 GIVING WUU80TD OF
             WORK-CONTEXT
      *    U:80%  of target Reg
           MULTIPLY WUU80TD OF WORK-CONTEXT BY 1 GIVING WUHTNU OF
             WORK-CONTEXT
      *    U:90% of target -decimal
           MULTIPLY WUTGTTOT OF WORK-CONTEXT BY 0.9 GIVING WUU90TD OF
             WORK-CONTEXT
      *    U:90%  of target Reg
           MULTIPLY WUU90TD OF WORK-CONTEXT BY 1 GIVING WUHUNU OF
             WORK-CONTEXT
      *    U:100% of Target -decimal
           MULTIPLY WUTGTTOT OF WORK-CONTEXT BY 1.00 GIVING WUU100PCTD
             OF WORK-CONTEXT
      *    U:100% of target Reg
           MULTIPLY WUU100PCTD OF WORK-CONTEXT BY 1 GIVING WUHVNU OF
             WORK-CONTEXT
      *    U:105% of target -decimal
           MULTIPLY WUTGTTOT OF WORK-CONTEXT BY 1.05 GIVING WUU105PCTD
             OF WORK-CONTEXT
      *    U:105% of target Reg
           MULTIPLY WUU105PCTD OF WORK-CONTEXT BY 1 GIVING WUHZNU OF
             WORK-CONTEXT
      *    U:110% of target -decimal
           MULTIPLY WUTGTTOT OF WORK-CONTEXT BY 1.1 GIVING WUU110PCTD
             OF WORK-CONTEXT
      *    U:110% of target Reg
           MULTIPLY WUU110PCTD OF WORK-CONTEXT BY 1 GIVING WUHXNU OF
             WORK-CONTEXT
      *    U:120% of target -decimal
           MULTIPLY WUTGTTOT OF WORK-CONTEXT BY 1.2 GIVING WUU120PCTD
             OF WORK-CONTEXT
      *    U:120% of target Reg
           MULTIPLY WUU120PCTD OF WORK-CONTEXT BY 1 GIVING WUHYNU OF
             WORK-CONTEXT
      *==============================================================
           CONTINUE.
       UF4EXIT.
           EXIT.
      /EJECT
       UF5SUBR SECTION.
      *==============================================================
      *    Achievement , Summary for dealer
      *==============================================================
      *    Set Targets for the different %'s on Dealer Summ file
      *    Set achievement Flag Combine Renault + Dacia
      *    CASE: LCL.PreQual Combine Reg Net GE WRK.U:80%  of target Reg
      *    *IF
           IF (YL0167 OF WORK-CONTEXT NOT < WUHTNU OF WORK-CONTEXT) THEN
      *        Achieved Pre-Qualifier R
               MOVE 'Y' TO YL0005 OF WORK-CONTEXT
           ELSE
      *        CASE: *OTHERWISE
      *        Achieved Pre-Qualifier R
               MOVE 'N' TO YL0005 OF WORK-CONTEXT
           END-IF
      *    Achievement band   by % target for Renault + Dacia
      *    CASE: WRK.U:Target Total is Equal to *zero
      *    *IF
           IF (WUTGTTOT OF WORK-CONTEXT = 0) THEN
      *        Default No target Payment
               PERFORM UF6SUBR
           ELSE
      *        CASE: LCL.PreQual Combine Reg Net GE WRK.U:120% of
      *          target Reg
      *        *IF
               IF (YL0167 OF WORK-CONTEXT NOT < WUHYNU OF WORK-CONTEXT)
                 THEN
      *            Achievement Band Reg
                   MOVE SPACES TO YL0002 OF WORK-CONTEXT
                   MOVE '120%+' TO YL0002 OF WORK-CONTEXT
      *            U:Payment Band
                   MOVE 6 TO WUWCNU OF WORK-CONTEXT
               ELSE
      *            CASE: LCL.PreQual Combine Reg Net GE WRK.U:110% of
      *              target Reg
      *            *IF
                   IF (YL0167 OF WORK-CONTEXT NOT < WUHXNU OF
                     WORK-CONTEXT) THEN
      *                Achievement Band Reg
                       MOVE '110-119.9%' TO YL0002 OF WORK-CONTEXT
      *                U:Payment Band
                       MOVE 5 TO WUWCNU OF WORK-CONTEXT
                   ELSE
      *                CASE: LCL.PreQual Combine Reg Net GE WRK.U:105%
      *                  of target Reg
      *                *IF
                       IF (YL0167 OF WORK-CONTEXT NOT < WUHZNU OF
                         WORK-CONTEXT) THEN
      *                    Achievement Band Reg
                           MOVE '105-109.9%' TO YL0002 OF WORK-CONTEXT
      *                    U:Payment Band
                           MOVE 4 TO WUWCNU OF WORK-CONTEXT
                       ELSE
      *                    CASE: LCL.PreQual Combine Reg Net GE
      *                      WRK.U:100% of target Reg
      *                    *IF
                           IF (YL0167 OF WORK-CONTEXT NOT < WUHVNU OF
                             WORK-CONTEXT) THEN
      *                        Achievement Band Reg
                               MOVE '100-104.9%' TO YL0002 OF
                                 WORK-CONTEXT
      *                        U:Payment Band
                               MOVE 3 TO WUWCNU OF WORK-CONTEXT
                           ELSE
      *                        CASE: LCL.PreQual Combine Reg Net GE
      *                          WRK.U:90%  of target Reg
      *                        *IF
                               IF (YL0167 OF WORK-CONTEXT NOT < WUHUNU
                                 OF WORK-CONTEXT) THEN
      *                        Achievement Band Reg
                               MOVE SPACES TO YL0002 OF WORK-CONTEXT
                               MOVE '90-99.9%' TO YL0002 OF WORK-CONTEXT
      *                        U:Payment Band
                               MOVE 2 TO WUWCNU OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.PreQual Combine Reg Net GE
      *                          WRK.U:80%  of target Reg
      *                        *IF
                               IF (YL0167 OF WORK-CONTEXT NOT < WUHTNU
                                 OF WORK-CONTEXT) THEN
      *                        Achievement Band Reg
                               MOVE SPACES TO YL0002 OF WORK-CONTEXT
                               MOVE '80-89.9%' TO YL0002 OF WORK-CONTEXT
      *                        U:Payment Band
                               MOVE 1 TO WUWCNU OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.PreQual Combine Reg Net LT
      *                          WRK.U:80%  of target Reg
      *                        *IF
                               IF (YL0167 OF WORK-CONTEXT < WUHTNU OF
                                 WORK-CONTEXT) THEN
      *                        Achievement Band Reg
                               MOVE SPACES TO YL0002 OF WORK-CONTEXT
                               MOVE '<80%' TO YL0002 OF WORK-CONTEXT
      *                        U:Payment Band
                               MOVE 999 TO WUWCNU OF WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
                   END-IF
               END-IF
           END-IF
      *==============================================================
           CONTINUE.
       UF5EXIT.
           EXIT.
      /EJECT
       UF6SUBR SECTION.
      *==============================================================
      *    Default No target Payment
      *==============================================================
      *    Achievement Band Reg
           MOVE SPACES TO YL0002 OF WORK-CONTEXT
           MOVE 'No Target' TO YL0002 OF WORK-CONTEXT
      *    Achieved Pre-Qualifier R
           MOVE 'N' TO YL0005 OF WORK-CONTEXT
      *    U:Payment Band
           MOVE 999 TO WUWCNU OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       UF6EXIT.
           EXIT.
      /EJECT
       UF7SUBR SECTION.
      *==============================================================
      *    Initialization for order
      *==============================================================
      *    U:Payment Band 2
           MOVE ZEROS TO WUZZNU OF WORK-CONTEXT
      *    U:80% of Target -Decimal
           MOVE ZEROS TO WUU80TD OF WORK-CONTEXT
      *    U:90% of target -decimal
           MOVE ZEROS TO WUU90TD OF WORK-CONTEXT
      *    U:100% of Target -decimal
           MOVE ZEROS TO WUU100PCTD OF WORK-CONTEXT
      *    U:105% of target -decimal
           MOVE ZEROS TO WUU105PCTD OF WORK-CONTEXT
      *    U:110% of target -decimal
           MOVE ZEROS TO WUU110PCTD OF WORK-CONTEXT
      *    U:120% of target -decimal
           MOVE ZEROS TO WUU120PCTD OF WORK-CONTEXT
      *    Achievement Band
           MOVE SPACES TO YL0169 OF WORK-CONTEXT
           MOVE ' ' TO YL0169 OF WORK-CONTEXT
      *    U:Achieved Target 1
           MOVE 'N' TO YL0003 OF WORK-CONTEXT
      *    U:Achieved Target 2
           MOVE 'N' TO YL0004 OF WORK-CONTEXT
      *    Achieved Pre-Qualifier
           MOVE 'N' TO YL0170 OF WORK-CONTEXT
      *    PreQual Cancel Ren Prev
           MOVE ZEROS TO YL0171 OF WORK-CONTEXT
      *    PreQual Cancel Dac Prev
           MOVE ZEROS TO YL0172 OF WORK-CONTEXT
      *    PreQual Net 1
           MOVE ZEROS TO YL0173 OF WORK-CONTEXT
      *    PreQual Net 1 Dacia
           MOVE ZEROS TO YL0174 OF WORK-CONTEXT
      *    PreQual Net 2
           MOVE ZEROS TO YL0175 OF WORK-CONTEXT
      *    PreQual Net 3
           MOVE ZEROS TO YL0176 OF WORK-CONTEXT
      *    PreQual Net 4
           MOVE ZEROS TO YL0177 OF WORK-CONTEXT
      *    PreQual Net 5
           MOVE ZEROS TO YL0178 OF WORK-CONTEXT
      *    PreQual Net 6
           MOVE ZEROS TO YL0179 OF WORK-CONTEXT
      *    PreQual Net 7
           MOVE ZEROS TO YL0180 OF WORK-CONTEXT
      *    PreQual Target 1 DACIA
           MOVE ZEROS TO YL0181 OF WORK-CONTEXT
      *    PreQual Order 1 Dacia
           MOVE ZEROS TO YL0182 OF WORK-CONTEXT
      *    PreQual Cancel 1 Dacia
           MOVE ZEROS TO YL0183 OF WORK-CONTEXT
      *    PreQual Net 1 Renault
           MOVE ZEROS TO YL0184 OF WORK-CONTEXT
      *    PreQual Target 1 Renault
           MOVE ZEROS TO YL0185 OF WORK-CONTEXT
      *    PreQual Order 1 Renault
           MOVE ZEROS TO YL0186 OF WORK-CONTEXT
      *    PreQual Cancel 1 Renault
           MOVE ZEROS TO YL0187 OF WORK-CONTEXT
      *    PreQual Order A
           MOVE ZEROS TO YL0188 OF WORK-CONTEXT
      *    PreQual Order 7
           MOVE ZEROS TO YL0189 OF WORK-CONTEXT
      *    PreQual Cancel 7
           MOVE ZEROS TO YL0190 OF WORK-CONTEXT
      *    PreQual Target 7
           MOVE ZEROS TO YL0191 OF WORK-CONTEXT
      *    U:Target Total
           MOVE ZEROS TO WUTGTTOT OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       UF7EXIT.
           EXIT.
      /EJECT
       UF8SUBR SECTION.
      *==============================================================
      *    Orders
      *==============================================================
      *    Get previous run
      *    CASE: LCL.Initial Run is N
      *    *IF
           IF (YL0091 OF WORK-CONTEXT = 'N') THEN
      *        *rtv Order
      *        P3 , P4 archivent P7
               PERFORM UF9SUBR
      *        Total prev
               PERFORM UG1SUBR
           END-IF
      *    Targets for  OTQ417
           PERFORM UG2SUBR
      *    Orders for OTQ417 , prefix  deduc is TT
           PERFORM UG6SUBR
      *    Archivent P1 P2 P3 P4 P5 P6 P7 total
           PERFORM UH3SUBR
      *    Compute Target Total
           PERFORM UH6SUBR
      *    Calculate Achievement %  Target
           PERFORM UH7SUBR
      *    Achievement
      *    CASE: LCL.Recalculate Order Ach Brn is Y
      *    *IF
           IF (YL0083 OF WORK-CONTEXT = 'Y') THEN
      *        Achievement , Summary for Re-Calculate
               PERFORM UH8SUBR
           ELSE
      *        CASE: *OTHERWISE
      *        * Normal run
      *        without Clawinging
               PERFORM UI3SUBR
           END-IF
      *==============================================================
           CONTINUE.
       UF8EXIT.
           EXIT.
      /EJECT
       UF9SUBR SECTION.
      *==============================================================
      *    P3 , P4 archivent P7
      *==============================================================
      *    P3 Order Renault
      *    PreQual Order 3
           MOVE YL0074 OF WORK-CONTEXT TO YL0068 OF WORK-CONTEXT
      *    P4 Order Dacia
      *    PreQual Order 4
           MOVE YL0077 OF WORK-CONTEXT TO YL0071 OF WORK-CONTEXT
      *    P3 Canceled orders Renault
      *    PreQual Cancel 3
           MOVE YL0075 OF WORK-CONTEXT TO YL0069 OF WORK-CONTEXT
      *    P4 Canceled orders Dacia
      *    PreQual Cancel 4
           MOVE YL0078 OF WORK-CONTEXT TO YL0072 OF WORK-CONTEXT
      *    P3 Target - Renault
      *    PreQual Target 3
           MOVE YL0076 OF WORK-CONTEXT TO YL0070 OF WORK-CONTEXT
      *    P4 Target - Dacia
      *    PreQual Target 4
           MOVE YL0079 OF WORK-CONTEXT TO YL0073 OF WORK-CONTEXT
      *    P7 Orders Ranault + Dacia
      *    PreQual Order 7
           ADD YL0068 OF WORK-CONTEXT, YL0071 OF WORK-CONTEXT GIVING
             YL0189 OF WORK-CONTEXT
      *    P7 Cancel Ranault + Dacia
      *    PreQual Cancel 7
           ADD YL0069 OF WORK-CONTEXT, YL0072 OF WORK-CONTEXT GIVING
             YL0190 OF WORK-CONTEXT
      *    P7 Target  (Renault + Dacia)
      *    PreQual Target 7
           ADD YL0070 OF WORK-CONTEXT, YL0073 OF WORK-CONTEXT GIVING
             YL0191 OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       UF9EXIT.
           EXIT.
      /EJECT
       UG1SUBR SECTION.
      *==============================================================
      *    Total prev
      *==============================================================
      *    Combination Total Net  (Renault + Dacia)
      *    PreQual Combine Net
           ADD YL0176 OF WORK-CONTEXT, YL0177 OF WORK-CONTEXT GIVING
             YL0192 OF WORK-CONTEXT
      *    Combination Total order (Renault + Dacia)
      *    PreQual Order A
           ADD YL0068 OF WORK-CONTEXT, YL0071 OF WORK-CONTEXT GIVING
             YL0188 OF WORK-CONTEXT
      *    Combination Total Target  (Renault + Dacia)
      *    PreQual Combine Target
           ADD YL0070 OF WORK-CONTEXT, YL0073 OF WORK-CONTEXT GIVING
             YL0193 OF WORK-CONTEXT
      *    Combination Total De-order (Renault + Dacia)
      *    PreQual Cancel A
           ADD YL0069 OF WORK-CONTEXT, YL0072 OF WORK-CONTEXT GIVING
             YL0194 OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       UG1EXIT.
           EXIT.
      /EJECT
       UG2SUBR SECTION.
      *==============================================================
      *    Targets for  OTQ417
      *==============================================================
      *    Total Targets per Band
           PERFORM UG3SUBR
      *==============================================================
           CONTINUE.
       UG2EXIT.
           EXIT.
      /EJECT
       UG3SUBR SECTION.
      *==============================================================
      *    Total Targets per Band
      *==============================================================
      *    Total Targets for CAR + VAN - Renault
           PERFORM UG4SUBR
      *    Total Targets for CAR + VAN - Dacia
           PERFORM UG5SUBR
      *==============================================================
           CONTINUE.
       UG3EXIT.
           EXIT.
      /EJECT
       UG4SUBR SECTION.
      *==============================================================
      *    Total Targets for CAR + VAN - Renault
      *==============================================================
      *    U:Target Total a
           MOVE ZEROS TO YL0097 OF WORK-CONTEXT
      *    U:Target Total a
           MOVE ZEROS TO WUTGTTOTA OF WORK-CONTEXT
      *    Rtv Target Value (Single) - Target Information  * Car
           PERFORM SJ6RVGN
      *    U:Target Total a
           MULTIPLY YL0097 OF WORK-CONTEXT BY 1 GIVING WUTGTTOTA OF
             WORK-CONTEXT
      *    U:Target Total a
           MOVE ZEROS TO YL0097 OF WORK-CONTEXT
      *    Rtv Target Value (Single) - Target Information  * Van
           PERFORM SJ7RVGN
      *    U:Target Total a
           ADD WUTGTTOTA OF WORK-CONTEXT, YL0097 OF WORK-CONTEXT GIVING
             WUTGTTOTA OF WORK-CONTEXT
      *    PreQual Target 1 Renault
           MULTIPLY WUTGTTOTA OF WORK-CONTEXT BY 1 GIVING YL0185 OF
             WORK-CONTEXT
      *==============================================================
           CONTINUE.
       UG4EXIT.
           EXIT.
      /EJECT
       UG5SUBR SECTION.
      *==============================================================
      *    Total Targets for CAR + VAN - Dacia
      *==============================================================
      *    U:Target Dacia
           MOVE ZEROS TO WULTVB OF WORK-CONTEXT
      *    U:Target Dacia
           MOVE ZEROS TO YL0098 OF WORK-CONTEXT
      *    U:Target Total DACIA
           MOVE ZEROS TO WUNHVB OF WORK-CONTEXT
      *    Rtv Target Value (Single) - Target Information  * Dacia car
           PERFORM SJ8RVGN
      *    U:Target Dacia
           MULTIPLY YL0098 OF WORK-CONTEXT BY 1 GIVING WULTVB OF
             WORK-CONTEXT
      *    U:Target Dacia
           MOVE ZEROS TO YL0098 OF WORK-CONTEXT
      *    Rtv Target Value (Single) - Target Information  * Van
           PERFORM SJ9RVGN
      *    U:Target Total DACIA
           ADD WULTVB OF WORK-CONTEXT, YL0098 OF WORK-CONTEXT GIVING
             WUNHVB OF WORK-CONTEXT
      *    PreQual Target 1 DACIA
           MULTIPLY WUNHVB OF WORK-CONTEXT BY 1 GIVING YL0181 OF
             WORK-CONTEXT
      *==============================================================
           CONTINUE.
       UG5EXIT.
           EXIT.
      /EJECT
       UG6SUBR SECTION.
      *==============================================================
      *    Orders for OTQ417 , prefix  deduc is TT
      *==============================================================
      *    Get latest order by Mod and parameter
      *    Renault Order ,Cancel and De-Alocation
           PERFORM UG7SUBR
      *    Dacia Order ,Cancel and De-Alocation
           PERFORM UG8SUBR
           PERFORM UG9SUBR
      *    Clawinging back 5% Re-Calculate
      *    CASE:
      *    - c1 AND c2 AND c3
      *    |- c1    : LCL.Recalculate Order Ach Brn is Y
      *    |- c2    : LCL.U:Run Mode is *1
      *    |- c3    : LCL.Initial Run is N
      *    '-
      *    *IF
           IF (YL0083 OF WORK-CONTEXT = 'Y' AND
               YL0085 OF WORK-CONTEXT = '1' AND
               YL0091 OF WORK-CONTEXT = 'N') THEN
      *        ** actual Order (Total Deductions)
      *        PreQual Net Actual
               ADD YL0184 OF WORK-CONTEXT, YL0174 OF WORK-CONTEXT
                 GIVING YL0059 OF WORK-CONTEXT
      *        ** Previous net Run mode 2
      *        Previous net combine
      *        LCL.PreQual Net Previous =
      *        *COMPUTE ((x1 - x2 ) + (x3 - x4))
      *        x1    : LCL.PreQual Order 1 Renault
      *        -     : PGM.*Synon (17,7) work field
      *        x2    : LCL.PreQual Cancel Ren Prev
      *        +     : PGM.*Synon (17,7) work field
      *        x3    : LCL.PreQual Order 1 Dacia
      *        -     : PGM.*Synon (17,7) work field
      *        x4    : LCL.PreQual Cancel Dac Prev
      *        *Synon (17,7) work field
               SUBTRACT YL0171 OF WORK-CONTEXT FROM YL0186 OF
                 WORK-CONTEXT GIVING W0WD01
      *        *Synon (17,7) work field
               SUBTRACT YL0172 OF WORK-CONTEXT FROM YL0182 OF
                 WORK-CONTEXT GIVING W0WD02
      *        *Synon (17,7) work field
               ADD W0WD01, W0WD02 GIVING W0WD00
      *        PreQual Net Previous
               MOVE W0WD00 TO YL0058 OF WORK-CONTEXT
      *        CASE:
      *        - NOTc1 AND NOTc2
      *        |- c1    : LCL.PreQual Net Actual is *Zero
      *        |- c2    : LCL.PreQual Net Previous is *Zero
      *        '-
      *        *IF
               IF (NOT (YL0059 OF WORK-CONTEXT = 0) AND
                   NOT (YL0058 OF WORK-CONTEXT = 0)) THEN
      *            compute % claw back
      *            LCL.U:Number (8.0) =
      *            *COMPUTE ((x1 /x2) *x3)
      *            x1    : LCL.PreQual Net Previous
      *            /     : PGM.*Synon (17,7) work field *
      *            x2    : LCL.PreQual Net Actual
      *            *     : PGM.*Synon (17,7) work field *
      *            x3    : CON.1000
      *            *Synon (17,7) work field
                   DIVIDE YL0059 OF WORK-CONTEXT INTO YL0058 OF
                     WORK-CONTEXT GIVING W0WD01
      *            *Synon (17,7) work field
                   MULTIPLY W0WD01 BY 1000 GIVING W0WD00
      *            U:Number (8.0)
                   MOVE W0WD00 TO YL0060 OF WORK-CONTEXT
      *            CASE: LCL.U:Number (8.0) is GT 5 %
      *            *IF
                   IF (YL0060 OF WORK-CONTEXT > 1050) THEN
      *                * Dealer have more than 5% of Cancellations
      *                U:Clawinging back
                       MOVE 'Y' TO YL0057 OF WORK-CONTEXT
      *                *  number Cancellations without 5%
      *                5 %  net  different
      *                LCL.PreQual Net 5% =
      *                *COMPUTE (x4 - ( (x1 /x2 ) * x3))
      *                x4    : LCL.PreQual Net Previous
      *                -     : PGM.*Synon (17,7) work field
      *                x1    : LCL.PreQual Net Previous
      *                /     : PGM.*Synon (17,7) work field *
      *                x2    : CON.100
      *                *     : PGM.*Synon (17,7) work field *
      *                x3    : CON.95
      *                *Synon (17,7) work field
                       DIVIDE 100 INTO YL0058 OF WORK-CONTEXT GIVING
                         W0WD02
      *                *Synon (17,7) work field
                       MULTIPLY W0WD02 BY 95 GIVING W0WD01
      *                *Synon (17,7) work field
                       SUBTRACT W0WD01 FROM YL0058 OF WORK-CONTEXT
                         GIVING W0WD00
      *                PreQual Net 5%
                       MOVE W0WD00 TO YL0061 OF WORK-CONTEXT
      *                Numer of Order claw back
      *                LCL.Order claw back =
      *                *COMPUTE (x1 + x2 - x3 - x4)
      *                x1    : LCL.PreQual Order 1 Dacia
      *                +     : PGM.*Synon (17,7) work field
      *                x2    : LCL.PreQual Order 1 Renault
      *                -     : PGM.*Synon (17,7) work field
      *                x3    : LCL.PreQual Net Actual
      *                -     : PGM.*Synon (17,7) work field
      *                x4    : LCL.PreQual Net 5%
      *                *Synon (17,7) work field
                       ADD YL0182 OF WORK-CONTEXT, YL0186 OF
                         WORK-CONTEXT GIVING W0WD02
      *                *Synon (17,7) work field
                       SUBTRACT YL0059 OF WORK-CONTEXT FROM W0WD02
                         GIVING W0WD01
      *                *Synon (17,7) work field
                       SUBTRACT YL0061 OF WORK-CONTEXT FROM W0WD01
                         GIVING W0WD00
      *                Order claw back
                       MOVE W0WD00 TO YL0245 OF WORK-CONTEXT
                   ELSE
      *                CASE: *OTHERWISE
      *                * Dealer to Keep 5% of Cancellations
      *                U:Clawinging back
                       MOVE 'N' TO YL0057 OF WORK-CONTEXT
                   END-IF
               ELSE
      *            CASE: *OTHERWISE
                   CONTINUE
               END-IF
           END-IF
      *    Initial run  default for mode 2
      *    CASE: LCL.Initial Run is Y
      *    *IF
           IF (YL0091 OF WORK-CONTEXT = 'Y') THEN
      *        decut to date 20171231    for P1 P2
      *        PreQual Cancel 2
               MOVE YL0171 OF WORK-CONTEXT TO YL0066 OF WORK-CONTEXT
      *        PreQual Cancel 1
               MOVE YL0171 OF WORK-CONTEXT TO YL0063 OF WORK-CONTEXT
           END-IF
      *==============================================================
           CONTINUE.
       UG6EXIT.
           EXIT.
      /EJECT
       UG7SUBR SECTION.
      *==============================================================
      *    Renault Order ,Cancel and De-Alocation
      *==============================================================
      *    Get number of live Order
      *    Rtv Num of Order - Customer Order  *
           PERFORM SK1RVGN
      *    Deduct (Cancel +De-Alocation)
      *    Get Order Deduct by parameter
      *    CASE:
      *    - c1 AND c2
      *    |- c1    : LCL.Include Cancelled Orders is Y
      *    |- c2    : LCL.Include Unmatched Orders is Y
      *    '-
      *    *IF
           IF (YL0081 OF WORK-CONTEXT = 'Y' AND
               YL0082 OF WORK-CONTEXT = 'Y') THEN
      *        * Normal get deduct
      *        Rtv Num of Deductions - Customer Order Deduct VB  *
               PERFORM SK6RVGN
           ELSE
      *        CASE: *OTHERWISE
      *        CASE: LCL.Include Unmatched Orders is Y
      *        *IF
               IF (YL0082 OF WORK-CONTEXT = 'Y') THEN
      *            * Order De-Allocation
      *            Rtv Num of Deductions C/D - Customer Order Deduct
      *              VB  *
                   PERFORM SK7RVGN
               ELSE
      *            CASE: LCL.Include Cancelled Orders is Y
      *            *IF
                   IF (YL0081 OF WORK-CONTEXT = 'Y') THEN
      *                *  Order Cancellation
      *                Rtv Num of Deductions C/D - Customer Order
      *                  Deduct VB  *
                       PERFORM SK8RVGN
                   ELSE
      *                CASE: *OTHERWISE
      *                U:Pay Cat 1 De-Order
                       MOVE ZEROS TO YL0220 OF WORK-CONTEXT
      *                U:Pay Cat 2 De-Order
                       MOVE ZEROS TO YL0221 OF WORK-CONTEXT
      *                U:Pay Cat 3 De-Order
                       MOVE ZEROS TO YL0222 OF WORK-CONTEXT
      *                U:Pay Cat 4 De-Order
                       MOVE ZEROS TO YL0223 OF WORK-CONTEXT
      *                U:Pay Cat 5 De-Order
                       MOVE ZEROS TO YL0224 OF WORK-CONTEXT
      *                U:Pay Cat N De-Order
                       MOVE ZEROS TO YL0226 OF WORK-CONTEXT
      *                U:Pay Cat O De-Order
                       MOVE ZEROS TO YL0225 OF WORK-CONTEXT
                   END-IF
               END-IF
           END-IF
      *    Orders
      *    LCL.PreQual Order Ren =
      *    *COMPUTE (x1 + x2 + x3 + x4 + x5 + x6)
      *    x1    : LCL.U:Pay Cat 1 Order
      *    +     : PGM.*Synon (17,7) work field
      *    x2    : LCL.U:Pay Cat 2 Order
      *    +     : PGM.*Synon (17,7) work field
      *    x3    : LCL.U:Pay Cat 3 Order
      *    +     : PGM.*Synon (17,7) work field
      *    x4    : LCL.U:Pay Cat 4 Order
      *    +     : PGM.*Synon (17,7) work field
      *    x5    : LCL.U:Pay Cat 5 Order
      *    +     : PGM.*Synon (17,7) work field
      *    x6    : LCL.U:Pay Cat N Order
      *    *Synon (17,7) work field
           ADD YL0195 OF WORK-CONTEXT, YL0196 OF WORK-CONTEXT GIVING
             W0WD04
      *    *Synon (17,7) work field
           ADD W0WD04, YL0197 OF WORK-CONTEXT GIVING W0WD03
      *    *Synon (17,7) work field
           ADD W0WD03, YL0198 OF WORK-CONTEXT GIVING W0WD02
      *    *Synon (17,7) work field
           ADD W0WD02, YL0199 OF WORK-CONTEXT GIVING W0WD01
      *    *Synon (17,7) work field
           ADD W0WD01, YL0200 OF WORK-CONTEXT GIVING W0WD00
      *    PreQual Order 1 Renault
           MOVE W0WD00 TO YL0186 OF WORK-CONTEXT
      *    Deduct
      *    LCL.PreQual Cancel 1 Renault =
      *    *COMPUTE (x1 + x2 + x3 + x4 + x5 + x6)
      *    x1    : LCL.U:Pay Cat 1 De-Order
      *    +     : PGM.*Synon (17,7) work field
      *    x2    : LCL.U:Pay Cat 2 De-Order
      *    +     : PGM.*Synon (17,7) work field
      *    x3    : LCL.U:Pay Cat 3 De-Order
      *    +     : PGM.*Synon (17,7) work field
      *    x4    : LCL.U:Pay Cat 4 De-Order
      *    +     : PGM.*Synon (17,7) work field
      *    x5    : LCL.U:Pay Cat 5 De-Order
      *    +     : PGM.*Synon (17,7) work field
      *    x6    : LCL.U:Pay Cat N De-Order
      *    *Synon (17,7) work field
           ADD YL0220 OF WORK-CONTEXT, YL0221 OF WORK-CONTEXT GIVING
             W0WD04
      *    *Synon (17,7) work field
           ADD W0WD04, YL0222 OF WORK-CONTEXT GIVING W0WD03
      *    *Synon (17,7) work field
           ADD W0WD03, YL0223 OF WORK-CONTEXT GIVING W0WD02
      *    *Synon (17,7) work field
           ADD W0WD02, YL0224 OF WORK-CONTEXT GIVING W0WD01
      *    *Synon (17,7) work field
           ADD W0WD01, YL0226 OF WORK-CONTEXT GIVING W0WD00
      *    PreQual Cancel 1 Renault
           MOVE W0WD00 TO YL0187 OF WORK-CONTEXT
      *    PreQual Net 1 Renault
           SUBTRACT YL0187 OF WORK-CONTEXT FROM YL0186 OF WORK-CONTEXT
             GIVING YL0184 OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       UG7EXIT.
           EXIT.
      /EJECT
       UG8SUBR SECTION.
      *==============================================================
      *    Dacia Order ,Cancel and De-Alocation
      *==============================================================
      *    Get number of live Order
      *    Rtv Num of Order - Customer Order  *
           PERFORM SK9RVGN
      *    Deduct (Cancel +De-Alocation)
      *    Get Order Deduct by parameter
      *    CASE:
      *    - c1 AND c2
      *    |- c1    : LCL.Include Cancelled Orders is Y
      *    |- c2    : LCL.Include Unmatched Orders is Y
      *    '-
      *    *IF
           IF (YL0081 OF WORK-CONTEXT = 'Y' AND
               YL0082 OF WORK-CONTEXT = 'Y') THEN
      *        * Normal get deduct
      *        Rtv Num of Deductions - Customer Order Deduct VB  *
               PERFORM SL5RVGN
           ELSE
      *        CASE: *OTHERWISE
      *        CASE: LCL.Include Unmatched Orders is Y
      *        *IF
               IF (YL0082 OF WORK-CONTEXT = 'Y') THEN
      *            * Order De-Allocation
      *            Rtv Num of Deductions C/D - Customer Order Deduct
      *              VB  *
                   PERFORM SL6RVGN
               ELSE
      *            CASE: LCL.Include Cancelled Orders is Y
      *            *IF
                   IF (YL0081 OF WORK-CONTEXT = 'Y') THEN
      *                *  Order Cancellation
      *                Rtv Num of Deductions C/D - Customer Order
      *                  Deduct VB  *
                       PERFORM SL7RVGN
                   ELSE
      *                CASE: *OTHERWISE
      *                U:Pay Cat 1 De-Order
                       MOVE ZEROS TO YL0220 OF WORK-CONTEXT
      *                U:Pay Cat 2 De-Order
                       MOVE ZEROS TO YL0221 OF WORK-CONTEXT
      *                U:Pay Cat 3 De-Order
                       MOVE ZEROS TO YL0222 OF WORK-CONTEXT
      *                U:Pay Cat 4 De-Order
                       MOVE ZEROS TO YL0223 OF WORK-CONTEXT
      *                U:Pay Cat 5 De-Order
                       MOVE ZEROS TO YL0224 OF WORK-CONTEXT
      *                U:Pay Cat N De-Order
                       MOVE ZEROS TO YL0226 OF WORK-CONTEXT
      *                U:Pay Cat O De-Order
                       MOVE ZEROS TO YL0225 OF WORK-CONTEXT
                   END-IF
               END-IF
           END-IF
      *    Orders
      *    LCL.PreQual Order 1 Dacia =
      *    *COMPUTE (x1 + x2 + x3 + x4 + x5 + x6 +
      *    x7)
      *    x1    : LCL.U:Pay Cat 1 Order
      *    +     : PGM.*Synon (17,7) work field
      *    x2    : LCL.U:Pay Cat 2 Order
      *    +     : PGM.*Synon (17,7) work field
      *    x3    : LCL.U:Pay Cat 3 Order
      *    +     : PGM.*Synon (17,7) work field
      *    x4    : LCL.U:Pay Cat 4 Order
      *    +     : PGM.*Synon (17,7) work field
      *    x5    : LCL.U:Pay Cat 5 Order
      *    +     : PGM.*Synon (17,7) work field
      *    x6    : LCL.U:Pay Cat N Order
      *    +     : PGM.*Synon (17,7) work field
      *    x7    : LCL.U:Pay Cat O Order
      *    *Synon (17,7) work field
           ADD YL0195 OF WORK-CONTEXT, YL0196 OF WORK-CONTEXT GIVING
             W0WD05
      *    *Synon (17,7) work field
           ADD W0WD05, YL0197 OF WORK-CONTEXT GIVING W0WD04
      *    *Synon (17,7) work field
           ADD W0WD04, YL0198 OF WORK-CONTEXT GIVING W0WD03
      *    *Synon (17,7) work field
           ADD W0WD03, YL0199 OF WORK-CONTEXT GIVING W0WD02
      *    *Synon (17,7) work field
           ADD W0WD02, YL0200 OF WORK-CONTEXT GIVING W0WD01
      *    *Synon (17,7) work field
           ADD W0WD01, YL0201 OF WORK-CONTEXT GIVING W0WD00
      *    PreQual Order 1 Dacia
           MOVE W0WD00 TO YL0182 OF WORK-CONTEXT
      *    Deduct
      *    LCL.PreQual Cancel 1 Dacia =
      *    *COMPUTE (x1 + x2 + x3 + x4 + x5 + x6 +
      *    x7)
      *    x1    : LCL.U:Pay Cat 1 De-Order
      *    +     : PGM.*Synon (17,7) work field
      *    x2    : LCL.U:Pay Cat 2 De-Order
      *    +     : PGM.*Synon (17,7) work field
      *    x3    : LCL.U:Pay Cat 3 De-Order
      *    +     : PGM.*Synon (17,7) work field
      *    x4    : LCL.U:Pay Cat 4 De-Order
      *    +     : PGM.*Synon (17,7) work field
      *    x5    : LCL.U:Pay Cat 5 De-Order
      *    +     : PGM.*Synon (17,7) work field
      *    x6    : LCL.U:Pay Cat N De-Order
      *    +     : PGM.*Synon (17,7) work field
      *    x7    : LCL.U:Pay Cat O De-Order
      *    *Synon (17,7) work field
           ADD YL0220 OF WORK-CONTEXT, YL0221 OF WORK-CONTEXT GIVING
             W0WD05
      *    *Synon (17,7) work field
           ADD W0WD05, YL0222 OF WORK-CONTEXT GIVING W0WD04
      *    *Synon (17,7) work field
           ADD W0WD04, YL0223 OF WORK-CONTEXT GIVING W0WD03
      *    *Synon (17,7) work field
           ADD W0WD03, YL0224 OF WORK-CONTEXT GIVING W0WD02
      *    *Synon (17,7) work field
           ADD W0WD02, YL0226 OF WORK-CONTEXT GIVING W0WD01
      *    *Synon (17,7) work field
           ADD W0WD01, YL0225 OF WORK-CONTEXT GIVING W0WD00
      *    PreQual Cancel 1 Dacia
           MOVE W0WD00 TO YL0183 OF WORK-CONTEXT
      *    PreQual Net 1 Dacia
           SUBTRACT YL0183 OF WORK-CONTEXT FROM YL0182 OF WORK-CONTEXT
             GIVING YL0174 OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       UG8EXIT.
           EXIT.
      /EJECT
       UG9SUBR SECTION.
      *==============================================================
      *
      *==============================================================
      *    Renault Order ,Cancel and De-Alocation
           PERFORM UH1SUBR
      *    Dacia Order ,Cancel and De-Alocation
           PERFORM UH2SUBR
      *==============================================================
           CONTINUE.
       UG9EXIT.
           EXIT.
      /EJECT
       UH1SUBR SECTION.
      *==============================================================
      *    Renault Order ,Cancel and De-Alocation
      *==============================================================
      *    Deduct (Cancel +De-Alocation)
      *    Get Order Deduct by parameter
      *    CASE:
      *    - c1 AND c2
      *    |- c1    : LCL.Include Cancelled Orders is Y
      *    |- c2    : LCL.Include Unmatched Orders is Y
      *    '-
      *    *IF
           IF (YL0081 OF WORK-CONTEXT = 'Y' AND
               YL0082 OF WORK-CONTEXT = 'Y') THEN
      *        * Normal get deduct
      *        Rtv Num of Deductions - Customer Order Deduct VB  *
               PERFORM SL8RVGN
           ELSE
      *        CASE: *OTHERWISE
      *        CASE: LCL.Include Unmatched Orders is Y
      *        *IF
               IF (YL0082 OF WORK-CONTEXT = 'Y') THEN
      *            * Order De-Allocation
      *            Rtv Num of Deductions C/D - Customer Order Deduct
      *              VB  *
                   PERFORM SL9RVGN
               ELSE
      *            CASE: LCL.Include Cancelled Orders is Y
      *            *IF
                   IF (YL0081 OF WORK-CONTEXT = 'Y') THEN
      *                *  Order Cancellation
      *                Rtv Num of Deductions C/D - Customer Order
      *                  Deduct VB  *
                       PERFORM SM1RVGN
                   ELSE
      *                CASE: *OTHERWISE
      *                U:Pay Cat 1 De-Order
                       MOVE ZEROS TO YL0220 OF WORK-CONTEXT
      *                U:Pay Cat 2 De-Order
                       MOVE ZEROS TO YL0221 OF WORK-CONTEXT
      *                U:Pay Cat 3 De-Order
                       MOVE ZEROS TO YL0222 OF WORK-CONTEXT
      *                U:Pay Cat 4 De-Order
                       MOVE ZEROS TO YL0223 OF WORK-CONTEXT
      *                U:Pay Cat 5 De-Order
                       MOVE ZEROS TO YL0224 OF WORK-CONTEXT
      *                U:Pay Cat N De-Order
                       MOVE ZEROS TO YL0226 OF WORK-CONTEXT
      *                U:Pay Cat O De-Order
                       MOVE ZEROS TO YL0225 OF WORK-CONTEXT
                   END-IF
               END-IF
           END-IF
      *    Deduct
      *    LCL.PreQual Cancel Ren Prev =
      *    *COMPUTE (x1 + x2 + x3 + x4 + x5 + x6)
      *    x1    : LCL.U:Pay Cat 1 De-Order
      *    +     : PGM.*Synon (17,7) work field
      *    x2    : LCL.U:Pay Cat 2 De-Order
      *    +     : PGM.*Synon (17,7) work field
      *    x3    : LCL.U:Pay Cat 3 De-Order
      *    +     : PGM.*Synon (17,7) work field
      *    x4    : LCL.U:Pay Cat 4 De-Order
      *    +     : PGM.*Synon (17,7) work field
      *    x5    : LCL.U:Pay Cat 5 De-Order
      *    +     : PGM.*Synon (17,7) work field
      *    x6    : LCL.U:Pay Cat N De-Order
      *    *Synon (17,7) work field
           ADD YL0220 OF WORK-CONTEXT, YL0221 OF WORK-CONTEXT GIVING
             W0WD04
      *    *Synon (17,7) work field
           ADD W0WD04, YL0222 OF WORK-CONTEXT GIVING W0WD03
      *    *Synon (17,7) work field
           ADD W0WD03, YL0223 OF WORK-CONTEXT GIVING W0WD02
      *    *Synon (17,7) work field
           ADD W0WD02, YL0224 OF WORK-CONTEXT GIVING W0WD01
      *    *Synon (17,7) work field
           ADD W0WD01, YL0226 OF WORK-CONTEXT GIVING W0WD00
      *    PreQual Cancel Ren Prev
           MOVE W0WD00 TO YL0171 OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       UH1EXIT.
           EXIT.
      /EJECT
       UH2SUBR SECTION.
      *==============================================================
      *    Dacia Order ,Cancel and De-Alocation
      *==============================================================
      *    Get Order Deduct by parameter
      *    CASE:
      *    - c1 AND c2
      *    |- c1    : LCL.Include Cancelled Orders is Y
      *    |- c2    : LCL.Include Unmatched Orders is Y
      *    '-
      *    *IF
           IF (YL0081 OF WORK-CONTEXT = 'Y' AND
               YL0082 OF WORK-CONTEXT = 'Y') THEN
      *        * Normal get deduct
      *        Rtv Num of Deductions - Customer Order Deduct VB  *
               PERFORM SM2RVGN
           ELSE
      *        CASE: *OTHERWISE
      *        CASE: LCL.Include Unmatched Orders is Y
      *        *IF
               IF (YL0082 OF WORK-CONTEXT = 'Y') THEN
      *            * Order De-Allocation
      *            Rtv Num of Deductions C/D - Customer Order Deduct
      *              VB  *
                   PERFORM SM3RVGN
               ELSE
      *            CASE: LCL.Include Cancelled Orders is Y
      *            *IF
                   IF (YL0081 OF WORK-CONTEXT = 'Y') THEN
      *                *  Order Cancellation
      *                Rtv Num of Deductions C/D - Customer Order
      *                  Deduct VB  *
                       PERFORM SM4RVGN
                   ELSE
      *                CASE: *OTHERWISE
      *                U:Pay Cat 1 De-Order
                       MOVE ZEROS TO YL0220 OF WORK-CONTEXT
      *                U:Pay Cat 2 De-Order
                       MOVE ZEROS TO YL0221 OF WORK-CONTEXT
      *                U:Pay Cat 3 De-Order
                       MOVE ZEROS TO YL0222 OF WORK-CONTEXT
      *                U:Pay Cat 4 De-Order
                       MOVE ZEROS TO YL0223 OF WORK-CONTEXT
      *                U:Pay Cat 5 De-Order
                       MOVE ZEROS TO YL0224 OF WORK-CONTEXT
      *                U:Pay Cat N De-Order
                       MOVE ZEROS TO YL0226 OF WORK-CONTEXT
      *                U:Pay Cat O De-Order
                       MOVE ZEROS TO YL0225 OF WORK-CONTEXT
                   END-IF
               END-IF
           END-IF
      *    Deduct
      *    LCL.PreQual Cancel Dac Prev =
      *    *COMPUTE (x1 + x2 + x3 + x4 + x5 + x6 +
      *    x7)
      *    x1    : LCL.U:Pay Cat 1 De-Order
      *    +     : PGM.*Synon (17,7) work field
      *    x2    : LCL.U:Pay Cat 2 De-Order
      *    +     : PGM.*Synon (17,7) work field
      *    x3    : LCL.U:Pay Cat 3 De-Order
      *    +     : PGM.*Synon (17,7) work field
      *    x4    : LCL.U:Pay Cat 4 De-Order
      *    +     : PGM.*Synon (17,7) work field
      *    x5    : LCL.U:Pay Cat 5 De-Order
      *    +     : PGM.*Synon (17,7) work field
      *    x6    : LCL.U:Pay Cat N De-Order
      *    +     : PGM.*Synon (17,7) work field
      *    x7    : LCL.U:Pay Cat O De-Order
      *    *Synon (17,7) work field
           ADD YL0220 OF WORK-CONTEXT, YL0221 OF WORK-CONTEXT GIVING
             W0WD05
      *    *Synon (17,7) work field
           ADD W0WD05, YL0222 OF WORK-CONTEXT GIVING W0WD04
      *    *Synon (17,7) work field
           ADD W0WD04, YL0223 OF WORK-CONTEXT GIVING W0WD03
      *    *Synon (17,7) work field
           ADD W0WD03, YL0224 OF WORK-CONTEXT GIVING W0WD02
      *    *Synon (17,7) work field
           ADD W0WD02, YL0226 OF WORK-CONTEXT GIVING W0WD01
      *    *Synon (17,7) work field
           ADD W0WD01, YL0225 OF WORK-CONTEXT GIVING W0WD00
      *    PreQual Cancel Dac Prev
           MOVE W0WD00 TO YL0172 OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       UH2EXIT.
           EXIT.
      /EJECT
       UH3SUBR SECTION.
      *==============================================================
      *    Archivent P1 P2 P3 P4 P5 P6 P7 total
      *==============================================================
      *    Run mode Rulest Order  P1,P2 ,P5,P6
      *    CASE: LCL.U:Run Mode is *2
      *    *IF
           IF (YL0085 OF WORK-CONTEXT = '2') THEN
      *        Mode 2
               PERFORM UH4SUBR
           ELSE
      *        CASE: LCL.U:Run Mode is *1
      *        *IF
               IF (YL0085 OF WORK-CONTEXT = '1') THEN
      *            Mode 1
                   PERFORM UH5SUBR
               END-IF
           END-IF
      *    Initial Run Total
      *    CASE: LCL.Initial Run is Y
      *    *IF
           IF (YL0091 OF WORK-CONTEXT = 'Y') THEN
      *        *Deduc mode 2
      *        Combination Total De-order (Renault + Dacia)
      *        PreQual Cancel A
               ADD YL0171 OF WORK-CONTEXT, YL0172 OF WORK-CONTEXT
                 GIVING YL0194 OF WORK-CONTEXT
      *        Combination Total order (Renault + Dacia)
      *        PreQual Order A
               ADD YL0186 OF WORK-CONTEXT, YL0182 OF WORK-CONTEXT
                 GIVING YL0188 OF WORK-CONTEXT
      *        Combination Total Target  (Renault + Dacia)
      *        PreQual Combine Target
               ADD YL0185 OF WORK-CONTEXT, YL0181 OF WORK-CONTEXT
                 GIVING YL0193 OF WORK-CONTEXT
      *        Combination Total Net  (Renault + Dacia)
      *        PreQual Combine Net
               SUBTRACT YL0194 OF WORK-CONTEXT FROM YL0188 OF
                 WORK-CONTEXT GIVING YL0192 OF WORK-CONTEXT
           END-IF
      *    P7
      *    CASE:
      *    - c1 AND c2
      *    |- c1    : LCL.U:Run Mode is *1
      *    |- c2    : LCL.Recalculate Order Ach Brn is Y
      *    '-
      *    *IF
           IF (YL0085 OF WORK-CONTEXT = '1' AND
               YL0083 OF WORK-CONTEXT = 'Y') THEN
      *        P7 Orders Ranault + Dacia
      *        PreQual Order 7
               ADD YL0074 OF WORK-CONTEXT, YL0077 OF WORK-CONTEXT
                 GIVING YL0189 OF WORK-CONTEXT
      *        P7 Cancel Ranault + Dacia
      *        PreQual Cancel 7
               ADD YL0075 OF WORK-CONTEXT, YL0078 OF WORK-CONTEXT
                 GIVING YL0190 OF WORK-CONTEXT
      *        P7 Target  (Renault + Dacia)
      *        PreQual Target 7
               ADD YL0079 OF WORK-CONTEXT, YL0076 OF WORK-CONTEXT
                 GIVING YL0191 OF WORK-CONTEXT
           ELSE
      *        CASE:
      *        - c1 OR c2
      *        |- c1    : LCL.U:Run Mode is *2
      *        |- c2    : LCL.Initial Run is Y
      *        '-
      *        *IF
               IF (YL0085 OF WORK-CONTEXT = '2' OR
                   YL0091 OF WORK-CONTEXT = 'Y') THEN
      *            P7 Orders Ranault + Dacia
      *            PreQual Order 7
                   ADD YL0062 OF WORK-CONTEXT, YL0065 OF WORK-CONTEXT
                     GIVING YL0189 OF WORK-CONTEXT
      *            P7 Cancel Ranault + Dacia
      *            PreQual Cancel 7
                   ADD YL0063 OF WORK-CONTEXT, YL0066 OF WORK-CONTEXT
                     GIVING YL0190 OF WORK-CONTEXT
      *            P7 Target  (Renault + Dacia)
      *            PreQual Target 7
                   ADD YL0064 OF WORK-CONTEXT, YL0067 OF WORK-CONTEXT
                     GIVING YL0191 OF WORK-CONTEXT
               END-IF
           END-IF
      *==============================================================
           CONTINUE.
       UH3EXIT.
           EXIT.
      /EJECT
       UH4SUBR SECTION.
      *==============================================================
      *    Mode 2
      *==============================================================
      *    P1 Order Renault
      *    PreQual Order 1
           MOVE YL0186 OF WORK-CONTEXT TO YL0062 OF WORK-CONTEXT
      *    P2 Order Dacia
      *    PreQual Order 2
           MOVE YL0182 OF WORK-CONTEXT TO YL0065 OF WORK-CONTEXT
      *    P1 Canceled orders Renault
      *    PreQual Cancel 1
           MOVE YL0187 OF WORK-CONTEXT TO YL0063 OF WORK-CONTEXT
      *    P2 Canceled orders Dacia
      *    PreQual Cancel 2
           MOVE YL0183 OF WORK-CONTEXT TO YL0066 OF WORK-CONTEXT
      *    P1 Target - Renault
      *    PreQual Target 1
           MOVE YL0185 OF WORK-CONTEXT TO YL0064 OF WORK-CONTEXT
      *    P2 Target - Dacia
      *    PreQual Target 2
           MOVE YL0181 OF WORK-CONTEXT TO YL0067 OF WORK-CONTEXT
      *    P5 Order Renault
      *    PreQual Order 5
           MOVE YL0186 OF WORK-CONTEXT TO YL0074 OF WORK-CONTEXT
      *    P6 Order Dacia
      *    PreQual Order 6
           MOVE YL0182 OF WORK-CONTEXT TO YL0077 OF WORK-CONTEXT
      *    P5 Canceled orders Renault
      *    PreQual Cancel 5
           MOVE YL0187 OF WORK-CONTEXT TO YL0075 OF WORK-CONTEXT
      *    P6 Canceled orders Dacia
      *    PreQual Cancel 6
           MOVE YL0183 OF WORK-CONTEXT TO YL0078 OF WORK-CONTEXT
      *    P5 Target - Renault
      *    PreQual Target 5
           MOVE YL0185 OF WORK-CONTEXT TO YL0076 OF WORK-CONTEXT
      *    P6 Target - Dacia
      *    PreQual Target 6
           MOVE YL0181 OF WORK-CONTEXT TO YL0079 OF WORK-CONTEXT
      *    Combination Total order (Renault + Dacia)
      *    PreQual Order A
           ADD YL0186 OF WORK-CONTEXT, YL0182 OF WORK-CONTEXT GIVING
             YL0188 OF WORK-CONTEXT
      *    Combination Total Target  (Renault + Dacia)
      *    PreQual Combine Target
           ADD YL0064 OF WORK-CONTEXT, YL0067 OF WORK-CONTEXT GIVING
             YL0193 OF WORK-CONTEXT
      *    Combination Total De-order (Renault + Dacia)
      *    PreQual Cancel A
           ADD YL0187 OF WORK-CONTEXT, YL0183 OF WORK-CONTEXT GIVING
             YL0194 OF WORK-CONTEXT
      *    Combination Total Net  (Renault + Dacia)
      *    PreQual Combine Net
           SUBTRACT YL0194 OF WORK-CONTEXT FROM YL0188 OF WORK-CONTEXT
             GIVING YL0192 OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       UH4EXIT.
           EXIT.
      /EJECT
       UH5SUBR SECTION.
      *==============================================================
      *    Mode 1
      *==============================================================
      *    P5 Canceled orders Renault
      *    PreQual Cancel 5
           MOVE YL0187 OF WORK-CONTEXT TO YL0075 OF WORK-CONTEXT
      *    P6 Canceled orders Dacia
      *    PreQual Cancel 6
           MOVE YL0183 OF WORK-CONTEXT TO YL0078 OF WORK-CONTEXT
      *    P5 Target - Renault
      *    PreQual Target 5
           MOVE YL0185 OF WORK-CONTEXT TO YL0076 OF WORK-CONTEXT
      *    P6 Target - Dacia
      *    PreQual Target 6
           MOVE YL0181 OF WORK-CONTEXT TO YL0079 OF WORK-CONTEXT
      *    P5 Order Renault
      *    PreQual Order 5
           MOVE YL0186 OF WORK-CONTEXT TO YL0074 OF WORK-CONTEXT
      *    P6 Order Dacia
      *    PreQual Order 6
           MOVE YL0182 OF WORK-CONTEXT TO YL0077 OF WORK-CONTEXT
      *    Combination Total order (Renault + Dacia)
      *    PreQual Order A
           ADD YL0186 OF WORK-CONTEXT, YL0182 OF WORK-CONTEXT GIVING
             YL0188 OF WORK-CONTEXT
      *    Combination Total Target  (Renault + Dacia)
      *    PreQual Combine Target
           ADD YL0076 OF WORK-CONTEXT, YL0079 OF WORK-CONTEXT GIVING
             YL0193 OF WORK-CONTEXT
      *    Combination Total De-order (Renault + Dacia)
      *    PreQual Cancel A
           ADD YL0187 OF WORK-CONTEXT, YL0183 OF WORK-CONTEXT GIVING
             YL0194 OF WORK-CONTEXT
      *    Combination Total Net  (Renault + Dacia)
      *    PreQual Combine Net
           SUBTRACT YL0194 OF WORK-CONTEXT FROM YL0188 OF WORK-CONTEXT
             GIVING YL0192 OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       UH5EXIT.
           EXIT.
      /EJECT
       UH6SUBR SECTION.
      *==============================================================
      *    Compute Target Total
      *==============================================================
      *    Compute combination DACIA + RENAULT
      *    U:Target Total
           MOVE ZEROS TO WUTGTTOT OF WORK-CONTEXT
      *    U:Target Total
           MULTIPLY YL0193 OF WORK-CONTEXT BY 1 GIVING WUTGTTOT OF
             WORK-CONTEXT
      *==============================================================
           CONTINUE.
       UH6EXIT.
           EXIT.
      /EJECT
       UH7SUBR SECTION.
      *==============================================================
      *    Calculate Achievement %  Target
      *==============================================================
      *    * For Calculation of Targets use Tuncation Rather Than
      *      Rounding
      *    U:80% of Target -Decimal
           MULTIPLY WUTGTTOT OF WORK-CONTEXT BY 0.8 GIVING WUU80TD OF
             WORK-CONTEXT
      *    U:80%  of target Ord
           MULTIPLY WUU80TD OF WORK-CONTEXT BY 1 GIVING WUH0NU OF
             WORK-CONTEXT
      *    U:90% of target -decimal
           MULTIPLY WUTGTTOT OF WORK-CONTEXT BY 0.9 GIVING WUU90TD OF
             WORK-CONTEXT
      *    U:90%  of target Ord
           MULTIPLY WUU90TD OF WORK-CONTEXT BY 1 GIVING WUH1NU OF
             WORK-CONTEXT
      *    U:100% of Target -decimal
           MULTIPLY WUTGTTOT OF WORK-CONTEXT BY 1.00 GIVING WUU100PCTD
             OF WORK-CONTEXT
      *    U:100% of target Ord
           MULTIPLY WUU100PCTD OF WORK-CONTEXT BY 1 GIVING WUH2NU OF
             WORK-CONTEXT
      *    U:105% of target -decimal
           MULTIPLY WUTGTTOT OF WORK-CONTEXT BY 1.05 GIVING WUU105PCTD
             OF WORK-CONTEXT
      *    U:105% of target Ord
           MULTIPLY WUU105PCTD OF WORK-CONTEXT BY 1 GIVING WUH5NU OF
             WORK-CONTEXT
      *    U:110% of target -decimal
           MULTIPLY WUTGTTOT OF WORK-CONTEXT BY 1.1 GIVING WUU110PCTD
             OF WORK-CONTEXT
      *    U:110% of target Ord
           MULTIPLY WUU110PCTD OF WORK-CONTEXT BY 1 GIVING WUH3NU OF
             WORK-CONTEXT
      *    U:120% of target -decimal
           MULTIPLY WUTGTTOT OF WORK-CONTEXT BY 1.2 GIVING WUU120PCTD
             OF WORK-CONTEXT
      *    U:120% of target Ord
           MULTIPLY WUU120PCTD OF WORK-CONTEXT BY 1 GIVING WUH4NU OF
             WORK-CONTEXT
      *==============================================================
           CONTINUE.
       UH7EXIT.
           EXIT.
      /EJECT
       UH8SUBR SECTION.
      *==============================================================
      *    Achievement , Summary for Re-Calculate
      *==============================================================
      *    Set Targets for the different %'s on Dealer Summ file
      *    Set achievement Flag Combine Renault + Dacia
      *    CASE: LCL.PreQual Combine Net GE WRK.U:80%  of target Ord
      *    *IF
           IF (YL0192 OF WORK-CONTEXT NOT < WUH0NU OF WORK-CONTEXT) THEN
      *        Achieved Pre-Qualifier
               MOVE 'Y' TO YL0170 OF WORK-CONTEXT
           ELSE
      *        CASE: *OTHERWISE
      *        Achieved Pre-Qualifier
               MOVE 'N' TO YL0170 OF WORK-CONTEXT
           END-IF
      *    CASE:
      *    - c1 OR c2
      *    |- c1    : LCL.U:Clawinging back is Y
      *    |- c2    : LCL.Initial Run is Y
      *    '-
      *    *IF
           IF (YL0057 OF WORK-CONTEXT = 'Y' OR
               YL0091 OF WORK-CONTEXT = 'Y') THEN
      *        Achievement band   by % target Renault + Dacia
      *        CASE: WRK.U:Target Total is Equal to *zero
      *        *IF
               IF (WUTGTTOT OF WORK-CONTEXT = 0) THEN
      *            Default No target Payment
                   PERFORM UH9SUBR
               ELSE
      *            CASE: LCL.PreQual Combine Net GE WRK.U:120% of
      *              target Ord
      *            *IF
                   IF (YL0192 OF WORK-CONTEXT NOT < WUH4NU OF
                     WORK-CONTEXT) THEN
      *                Achievement Band
                       MOVE SPACES TO YL0169 OF WORK-CONTEXT
                       MOVE '120%+' TO YL0169 OF WORK-CONTEXT
      *                U:Payment Band 2
                       MOVE 6 TO WUZZNU OF WORK-CONTEXT
                   ELSE
      *                CASE: LCL.PreQual Combine Net GE WRK.U:110% of
      *                  target Ord
      *                *IF
                       IF (YL0192 OF WORK-CONTEXT NOT < WUH3NU OF
                         WORK-CONTEXT) THEN
      *                    Achievement Band
                           MOVE '110-119.9%' TO YL0169 OF WORK-CONTEXT
      *                    U:Payment Band 2
                           MOVE 5 TO WUZZNU OF WORK-CONTEXT
                       ELSE
      *                    CASE: LCL.PreQual Combine Net GE WRK.U:105%
      *                      of target Ord
      *                    *IF
                           IF (YL0192 OF WORK-CONTEXT NOT < WUH5NU OF
                             WORK-CONTEXT) THEN
      *                        Achievement Band
                               MOVE '105-109.9%' TO YL0169 OF
                                 WORK-CONTEXT
      *                        U:Payment Band 2
                               MOVE 4 TO WUZZNU OF WORK-CONTEXT
                           ELSE
      *                        CASE: LCL.PreQual Combine Net GE
      *                          WRK.U:100% of target Ord
      *                        *IF
                               IF (YL0192 OF WORK-CONTEXT NOT < WUH2NU
                                 OF WORK-CONTEXT) THEN
      *                        Achievement Band
                               MOVE '100-104.9%' TO YL0169 OF
                                 WORK-CONTEXT
      *                        U:Payment Band 2
                               MOVE 3 TO WUZZNU OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.PreQual Combine Net GE
      *                          WRK.U:90%  of target Ord
      *                        *IF
                               IF (YL0192 OF WORK-CONTEXT NOT < WUH1NU
                                 OF WORK-CONTEXT) THEN
      *                        Achievement Band
                               MOVE SPACES TO YL0169 OF WORK-CONTEXT
                               MOVE '90-99.9%' TO YL0169 OF WORK-CONTEXT
      *                        U:Payment Band 2
                               MOVE 2 TO WUZZNU OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.PreQual Combine Net GE
      *                          WRK.U:80%  of target Ord
      *                        *IF
                               IF (YL0192 OF WORK-CONTEXT NOT < WUH0NU
                                 OF WORK-CONTEXT) THEN
      *                        Achievement Band
                               MOVE SPACES TO YL0169 OF WORK-CONTEXT
                               MOVE '80-89.9%' TO YL0169 OF WORK-CONTEXT
      *                        U:Payment Band 2
                               MOVE 1 TO WUZZNU OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.PreQual Combine Net LT
      *                          WRK.U:80%  of target Ord
      *                        *IF
                               IF (YL0192 OF WORK-CONTEXT < WUH0NU OF
                                 WORK-CONTEXT) THEN
      *                        Achievement Band
                               MOVE SPACES TO YL0169 OF WORK-CONTEXT
                               MOVE '<80%' TO YL0169 OF WORK-CONTEXT
      *                        U:Payment Band 2
                               MOVE 999 TO WUZZNU OF WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
                   END-IF
               END-IF
           ELSE
      *        CASE: *OTHERWISE
      *        Achievement , Summary for normal run
               PERFORM UI1SUBR
           END-IF
      *==============================================================
           CONTINUE.
       UH8EXIT.
           EXIT.
      /EJECT
       UH9SUBR SECTION.
      *==============================================================
      *    Default No target Payment
      *==============================================================
      *    Achievement Band
           MOVE SPACES TO YL0169 OF WORK-CONTEXT
           MOVE 'No Target' TO YL0169 OF WORK-CONTEXT
      *    Achieved Pre-Qualifier
           MOVE 'N' TO YL0170 OF WORK-CONTEXT
      *    U:Payment Band 2
           MOVE 999 TO WUZZNU OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       UH9EXIT.
           EXIT.
      /EJECT
       UI1SUBR SECTION.
      *==============================================================
      *    Achievement , Summary for normal run
      *==============================================================
      *    Set Targets for the different %'s on Dealer Summ file
      *    Achievement band   by % target Renault + Dacia
      *    CASE: WRK.U:Target Total is Equal to *zero
      *    *IF
           IF (WUTGTTOT OF WORK-CONTEXT = 0) THEN
      *        Default No target Payment
               PERFORM UI2SUBR
           ELSE
      *        CASE: LCL.PreQual Combine Net GE WRK.U:120% of target Ord
      *        *IF
               IF (YL0192 OF WORK-CONTEXT NOT < WUH4NU OF WORK-CONTEXT)
                 THEN
      *            Achievement Band
                   MOVE SPACES TO YL0169 OF WORK-CONTEXT
                   MOVE '120%+' TO YL0169 OF WORK-CONTEXT
               ELSE
      *            CASE: LCL.PreQual Combine Net GE WRK.U:110% of
      *              target Ord
      *            *IF
                   IF (YL0192 OF WORK-CONTEXT NOT < WUH3NU OF
                     WORK-CONTEXT) THEN
      *                Achievement Band
                       MOVE '110-119.9%' TO YL0169 OF WORK-CONTEXT
                   ELSE
      *                CASE: LCL.PreQual Combine Net GE WRK.U:105% of
      *                  target Ord
      *                *IF
                       IF (YL0192 OF WORK-CONTEXT NOT < WUH5NU OF
                         WORK-CONTEXT) THEN
      *                    Achievement Band
                           MOVE '105-109.9%' TO YL0169 OF WORK-CONTEXT
                       ELSE
      *                    CASE: LCL.PreQual Combine Net GE WRK.U:100%
      *                      of target Ord
      *                    *IF
                           IF (YL0192 OF WORK-CONTEXT NOT < WUH2NU OF
                             WORK-CONTEXT) THEN
      *                        Achievement Band
                               MOVE '100-104.9%' TO YL0169 OF
                                 WORK-CONTEXT
                           ELSE
      *                        CASE: LCL.PreQual Combine Net GE
      *                          WRK.U:90%  of target Ord
      *                        *IF
                               IF (YL0192 OF WORK-CONTEXT NOT < WUH1NU
                                 OF WORK-CONTEXT) THEN
      *                        Achievement Band
                               MOVE SPACES TO YL0169 OF WORK-CONTEXT
                               MOVE '90-99.9%' TO YL0169 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.PreQual Combine Net GE
      *                          WRK.U:80%  of target Ord
      *                        *IF
                               IF (YL0192 OF WORK-CONTEXT NOT < WUH0NU
                                 OF WORK-CONTEXT) THEN
      *                        Achievement Band
                               MOVE SPACES TO YL0169 OF WORK-CONTEXT
                               MOVE '80-89.9%' TO YL0169 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.PreQual Combine Net LT
      *                          WRK.U:80%  of target Ord
      *                        *IF
                               IF (YL0192 OF WORK-CONTEXT < WUH0NU OF
                                 WORK-CONTEXT) THEN
      *                        Achievement Band
                               MOVE SPACES TO YL0169 OF WORK-CONTEXT
                               MOVE '<80%' TO YL0169 OF WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
                   END-IF
               END-IF
           END-IF
      *    * Previous run Band
      *    U:Payment Band 2
           MOVE YL0087 OF WORK-CONTEXT TO WUZZNU OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       UI1EXIT.
           EXIT.
      /EJECT
       UI2SUBR SECTION.
      *==============================================================
      *    Default No target Payment
      *==============================================================
      *    Achievement Band
           MOVE SPACES TO YL0169 OF WORK-CONTEXT
           MOVE 'No Target' TO YL0169 OF WORK-CONTEXT
      *    Achieved Pre-Qualifier
           MOVE 'N' TO YL0170 OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       UI2EXIT.
           EXIT.
      /EJECT
       UI3SUBR SECTION.
      *==============================================================
      *    without Clawinging
      *==============================================================
      *    Set Targets for the different %'s on Dealer Summ file
      *    Set achievement Flag Combine Renault + Dacia
      *    CASE: LCL.PreQual Combine Net GE WRK.U:80%  of target Ord
      *    *IF
           IF (YL0192 OF WORK-CONTEXT NOT < WUH0NU OF WORK-CONTEXT) THEN
      *        Achieved Pre-Qualifier
               MOVE 'Y' TO YL0170 OF WORK-CONTEXT
           ELSE
      *        CASE: *OTHERWISE
      *        Achieved Pre-Qualifier
               MOVE 'N' TO YL0170 OF WORK-CONTEXT
           END-IF
      *    Achievement band   by % target Renault + Dacia
      *    CASE: WRK.U:Target Total is Equal to *zero
      *    *IF
           IF (WUTGTTOT OF WORK-CONTEXT = 0) THEN
      *        Default No target Payment
               PERFORM UI4SUBR
           ELSE
      *        CASE: LCL.PreQual Combine Net GE WRK.U:120% of target Ord
      *        *IF
               IF (YL0192 OF WORK-CONTEXT NOT < WUH4NU OF WORK-CONTEXT)
                 THEN
      *            Achievement Band
                   MOVE SPACES TO YL0169 OF WORK-CONTEXT
                   MOVE '120%+' TO YL0169 OF WORK-CONTEXT
               ELSE
      *            CASE: LCL.PreQual Combine Net GE WRK.U:110% of
      *              target Ord
      *            *IF
                   IF (YL0192 OF WORK-CONTEXT NOT < WUH3NU OF
                     WORK-CONTEXT) THEN
      *                Achievement Band
                       MOVE '110-119.9%' TO YL0169 OF WORK-CONTEXT
                   ELSE
      *                CASE: LCL.PreQual Combine Net GE WRK.U:105% of
      *                  target Ord
      *                *IF
                       IF (YL0192 OF WORK-CONTEXT NOT < WUH5NU OF
                         WORK-CONTEXT) THEN
      *                    Achievement Band
                           MOVE '105-109.9%' TO YL0169 OF WORK-CONTEXT
                       ELSE
      *                    CASE: LCL.PreQual Combine Net GE WRK.U:100%
      *                      of target Ord
      *                    *IF
                           IF (YL0192 OF WORK-CONTEXT NOT < WUH2NU OF
                             WORK-CONTEXT) THEN
      *                        Achievement Band
                               MOVE '100-104.9%' TO YL0169 OF
                                 WORK-CONTEXT
                           ELSE
      *                        CASE: LCL.PreQual Combine Net GE
      *                          WRK.U:90%  of target Ord
      *                        *IF
                               IF (YL0192 OF WORK-CONTEXT NOT < WUH1NU
                                 OF WORK-CONTEXT) THEN
      *                        Achievement Band
                               MOVE SPACES TO YL0169 OF WORK-CONTEXT
                               MOVE '90-99.9%' TO YL0169 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.PreQual Combine Net GE
      *                          WRK.U:80%  of target Ord
      *                        *IF
                               IF (YL0192 OF WORK-CONTEXT NOT < WUH0NU
                                 OF WORK-CONTEXT) THEN
      *                        Achievement Band
                               MOVE SPACES TO YL0169 OF WORK-CONTEXT
                               MOVE '80-89.9%' TO YL0169 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.PreQual Combine Net LT
      *                          WRK.U:80%  of target Ord
      *                        *IF
                               IF (YL0192 OF WORK-CONTEXT < WUH0NU OF
                                 WORK-CONTEXT) THEN
      *                        Achievement Band
                               MOVE SPACES TO YL0169 OF WORK-CONTEXT
                               MOVE '<80%' TO YL0169 OF WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
                           END-IF
                       END-IF
                   END-IF
               END-IF
           END-IF
      *    * Previous run Band
      *    U:Payment Band 2
           MOVE YL0087 OF WORK-CONTEXT TO WUZZNU OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       UI3EXIT.
           EXIT.
      /EJECT
       UI4SUBR SECTION.
      *==============================================================
      *    Default No target Payment
      *==============================================================
      *    Achievement Band
           MOVE SPACES TO YL0169 OF WORK-CONTEXT
           MOVE 'No Target' TO YL0169 OF WORK-CONTEXT
      *    Achieved Pre-Qualifier
           MOVE 'N' TO YL0170 OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       UI4EXIT.
           EXIT.
      /EJECT
       UI5SUBR SECTION.
      *==============================================================
      *    Payment Band Registration + Order
      *==============================================================
           MOVE WUZZNU OF WORK-CONTEXT TO YL0246 OF WORK-CONTEXT
           MOVE WUWCNU OF WORK-CONTEXT TO YL0247 OF WORK-CONTEXT
      *    CASE:
      *    - c1 ANDc2
      *    |- c1    : WRK.U:Payment Band is LE 9
      *    |- c2    : WRK.U:Payment Band 2 is LE 9
      *    '-
      *    *IF
           IF (WUWCNU OF WORK-CONTEXT NOT > 9 AND
               WUZZNU OF WORK-CONTEXT NOT > 9) THEN
      *        * Order
               MOVE WUZZNU OF WORK-CONTEXT TO YL0248 OF WORK-CONTEXT
      *        * Registration
               MOVE WUWCNU OF WORK-CONTEXT TO YL0249 OF WORK-CONTEXT
      *        * Combined Band
               MOVE 1 TO YRSW03
               MOVE 3 TO YRSW02
               IF (YRSW02 NOT > 0 OR
                   YRSW03 NOT > 0 OR
                   YRSW02 > 00003 OR
                   YRSW03 > 00003) THEN
                   MOVE 'Y2U0510' TO W0RTN
               ELSE
                   MOVE YL0248 OF WORK-CONTEXT TO W0STRNG
                   MOVE W0STRNG(YRSW02:YRSW03) TO YL0250 OF WORK-CONTEXT
               END-IF
               MOVE 1 TO YRSW03
               MOVE 3 TO YRSW02
               IF (YRSW02 NOT > 0 OR
                   YRSW03 NOT > 0 OR
                   YRSW02 > 00003 OR
                   YRSW03 > 00003) THEN
                   MOVE 'Y2U0510' TO W0RTN
               ELSE
                   MOVE YL0249 OF WORK-CONTEXT TO W0STRNG
                   MOVE W0STRNG(YRSW02:YRSW03) TO YL0251 OF WORK-CONTEXT
               END-IF
               MOVE 0 TO YRSW03
               MOVE 'T' TO YRSW05
               IF (YL0250 OF WORK-CONTEXT = SPACES AND
                   YRSW05 = 'T') THEN
                   ADD  1 TO 0 GIVING YRSW04
               ELSE
                   ADD  1 TO 00001 GIVING YRSW04
               END-IF
               MOVE 00001 TO YRSW02
               MOVE YL0250 OF WORK-CONTEXT TO YRSW06
               PERFORM ZCATWK
               STRING YRSW06 DELIMITED BY X'FF',
                      YL0251 OF WORK-CONTEXT DELIMITED BY SIZE
               INTO   YRSW06
               MOVE YRSW06 TO YL0252 OF WORK-CONTEXT
               IF (YL0252 OF WORK-CONTEXT = SPACES) THEN
                   MOVE ZERO TO WUUPAYBN3 OF WORK-CONTEXT
               ELSE
                   MOVE YL0252 OF WORK-CONTEXT TO WUUPAYBN3 OF
                     WORK-CONTEXT
               END-IF
           ELSE
      *        CASE: *OTHERWISE
      *        2 , 999  to 20| 999 , 5  to 05 |order 999
      *        CASE: WRK.U:Payment Band is LE 9
      *        *IF
               IF (WUWCNU OF WORK-CONTEXT NOT > 9) THEN
      *            * Registration
      *            U:Text (1) f
                   MOVE '0' TO YL0250 OF WORK-CONTEXT
                   MOVE WUWCNU OF WORK-CONTEXT TO YL0249 OF WORK-CONTEXT
                   MOVE 1 TO YRSW03
                   MOVE 3 TO YRSW02
                   IF (YRSW02 NOT > 0 OR
                       YRSW03 NOT > 0 OR
                       YRSW02 > 00003 OR
                       YRSW03 > 00003) THEN
                       MOVE 'Y2U0510' TO W0RTN
                   ELSE
                       MOVE YL0249 OF WORK-CONTEXT TO W0STRNG
                       MOVE W0STRNG(YRSW02:YRSW03) TO YL0251 OF
                         WORK-CONTEXT
                   END-IF
                   MOVE ZEROS TO YRSW03
                   MOVE 'T' TO YRSW05
                   IF (YL0250 OF WORK-CONTEXT = SPACES AND
                       YRSW05 = 'T') THEN
                       ADD  1 TO ZEROS GIVING YRSW04
                   ELSE
                       ADD  1 TO 00001 GIVING YRSW04
                   END-IF
                   MOVE 00001 TO YRSW02
                   MOVE YL0250 OF WORK-CONTEXT TO YRSW06
                   PERFORM ZCATWK
                   STRING YRSW06 DELIMITED BY X'FF',
                          YL0251 OF WORK-CONTEXT DELIMITED BY SIZE
                   INTO   YRSW06
                   MOVE YRSW06 TO YL0252 OF WORK-CONTEXT
                   IF (YL0252 OF WORK-CONTEXT = SPACES) THEN
                       MOVE ZERO TO WUUPAYBN3 OF WORK-CONTEXT
                   ELSE
                       MOVE YL0252 OF WORK-CONTEXT TO WUUPAYBN3 OF
                         WORK-CONTEXT
                   END-IF
               ELSE
      *            CASE: WRK.U:Payment Band 2 is LE 9
      *            *IF
                   IF (WUZZNU OF WORK-CONTEXT NOT > 9) THEN
                       MOVE WUZZNU OF WORK-CONTEXT TO YL0248 OF
                         WORK-CONTEXT
                       MOVE 1 TO YRSW03
                       MOVE 3 TO YRSW02
                       IF (YRSW02 NOT > 0 OR
                           YRSW03 NOT > 0 OR
                           YRSW02 > 00003 OR
                           YRSW03 > 00003) THEN
                           MOVE 'Y2U0510' TO W0RTN
                       ELSE
                           MOVE YL0248 OF WORK-CONTEXT TO W0STRNG
                           MOVE W0STRNG(YRSW02:YRSW03) TO YL0250 OF
                             WORK-CONTEXT
                       END-IF
      *                U:Text (1) e
                       MOVE '0' TO YL0251 OF WORK-CONTEXT
                       MOVE ZEROS TO YRSW03
                       MOVE 'T' TO YRSW05
                       IF (YL0250 OF WORK-CONTEXT = SPACES AND
                           YRSW05 = 'T') THEN
                           ADD  1 TO ZEROS GIVING YRSW04
                       ELSE
                           ADD  1 TO 00001 GIVING YRSW04
                       END-IF
                       MOVE 00001 TO YRSW02
                       MOVE YL0250 OF WORK-CONTEXT TO YRSW06
                       PERFORM ZCATWK
                       STRING YRSW06 DELIMITED BY X'FF',
                              YL0251 OF WORK-CONTEXT DELIMITED BY SIZE
                       INTO   YRSW06
                       MOVE YRSW06 TO YL0252 OF WORK-CONTEXT
                       IF (YL0252 OF WORK-CONTEXT = SPACES) THEN
                           MOVE ZERO TO WUUPAYBN3 OF WORK-CONTEXT
                       ELSE
                           MOVE YL0252 OF WORK-CONTEXT TO WUUPAYBN3 OF
                             WORK-CONTEXT
                       END-IF
                   ELSE
      *                CASE: *OTHERWISE
      *                U:Payment Band 3
                       MOVE 999 TO WUUPAYBN3 OF WORK-CONTEXT
                   END-IF
               END-IF
           END-IF
      *==============================================================
           CONTINUE.
       UI5EXIT.
           EXIT.
      /EJECT
       UI6SUBR SECTION.
      *==============================================================
      *    override Band and Percent for pay
      *==============================================================
      *    Manual Override Band
           MOVE ZEROS TO YL0253 OF WORK-CONTEXT
      *    Payment Band Changes
           MOVE SPACES TO YL0254 OF WORK-CONTEXT
           MOVE ' ' TO YL0254 OF WORK-CONTEXT
      *    Payment Band Changes
           MOVE SPACES TO YL0254 OF WORK-CONTEXT
           MOVE ' ' TO YL0254 OF WORK-CONTEXT
      *    Manual Override Penalty
           MOVE ZEROS TO YL0255 OF WORK-CONTEXT
      *    Rtv *all - BonusSls-DlrPrm Override2  *
           PERFORM SM5RVGN
      *    Override Band
      *    CASE:
      *    - c1 AND c2
      *    |- c1    : LCL.Payment Band Changes is 00-99
      *    |- c2    : PGM.*Return code is *Normal
      *    '-
      *    *IF
           IF (YL0254 OF WORK-CONTEXT NOT < '00' AND
               YL0254 OF WORK-CONTEXT NOT > '99' AND
               W0RTN = ' ') THEN
               IF (YL0254 OF WORK-CONTEXT = SPACES) THEN
                   MOVE ZERO TO WUUPAYBN3 OF WORK-CONTEXT
               ELSE
                   MOVE YL0254 OF WORK-CONTEXT TO WUUPAYBN3 OF
                     WORK-CONTEXT
               END-IF
               IF (YL0254 OF WORK-CONTEXT = SPACES) THEN
                   MOVE ZERO TO YL0253 OF WORK-CONTEXT
               ELSE
                   MOVE YL0254 OF WORK-CONTEXT TO YL0253 OF WORK-CONTEXT
               END-IF
           END-IF
      *    Override Penalty
      *    CASE: LCL.Apply Penalty is Yes
      *    *IF
           IF (YL0256 OF WORK-CONTEXT = 'Y') THEN
      *        Percentage Penalty
               MOVE YL0255 OF WORK-CONTEXT TO YL0001 OF WORK-CONTEXT
           ELSE
      *        CASE: *OTHERWISE
      *        Manual Override Penalty
               MOVE ZEROS TO YL0255 OF WORK-CONTEXT
           END-IF
      *    * total Band for archivent
           MOVE WUUPAYBN3 OF WORK-CONTEXT TO YL0257 OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       UI6EXIT.
           EXIT.
      /EJECT
       UI7SUBR SECTION.
      *==============================================================
      *    Dealer Archievent save
      *==============================================================
      *    EXC Chg bonus Suggest 2 - Bonus Sls-Suggest DlrAch2  *
      *    Clear array PCRC
           INITIALIZE PCRC
      *    Bonus Scheme (8)
           MOVE QCBNSSCM OF FBNSSX9 OF SBBNSSGWL4-R TO PCBNSSCM
      *    Dealer number (Num key)
           ADD QCDLRNOKEY OF FBNSSX9 OF SBBNSSGWL4-R TO PCDLRNOKEY
      *    Run Number
           ADD QCSUGRNO OF FBNSSX9 OF SBBNSSGWL4-R TO PCRUNNO
      *    Scheme Sequence
           MOVE 'B' TO PCSCMSTS
      *    Achievement Band
           MOVE YL0002 OF WORK-CONTEXT TO PCACHBND
      *    No of Registrations
           ADD YL0258 OF WORK-CONTEXT TO PCNOREG
      *    No of Order
           ADD YL0188 OF WORK-CONTEXT TO PCKENU
      *    No of Registrations cancl
           ADD YL0259 OF WORK-CONTEXT TO PCEONU
      *    No of Order Canceled
           ADD YL0194 OF WORK-CONTEXT TO PCKFNU
      *    Target Value Registration
           ADD YL0168 OF WORK-CONTEXT TO PCOEVB
      *    Target Value Order
           ADD YL0193 OF WORK-CONTEXT TO PCOFVB
      *    Total Count Registration
           ADD YL0167 OF WORK-CONTEXT TO PCKGNU
      *    Total Count Order
           ADD YL0192 OF WORK-CONTEXT TO PCKHNU
      *    Achieved Pre-Qualifier
           MOVE YL0005 OF WORK-CONTEXT TO PCACPRQ
      *    Achieved Pre-Qualifier 2
           MOVE ' ' TO PCACPRQ2
      *    PreQual Reg/Ord 1
           ADD YL0062 OF WORK-CONTEXT TO PCFNNU
      *    PreQual Reg/Ord 2
           ADD YL0065 OF WORK-CONTEXT TO PCFONU
      *    PreQual Reg/Ord 3
           ADD YL0068 OF WORK-CONTEXT TO PCFPNU
      *    PreQual Reg/Ord 4
           ADD YL0071 OF WORK-CONTEXT TO PCFQNU
      *    PreQual Reg/Ord 5
           ADD YL0074 OF WORK-CONTEXT TO PCFRNU
      *    PreQual Reg/Ord 6
           ADD YL0077 OF WORK-CONTEXT TO PCE9NU
      *    PreQual Reg/Ord 7
           ADD YL0189 OF WORK-CONTEXT TO PCFANU
      *    PreQual Reg/Ord 8
           ADD YL0013 OF WORK-CONTEXT TO PCE0NU
      *    PreQual Reg/Ord 9
           ADD YL0017 OF WORK-CONTEXT TO PCE1NU
      *    PreQual Reg/Ord 10
           ADD YL0021 OF WORK-CONTEXT TO PCE2NU
      *    PreQual Reg/Ord 11
           ADD YL0025 OF WORK-CONTEXT TO PCE3NU
      *    PreQual Reg/Ord 12
           ADD YL0029 OF WORK-CONTEXT TO PCE6NU
      *    PreQual Reg/Ord 13
           ADD YL0033 OF WORK-CONTEXT TO PCJQNU
      *    PreQual Reg/Ord 14
           ADD ZEROS TO PCJRNU
      *    PreQual Reg/Ord 15
           ADD YL0164 OF WORK-CONTEXT TO PCJSNU
      *    PreQual Reg/Ord 16
           ADD YL0037 OF WORK-CONTEXT TO PCJTNU
      *    PreQual Reg/Ord 17
           ADD YL0041 OF WORK-CONTEXT TO PCJUNU
      *    PreQual Reg/Ord 18
           ADD YL0045 OF WORK-CONTEXT TO PCJVNU
      *    PreQual Reg/Ord 19
           ADD YL0049 OF WORK-CONTEXT TO PCJWNU
      *    PreQual Reg/Ord 20
           ADD YL0053 OF WORK-CONTEXT TO PCJXNU
      *    PreQual De-Reg/Ord 1
           ADD YL0063 OF WORK-CONTEXT TO PCH6NU
      *    PreQual De-Reg/Ord 2
           ADD YL0066 OF WORK-CONTEXT TO PCH7NU
      *    PreQual De-Reg/Ord 3
           ADD YL0069 OF WORK-CONTEXT TO PCH8NU
      *    PreQual De-Reg/Ord 4
           ADD YL0072 OF WORK-CONTEXT TO PCH9NU
      *    PreQual De-Reg/Ord 5
           ADD YL0075 OF WORK-CONTEXT TO PCIANU
      *    PreQual De-Reg/Ord 6
           ADD YL0078 OF WORK-CONTEXT TO PCIBNU
      *    PreQual De-Reg/Ord 7
           ADD YL0190 OF WORK-CONTEXT TO PCICNU
      *    PreQual De-Reg/Ord 8
           ADD YL0014 OF WORK-CONTEXT TO PCIDNU
      *    PreQual De-Reg/Ord 9
           ADD YL0018 OF WORK-CONTEXT TO PCIENU
      *    PreQual De-Reg/Ord 10
           ADD YL0022 OF WORK-CONTEXT TO PCFFNU
      *    PreQual De-Reg/Ord 11
           ADD YL0026 OF WORK-CONTEXT TO PCFJNU
      *    PreQual De-Reg/Ord 12
           ADD YL0030 OF WORK-CONTEXT TO PCFKNU
      *    PreQual De-Reg/Ord 13
           ADD YL0034 OF WORK-CONTEXT TO PCJYNU
      *    PreQual De-Reg/Ord 14
           ADD ZEROS TO PCJZNU
      *    PreQual De-Reg/Ord 15
           ADD YL0165 OF WORK-CONTEXT TO PCJ0NU
      *    PreQual De-Reg/Ord 16
           ADD YL0038 OF WORK-CONTEXT TO PCJ1NU
      *    PreQual De-Reg/Ord 17
           ADD YL0042 OF WORK-CONTEXT TO PCJ2NU
      *    PreQual De-Reg/Ord 18
           ADD YL0046 OF WORK-CONTEXT TO PCJ3NU
      *    PreQual De-Reg/Ord 19
           ADD YL0050 OF WORK-CONTEXT TO PCJ4NU
      *    PreQual De-Reg/Ord 20
           ADD YL0054 OF WORK-CONTEXT TO PCJ5NU
      *    PreQual Target Reg/Ord 1
           ADD YL0064 OF WORK-CONTEXT TO PCNWVB
      *    PreQual Target Reg/Ord 2
           ADD YL0067 OF WORK-CONTEXT TO PCNXVB
      *    PreQual Target Reg/Ord 3
           ADD YL0070 OF WORK-CONTEXT TO PCNYVB
      *    PreQual Target Reg/Ord 4
           ADD YL0073 OF WORK-CONTEXT TO PCNZVB
      *    PreQual Target Reg/Ord 5
           ADD YL0076 OF WORK-CONTEXT TO PCN0VB
      *    PreQual Target Reg/Ord 6
           ADD YL0079 OF WORK-CONTEXT TO PCN1VB
      *    PreQual Target Reg/Ord 7
           ADD YL0191 OF WORK-CONTEXT TO PCN2VB
      *    PreQual Target Reg/Ord 8
           ADD YL0016 OF WORK-CONTEXT TO PCN3VB
      *    PreQual Target Reg/Ord 9
           ADD YL0020 OF WORK-CONTEXT TO PCN4VB
      *    PreQual Target Reg/Ord 10
           ADD YL0024 OF WORK-CONTEXT TO PCFLNU
      *    PreQual Target Reg/Ord 11
           ADD YL0028 OF WORK-CONTEXT TO PCFMNU
      *    PreQual Target Reg/Ord 12
           ADD YL0032 OF WORK-CONTEXT TO PCNVVB
      *    PreQual Target Reg/Ord 13
           ADD YL0036 OF WORK-CONTEXT TO PCN6VB
      *    PreQual Target Reg/Ord 14
           ADD ZEROS TO PCN7VB
      *    PreQual Target Reg/Ord 15
           ADD YL0163 OF WORK-CONTEXT TO PCN8VB
      *    PreQual Target Reg/Ord 16
           ADD YL0040 OF WORK-CONTEXT TO PCN9VB
      *    PreQual Target Reg/Ord 17
           ADD YL0044 OF WORK-CONTEXT TO PCOAVB
      *    PreQual Target Reg/Ord 18
           ADD YL0048 OF WORK-CONTEXT TO PCOBVB
      *    PreQual Target Reg/Ord 19
           ADD YL0052 OF WORK-CONTEXT TO PCOCVB
      *    PreQual Target Reg/Ord 20
           ADD YL0056 OF WORK-CONTEXT TO PCODVB
      *    Dealer total bonus amount
           ADD ZEROS TO PCDLBNAMTT
      *    Run Mode
           MOVE YL0085 OF WORK-CONTEXT TO PCZKCF
      *    Order Band Achieved
           ADD YL0246 OF WORK-CONTEXT TO PCZLCF
      *    Registration Band Ach
           ADD YL0247 OF WORK-CONTEXT TO PCZMCF
      *    Manual Override Band
           ADD YL0253 OF WORK-CONTEXT TO PCZRCF
      *    Overall Combined Ach Band
           ADD YL0257 OF WORK-CONTEXT TO PCZNCF
      *    Manual Override Penalty
           ADD YL0255 OF WORK-CONTEXT TO PCHSNU
      *    Overall Penalty
           ADD YL0001 OF WORK-CONTEXT TO PCI0NU
      *    *USER
           MOVE ZZUSR OF JOB-CONTEXT TO PCUSR
      *    *PROGRAM
           MOVE ZZPGM OF JOB-CONTEXT TO PCPGM
      *    *JOB
           MOVE ZZJOB OF JOB-CONTEXT TO PCJOB
      *    Job Date (8)
           ADD WUJOBDTE8 OF WORK-CONTEXT TO PCJOBDTE8
      *    *Job time
           ADD ZZJTM OF JOB-CONTEXT TO PCJTM
      *
           SET C-INDICATOR-OFF(90) TO TRUE
      *
           CALL 'SBA011000S' USING
      *    Return code
             W0RTN
      *    RCD : Bonus Sls-Suggest DlrAch2
             PCRC
                    ON OVERFLOW
                    SET C-INDICATOR-ON(90) TO TRUE
           END-CALL
      *
      *
      *    Error on program call will terminate run unit
           IF (C-INDICATOR-ON(90)) THEN
               MOVE 'Y2U0032' TO W0RTN
               MOVE 'SBA011000S' TO W0CLPG
      *        Send message '*Error occured on CALL...'
      *        Message ID
               MOVE 'Y2U0032' TO ZAMSID
      *        Message file
               MOVE 'Y2USRMSG' TO ZAMSGF
      *        Message data
               MOVE W0CLPG TO ZAMSDA
               PERFORM ZASNMS
           END-IF
      *    Error detected?
           IF (W0RTN        NOT = SPACES) THEN
               SET C-INDICATOR-ON(99) TO TRUE
           END-IF
      *==============================================================
           CONTINUE.
       UI7EXIT.
           EXIT.
      /EJECT
       UI8SUBR SECTION.
      *==============================================================
      *    Allocate payment to vehicle
      *==============================================================
      *    Initialise
           PERFORM UI9SUBR
      *    U:Yes/No (2)
           MOVE 'N' TO YL0268 OF WORK-CONTEXT
      *    Sequence Number
           MOVE ZEROS TO YL0080 OF WORK-CONTEXT
      *    Get payment value for vehicle
           PERFORM UJ1SUBR
      *    Derive the Payment Sequence and Rules
      *    CASE: DB1.BDC Model is CAR ZOE
      *    *IF
           IF (QCBDCM OF FBNSSX9 OF SBBNSSGWL4-R = 'ZOE') THEN
      *        Sequence Number
               MOVE 201 TO YL0080 OF WORK-CONTEXT
           ELSE
      *        CASE:
      *        - c1 AND c2
      *        |- c1    : DB1.BDC Model is CAR TW3
      *        |- c2    : LCL.BDC Payment Term is CNPF
      *        '-
      *        *IF
               IF (QCBDCM OF FBNSSX9 OF SBBNSSGWL4-R = 'TW3' AND
                   YL0272 OF WORK-CONTEXT = 'CNPF') THEN
      *            Flat Fee  Twingo
      *            CASE: LCL.Target Market is Local Fleet Target
      *            *IF
                   IF (YL0276 OF WORK-CONTEXT = 'L') THEN
      *                Sequence Number
                       MOVE 101 TO YL0080 OF WORK-CONTEXT
                   ELSE
      *                CASE: LCL.Target Market is Retail
      *                *IF
                       IF (YL0276 OF WORK-CONTEXT = 'R') THEN
      *                    Sequence Number
                           MOVE 102 TO YL0080 OF WORK-CONTEXT
                       ELSE
      *                    CASE: LCL.Target Market is Major Fleet Target
      *                    *IF
                           IF (YL0276 OF WORK-CONTEXT = 'M') THEN
      *                        Sequence Number
                               MOVE 103 TO YL0080 OF WORK-CONTEXT
                           END-IF
                       END-IF
                   END-IF
               ELSE
      *            CASE: LCL.BDC Payment Term is CNPF
      *            *IF
                   IF (YL0272 OF WORK-CONTEXT = 'CNPF') THEN
      *                Sequence Number
                       MOVE 100 TO YL0080 OF WORK-CONTEXT
                   ELSE
      *                CASE: Payment category 1 2 3 N
      *                - c1 OR c2 OR c3 OR c4
      *                |- c1    : LCL.OBT Count Target Status is
      *                  Payment Category 1
      *                |- c2    : LCL.OBT Count Target Status is
      *                  Payment Category 2
      *                |- c3    : LCL.OBT Count Target Status is
      *                  Payment Category 3
      *                |- c4    : LCL.OBT Count Target Status is
      *                  Payment Category N - New
      *                '-
      *                *IF
                       IF (YL0273 OF WORK-CONTEXT = '1' OR
                           YL0273 OF WORK-CONTEXT = '2' OR
                           YL0273 OF WORK-CONTEXT = '3' OR
                           YL0273 OF WORK-CONTEXT = 'N') THEN
      *                    Sequence Number
                           MULTIPLY WUUPAYBN3 OF WORK-CONTEXT BY 1
                             GIVING YL0080 OF WORK-CONTEXT
                       ELSE
      *                    CASE: *OTHERWISE
      *                    Sequence Number
                           MOVE 999 TO YL0080 OF WORK-CONTEXT
                       END-IF
                   END-IF
               END-IF
           END-IF
      *    Get Bonus price by Vin
      *    Prc Derive Pay Value - Bonus Scheme  *
      *    Clear array PDRC
           INITIALIZE PDRC
      *    Bonus Scheme (8)
           MOVE QCBNSSCM OF FBNSSX9 OF SBBNSSGWL4-R TO PDBNSSCM
      *    SCP Model Code
           MOVE QCBDCM OF FBNSSX9 OF SBBNSSGWL4-R TO PDSCMDLCDE
      *    SCP Model Version Code
           MOVE QCBDCMV OF FBNSSX9 OF SBBNSSGWL4-R TO PDSCVERCDE
      *    Sequence Number
           ADD YL0080 OF WORK-CONTEXT TO PDSEQNBR
      *
           SET C-INDICATOR-OFF(90) TO TRUE
      *
           CALL 'SBA004444S' USING
      *    Return code
             W0RTN
      *    RCD : Bonus Sls-Scm Version Val
             PDRC
                    ON OVERFLOW
                    SET C-INDICATOR-ON(90) TO TRUE
           END-CALL
      *
      *
      *    Payable Value
           MOVE PDVALPAY TO YL0261 OF WORK-CONTEXT
      *
      *    Error on program call will terminate run unit
           IF (C-INDICATOR-ON(90)) THEN
               MOVE 'Y2U0032' TO W0RTN
               MOVE 'SBA004444S' TO W0CLPG
      *        Send message '*Error occured on CALL...'
      *        Message ID
               MOVE 'Y2U0032' TO ZAMSID
      *        Message file
               MOVE 'Y2USRMSG' TO ZAMSGF
      *        Message data
               MOVE W0CLPG TO ZAMSDA
               PERFORM ZASNMS
           END-IF
      *    Error detected?
           IF (W0RTN        NOT = SPACES) THEN
               SET C-INDICATOR-ON(99) TO TRUE
           END-IF
      *    Penalty
      *    CASE: LCL.Percentage Penalty is NE 0%
      *    *IF
           IF (YL0001 OF WORK-CONTEXT NOT = 0) THEN
      *        CASE: LCL.Sequence Number is Range 1 - 99
      *        *IF
               IF (YL0080 OF WORK-CONTEXT NOT < 1 AND
                   YL0080 OF WORK-CONTEXT NOT > 99) THEN
      *            U:Number (3.0)
                   SUBTRACT YL0001 OF WORK-CONTEXT FROM 100 GIVING
                     YL0277 OF WORK-CONTEXT
      *            (price /100) * penal
      *            WRK.Bonus Amount (This) =
      *            *COMPUTE ((x1 /x2) * x3)
      *            x1    : LCL.Bonus Amount (This)
      *            /     : PGM.*Synon (17,7) work field *
      *            x2    : CON.100
      *            *     : PGM.*Synon (17,7) work field *
      *            x3    : LCL.U:Number (3.0)
      *            *Synon (17,7) work field
                   DIVIDE 100 INTO YL0261 OF WORK-CONTEXT GIVING W0WD01
      *            *Synon (17,7) work field
                   MULTIPLY W0WD01 BY YL0277 OF WORK-CONTEXT GIVING
                     W0WD00
      *            Bonus Amount (This)
                   MOVE W0WD00 TO WUBNSAMTT OF WORK-CONTEXT
               ELSE
      *            CASE: *OTHERWISE
      *            Bonus Amount (This)
                   MOVE YL0261 OF WORK-CONTEXT TO WUBNSAMTT OF
                     WORK-CONTEXT
               END-IF
           ELSE
      *        CASE: *OTHERWISE
      *        Bonus Amount (This)
               MOVE YL0261 OF WORK-CONTEXT TO WUBNSAMTT OF WORK-CONTEXT
           END-IF
      *    Vehicle Rejection Flag
           MOVE QCVEHREJF OF FBNSSX9 OF SBBNSSGWL4-R TO YL0278 OF
             WORK-CONTEXT
      *    #Chg Bonus Suggest Wrk-Sl - Bonus Sls-Suggest Work  *
           PERFORM SM8CHRC
      *==============================================================
           CONTINUE.
       UI8EXIT.
           EXIT.
      /EJECT
       UI9SUBR SECTION.
      *==============================================================
      *    Initialise
      *==============================================================
      *    Car/Van Indicator
           MOVE ' ' TO YL0260 OF WORK-CONTEXT
      *    Bonus Amount (This)
           MOVE ZEROS TO WUBNSAMTT OF WORK-CONTEXT
      *    Bonus Amount (This)
           MOVE ZEROS TO YL0261 OF WORK-CONTEXT
      *    BDC Salesman PIN
           MOVE QCSLSMNP OF FBNSSX9 OF SBBNSSGWL4-R TO WUSLSMNP OF
             WORK-CONTEXT
      *    TYPE CLIENT SEDRE
           MOVE QCBDCTCS OF FBNSSX9 OF SBBNSSGWL4-R TO WUYCST OF
             WORK-CONTEXT
      *    TYPE DR CENTRAL
           MOVE QCBDCVTP OF FBNSSX9 OF SBBNSSGWL4-R TO WUL5CO OF
             WORK-CONTEXT
      *    CASE: DB1.Fleet Operator Number is Disabled - Non Motability
      *    *IF
           IF (QCFLOPNO OF FBNSSX9 OF SBBNSSGWL4-R = '30286') THEN
      *        TYPE CLIENT SEDRE
               MOVE '1' TO WUYCST OF WORK-CONTEXT
           END-IF
      *    Number of Ord TBC
           MOVE ZEROS TO YL0262 OF WORK-CONTEXT
      *    Number of Ord Car Retail
           MOVE ZEROS TO YL0263 OF WORK-CONTEXT
      *    Number of Ord Car LFlt
           MOVE ZEROS TO YL0264 OF WORK-CONTEXT
      *    Number of Ord Van LFlt
           MOVE ZEROS TO YL0265 OF WORK-CONTEXT
      *    Number of Ord Motab
           MOVE ZEROS TO YL0266 OF WORK-CONTEXT
      *    Number of Ord Major Flt
           MOVE ZEROS TO YL0267 OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       UI9EXIT.
           EXIT.
      /EJECT
       UJ1SUBR SECTION.
      *==============================================================
      *    Get payment value for vehicle
      *==============================================================
      *    Rtv All Dtl by Dlr/Mdl/ON - OBT Extract  *
           PERFORM SM6RVGN
      *    Rtv Car or Van SCP Mdl - Vehicle Model Bonus Atr  *
           PERFORM SM7RVGN
      *==============================================================
           CONTINUE.
       UJ1EXIT.
           EXIT.
      /EJECT
       ZASNMS SECTION.
      *==============================================================
      *    Send message to program's message queue
      *==============================================================
      *    Send if first error message or not an error message
           IF (ZAMSTP NOT = SPACES OR
               ZAFSMS NOT = 'N') THEN
               IF (ZAMSTP = SPACES) THEN
      *            Signal first error message sent
                   MOVE 'N' TO ZAFSMS
               END-IF
               IF (ZAPGMQ = SPACES) THEN
                   MOVE ZZPGM OF JOB-CONTEXT TO ZAPGMQ
               END-IF
               MOVE 'Y' TO ZAILE
               CALL 'Y2SNMGC' USING
      *        Program queue
                 ZAPGMQ
      *        Relative queue
                 ZAPGRL
      *        Message ID
                 ZAMSID
      *        Message file
                 ZAMSGF
      *        Message data
                 ZAMSDA
      *        Message type
                 ZAMSTP
                 ZAILE
               END-CALL
           END-IF
      *    Clear all fields for default mechanism next time
      *    Program queue
           MOVE SPACES TO ZAPGMQ
      *    Relative queue
           MOVE SPACES TO ZAPGRL
      *    Message ID
           MOVE SPACES TO ZAMSID
      *    Message file
           MOVE SPACES TO ZAMSGF
      *    Message data
           MOVE SPACES TO ZAMSDA
      *    Message type
           MOVE SPACES TO ZAMSTP
      *==============================================================
           CONTINUE.
       ZAEXIT.
           EXIT.
      /EJECT
       ZCATWK SECTION.
      *==============================================================
      *    Process *CONCAT request
      *==============================================================
           MOVE YRSW04 TO YRSW00
           MOVE ZEROS TO YRSW01
           IF (YRSW05 = SPACES) THEN
               ADD YRSW02 TO YRSW01
               ADD YRSW03 TO YRSW01
               ADD  1 TO YRSW01
               IF (YRSW01 < YRSW04) THEN
                   MOVE X'FF' TO YRSW06X(YRSW01)
               ELSE
                   MOVE X'FF' TO YRSW06X(YRSW04)
               END-IF
           END-IF
           IF (YRSW05 = 'T') THEN
               PERFORM UNTIL NOT (YRSW01 = 0)
                   SUBTRACT 1 FROM YRSW00
                   IF (YRSW00 = 0) THEN
                       MOVE X'FF' TO YRSW06X(YRSW04)
                       ADD  1  TO YRSW01
                   ELSE
                       IF (YRSW06X(YRSW00) NOT = SPACES) THEN
                           MOVE YRSW00 TO YRSW01
                           ADD   1 TO YRSW01
                           ADD  YRSW03 TO YRSW01
                           MOVE X'FF' TO YRSW06X(YRSW01)
                       END-IF
                   END-IF
               END-PERFORM
           END-IF
      *==============================================================
           CONTINUE.
       ZCEXIT.
           EXIT.
      /EJECT
       ZXEXPG SECTION.
      *==============================================================
      *    Exit program: Normal
      *==============================================================
           PERFORM ZYEXPG
      *==============================================================
           CONTINUE.
       ZXEXIT.
           EXIT.
      /EJECT
       ZYEXPG SECTION.
      *==============================================================
      *    Exit program: Direct
      *==============================================================
           CLOSE SBBNSSGWL4
           CLOSE SBSCMPRML1
           CLOSE SBSCMRU2L1
           CLOSE SBDLRPRML1
           CLOSE DIDLRDTAL2
           CLOSE AMTGTDTAL7
           CLOSE SBDOTEXTL7
           CLOSE VAMDLBNSL1
           CLOSE SBRICDSQL4
           CLOSE RAOBEXTRL2
           CLOSE SBDOTEXTL8
           CLOSE RAOBEXTRL4
           CLOSE COORDDTAL8
           CLOSE COORDDEDL1
           CLOSE COORDDEDL2
           CLOSE SBDLROV2L1
           CLOSE SBBNSSGWL0
      *    Reset entry parameters as appropriate
           PERFORM ZZEXPM.
      *    Exit program
           CONTINUE.
       ZYEXPG-EXIT.
           GOBACK.
      *==============================================================
           CONTINUE.
       ZYEXIT.
           EXIT.
      /EJECT
       ZZEXPM SECTION.
      *==============================================================
      *    Return parameters from work fields
      *==============================================================
      *==============================================================
           CONTINUE.
       ZZPEXT.
           EXIT.
      /EJECT
       ZZINIT SECTION.
      *==============================================================
      *    Initialisation
      *==============================================================
           IF (W0ICL = SPACES) THEN
      *        *Initial call
               MOVE 'Y' TO W0ICL
           ELSE
               MOVE 'N' TO W0ICL
           END-IF
           MOVE SPACES TO P0RTN
           MOVE SPACES TO W0RTN
           MOVE ZEROS  TO W0RTW
           MOVE SPACES TO W0RSF
           MOVE '400' TO W0ENV
           MOVE ALL B'0' TO INDICS
           MOVE SPACES TO ZZPGM OF JOB-CONTEXT
      *    Retrieve job attributes
           CALL 'Y2RTJCR' USING
             JOB-CONTEXT
           END-CALL
      *    Setup job date/time
           MOVE ZZSD7 OF JOB-CONTEXT TO ZZJDT
           ACCEPT ZZTIME FROM TIME
           MOVE ZZHNS TO ZZJTM OF JOB-CONTEXT
           MOVE 'SBA17O401S' TO ZZPGM OF JOB-CONTEXT
      *    Define work field Job Date (8)
           MOVE ZERO TO WUJOBDTE8 OF WORK-CONTEXT
      *    Define work field Object Code
           MOVE SPACES TO WUOBJCDE OF WORK-CONTEXT
      *    Define work field U:Target Period Code a
           MOVE SPACES TO WUUTGTPRDA OF WORK-CONTEXT
      *    Define work field U:From Date (8) a
           MOVE ZERO TO WUUFRMDTXA OF WORK-CONTEXT
      *    Define work field U:To Date (8) a
           MOVE ZERO TO WUUTODTXA OF WORK-CONTEXT
      *    Define work field U:Target Period Code b
           MOVE SPACES TO WUUTGTPRDB OF WORK-CONTEXT
      *    Define work field U:From Date (8) b
           MOVE ZERO TO WUUFRMDTXB OF WORK-CONTEXT
      *    Define work field U:To Date (8) b
           MOVE ZERO TO WUUTODTXB OF WORK-CONTEXT
      *    Define work field U:Target Period Code c
           MOVE SPACES TO WUUTGTPRDC OF WORK-CONTEXT
      *    Define work field U:From Date (8) c
           MOVE ZERO TO WUUFRMDTXC OF WORK-CONTEXT
      *    Define work field U:To Date (8) c
           MOVE ZERO TO WUUTODTXC OF WORK-CONTEXT
      *    Define work field U:Target Period Code e
           MOVE SPACES TO WUUTGTPRDE OF WORK-CONTEXT
      *    Define work field U:From Date (8) e
           MOVE ZERO TO WUXBDX OF WORK-CONTEXT
      *    Define work field U:To Date (8) e
           MOVE ZERO TO WUXCDX OF WORK-CONTEXT
      *    Define work field U:Target Period Code d
           MOVE SPACES TO WUUTGTPRDD OF WORK-CONTEXT
      *    Define work field U:From Date (8) d
           MOVE ZERO TO WUUFRMDTXD OF WORK-CONTEXT
      *    Define work field U:To Date (8) d
           MOVE ZERO TO WUUTODTXD OF WORK-CONTEXT
      *    Define work field Customer Order Date #
           MOVE ZERO TO WUCUSORDD8 OF WORK-CONTEXT
      *    Define work field Dealer to pay Number (Num
           MOVE ZERO TO WUEDNB OF WORK-CONTEXT
      *    Define work field U:Payment Band
           MOVE ZERO TO WUWCNU OF WORK-CONTEXT
      *    Define work field U:Payment Band 3
           MOVE ZERO TO WUUPAYBN3 OF WORK-CONTEXT
      *    Define work field U:90% of target -decimal
           MOVE ZERO TO WUU90TD OF WORK-CONTEXT
      *    Define work field U:80% of Target -Decimal
           MOVE ZERO TO WUU80TD OF WORK-CONTEXT
      *    Define work field U:100% of Target -decimal
           MOVE ZERO TO WUU100PCTD OF WORK-CONTEXT
      *    Define work field U:105% of target -decimal
           MOVE ZERO TO WUU105PCTD OF WORK-CONTEXT
      *    Define work field U:110% of target -decimal
           MOVE ZERO TO WUU110PCTD OF WORK-CONTEXT
      *    Define work field U:120% of target -decimal
           MOVE ZERO TO WUU120PCTD OF WORK-CONTEXT
      *    Define work field U:Target Total
           MOVE ZERO TO WUTGTTOT OF WORK-CONTEXT
      *    Define work field U:Dealer Nbr
           MOVE SPACES TO WUDLRNO OF WORK-CONTEXT
      *    Define work field U:Dealer Nbr Sfx
           MOVE SPACES TO WUUDLRSFX OF WORK-CONTEXT
      *    Define work field CONCES PROPRIETAIRE
           MOVE SPACES TO WUNECO OF WORK-CONTEXT
      *    Define work field U:Dealer Nbr Dacia
           MOVE SPACES TO WUWECF OF WORK-CONTEXT
      *    Define work field U:Dealer Nbr Sfx Dacia
           MOVE SPACES TO WUWFCF OF WORK-CONTEXT
      *    Define work field CONCES PROPRIETAIRE DACIA
           MOVE SPACES TO WUTOCF OF WORK-CONTEXT
      *    Define work field Region Code
           MOVE SPACES TO WURGNCDE OF WORK-CONTEXT
      *    Define work field Zone Code
           MOVE SPACES TO WUZONCOD OF WORK-CONTEXT
      *    Define work field U:Target Total a
           MOVE ZERO TO WUTGTTOTA OF WORK-CONTEXT
      *    Define work field U:Target Dacia
           MOVE ZERO TO WULTVB OF WORK-CONTEXT
      *    Define work field U:Target Total DACIA
           MOVE ZERO TO WUNHVB OF WORK-CONTEXT
      *    Define work field U:Code (5)
           MOVE SPACES TO WUUCODE5 OF WORK-CONTEXT
      *    Define work field U:80%  of target Reg
           MOVE ZERO TO WUHTNU OF WORK-CONTEXT
      *    Define work field U:90%  of target Reg
           MOVE ZERO TO WUHUNU OF WORK-CONTEXT
      *    Define work field U:100% of target Reg
           MOVE ZERO TO WUHVNU OF WORK-CONTEXT
      *    Define work field U:105% of target Reg
           MOVE ZERO TO WUHZNU OF WORK-CONTEXT
      *    Define work field U:110% of target Reg
           MOVE ZERO TO WUHXNU OF WORK-CONTEXT
      *    Define work field U:120% of target Reg
           MOVE ZERO TO WUHYNU OF WORK-CONTEXT
      *    Define work field U:Payment Band 2
           MOVE ZERO TO WUZZNU OF WORK-CONTEXT
      *    Define work field U:80%  of target Ord
           MOVE ZERO TO WUH0NU OF WORK-CONTEXT
      *    Define work field U:90%  of target Ord
           MOVE ZERO TO WUH1NU OF WORK-CONTEXT
      *    Define work field U:100% of target Ord
           MOVE ZERO TO WUH2NU OF WORK-CONTEXT
      *    Define work field U:105% of target Ord
           MOVE ZERO TO WUH5NU OF WORK-CONTEXT
      *    Define work field U:110% of target Ord
           MOVE ZERO TO WUH3NU OF WORK-CONTEXT
      *    Define work field U:120% of target Ord
           MOVE ZERO TO WUH4NU OF WORK-CONTEXT
      *    Define work field Bonus Amount (This)
           MOVE ZERO TO WUBNSAMTT OF WORK-CONTEXT
      *    Define work field BDC Salesman PIN
           MOVE SPACES TO WUSLSMNP OF WORK-CONTEXT
      *    Define work field TYPE CLIENT SEDRE
           MOVE SPACES TO WUYCST OF WORK-CONTEXT
      *    Define work field TYPE DR CENTRAL
           MOVE SPACES TO WUL5CO OF WORK-CONTEXT
      *    Signal first error message outstanding
           MOVE 'Y' TO ZAFSMS
      *    Open files
           OPEN INPUT SBBNSSGWL4
           ACCEPT SBBNSSGWL4-OPEN FROM OPEN-FEEDBACK-AREA FOR SBBNSSGWL4
      *    Move main file information to JOB context
           MOVE CORRESPONDING OPENFA OF SBBNSSGWL4-OPEN TO JOB-CONTEXT
           CALL 'Y2QLVNR' USING
             ZZFFL OF JOB-CONTEXT
             ZZFLB OF JOB-CONTEXT
             ZZFQL OF JOB-CONTEXT
           END-CALL
           OPEN INPUT SBSCMPRML1
           ACCEPT SBSCMPRML1-OPEN FROM OPEN-FEEDBACK-AREA FOR SBSCMPRML1
           OPEN INPUT SBSCMRU2L1
           ACCEPT SBSCMRU2L1-OPEN FROM OPEN-FEEDBACK-AREA FOR SBSCMRU2L1
           OPEN INPUT SBDLRPRML1
           ACCEPT SBDLRPRML1-OPEN FROM OPEN-FEEDBACK-AREA FOR SBDLRPRML1
           OPEN INPUT DIDLRDTAL2
           ACCEPT DIDLRDTAL2-OPEN FROM OPEN-FEEDBACK-AREA FOR DIDLRDTAL2
           OPEN INPUT AMTGTDTAL7
           ACCEPT AMTGTDTAL7-OPEN FROM OPEN-FEEDBACK-AREA FOR AMTGTDTAL7
           OPEN INPUT SBDOTEXTL7
           ACCEPT SBDOTEXTL7-OPEN FROM OPEN-FEEDBACK-AREA FOR SBDOTEXTL7
           OPEN INPUT VAMDLBNSL1
           ACCEPT VAMDLBNSL1-OPEN FROM OPEN-FEEDBACK-AREA FOR VAMDLBNSL1
           OPEN INPUT SBRICDSQL4
           ACCEPT SBRICDSQL4-OPEN FROM OPEN-FEEDBACK-AREA FOR SBRICDSQL4
           OPEN INPUT RAOBEXTRL2
           ACCEPT RAOBEXTRL2-OPEN FROM OPEN-FEEDBACK-AREA FOR RAOBEXTRL2
           OPEN INPUT SBDOTEXTL8
           ACCEPT SBDOTEXTL8-OPEN FROM OPEN-FEEDBACK-AREA FOR SBDOTEXTL8
           OPEN INPUT RAOBEXTRL4
           ACCEPT RAOBEXTRL4-OPEN FROM OPEN-FEEDBACK-AREA FOR RAOBEXTRL4
           OPEN INPUT COORDDTAL8
           ACCEPT COORDDTAL8-OPEN FROM OPEN-FEEDBACK-AREA FOR COORDDTAL8
           OPEN INPUT COORDDEDL1
           ACCEPT COORDDEDL1-OPEN FROM OPEN-FEEDBACK-AREA FOR COORDDEDL1
           OPEN INPUT COORDDEDL2
           ACCEPT COORDDEDL2-OPEN FROM OPEN-FEEDBACK-AREA FOR COORDDEDL2
           OPEN INPUT SBDLROV2L1
           ACCEPT SBDLROV2L1-OPEN FROM OPEN-FEEDBACK-AREA FOR SBDLROV2L1
           OPEN I-O SBBNSSGWL0
           ACCEPT SBBNSSGWL0-OPEN FROM OPEN-FEEDBACK-AREA FOR SBBNSSGWL0
           MOVE 'Y' TO W0OPN
           MOVE 'N' TO W0PMT
      *    Define local work field Run Number
           MOVE ZERO TO YN0001 OF WORK-CONTEXT
      *    Define local work field Period text 1
           MOVE SPACES TO YN0002 OF WORK-CONTEXT
      *    Define local work field Period text 2
           MOVE SPACES TO YN0003 OF WORK-CONTEXT
      *    Define local work field Target Period Code
           MOVE SPACES TO YN0004 OF WORK-CONTEXT
      *    Define local work field Accounting Date
           MOVE ZERO TO YN0005 OF WORK-CONTEXT
      *    Define local work field Price Date From
           MOVE ZERO TO YN0006 OF WORK-CONTEXT
      *    Define local work field Price Date To
           MOVE ZERO TO YN0007 OF WORK-CONTEXT
      *    Define local work field Target Period Short Desc
           MOVE SPACES TO YN0008 OF WORK-CONTEXT
      *    Define local work field Target Period Full Desc
           MOVE SPACES TO YN0009 OF WORK-CONTEXT
      *    Define local work field Percentage Penalty
           MOVE ZERO TO YL0001 OF WORK-CONTEXT
      *    Define local work field Achievement Band Reg
           MOVE SPACES TO YL0002 OF WORK-CONTEXT
      *    Define local work field U:Achieved Target 1
           MOVE SPACES TO YL0003 OF WORK-CONTEXT
      *    Define local work field U:Achieved Target 2
           MOVE SPACES TO YL0004 OF WORK-CONTEXT
      *    Define local work field Achieved Pre-Qualifier R
           MOVE SPACES TO YL0005 OF WORK-CONTEXT
      *    Define local work field PreQual Net 1 OCTOBER
           MOVE ZERO TO YL0006 OF WORK-CONTEXT
      *    Define local work field PreQual Net 1 NOVEMBER
           MOVE ZERO TO YL0007 OF WORK-CONTEXT
      *    Define local work field PreQual Net A
           MOVE ZERO TO YL0008 OF WORK-CONTEXT
      *    Define local work field PreQual Reg/Ord 7
           MOVE ZERO TO YL0009 OF WORK-CONTEXT
      *    Define local work field PreQual De-Reg/Ord 7
           MOVE ZERO TO YL0010 OF WORK-CONTEXT
      *    Define local work field PreQual Net Reg/Ord 7
           MOVE ZERO TO YL0011 OF WORK-CONTEXT
      *    Define local work field PreQual Target Reg/Ord 7
           MOVE ZERO TO YL0012 OF WORK-CONTEXT
      *    Define local work field PreQual Reg/Ord 8
           MOVE ZERO TO YL0013 OF WORK-CONTEXT
      *    Define local work field PreQual De-Reg/Ord 8
           MOVE ZERO TO YL0014 OF WORK-CONTEXT
      *    Define local work field PreQual Net Reg/Ord 8
           MOVE ZERO TO YL0015 OF WORK-CONTEXT
      *    Define local work field PreQual Target Reg/Ord 8
           MOVE ZERO TO YL0016 OF WORK-CONTEXT
      *    Define local work field PreQual Reg/Ord 9
           MOVE ZERO TO YL0017 OF WORK-CONTEXT
      *    Define local work field PreQual De-Reg/Ord 9
           MOVE ZERO TO YL0018 OF WORK-CONTEXT
      *    Define local work field PreQual Net Reg/Ord 9
           MOVE ZERO TO YL0019 OF WORK-CONTEXT
      *    Define local work field PreQual Target Reg/Ord 9
           MOVE ZERO TO YL0020 OF WORK-CONTEXT
      *    Define local work field PreQual Reg/Ord 10
           MOVE ZERO TO YL0021 OF WORK-CONTEXT
      *    Define local work field PreQual De-Reg/Ord 10
           MOVE ZERO TO YL0022 OF WORK-CONTEXT
      *    Define local work field PreQual Net Reg/Ord 10
           MOVE ZERO TO YL0023 OF WORK-CONTEXT
      *    Define local work field PreQual Target Reg/Ord 10
           MOVE ZERO TO YL0024 OF WORK-CONTEXT
      *    Define local work field PreQual Reg/Ord 11
           MOVE ZERO TO YL0025 OF WORK-CONTEXT
      *    Define local work field PreQual De-Reg/Ord 11
           MOVE ZERO TO YL0026 OF WORK-CONTEXT
      *    Define local work field PreQual Net Reg/Ord 11
           MOVE ZERO TO YL0027 OF WORK-CONTEXT
      *    Define local work field PreQual Target Reg/Ord 11
           MOVE ZERO TO YL0028 OF WORK-CONTEXT
      *    Define local work field PreQual Reg/Ord 12
           MOVE ZERO TO YL0029 OF WORK-CONTEXT
      *    Define local work field PreQual De-Reg/Ord 12
           MOVE ZERO TO YL0030 OF WORK-CONTEXT
      *    Define local work field PreQual Net Reg/Ord 12
           MOVE ZERO TO YL0031 OF WORK-CONTEXT
      *    Define local work field PreQual Target Reg/Ord 12
           MOVE ZERO TO YL0032 OF WORK-CONTEXT
      *    Define local work field PreQual Reg/Ord 13
           MOVE ZERO TO YL0033 OF WORK-CONTEXT
      *    Define local work field PreQual De-Reg/Ord 13
           MOVE ZERO TO YL0034 OF WORK-CONTEXT
      *    Define local work field PreQual Net Reg/Ord 13
           MOVE ZERO TO YL0035 OF WORK-CONTEXT
      *    Define local work field PreQual Target Reg/Ord 13
           MOVE ZERO TO YL0036 OF WORK-CONTEXT
      *    Define local work field PreQual Reg/Ord 16
           MOVE ZERO TO YL0037 OF WORK-CONTEXT
      *    Define local work field PreQual De-Reg/Ord 16
           MOVE ZERO TO YL0038 OF WORK-CONTEXT
      *    Define local work field PreQual Net Reg/Ord 16
           MOVE ZERO TO YL0039 OF WORK-CONTEXT
      *    Define local work field PreQual Target Reg/Ord 16
           MOVE ZERO TO YL0040 OF WORK-CONTEXT
      *    Define local work field PreQual Reg/Ord 17
           MOVE ZERO TO YL0041 OF WORK-CONTEXT
      *    Define local work field PreQual De-Reg/Ord 17
           MOVE ZERO TO YL0042 OF WORK-CONTEXT
      *    Define local work field PreQual Net Reg/Ord 17
           MOVE ZERO TO YL0043 OF WORK-CONTEXT
      *    Define local work field PreQual Target Reg/Ord 17
           MOVE ZERO TO YL0044 OF WORK-CONTEXT
      *    Define local work field PreQual Reg/Ord 18
           MOVE ZERO TO YL0045 OF WORK-CONTEXT
      *    Define local work field PreQual De-Reg/Ord 18
           MOVE ZERO TO YL0046 OF WORK-CONTEXT
      *    Define local work field PreQual Net Reg/Ord 18
           MOVE ZERO TO YL0047 OF WORK-CONTEXT
      *    Define local work field PreQual Target Reg/Ord 18
           MOVE ZERO TO YL0048 OF WORK-CONTEXT
      *    Define local work field PreQual Reg/Ord 19
           MOVE ZERO TO YL0049 OF WORK-CONTEXT
      *    Define local work field PreQual De-Reg/Ord 19
           MOVE ZERO TO YL0050 OF WORK-CONTEXT
      *    Define local work field PreQual Net Reg/Ord 19
           MOVE ZERO TO YL0051 OF WORK-CONTEXT
      *    Define local work field PreQual Target Reg/Ord 19
           MOVE ZERO TO YL0052 OF WORK-CONTEXT
      *    Define local work field PreQual Reg/Ord 20
           MOVE ZERO TO YL0053 OF WORK-CONTEXT
      *    Define local work field PreQual De-Reg/Ord 20
           MOVE ZERO TO YL0054 OF WORK-CONTEXT
      *    Define local work field PreQual Net Reg/Ord 20
           MOVE ZERO TO YL0055 OF WORK-CONTEXT
      *    Define local work field PreQual Target Reg/Ord 20
           MOVE ZERO TO YL0056 OF WORK-CONTEXT
      *    Define local work field U:Clawinging back
           MOVE SPACES TO YL0057 OF WORK-CONTEXT
      *    Define local work field PreQual Net Previous
           MOVE ZERO TO YL0058 OF WORK-CONTEXT
      *    Define local work field PreQual Net Actual
           MOVE ZERO TO YL0059 OF WORK-CONTEXT
      *    Define local work field U:Number (8.0)
           MOVE ZERO TO YL0060 OF WORK-CONTEXT
      *    Define local work field PreQual Net 5%
           MOVE ZERO TO YL0061 OF WORK-CONTEXT
      *    Define local work field PreQual Order 1
           MOVE ZERO TO YL0062 OF WORK-CONTEXT
      *    Define local work field PreQual Cancel 1
           MOVE ZERO TO YL0063 OF WORK-CONTEXT
      *    Define local work field PreQual Target 1
           MOVE ZERO TO YL0064 OF WORK-CONTEXT
      *    Define local work field PreQual Order 2
           MOVE ZERO TO YL0065 OF WORK-CONTEXT
      *    Define local work field PreQual Cancel 2
           MOVE ZERO TO YL0066 OF WORK-CONTEXT
      *    Define local work field PreQual Target 2
           MOVE ZERO TO YL0067 OF WORK-CONTEXT
      *    Define local work field PreQual Order 3
           MOVE ZERO TO YL0068 OF WORK-CONTEXT
      *    Define local work field PreQual Cancel 3
           MOVE ZERO TO YL0069 OF WORK-CONTEXT
      *    Define local work field PreQual Target 3
           MOVE ZERO TO YL0070 OF WORK-CONTEXT
      *    Define local work field PreQual Order 4
           MOVE ZERO TO YL0071 OF WORK-CONTEXT
      *    Define local work field PreQual Cancel 4
           MOVE ZERO TO YL0072 OF WORK-CONTEXT
      *    Define local work field PreQual Target 4
           MOVE ZERO TO YL0073 OF WORK-CONTEXT
      *    Define local work field PreQual Order 5
           MOVE ZERO TO YL0074 OF WORK-CONTEXT
      *    Define local work field PreQual Cancel 5
           MOVE ZERO TO YL0075 OF WORK-CONTEXT
      *    Define local work field PreQual Target 5
           MOVE ZERO TO YL0076 OF WORK-CONTEXT
      *    Define local work field PreQual Order 6
           MOVE ZERO TO YL0077 OF WORK-CONTEXT
      *    Define local work field PreQual Cancel 6
           MOVE ZERO TO YL0078 OF WORK-CONTEXT
      *    Define local work field PreQual Target 6
           MOVE ZERO TO YL0079 OF WORK-CONTEXT
      *    Define local work field Sequence Number
           MOVE ZERO TO YL0080 OF WORK-CONTEXT
      *    Define local work field Use Extended Achievement
           MOVE SPACES TO YN0010 OF WORK-CONTEXT
      *    Define local work field Include Cancelled Orders
           MOVE SPACES TO YL0081 OF WORK-CONTEXT
      *    Define local work field Include Unmatched Orders
           MOVE SPACES TO YL0082 OF WORK-CONTEXT
      *    Define local work field Recalculate Order Ach Brn
           MOVE SPACES TO YL0083 OF WORK-CONTEXT
      *    Define local work field Recalculate Reg Ach Brnd
           MOVE SPACES TO YL0084 OF WORK-CONTEXT
      *    Define local work field U:Run Mode
           MOVE SPACES TO YL0085 OF WORK-CONTEXT
      *    Define local work field Record Status
           MOVE SPACES TO YL0086 OF WORK-CONTEXT
      *    Define local work field Scheme Sequence
           MOVE SPACES TO YN0011 OF WORK-CONTEXT
      *    Define local work field Achievement Band
           MOVE SPACES TO YN0012 OF WORK-CONTEXT
      *    Define local work field No of Registrations
           MOVE ZERO TO YN0013 OF WORK-CONTEXT
      *    Define local work field No of Order
           MOVE ZERO TO YN0014 OF WORK-CONTEXT
      *    Define local work field No of Registrations cancl
           MOVE ZERO TO YN0015 OF WORK-CONTEXT
      *    Define local work field No of Order Canceled
           MOVE ZERO TO YN0016 OF WORK-CONTEXT
      *    Define local work field Target Value Registration
           MOVE ZERO TO YN0017 OF WORK-CONTEXT
      *    Define local work field Target Value Order
           MOVE ZERO TO YN0018 OF WORK-CONTEXT
      *    Define local work field Total Count Registration
           MOVE ZERO TO YN0019 OF WORK-CONTEXT
      *    Define local work field Total Count Order
           MOVE ZERO TO YN0020 OF WORK-CONTEXT
      *    Define local work field Achieved Pre-Qualifier
           MOVE SPACES TO YN0021 OF WORK-CONTEXT
      *    Define local work field Achieved Pre-Qualifier 2
           MOVE SPACES TO YN0022 OF WORK-CONTEXT
      *    Define local work field PreQual Reg/Ord 7
           MOVE ZERO TO YN0023 OF WORK-CONTEXT
      *    Define local work field PreQual Reg/Ord 8
           MOVE ZERO TO YN0024 OF WORK-CONTEXT
      *    Define local work field PreQual Reg/Ord 9
           MOVE ZERO TO YN0025 OF WORK-CONTEXT
      *    Define local work field PreQual Reg/Ord 10
           MOVE ZERO TO YN0026 OF WORK-CONTEXT
      *    Define local work field PreQual Reg/Ord 11
           MOVE ZERO TO YN0027 OF WORK-CONTEXT
      *    Define local work field PreQual Reg/Ord 12
           MOVE ZERO TO YN0028 OF WORK-CONTEXT
      *    Define local work field PreQual Reg/Ord 13
           MOVE ZERO TO YN0029 OF WORK-CONTEXT
      *    Define local work field PreQual Reg/Ord 14
           MOVE ZERO TO YN0030 OF WORK-CONTEXT
      *    Define local work field PreQual Reg/Ord 15
           MOVE ZERO TO YN0031 OF WORK-CONTEXT
      *    Define local work field PreQual Reg/Ord 16
           MOVE ZERO TO YN0032 OF WORK-CONTEXT
      *    Define local work field PreQual Reg/Ord 17
           MOVE ZERO TO YN0033 OF WORK-CONTEXT
      *    Define local work field PreQual Reg/Ord 18
           MOVE ZERO TO YN0034 OF WORK-CONTEXT
      *    Define local work field PreQual Reg/Ord 19
           MOVE ZERO TO YN0035 OF WORK-CONTEXT
      *    Define local work field PreQual Reg/Ord 20
           MOVE ZERO TO YN0036 OF WORK-CONTEXT
      *    Define local work field PreQual De-Reg/Ord 7
           MOVE ZERO TO YN0037 OF WORK-CONTEXT
      *    Define local work field PreQual De-Reg/Ord 8
           MOVE ZERO TO YN0038 OF WORK-CONTEXT
      *    Define local work field PreQual De-Reg/Ord 9
           MOVE ZERO TO YN0039 OF WORK-CONTEXT
      *    Define local work field PreQual De-Reg/Ord 10
           MOVE ZERO TO YN0040 OF WORK-CONTEXT
      *    Define local work field PreQual De-Reg/Ord 11
           MOVE ZERO TO YN0041 OF WORK-CONTEXT
      *    Define local work field PreQual De-Reg/Ord 12
           MOVE ZERO TO YN0042 OF WORK-CONTEXT
      *    Define local work field PreQual De-Reg/Ord 13
           MOVE ZERO TO YN0043 OF WORK-CONTEXT
      *    Define local work field PreQual De-Reg/Ord 14
           MOVE ZERO TO YN0044 OF WORK-CONTEXT
      *    Define local work field PreQual De-Reg/Ord 15
           MOVE ZERO TO YN0045 OF WORK-CONTEXT
      *    Define local work field PreQual De-Reg/Ord 16
           MOVE ZERO TO YN0046 OF WORK-CONTEXT
      *    Define local work field PreQual De-Reg/Ord 17
           MOVE ZERO TO YN0047 OF WORK-CONTEXT
      *    Define local work field PreQual De-Reg/Ord 18
           MOVE ZERO TO YN0048 OF WORK-CONTEXT
      *    Define local work field PreQual De-Reg/Ord 19
           MOVE ZERO TO YN0049 OF WORK-CONTEXT
      *    Define local work field PreQual De-Reg/Ord 20
           MOVE ZERO TO YN0050 OF WORK-CONTEXT
      *    Define local work field PreQual Target Reg/Ord 7
           MOVE ZERO TO YN0051 OF WORK-CONTEXT
      *    Define local work field PreQual Target Reg/Ord 8
           MOVE ZERO TO YN0052 OF WORK-CONTEXT
      *    Define local work field PreQual Target Reg/Ord 9
           MOVE ZERO TO YN0053 OF WORK-CONTEXT
      *    Define local work field PreQual Target Reg/Ord 10
           MOVE ZERO TO YN0054 OF WORK-CONTEXT
      *    Define local work field PreQual Target Reg/Ord 11
           MOVE ZERO TO YN0055 OF WORK-CONTEXT
      *    Define local work field PreQual Target Reg/Ord 12
           MOVE ZERO TO YN0056 OF WORK-CONTEXT
      *    Define local work field PreQual Target Reg/Ord 13
           MOVE ZERO TO YN0057 OF WORK-CONTEXT
      *    Define local work field PreQual Target Reg/Ord 14
           MOVE ZERO TO YN0058 OF WORK-CONTEXT
      *    Define local work field PreQual Target Reg/Ord 15
           MOVE ZERO TO YN0059 OF WORK-CONTEXT
      *    Define local work field PreQual Target Reg/Ord 16
           MOVE ZERO TO YN0060 OF WORK-CONTEXT
      *    Define local work field PreQual Target Reg/Ord 17
           MOVE ZERO TO YN0061 OF WORK-CONTEXT
      *    Define local work field PreQual Target Reg/Ord 18
           MOVE ZERO TO YN0062 OF WORK-CONTEXT
      *    Define local work field PreQual Target Reg/Ord 19
           MOVE ZERO TO YN0063 OF WORK-CONTEXT
      *    Define local work field PreQual Target Reg/Ord 20
           MOVE ZERO TO YN0064 OF WORK-CONTEXT
      *    Define local work field Run Mode
           MOVE SPACES TO YN0065 OF WORK-CONTEXT
      *    Define local work field U:Number (3.0) D
           MOVE ZERO TO YL0087 OF WORK-CONTEXT
      *    Define local work field U:Number (3.0) E
           MOVE ZERO TO YL0088 OF WORK-CONTEXT
      *    Define local work field Manual Override Band
           MOVE ZERO TO YN0066 OF WORK-CONTEXT
      *    Define local work field U:Number (3.0) F
           MOVE ZERO TO YL0089 OF WORK-CONTEXT
      *    Define local work field Manual Override Penalty
           MOVE ZERO TO YN0067 OF WORK-CONTEXT
      *    Define local work field U:Number (3.0) G
           MOVE ZERO TO YL0090 OF WORK-CONTEXT
      *    Define local work field Initial Run
           MOVE SPACES TO YL0091 OF WORK-CONTEXT
      *    Define local work field U:Return Code Id
           MOVE SPACES TO YL0092 OF WORK-CONTEXT
      *    Define local work field SD Dealer Number
           MOVE SPACES TO YL0093 OF WORK-CONTEXT
      *    Define local work field Owning Account
           MOVE SPACES TO YL0094 OF WORK-CONTEXT
      *    Define local work field U:Dealer Number Numeric 2
           MOVE ZERO TO YL0095 OF WORK-CONTEXT
      *    Define local work field Dealer Network Type
           MOVE SPACES TO YL0096 OF WORK-CONTEXT
      *    Define local work field Network/Non Network Ind
           MOVE SPACES TO YN0068 OF WORK-CONTEXT
      *    Define local work field Dealer Number (Numeric)
           MOVE ZERO TO YN0069 OF WORK-CONTEXT
      *    Define local work field U:Target Total a
           MOVE ZERO TO YL0097 OF WORK-CONTEXT
      *    Define local work field U:Target Dacia
           MOVE ZERO TO YL0098 OF WORK-CONTEXT
      *    Define local work field U:Dealer Nbr Sfx Dacia
           MOVE SPACES TO YL0099 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat 1 Regs
           MOVE ZERO TO YL0100 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat 2 Regs
           MOVE ZERO TO YL0101 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat 3 Regs
           MOVE ZERO TO YL0102 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat 4 Regs
           MOVE ZERO TO YL0103 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat 5 Regs
           MOVE ZERO TO YL0104 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat N Regs
           MOVE ZERO TO YL0105 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat O Regs
           MOVE ZERO TO YL0106 OF WORK-CONTEXT
      *    Define local work field U:Job Date DTX
           MOVE ZERO TO YL0107 OF WORK-CONTEXT
      *    Define local work field Dealer number (Num key)
           MOVE ZERO TO YL0108 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat 1 Regs
           MOVE ZERO TO YL0109 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat 2 Regs
           MOVE ZERO TO YL0110 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat 3 Regs
           MOVE ZERO TO YL0111 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat 4 Regs
           MOVE ZERO TO YL0112 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat 5 Regs
           MOVE ZERO TO YL0113 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat N Regs
           MOVE ZERO TO YL0114 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat O Regs
           MOVE ZERO TO YL0115 OF WORK-CONTEXT
      *    Define local work field Car/Van Indicator
           MOVE SPACES TO YL0116 OF WORK-CONTEXT
      *    Define local work field OBT Count Target Status
           MOVE SPACES TO YL0117 OF WORK-CONTEXT
      *    Define local work field Bns RIC Config Year
           MOVE ZERO TO YN0070 OF WORK-CONTEXT
      *    Define local work field Bns RIC Display Sequence
           MOVE ZERO TO YN0071 OF WORK-CONTEXT
      *    Define local work field Bns Brand Name
           MOVE SPACES TO YL0118 OF WORK-CONTEXT
      *    Define local work field Bns RIC Mdl Dsp Rec Sts
           MOVE SPACES TO YN0072 OF WORK-CONTEXT
      *    Define local work field Fleet Programmes Code
           MOVE SPACES TO YL0119 OF WORK-CONTEXT
      *    Define local work field U:Continue
           MOVE SPACES TO YL0120 OF WORK-CONTEXT
      *    Define local work field BDC Order Date YYYYMM
           MOVE SPACES TO YN0073 OF WORK-CONTEXT
      *    Define local work field Zone Code
           MOVE SPACES TO YN0074 OF WORK-CONTEXT
      *    Define local work field Network/Non Network Ind
           MOVE SPACES TO YN0075 OF WORK-CONTEXT
      *    Define local work field BDC Order Cnl Dte YYYYMM
           MOVE SPACES TO YN0076 OF WORK-CONTEXT
      *    Define local work field BDC Model Version
           MOVE SPACES TO YN0077 OF WORK-CONTEXT
      *    Define local work field Chassis number
           MOVE SPACES TO YN0078 OF WORK-CONTEXT
      *    Define local work field BDC Order Crt Date
           MOVE ZERO TO YN0079 OF WORK-CONTEXT
      *    Define local work field BDC Order Cnl Date
           MOVE ZERO TO YN0080 OF WORK-CONTEXT
      *    Define local work field TYPE CLIENT SEDRE
           MOVE SPACES TO YN0081 OF WORK-CONTEXT
      *    Define local work field TYPE DR CENTRAL
           MOVE SPACES TO YN0082 OF WORK-CONTEXT
      *    Define local work field SD Sales Channel Code
           MOVE SPACES TO YN0083 OF WORK-CONTEXT
      *    Define local work field Fleet Operator Number
           MOVE SPACES TO YL0121 OF WORK-CONTEXT
      *    Define local work field Fleet Report Group Code
           MOVE SPACES TO YN0084 OF WORK-CONTEXT
      *    Define local work field Fleet Report Group Plan
           MOVE SPACES TO YN0085 OF WORK-CONTEXT
      *    Define local work field Sell Price
           MOVE ZERO TO YN0086 OF WORK-CONTEXT
      *    Define local work field BDC Payment Method
           MOVE SPACES TO YN0087 OF WORK-CONTEXT
      *    Define local work field BDC Payment Term
           MOVE SPACES TO YL0122 OF WORK-CONTEXT
      *    Define local work field Report Group Description
           MOVE SPACES TO YN0088 OF WORK-CONTEXT
      *    Define local work field Registration Date 58
           MOVE ZERO TO YN0089 OF WORK-CONTEXT
      *    Define local work field De-registration Date #
           MOVE ZERO TO YN0090 OF WORK-CONTEXT
      *    Define local work field SD Order Type Assoc w FON
           MOVE SPACES TO YN0091 OF WORK-CONTEXT
      *    Define local work field Fleet Programmes Desc
           MOVE SPACES TO YN0092 OF WORK-CONTEXT
      *    Define local work field FM Agreement Number (FON)
           MOVE SPACES TO YN0093 OF WORK-CONTEXT
      *    Define local work field FM Agreement Version Nbr
           MOVE SPACES TO YN0094 OF WORK-CONTEXT
      *    Define local work field Target Market
           MOVE SPACES TO YL0123 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat 1 De-Regs
           MOVE ZERO TO YL0124 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat 2 De-Regs
           MOVE ZERO TO YL0125 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat 3 De-Regs
           MOVE ZERO TO YL0126 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat 4 De-Regs
           MOVE ZERO TO YL0127 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat 5 De-Regs
           MOVE ZERO TO YL0128 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat N De-Regs
           MOVE ZERO TO YL0129 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat O De-Regs
           MOVE ZERO TO YL0130 OF WORK-CONTEXT
      *    Define local work field U:Job Date DTX
           MOVE ZERO TO YL0131 OF WORK-CONTEXT
      *    Define local work field Dealer number (Num key)
           MOVE ZERO TO YL0132 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat 1 De-Regs
           MOVE ZERO TO YL0133 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat 2 De-Regs
           MOVE ZERO TO YL0134 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat 3 De-Regs
           MOVE ZERO TO YL0135 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat 4 De-Regs
           MOVE ZERO TO YL0136 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat 5 De-Regs
           MOVE ZERO TO YL0137 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat N De-Regs
           MOVE ZERO TO YL0138 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat O De-Regs
           MOVE ZERO TO YL0139 OF WORK-CONTEXT
      *    Define local work field Car/Van Indicator
           MOVE SPACES TO YL0140 OF WORK-CONTEXT
      *    Define local work field OBT Count Target Status
           MOVE SPACES TO YL0141 OF WORK-CONTEXT
      *    Define local work field Bns RIC Config Year
           MOVE ZERO TO YN0095 OF WORK-CONTEXT
      *    Define local work field Bns RIC Display Sequence
           MOVE ZERO TO YN0096 OF WORK-CONTEXT
      *    Define local work field Bns Brand Name
           MOVE SPACES TO YL0142 OF WORK-CONTEXT
      *    Define local work field Bns RIC Mdl Dsp Rec Sts
           MOVE SPACES TO YN0097 OF WORK-CONTEXT
      *    Define local work field Fleet Programmes Code
           MOVE SPACES TO YL0143 OF WORK-CONTEXT
      *    Define local work field U:Continue
           MOVE SPACES TO YL0144 OF WORK-CONTEXT
      *    Define local work field BDC Order Date YYYYMM
           MOVE SPACES TO YN0098 OF WORK-CONTEXT
      *    Define local work field Zone Code
           MOVE SPACES TO YN0099 OF WORK-CONTEXT
      *    Define local work field Network/Non Network Ind
           MOVE SPACES TO YN0100 OF WORK-CONTEXT
      *    Define local work field Dealer number (Num key)
           MOVE ZERO TO YN0101 OF WORK-CONTEXT
      *    Define local work field BDC Model
           MOVE SPACES TO YN0102 OF WORK-CONTEXT
      *    Define local work field BDC Customer Order Number
           MOVE SPACES TO YN0103 OF WORK-CONTEXT
      *    Define local work field BDC Order Cnl Dte YYYYMM
           MOVE SPACES TO YN0104 OF WORK-CONTEXT
      *    Define local work field BDC Model Version
           MOVE SPACES TO YN0105 OF WORK-CONTEXT
      *    Define local work field BDC Order Crt Date
           MOVE ZERO TO YN0106 OF WORK-CONTEXT
      *    Define local work field BDC Order Cnl Date
           MOVE ZERO TO YN0107 OF WORK-CONTEXT
      *    Define local work field TYPE CLIENT SEDRE
           MOVE SPACES TO YN0108 OF WORK-CONTEXT
      *    Define local work field TYPE DR CENTRAL
           MOVE SPACES TO YN0109 OF WORK-CONTEXT
      *    Define local work field SD Sales Channel Code
           MOVE SPACES TO YN0110 OF WORK-CONTEXT
      *    Define local work field Fleet Operator Number
           MOVE SPACES TO YL0145 OF WORK-CONTEXT
      *    Define local work field Fleet Report Group Code
           MOVE SPACES TO YN0111 OF WORK-CONTEXT
      *    Define local work field Fleet Report Group Plan
           MOVE SPACES TO YN0112 OF WORK-CONTEXT
      *    Define local work field Sell Price
           MOVE ZERO TO YN0113 OF WORK-CONTEXT
      *    Define local work field BDC Payment Method
           MOVE SPACES TO YN0114 OF WORK-CONTEXT
      *    Define local work field BDC Payment Term
           MOVE SPACES TO YL0146 OF WORK-CONTEXT
      *    Define local work field Report Group Description
           MOVE SPACES TO YN0115 OF WORK-CONTEXT
      *    Define local work field Registration Date 58
           MOVE ZERO TO YN0116 OF WORK-CONTEXT
      *    Define local work field De-registration Date #
           MOVE ZERO TO YN0117 OF WORK-CONTEXT
      *    Define local work field SD Order Type Assoc w FON
           MOVE SPACES TO YN0118 OF WORK-CONTEXT
      *    Define local work field Fleet Programmes Desc
           MOVE SPACES TO YN0119 OF WORK-CONTEXT
      *    Define local work field FM Agreement Number (FON)
           MOVE SPACES TO YN0120 OF WORK-CONTEXT
      *    Define local work field FM Agreement Version Nbr
           MOVE SPACES TO YN0121 OF WORK-CONTEXT
      *    Define local work field Target Market
           MOVE SPACES TO YL0147 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat 1 Regs DACIA
           MOVE ZERO TO YL0148 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat 2 Regs DACIA
           MOVE ZERO TO YL0149 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat 3 Regs DACIA
           MOVE ZERO TO YL0150 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat 4 Regs DACIA
           MOVE ZERO TO YL0151 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat 5 Regs DACIA
           MOVE ZERO TO YL0152 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat N Regs DACIA
           MOVE ZERO TO YL0153 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat O Regs DACIA
           MOVE ZERO TO YL0154 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat 1 De-Regs DACIA
           MOVE ZERO TO YL0155 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat 2 De-Regs DACIA
           MOVE ZERO TO YL0156 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat 3 De-Regs DACIA
           MOVE ZERO TO YL0157 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat 4 De-Regs DACIA
           MOVE ZERO TO YL0158 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat 5 De-Regs DACIA
           MOVE ZERO TO YL0159 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat N De-Regs DACIA
           MOVE ZERO TO YL0160 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat O De-Regs DACIA
           MOVE ZERO TO YL0161 OF WORK-CONTEXT
      *    Define local work field PreQual Target Reg/Ord 6
           MOVE ZERO TO YL0162 OF WORK-CONTEXT
      *    Define local work field PreQual Target Reg/Ord 15
           MOVE ZERO TO YL0163 OF WORK-CONTEXT
      *    Define local work field PreQual Reg/Ord 15
           MOVE ZERO TO YL0164 OF WORK-CONTEXT
      *    Define local work field PreQual De-Reg/Ord 15
           MOVE ZERO TO YL0165 OF WORK-CONTEXT
      *    Define local work field PreQual Net Reg/Ord 15
           MOVE ZERO TO YL0166 OF WORK-CONTEXT
      *    Define local work field PreQual Combine Reg Net
           MOVE ZERO TO YL0167 OF WORK-CONTEXT
      *    Define local work field PreQual Combine Target AP
           MOVE ZERO TO YL0168 OF WORK-CONTEXT
      *    Define local work field Achievement Band
           MOVE SPACES TO YL0169 OF WORK-CONTEXT
      *    Define local work field Achieved Pre-Qualifier
           MOVE SPACES TO YL0170 OF WORK-CONTEXT
      *    Define local work field PreQual Cancel Ren Prev
           MOVE ZERO TO YL0171 OF WORK-CONTEXT
      *    Define local work field PreQual Cancel Dac Prev
           MOVE ZERO TO YL0172 OF WORK-CONTEXT
      *    Define local work field PreQual Net 1
           MOVE ZERO TO YL0173 OF WORK-CONTEXT
      *    Define local work field PreQual Net 1 Dacia
           MOVE ZERO TO YL0174 OF WORK-CONTEXT
      *    Define local work field PreQual Net 2
           MOVE ZERO TO YL0175 OF WORK-CONTEXT
      *    Define local work field PreQual Net 3
           MOVE ZERO TO YL0176 OF WORK-CONTEXT
      *    Define local work field PreQual Net 4
           MOVE ZERO TO YL0177 OF WORK-CONTEXT
      *    Define local work field PreQual Net 5
           MOVE ZERO TO YL0178 OF WORK-CONTEXT
      *    Define local work field PreQual Net 6
           MOVE ZERO TO YL0179 OF WORK-CONTEXT
      *    Define local work field PreQual Net 7
           MOVE ZERO TO YL0180 OF WORK-CONTEXT
      *    Define local work field PreQual Target 1 DACIA
           MOVE ZERO TO YL0181 OF WORK-CONTEXT
      *    Define local work field PreQual Order 1 Dacia
           MOVE ZERO TO YL0182 OF WORK-CONTEXT
      *    Define local work field PreQual Cancel 1 Dacia
           MOVE ZERO TO YL0183 OF WORK-CONTEXT
      *    Define local work field PreQual Net 1 Renault
           MOVE ZERO TO YL0184 OF WORK-CONTEXT
      *    Define local work field PreQual Target 1 Renault
           MOVE ZERO TO YL0185 OF WORK-CONTEXT
      *    Define local work field PreQual Order 1 Renault
           MOVE ZERO TO YL0186 OF WORK-CONTEXT
      *    Define local work field PreQual Cancel 1 Renault
           MOVE ZERO TO YL0187 OF WORK-CONTEXT
      *    Define local work field PreQual Order A
           MOVE ZERO TO YL0188 OF WORK-CONTEXT
      *    Define local work field PreQual Order 7
           MOVE ZERO TO YL0189 OF WORK-CONTEXT
      *    Define local work field PreQual Cancel 7
           MOVE ZERO TO YL0190 OF WORK-CONTEXT
      *    Define local work field PreQual Target 7
           MOVE ZERO TO YL0191 OF WORK-CONTEXT
      *    Define local work field PreQual Combine Net
           MOVE ZERO TO YL0192 OF WORK-CONTEXT
      *    Define local work field PreQual Combine Target
           MOVE ZERO TO YL0193 OF WORK-CONTEXT
      *    Define local work field PreQual Cancel A
           MOVE ZERO TO YL0194 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat 1 Order
           MOVE ZERO TO YL0195 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat 2 Order
           MOVE ZERO TO YL0196 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat 3 Order
           MOVE ZERO TO YL0197 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat 4 Order
           MOVE ZERO TO YL0198 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat 5 Order
           MOVE ZERO TO YL0199 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat N Order
           MOVE ZERO TO YL0200 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat O Order
           MOVE ZERO TO YL0201 OF WORK-CONTEXT
      *    Define local work field U:Job Date DTX
           MOVE ZERO TO YL0202 OF WORK-CONTEXT
      *    Define local work field Dealer number (Num key)
           MOVE ZERO TO YL0203 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat 1 Order
           MOVE ZERO TO YL0204 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat 2 Order
           MOVE ZERO TO YL0205 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat 3 Order
           MOVE ZERO TO YL0206 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat 4 Order
           MOVE ZERO TO YL0207 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat 5 Order
           MOVE ZERO TO YL0208 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat N Order
           MOVE ZERO TO YL0209 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat O Order
           MOVE ZERO TO YL0210 OF WORK-CONTEXT
      *    Define local work field Car/Van Indicator
           MOVE SPACES TO YL0211 OF WORK-CONTEXT
      *    Define local work field OBT Count Target Status
           MOVE SPACES TO YL0212 OF WORK-CONTEXT
      *    Define local work field Bns RIC Config Year
           MOVE ZERO TO YN0122 OF WORK-CONTEXT
      *    Define local work field Bns RIC Display Sequence
           MOVE ZERO TO YN0123 OF WORK-CONTEXT
      *    Define local work field Bns Brand Name
           MOVE SPACES TO YL0213 OF WORK-CONTEXT
      *    Define local work field Bns RIC Mdl Dsp Rec Sts
           MOVE SPACES TO YN0124 OF WORK-CONTEXT
      *    Define local work field Fleet Programmes Code
           MOVE SPACES TO YL0214 OF WORK-CONTEXT
      *    Define local work field U:Continue
           MOVE SPACES TO YL0215 OF WORK-CONTEXT
      *    Define local work field BDC Order Date YYYYMM
           MOVE SPACES TO YN0125 OF WORK-CONTEXT
      *    Define local work field Zone Code
           MOVE SPACES TO YN0126 OF WORK-CONTEXT
      *    Define local work field Network/Non Network Ind
           MOVE SPACES TO YN0127 OF WORK-CONTEXT
      *    Define local work field BDC Order Cnl Dte YYYYMM
           MOVE SPACES TO YN0128 OF WORK-CONTEXT
      *    Define local work field BDC Model Version
           MOVE SPACES TO YN0129 OF WORK-CONTEXT
      *    Define local work field Chassis number
           MOVE SPACES TO YN0130 OF WORK-CONTEXT
      *    Define local work field BDC Order Crt Date
           MOVE ZERO TO YN0131 OF WORK-CONTEXT
      *    Define local work field BDC Order Cnl Date
           MOVE ZERO TO YN0132 OF WORK-CONTEXT
      *    Define local work field TYPE CLIENT SEDRE
           MOVE SPACES TO YN0133 OF WORK-CONTEXT
      *    Define local work field TYPE DR CENTRAL
           MOVE SPACES TO YN0134 OF WORK-CONTEXT
      *    Define local work field SD Sales Channel Code
           MOVE SPACES TO YN0135 OF WORK-CONTEXT
      *    Define local work field Fleet Operator Number
           MOVE SPACES TO YL0216 OF WORK-CONTEXT
      *    Define local work field Fleet Report Group Code
           MOVE SPACES TO YN0136 OF WORK-CONTEXT
      *    Define local work field Fleet Report Group Plan
           MOVE SPACES TO YN0137 OF WORK-CONTEXT
      *    Define local work field Sell Price
           MOVE ZERO TO YN0138 OF WORK-CONTEXT
      *    Define local work field BDC Payment Method
           MOVE SPACES TO YN0139 OF WORK-CONTEXT
      *    Define local work field BDC Payment Term
           MOVE SPACES TO YL0217 OF WORK-CONTEXT
      *    Define local work field Report Group Description
           MOVE SPACES TO YN0140 OF WORK-CONTEXT
      *    Define local work field Registration Date 58
           MOVE ZERO TO YN0141 OF WORK-CONTEXT
      *    Define local work field De-registration Date #
           MOVE ZERO TO YN0142 OF WORK-CONTEXT
      *    Define local work field SD Order Type Assoc w FON
           MOVE SPACES TO YN0143 OF WORK-CONTEXT
      *    Define local work field Fleet Programmes Desc
           MOVE SPACES TO YN0144 OF WORK-CONTEXT
      *    Define local work field FM Agreement Number (FON)
           MOVE SPACES TO YN0145 OF WORK-CONTEXT
      *    Define local work field FM Agreement Version Nbr
           MOVE SPACES TO YN0146 OF WORK-CONTEXT
      *    Define local work field Target Market
           MOVE SPACES TO YL0218 OF WORK-CONTEXT
      *    Define local work field Order Deduct Date Action
           MOVE ZERO TO YL0219 OF WORK-CONTEXT
      *    Define local work field Order Deduct Date Effect
           MOVE ZERO TO YN0147 OF WORK-CONTEXT
      *    Define local work field VIN
           MOVE SPACES TO YN0148 OF WORK-CONTEXT
      *    Define local work field Customer Order Date #
           MOVE ZERO TO YN0149 OF WORK-CONTEXT
      *    Define local work field Order Cancelled Date
           MOVE ZERO TO YN0150 OF WORK-CONTEXT
      *    Define local work field Order Cancellation Reason
           MOVE SPACES TO YN0151 OF WORK-CONTEXT
      *    Define local work field Cus Ord Allocation Dte
           MOVE ZERO TO YN0152 OF WORK-CONTEXT
      *    Define local work field Cus Ord Deallocation Dte
           MOVE ZERO TO YN0153 OF WORK-CONTEXT
      *    Define local work field Order Type code
           MOVE SPACES TO YN0154 OF WORK-CONTEXT
      *    Define local work field SD Order Type DR
           MOVE SPACES TO YN0155 OF WORK-CONTEXT
      *    Define local work field SEDRE Customer Type
           MOVE SPACES TO YN0156 OF WORK-CONTEXT
      *    Define local work field APL Code
           MOVE SPACES TO YN0157 OF WORK-CONTEXT
      *    Define local work field SCP Model Code
           MOVE SPACES TO YN0158 OF WORK-CONTEXT
      *    Define local work field Model Phase
           MOVE SPACES TO YN0159 OF WORK-CONTEXT
      *    Define local work field SCP Model Version Code
           MOVE SPACES TO YN0160 OF WORK-CONTEXT
      *    Define local work field Fleet Programmes Code
           MOVE SPACES TO YN0161 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat 1 De-Order
           MOVE ZERO TO YL0220 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat 2 De-Order
           MOVE ZERO TO YL0221 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat 3 De-Order
           MOVE ZERO TO YL0222 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat 4 De-Order
           MOVE ZERO TO YL0223 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat 5 De-Order
           MOVE ZERO TO YL0224 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat O De-Order
           MOVE ZERO TO YL0225 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat N De-Order
           MOVE ZERO TO YL0226 OF WORK-CONTEXT
      *    Define local work field U:Job Date DTX
           MOVE ZERO TO YL0227 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat 1 De-Order
           MOVE ZERO TO YL0228 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat 2 De-Order
           MOVE ZERO TO YL0229 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat 3 De-Order
           MOVE ZERO TO YL0230 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat 4 De-Order
           MOVE ZERO TO YL0231 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat 5 De-Order
           MOVE ZERO TO YL0232 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat N De-Order
           MOVE ZERO TO YL0233 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat O De-Order
           MOVE ZERO TO YL0234 OF WORK-CONTEXT
      *    Define local work field U:Continue
           MOVE SPACES TO YL0235 OF WORK-CONTEXT
      *    Define local work field U:Job Date DTX
           MOVE ZERO TO YL0236 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat 1 De-Order
           MOVE ZERO TO YL0237 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat 2 De-Order
           MOVE ZERO TO YL0238 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat 3 De-Order
           MOVE ZERO TO YL0239 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat 4 De-Order
           MOVE ZERO TO YL0240 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat 5 De-Order
           MOVE ZERO TO YL0241 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat N De-Order
           MOVE ZERO TO YL0242 OF WORK-CONTEXT
      *    Define local work field U:Pay Cat O De-Order
           MOVE ZERO TO YL0243 OF WORK-CONTEXT
      *    Define local work field U:Continue
           MOVE SPACES TO YL0244 OF WORK-CONTEXT
      *    Define local work field Order claw back
           MOVE ZERO TO YL0245 OF WORK-CONTEXT
      *    Define local work field Order Band Achieved
           MOVE ZERO TO YL0246 OF WORK-CONTEXT
      *    Define local work field Registration Band Ach
           MOVE ZERO TO YL0247 OF WORK-CONTEXT
      *    Define local work field U:Text (3) c
           MOVE SPACES TO YL0248 OF WORK-CONTEXT
      *    Define local work field U:Text (3) d
           MOVE SPACES TO YL0249 OF WORK-CONTEXT
      *    Define local work field U:Text (1) f
           MOVE SPACES TO YL0250 OF WORK-CONTEXT
      *    Define local work field U:Text (1) e
           MOVE SPACES TO YL0251 OF WORK-CONTEXT
      *    Define local work field U:Text (2) c
           MOVE SPACES TO YL0252 OF WORK-CONTEXT
      *    Define local work field Manual Override Band
           MOVE ZERO TO YL0253 OF WORK-CONTEXT
      *    Define local work field Payment Band Changes
           MOVE SPACES TO YL0254 OF WORK-CONTEXT
      *    Define local work field Manual Override Penalty
           MOVE ZERO TO YL0255 OF WORK-CONTEXT
      *    Define local work field Apply Penalty
           MOVE SPACES TO YL0256 OF WORK-CONTEXT
      *    Define local work field Overall Combined Ach Band
           MOVE ZERO TO YL0257 OF WORK-CONTEXT
      *    Define local work field PreQual Reg/Ord 3
           MOVE ZERO TO YL0258 OF WORK-CONTEXT
      *    Define local work field PreQual De-Reg/Ord 3
           MOVE ZERO TO YL0259 OF WORK-CONTEXT
      *    Define local work field Car/Van Indicator
           MOVE SPACES TO YL0260 OF WORK-CONTEXT
      *    Define local work field Bonus Amount (This)
           MOVE ZERO TO YL0261 OF WORK-CONTEXT
      *    Define local work field Number of Ord TBC
           MOVE ZERO TO YL0262 OF WORK-CONTEXT
      *    Define local work field Number of Ord Car Retail
           MOVE ZERO TO YL0263 OF WORK-CONTEXT
      *    Define local work field Number of Ord Car LFlt
           MOVE ZERO TO YL0264 OF WORK-CONTEXT
      *    Define local work field Number of Ord Van LFlt
           MOVE ZERO TO YL0265 OF WORK-CONTEXT
      *    Define local work field Number of Ord Motab
           MOVE ZERO TO YL0266 OF WORK-CONTEXT
      *    Define local work field Number of Ord Major Flt
           MOVE ZERO TO YL0267 OF WORK-CONTEXT
      *    Define local work field U:Yes/No (2)
           MOVE SPACES TO YL0268 OF WORK-CONTEXT
      *    Define local work field BDC Order Date YYYYMM
           MOVE SPACES TO YN0162 OF WORK-CONTEXT
      *    Define local work field Zone Code
           MOVE SPACES TO YN0163 OF WORK-CONTEXT
      *    Define local work field BDC Order Cnl Dte YYYYMM
           MOVE SPACES TO YN0164 OF WORK-CONTEXT
      *    Define local work field BDC Model Version
           MOVE SPACES TO YN0165 OF WORK-CONTEXT
      *    Define local work field Chassis number
           MOVE SPACES TO YN0166 OF WORK-CONTEXT
      *    Define local work field BDC Order Crt Date
           MOVE ZERO TO YL0269 OF WORK-CONTEXT
      *    Define local work field BDC Order Cnl Date
           MOVE ZERO TO YN0167 OF WORK-CONTEXT
      *    Define local work field TYPE CLIENT SEDRE
           MOVE SPACES TO YN0168 OF WORK-CONTEXT
      *    Define local work field TYPE DR CENTRAL
           MOVE SPACES TO YN0169 OF WORK-CONTEXT
      *    Define local work field SD Sales Channel Code
           MOVE SPACES TO YL0270 OF WORK-CONTEXT
      *    Define local work field Fleet Operator Number
           MOVE SPACES TO YN0170 OF WORK-CONTEXT
      *    Define local work field Fleet Report Group Code
           MOVE SPACES TO YL0271 OF WORK-CONTEXT
      *    Define local work field Fleet Report Group Plan
           MOVE SPACES TO YN0171 OF WORK-CONTEXT
      *    Define local work field Sell Price
           MOVE ZERO TO YN0172 OF WORK-CONTEXT
      *    Define local work field BDC Payment Method
           MOVE SPACES TO YN0173 OF WORK-CONTEXT
      *    Define local work field BDC Payment Term
           MOVE SPACES TO YL0272 OF WORK-CONTEXT
      *    Define local work field Report Group Description
           MOVE SPACES TO YN0174 OF WORK-CONTEXT
      *    Define local work field OBT Count Target Status
           MOVE SPACES TO YL0273 OF WORK-CONTEXT
      *    Define local work field Registration Date 58
           MOVE ZERO TO YL0274 OF WORK-CONTEXT
      *    Define local work field De-registration Date #
           MOVE ZERO TO YN0175 OF WORK-CONTEXT
      *    Define local work field SD Order Type Assoc w FON
           MOVE SPACES TO YN0176 OF WORK-CONTEXT
      *    Define local work field Fleet Programmes Code
           MOVE SPACES TO YL0275 OF WORK-CONTEXT
      *    Define local work field Fleet Programmes Desc
           MOVE SPACES TO YN0177 OF WORK-CONTEXT
      *    Define local work field FM Agreement Number (FON)
           MOVE SPACES TO YN0178 OF WORK-CONTEXT
      *    Define local work field FM Agreement Version Nbr
           MOVE SPACES TO YN0179 OF WORK-CONTEXT
      *    Define local work field Target Market
           MOVE SPACES TO YL0276 OF WORK-CONTEXT
      *    Define local work field U:Number (3.0)
           MOVE ZERO TO YL0277 OF WORK-CONTEXT
      *    Define local work field Vehicle Rejection Flag
           MOVE SPACES TO YL0278 OF WORK-CONTEXT
      *==============================================================
           CONTINUE.
       ZZEXIT.
           EXIT.
