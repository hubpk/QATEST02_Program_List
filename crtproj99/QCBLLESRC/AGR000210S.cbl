       PROCESS APOST GRAPHIC.
      ***************************************************************
       IDENTIFICATION DIVISION.
     H/TITLE Ext Crt Auto Bulk Upload  Execute external functio
     Z* CRTCBLPGM
     Z* OPTION(*SRCDBG) CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Execute external function  Version:  8.7
      *
     H* Company    : Vehicle Finance
     H* System     : Vehicle Finance
     H* User name  : PRAGTSK
     H* Date       : 07/10/21 time: 09:52:01
     H* Copyright  : Vehicle Finance
      *
      *==============================================================
     M* MAINTENANCE   :
      *==============================================================
       PROGRAM-ID.  AGR000210S.
       SECURITY.    (C) COPYRIGHT Renault UK Ltd. 2021
                    Reproduction is not allowed without prior permission
      /EJECT
      ***************************************************************
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       SOURCE-COMPUTER.  IBM-AS400.
       OBJECT-COMPUTER.  IBM-AS400.
       SPECIAL-NAMES.  OPEN-FEEDBACK IS OPEN-FEEDBACK-AREA,
           I-O-FEEDBACK IS I-O-FEEDBACK-AREA.
      /EJECT
      ***************************************************************
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
      *
           SELECT VAMDLREFL4
             ASSIGN TO DATABASE-VAMDLREFL4
             ORGANIZATION IS INDEXED
             ACCESS MODE IS DYNAMIC
             RECORD KEY IS EXTERNALLY-DESCRIBED-KEY
             FILE STATUS IS FILE-STATUS.
      *    RSQ : Vehicle Model X-Ref       SCP Code, Last Acard(D)
      *
           SELECT VAVEHDTALE
             ASSIGN TO DATABASE-VAVEHDTALE
             ORGANIZATION IS INDEXED
             ACCESS MODE IS DYNAMIC
             RECORD KEY IS EXTERNALLY-DESCRIBED-KEY
             FILE STATUS IS FILE-STATUS.
      *    RSQ : Vehicle                   BY SCP Model,Vers
      *
           SELECT RAVERSETL6
             ASSIGN TO DATABASE-RAVERSETL6
             ORGANIZATION IS INDEXED
             ACCESS MODE IS DYNAMIC
             RECORD KEY IS EXTERNALLY-DESCRIBED-KEY
             FILE STATUS IS FILE-STATUS.
      *    RSQ : AOC Set Version           SCP Mdl,Phase,SCP Vers
      *
           SELECT SFACAPXRL1
             ASSIGN TO DATABASE-SFACAPXRL1
             ORGANIZATION IS INDEXED
             ACCESS MODE IS DYNAMIC
             RECORD KEY IS EXTERNALLY-DESCRIBED-KEY
             FILE STATUS IS FILE-STATUS.
      *    RTV : SFA CAP Xref              Retrieval index
      *
           SELECT VAMVVSCPL2
             ASSIGN TO DATABASE-VAMVVSCPL2
             ORGANIZATION IS INDEXED
             ACCESS MODE IS DYNAMIC
             RECORD KEY IS EXTERNALLY-DESCRIBED-KEY
             FILE STATUS IS FILE-STATUS.
      *    RSQ : KSP Model Varient         By Model,Phase,Version
      *
           SELECT VAMVFLSTL1
             ASSIGN TO DATABASE-VAMVFLSTL1
             ORGANIZATION IS INDEXED
             ACCESS MODE IS DYNAMIC
             RECORD KEY IS EXTERNALLY-DESCRIBED-KEY
             FILE STATUS IS FILE-STATUS.
      *    RTV : KSP Model Varient Fea Lst Retrieval index
      *
           SELECT RAAOCVPRL2
             ASSIGN TO DATABASE-RAAOCVPRL2
             ORGANIZATION IS INDEXED
             ACCESS MODE IS DYNAMIC
             RECORD KEY IS EXTERNALLY-DESCRIBED-KEY
             FILE STATUS IS FILE-STATUS.
      *    RSQ : AOC Version Price         Mdl,Phs,Ver,Prc Dte DSC
      *
           SELECT AGRDLR10L1
             ASSIGN TO DATABASE-AGRDLR10L1
             ORGANIZATION IS INDEXED
             ACCESS MODE IS DYNAMIC
             RECORD KEY IS EXTERNALLY-DESCRIBED-KEY
             FILE STATUS IS FILE-STATUS.
      *    RTV : Autotrader Ret/Sec Dealer Retrieval index
      *
           SELECT VAVEHDTAL2
             ASSIGN TO DATABASE-VAVEHDTAL2
             ORGANIZATION IS INDEXED
             ACCESS MODE IS DYNAMIC
             RECORD KEY IS EXTERNALLY-DESCRIBED-KEY
             FILE STATUS IS FILE-STATUS.
      *    RSQ : Vehicle                   Chassis
      *
           SELECT AGPICG00L1
             ASSIGN TO DATABASE-AGPICG00L1
             ORGANIZATION IS INDEXED
             ACCESS MODE IS DYNAMIC
             RECORD KEY IS EXTERNALLY-DESCRIBED-KEY
             FILE STATUS IS FILE-STATUS.
      *    RTV : Autotrader PICG Price     Retrieval index
      *
           SELECT VAMVRTRML1
             ASSIGN TO DATABASE-VAMVRTRML1
             ORGANIZATION IS INDEXED
             ACCESS MODE IS DYNAMIC
             RECORD KEY IS EXTERNALLY-DESCRIBED-KEY
             FILE STATUS IS FILE-STATUS.
      *    RTV : KSP Mdl Vers Colour Trim  Retrieval index
      *
           SELECT VAVINATNL1
             ASSIGN TO DATABASE-VAVINATNL1
             ORGANIZATION IS INDEXED
             ACCESS MODE IS DYNAMIC
             RECORD KEY IS EXTERNALLY-DESCRIBED-KEY
             FILE STATUS IS FILE-STATUS.
      *    RTV : KSP VIN Attn text         Retrieval index
      *
           SELECT AGRDLR00L1
             ASSIGN TO DATABASE-AGRDLR00L1
             ORGANIZATION IS INDEXED
             ACCESS MODE IS DYNAMIC
             RECORD KEY IS EXTERNALLY-DESCRIBED-KEY
             FILE STATUS IS FILE-STATUS.
      *    RTV : Autotrader Dealer         Retrieval index
      *
           SELECT AGAUTOBUL2
             ASSIGN TO DATABASE-AGAUTOBUL2
             ORGANIZATION IS INDEXED
             ACCESS MODE IS DYNAMIC
             RECORD KEY IS EXTERNALLY-DESCRIBED-KEY
             FILE STATUS IS FILE-STATUS.
      *    RSQ : Autotrader Bulk Upload    By Status,Brand,Mdl,Ver
      *
           SELECT AGAUTOBUL0
             ASSIGN TO DATABASE-AGAUTOBUL0
             ORGANIZATION IS INDEXED
             ACCESS MODE IS DYNAMIC
             RECORD KEY IS EXTERNALLY-DESCRIBED-KEY
             FILE STATUS IS FILE-STATUS.
      *    UPD : Autotrader Bulk Upload    Update index
      *
       I-O-CONTROL.
      *
      /EJECT
      ***************************************************************
       DATA DIVISION.
       FILE SECTION.
      *
      *
       FD  VAMDLREFL4
           LABEL RECORDS ARE STANDARD.
       01  VAMDLREFL4-R.
           COPY DDS-ALL-FORMATS OF VAMDLREFL4.
      *
       FD  VAVEHDTALE
           LABEL RECORDS ARE STANDARD.
       01  VAVEHDTALE-R.
           COPY DDS-ALL-FORMATS OF VAVEHDTALE.
      *
       FD  RAVERSETL6
           LABEL RECORDS ARE STANDARD.
       01  RAVERSETL6-R.
           COPY DDS-ALL-FORMATS OF RAVERSETL6.
      *
       FD  SFACAPXRL1
           LABEL RECORDS ARE STANDARD.
       01  SFACAPXRL1-R.
           COPY DDS-ALL-FORMATS OF SFACAPXRL1.
      *
       FD  VAMVVSCPL2
           LABEL RECORDS ARE STANDARD.
       01  VAMVVSCPL2-R.
           COPY DDS-ALL-FORMATS OF VAMVVSCPL2.
      *
       FD  VAMVFLSTL1
           LABEL RECORDS ARE STANDARD.
       01  VAMVFLSTL1-R.
           COPY DDS-ALL-FORMATS OF VAMVFLSTL1.
      *
       FD  RAAOCVPRL2
           LABEL RECORDS ARE STANDARD.
       01  RAAOCVPRL2-R.
           COPY DDS-ALL-FORMATS OF RAAOCVPRL2.
      *
       FD  AGRDLR10L1
           LABEL RECORDS ARE STANDARD.
       01  AGRDLR10L1-R.
           COPY DDS-ALL-FORMATS OF AGRDLR10L1.
      *
       FD  VAVEHDTAL2
           LABEL RECORDS ARE STANDARD.
       01  VAVEHDTAL2-R.
           COPY DDS-ALL-FORMATS OF VAVEHDTAL2.
      *
       FD  AGPICG00L1
           LABEL RECORDS ARE STANDARD.
       01  AGPICG00L1-R.
           COPY DDS-ALL-FORMATS OF AGPICG00L1.
      *
       FD  VAMVRTRML1
           LABEL RECORDS ARE STANDARD.
       01  VAMVRTRML1-R.
           COPY DDS-ALL-FORMATS OF VAMVRTRML1.
      *
       FD  VAVINATNL1
           LABEL RECORDS ARE STANDARD.
       01  VAVINATNL1-R.
           COPY DDS-ALL-FORMATS OF VAVINATNL1.
      *
       FD  AGRDLR00L1
           LABEL RECORDS ARE STANDARD.
       01  AGRDLR00L1-R.
           COPY DDS-ALL-FORMATS OF AGRDLR00L1.
      *
       FD  AGAUTOBUL2
           LABEL RECORDS ARE STANDARD.
       01  AGAUTOBUL2-R.
           COPY DDS-ALL-FORMATS OF AGAUTOBUL2.
      *
       FD  AGAUTOBUL0
           LABEL RECORDS ARE STANDARD.
       01  AGAUTOBUL0-R.
           COPY DDS-ALL-FORMATS OF AGAUTOBUL0.
      /EJECT
      ***************************************************************
       WORKING-STORAGE SECTION.
      *
      *    Job context
       01  JOB-CONTEXT.
           COPY DDS-ALL-FORMATS OF Y2PGDSPK.
      *    Job date/time
           03  IJBDTTM.
           05  ZZJDT PIC S9(7).
           05  ZZJDTE REDEFINES ZZJDT.
           07  ZZJCC PIC S9(1).
           07  ZZJYY PIC S9(2).
           07  ZZJMM PIC S9(2).
           07  ZZJDD PIC S9(2).
           05  ZZJTM PIC S9(6).
           05  ZZJTME REDEFINES ZZJTM.
           07  ZZJHH PIC S9(2).
           07  ZZJNN PIC S9(2).
           07  ZZJSS PIC S9(2).
           03  ZZFQL PIC X(21).
           03  ZZFLB PIC X(10).
           03  ZZFFL PIC X(10).
           03  ZZFMB PIC X(10).
           03  ZZCDB PIC X(18).
           03  ZZLDB PIC X(18).
           03  ZZTMS PIC X(26).
       01  ZZTIME.
           03  ZZHNS PIC S9(6).
           03  ZZHH PIC S9(2).
      *
       77  C-IND-OFF PIC 1(1) VALUE B'0'.
       77  C-IND-ON PIC 1(1) VALUE B'1'.
       77  W0STRNG PIC X(32766).
      *
       01  FILE-STATUS PIC X(2).
           88  C-IO-OK VALUE '00'.
           88  C-EOF VALUE '10' '46'.
           88  C-NO-MOD-SFLRCDS VALUE '12'.
           88  C-IO-ERR VALUE '21' '22' '24' '30' '34' '90' '91' '92' '9
      -     '4' '95' '9A' '9H' '9I' '9K' '9M' '9N' '9P'.
           88  C-NO-RECORD VALUE '23'.
           88  C-RECORD-LOCKED VALUE '9D'.
      *
       01  UNTIL-CONDITION PIC 1(1).
           88  C-UNTIL-FALSE VALUE B'0'.
           88  C-UNTIL-TRUE VALUE B'1'.
      *
       01  FOREVER PIC 1(1) VALUE B'1'.
           88  C-FOREVER VALUE B'1'.
      *
       01  WRK-IO-TRASH-AREA PIC X(1).
      *
       01  P1PARM.
      *    SCP Model code
           03  P1SCMDLCDE PIC X(3).
       01  P2PARM.
      *    U:Display yes/no 1
           03  P2UDSPYN1 PIC X(1).
       01  P3PARM.
      *    U:Run Mode
           03  P3URUNMODE PIC X(1).
       01  P4PARM.
      *    U:Date (8) Char
           03  P4UDTECHR PIC X(8).
       01  P5PARM.
      *    U:To Date (TXT)
           03  P5Y3TX PIC X(8).
       01  P6PARM.
      *    U:From Date (8.0)
           03  P6E0DX PIC S9(8) COMP-3.
       01  P7PARM.
      *    U:To Date (8.0)
           03  P7JXDX PIC S9(8) COMP-3.
       01  W0RTN PIC X(7).
       01  W0RSF PIC X(1).
       01  W0ENV PIC X(3).
       01  W0RTW PIC S9(9) COMP-4.
       01  W0ICL PIC X(1).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSA1.
      *    SCP Model code
           03  OXSCMDLCDE PIC X(3).
      *    Phase
           03  OXO2ST PIC X(1).
      *    SCP Model Version Code
           03  OXSCVERCDE PIC X(12).
      *    SCP Version Last Acard
           03  OXSCVERACD PIC S9(8) COMP-3.
      *..............................................................
      *    Dealer Name
       01  WN0001 PIC X(40).
      *    Model Marketing Desc.
       01  WN0002 PIC X(40).
      *    Version Marketing Desc.
       01  WN0003 PIC X(50).
      *    Vehicle Model Trim Level
       01  WN0004 PIC X(50).
      *    CAP Vehicle Code
       01  WN0005 PIC X(20).
      *    CAP Vehicle ID Number
       01  WN0006 PIC S9(5).
      *    CAP Model Dsc Cleansed
       01  WN0007 PIC X(48).
      *    CAP Version Dsc Cleansed
       01  WN0008 PIC X(48).
      *    Autotrader Vehicle Type
       01  WN0009 PIC X(10).
      *    Vehicle Body Name ATR
       01  WN0010 PIC X(20).
      *    Vehicle Fuel Type
       01  WN0011 PIC X(25).
      *    Vehicle Drive System
       01  WN0012 PIC X(50).
      *    Vehicle Horse Power
       01  WN0013 PIC X(25).
      *    Vehicle Gearbox Type
       01  WN0014 PIC X(25).
      *    Colour Description
       01  WN0015 PIC X(50).
      *    Trim Description (48)
       01  WN0016 PIC X(48).
      *    Vehicle Engine Capacity
       01  WN0017 PIC S9(5).
      *    Vehicle Number of Doors
       01  WN0018 PIC S9(1).
      *    Vehicle Seating Capacity
       01  WN0019 PIC S9(5).
      *    Vehicle Mileage
       01  WN0020 PIC S9(7).
      *    Vehicle Top Speed
       01  WN0021 PIC X(25).
      *    Vehicle Fuel Tank Cap
       01  WN0022 PIC X(25).
      *    Vehicle Range
       01  WN0023 PIC X(25).
      *    Vehicle External Length
       01  WN0024 PIC X(25).
      *    Vehicle Ext Length Units
       01  WN0025 PIC X(25).
      *    Vehicle Ext Length AddTxt
       01  WN0026 PIC X(25).
      *    Vehicle External Width
       01  WN0027 PIC X(25).
      *    Vehicle External Height
       01  WN0028 PIC X(25).
      *    Vehicle Ext Height Units
       01  WN0029 PIC X(25).
      *    Vehicle Ext Height AddTxt
       01  WN0030 PIC X(25).
      *    Vehicle Gross Weight
       01  WN0031 PIC S9(4)V9(1).
      *    Vehicle Wheelbase
       01  WN0032 PIC X(25).
      *    Sedre Vehicle Status
       01  WN0033 PIC X(1).
      *    Sedre Vehicle Status Dsc
       01  WN0034 PIC X(25).
      *    Customer Order Number
       01  WN0035 PIC X(6).
      *    Customer Order Date #
       01  WN0036 PIC S9(8) COMP-3.
      *    Cust Allocation Date
       01  WN0037 PIC S9(8) COMP-3.
      *    SEDRE customer type
       01  WN0038 PIC X(1).
      *    Order Type Central
       01  WN0039 PIC X(2).
      *    SD Sales Channel Code ATR
       01  WN0040 PIC X(2).
      *    Vehicle List Price
       01  WN0041 PIC S9(7)V9(2).
      *    Vehicle Version Price
       01  WN0042 PIC S9(7)V9(2).
      *    Vehicle Delivery Price
       01  WN0043 PIC S9(7)V9(2).
      *    Vehicle Colour Price
       01  WN0044 PIC S9(7)V9(2).
      *    Vehicle Accessories Price
       01  WN0045 PIC S9(7)V9(2).
      *    Vehicle Options Price
       01  WN0046 PIC S9(7)V9(2).
      *    Vehicle First Reg Fee
       01  WN0047 PIC S9(9)V9(2).
      *    Vehicle Road Fun License
       01  WN0048 PIC S9(9)V9(2).
      *    Vehicle On The Road Price
       01  WN0049 PIC S9(7)V9(2).
      *    Vehicle All Options Dsc
       01  WN0050 PIC X(3000).
      *    Vehicle All Accessory Dsc
       01  WN0051 PIC X(600).
      *    Vehicle Version KSP All
       01  WN0052 PIC X(3000).
      *    Vehicle Options AXS Merge
       01  WN0053 PIC X(3400).
      *    Record Processed Status
       01  WN0054 PIC X(1).
      *    U:Record Selected
       01  WN0055 PIC X(1).
      *    Library
       01  WQ0001 PIC X(10).
      *    U:Action
       01  WQ0002 PIC X(1).
      *    U:Pozition
       01  WQ0003 PIC X(1).
      *    Library Reference
       01  WQ0004 PIC X(10).
      *    *Return code
       01  WQ0005 PIC X(7).
       01  W0CLPG PIC X(10).
      *    SCP Model code
       01  WQ0006 PIC X(3).
      *    Brand Code
       01  WQ0007 PIC X(6).
      *    *Synon (5,0) work field
       01  YRSW00 PIC S9(5) COMP-3.
      *    *Synon (5,0) work field
       01  YRSW01 PIC S9(5) COMP-3.
      *    *Synon (5,0) work field
       01  YRSW02 PIC S9(5) COMP-3.
      *    *Synon (5,0) work field
       01  YRSW03 PIC S9(5) COMP-3.
      *    *Synon (5,0) work field
       01  YRSW04 PIC S9(5) COMP-3.
      *    *String work field
       01  YRSW05 PIC X(1).
       01  YRSW06.
           03  YRSW06X PIC X(1) OCCURS 10000.
      *    *Synon (9999) work field
       01  YRSW07 PIC X(9999).
      *    VEH-ACTION
       01  WQ0008 PIC X(1).
      *    VEH-APLCDE
       01  WQ0009 PIC X(6).
      *    VEH-RECORD-AVEHBR2CB
       01  WQ0010 PIC X(81).
      *    VEH-RETCODE
       01  WQ0011 PIC X(2).
      *    *Synon (5,0) work field
       01  YRSW08 PIC S9(5) COMP-3.
       01  YRSW09.
           03  YRSW09X PIC X(1) OCCURS 10000.
      *    Define keylist
       01  KRSSA2.
      *    SCP Model code
           03  J6SCMDLCDE PIC X(3).
      *    Define keylist
       01  KRSSA2-TMP.
      *    SCP Model code
           03  J6SCMDLCDE PIC X(3).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSA2.
      *    SCP Model code
           03  J6SCMDLCDE PIC X(3).
      *    Phase
           03  J6O2ST PIC X(1).
      *    SCP Model Version Code
           03  J6SCVERCDE PIC X(12).
      *..............................................................
      *    Outward parameters
       01  PARC.
      *    RCD : STR - Vehicle Model
      *    I : RST SCP Model code
      *    SCP Model code
           03  PASCMDLCDE PIC X(3).
      *    I : RST Phase
      *    Phase
           03  PAO2ST PIC X(1).
      *    O : MAP Model Marketing Desc
      *    Model Marketing Desc
           03  PAMODDSC PIC X(40).
      *    O : MAP U:Model Year(millesme)
      *    U:Model Year(millesme)
           03  PAVCCD PIC X(2).
      *    O : MAP U:Vehicle Database Rec
      *    U:Vehicle Database Rec
           03  PAYFST PIC X(1).
      *
      *    *Return code
       01  WQ0012 PIC X(7).
      *    Outward parameters
       01  PBRC.
      *    RCD : STR: Veh Mdl Ver Parms
      *    I :  SCP Model code
      *    SCP Model code
           03  PBSCMDLCDE PIC X(3).
      *    I :  Phase
      *    Phase
           03  PBO2ST PIC X(1).
      *    I :  SCP Model Version Code
      *    SCP Model Version Code
           03  PBSCVERCDE PIC X(12).
      *    O : MAP Version Marketing Desc
      *    Version Marketing Desc
           03  PBVERMKDSC PIC X(50).
      *    O : MAP V55 Model Version Desc
      *    V55 Model Version Desc
           03  PBVERV55DS PIC X(20).
      *    O : MAP Manufacturer Code
      *    Manufacturer Code
           03  PBMANUCD PIC X(3).
      *    O : MAP SMMT MVRIS Make Code
      *    SMMT MVRIS Make Code
           03  PBMVMAKE PIC X(2).
      *    O : MAP SMMT Model MVRIS Code
      *    SMMT Model MVRIS Code
           03  PBMVRI PIC X(3).
      *    O : MAP DVLA Make Code
      *    DVLA Make Code
           03  PBAFDVMAKE PIC X(2).
      *    O : MAP SMMT Model Code
      *    SMMT Model Code
           03  PBMDLCDE PIC X(3).
      *    O : MAP Vehicle Body Class Code
      *    Vehicle Body Class Code
           03  PBBCBDYCLS PIC X(2).
      *    O : MAP Vehicle Body Code
      *    Vehicle Body Code
           03  PBBTBDYCDE PIC X(2).
      *    O : MAP Vehicle Body Name
      *    Vehicle Body Name
           03  PBBTBDYNAM PIC X(20).
      *    O : MAP DVLA Type Approval Categ
      *    DVLA Type Approval Categ
           03  PBDVLATACT PIC X(2).
      *    O : MAP Vehicle Fuel Code
      *    Vehicle Fuel Code
           03  PBFTFUEL PIC X(1).
      *    O : MAP Model Engine Capacity
      *    Model Engine Capacity
           03  PBENGC PIC S9(5) COMP-3.
      *    O : MAP Gross Weight
      *    Gross Weight
           03  PBGRWGHT PIC S9(4)V9(1).
      *    O : MAP Net Weight
      *    Net Weight
           03  PBNTWGHT PIC S9(4)V9(1).
      *    O : MAP Typemines
      *    Typemines
           03  PBTYPM PIC X(6).
      *    O : MAP High Performance (Y/N)
      *    High Performance (Y/N)
           03  PBHPSTS PIC X(1).
      *    O : MAP Special Edition (Y/N)
      *    Special Edition (Y/N)
           03  PBSESTS PIC X(1).
      *    O : MAP Gearbox Type Sts
      *    Gearbox Type Sts
           03  PBGBOXT PIC X(1).
      *    O : MAP Number of doors
      *    Number of doors
           03  PBNODRS PIC S9(1).
      *    O : MAP Seating Capacity V55
      *    Seating Capacity V55
           03  PBSEAT PIC S9(5).
      *    O : MAP Tax Class Code
      *    Tax Class Code
           03  PBTAXCDE PIC S9(2) COMP-3.
      *    O : MAP Vehicle Database Rec Sts
      *    Vehicle Database Rec Sts
           03  PBVEHRCSTS PIC X(1).
      *
      *    *Return code
       01  WQ0013 PIC X(7).
      *    Define keylist
       01  KRSSA3.
      *    SCP Model code
           03  SLSCMDLCDE PIC X(3).
      *    Phase
           03  SLO2ST PIC X(1).
      *    SCP Model Version Code
           03  SLSCVERCDE PIC X(12).
      *    Define keylist
       01  KRSSA3-TMP.
      *    SCP Model code
           03  SLSCMDLCDE PIC X(3).
      *    Phase
           03  SLO2ST PIC X(1).
      *    SCP Model Version Code
           03  SLSCVERCDE PIC X(12).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSA3.
      *    SCP Model code
           03  SLSCMDLCDE PIC X(3).
      *    Phase
           03  SLO2ST PIC X(1).
      *    SCP Model Version Code
           03  SLSCVERCDE PIC X(12).
      *..............................................................
      *    Define keylist
       01  KRSSA4.
      *    SCP Model code
           03  SLSCMDLCDE PIC X(3).
      *    Phase
           03  SLO2ST PIC X(1).
      *    SCP Model Version Code
           03  SLSCVERCDE PIC X(12).
      *    Define keylist
       01  KRSSA4-TMP.
      *    SCP Model code
           03  SLSCMDLCDE PIC X(3).
      *    Phase
           03  SLO2ST PIC X(1).
      *    SCP Model Version Code
           03  SLSCVERCDE PIC X(12).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSA4.
      *    SCP Model code
           03  SLSCMDLCDE PIC X(3).
      *    Phase
           03  SLO2ST PIC X(1).
      *    SCP Model Version Code
           03  SLSCVERCDE PIC X(12).
      *..............................................................
      *    Define keylist
       01  KRSSA5.
      *    SCP Model code
           03  SJSCMDLCDE PIC X(3).
      *    SCP Model Version Code
           03  SJSCVERCDE PIC X(12).
      *    Define keylist
       01  KRSSA5-TMP.
      *    SCP Model code
           03  SJSCMDLCDE PIC X(3).
      *    SCP Model Version Code
           03  SJSCVERCDE PIC X(12).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSA5.
      *    SCP Model code
           03  SJSCMDLCDE PIC X(3).
      *    SCP Model Version Code
           03  SJSCVERCDE PIC X(12).
      *..............................................................
      *    U:Return Code Id
       01  WQ0014 PIC X(7).
      *    U:Character Conv Code
       01  WQ0015 PIC X(6).
      *    U:Text (100) From
       01  WQ0016 PIC X(100).
      *    U:Text (100) To
       01  WQ0017 PIC X(100).
      *    U:update (Y/N)
       01  WQ0018 PIC X(1).
      *    U:Return Code Id
       01  WQ0019 PIC X(7).
      *    U:Character Conv Code
       01  WQ0020 PIC X(6).
      *    U:Text (100) From
       01  WQ0021 PIC X(100).
      *    U:Text (100) To
       01  WQ0022 PIC X(100).
      *    U:update (Y/N)
       01  WQ0023 PIC X(1).
      *    Define keylist
       01  KRSSA6.
      *    SCP Model code
           03  B7SCMDLCDE PIC X(3).
      *    Phase
           03  B7O2ST PIC X(1).
      *    SCP Model Version Code
           03  B7SCVERCDE PIC X(12).
      *    Define keylist
       01  KRSSA6-TMP.
      *    SCP Model code
           03  B7SCMDLCDE PIC X(3).
      *    Phase
           03  B7O2ST PIC X(1).
      *    SCP Model Version Code
           03  B7SCVERCDE PIC X(12).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSA6.
      *    SCP Model code
           03  B7SCMDLCDE PIC X(3).
      *    Phase
           03  B7O2ST PIC X(1).
      *    SCP Model Version Code
           03  B7SCVERCDE PIC X(12).
      *..............................................................
      *    Define keylist
       01  KRSSA7.
      *    SCP Model code
           03  B8SCMDLCDE PIC X(3).
      *    Phase
           03  B8O2ST PIC X(1).
      *    Vehicle Model KSP Varient
           03  B8MVKSPVAR PIC X(50).
      *    Define keylist
       01  KRSSA7-TMP.
      *    SCP Model code
           03  B8SCMDLCDE PIC X(3).
      *    Phase
           03  B8O2ST PIC X(1).
      *    Vehicle Model KSP Varient
           03  B8MVKSPVAR PIC X(50).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSA7.
      *    SCP Model code
           03  B8SCMDLCDE PIC X(3).
      *    Phase
           03  B8O2ST PIC X(1).
      *    Vehicle Model KSP Varient
           03  B8MVKSPVAR PIC X(50).
      *    Model Version KSP Seq
           03  B8MVKSPSEQ PIC S9(3).
      *..............................................................
      *    Define keylist
       01  KRSSA8.
      *    SCP Model code
           03  RCSCMDLCDE PIC X(3).
      *    Phase
           03  RCO2ST PIC X(1).
      *    SCP Model Version Code
           03  RCSCVERCDE PIC X(12).
      *    Define keylist
       01  KRSSA8-TMP.
      *    SCP Model code
           03  RCSCMDLCDE PIC X(3).
      *    Phase
           03  RCO2ST PIC X(1).
      *    SCP Model Version Code
           03  RCSCVERCDE PIC X(12).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSA8.
      *    SCP Model code
           03  RCSCMDLCDE PIC X(3).
      *    Phase
           03  RCO2ST PIC X(1).
      *    SCP Model Version Code
           03  RCSCVERCDE PIC X(12).
      *    Price Start Date - Dealer
           03  RCPRCDTDLR PIC S9(8) COMP-3.
      *..............................................................
      *    Define keylist
       01  KRSSA9.
      *    SCP Model code
           03  RCSCMDLCDE PIC X(3).
      *    Phase
           03  RCO2ST PIC X(1).
      *    SCP Model Version Code
           03  RCSCVERCDE PIC X(12).
      *    Define keylist
       01  KRSSA9-TMP.
      *    SCP Model code
           03  RCSCMDLCDE PIC X(3).
      *    Phase
           03  RCO2ST PIC X(1).
      *    SCP Model Version Code
           03  RCSCVERCDE PIC X(12).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSA9.
      *    SCP Model code
           03  RCSCMDLCDE PIC X(3).
      *    Phase
           03  RCO2ST PIC X(1).
      *    SCP Model Version Code
           03  RCSCVERCDE PIC X(12).
      *    Price Start Date - Dealer
           03  RCPRCDTDLR PIC S9(8) COMP-3.
      *..............................................................
      *    SCP Model code
       01  WQ0024 PIC X(3).
      *    SCP Model Version Code
       01  WQ0025 PIC X(12).
      *    Technical Equipment Code
       01  WQ0026 PIC X(7).
      *    Technical Equipment Value
       01  WQ0027 PIC X(200).
      *    SCP Model code
       01  WQ0028 PIC X(3).
      *    SCP Model Version Code
       01  WQ0029 PIC X(12).
      *    Technical Equipment Code
       01  WQ0030 PIC X(7).
      *    Technical Equipment Value
       01  WQ0031 PIC X(200).
      *    SCP Model code
       01  WQ0032 PIC X(3).
      *    SCP Model Version Code
       01  WQ0033 PIC X(12).
      *    Technical Equipment Code
       01  WQ0034 PIC X(7).
      *    Technical Equipment Value
       01  WQ0035 PIC X(200).
      *    SCP Model code
       01  WQ0036 PIC X(3).
      *    SCP Model Version Code
       01  WQ0037 PIC X(12).
      *    Technical Equipment Code
       01  WQ0038 PIC X(7).
      *    Technical Equipment Value
       01  WQ0039 PIC X(200).
      *    *Synon (17,7) work field
       01  W0WD00 PIC S9(10)V9(7) COMP-3.
      *    SCP Model code
       01  WQ0040 PIC X(3).
      *    SCP Model Version Code
       01  WQ0041 PIC X(12).
      *    Technical Equipment Code
       01  WQ0042 PIC X(7).
      *    Technical Equipment Value
       01  WQ0043 PIC X(200).
      *    SCP Model code
       01  WQ0044 PIC X(3).
      *    SCP Model Version Code
       01  WQ0045 PIC X(12).
      *    Technical Equipment Code
       01  WQ0046 PIC X(7).
      *    Technical Equipment Value
       01  WQ0047 PIC X(200).
      *    SCP Model code
       01  WQ0048 PIC X(3).
      *    SCP Model Version Code
       01  WQ0049 PIC X(12).
      *    Technical Equipment Code
       01  WQ0050 PIC X(7).
      *    Technical Equipment Value
       01  WQ0051 PIC X(200).
      *    SCP Model code
       01  WQ0052 PIC X(3).
      *    SCP Model Version Code
       01  WQ0053 PIC X(12).
      *    Technical Equipment Code
       01  WQ0054 PIC X(7).
      *    Technical Equipment Value
       01  WQ0055 PIC X(200).
      *    SCP Model code
       01  WQ0056 PIC X(3).
      *    SCP Model Version Code
       01  WQ0057 PIC X(12).
      *    Technical Equipment Code
       01  WQ0058 PIC X(7).
      *    Technical Equipment Value
       01  WQ0059 PIC X(200).
      *    Define keylist
       01  KRSSB1.
      *    Dealer number (alpha)
           03  CODLRNBRX PIC X(6).
      *    Define keylist
       01  KRSSB1-TMP.
      *    Dealer number (alpha)
           03  CODLRNBRX PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSB1.
      *    Dealer number (alpha)
           03  CODLRNBRX PIC X(6).
      *..............................................................
      *    Outward parameters
       01  PCRC.
      *    RCD : STR - Dealer Database
      *    I : MAP Dealer number
      *    Dealer number
           03  PCDLRNBR PIC X(4).
      *    I : MAP Dealer number suffix
      *    Dealer number suffix
           03  PCDLRSFX PIC X(2).
      *    O : MAP Name Number
      *    Name Number
           03  PCNAMNBR PIC X(9).
      *    O : MAP Address Number
      *    Address Number
           03  PCADDNBR PIC X(7).
      *    O : MAP Dealer Network Type
      *    Dealer Network Type
           03  PCDLRNET PIC X(1).
      *    O : MAP Dealer Region Code
      *    Dealer Region Code
           03  PCREGCDE PIC X(2).
      *    O : MAP Dealer Zone code
      *    Dealer Zone code
           03  PCZONCDE PIC X(2).
      *    O : MAP Dealer Trading Name
      *    Dealer Trading Name
           03  PCDLRTRD PIC X(40).
      *    O : MAP Dealer Known By Name
      *    Dealer Known By Name
           03  PCDLKNNM PIC X(40).
      *    O : MAP Dealer Short Name
      *    Dealer Short Name
           03  PCDLRSHT PIC X(20).
      *    O : MAP Dealer Activity Start Dte
      *    Dealer Activity Start Dte
           03  PCACTSTR PIC S9(8) COMP-3.
      *    O : MAP Dealer Servicing End Date
      *    Dealer Servicing End Date
           03  PCDLSVED PIC S9(8) COMP-3.
      *    O : MAP Dealer Cancel Final Date
      *    Dealer Cancel Final Date
           03  PCCNLFNL PIC S9(8) COMP-3.
      *    O : MAP Dealer Set-up Date
      *    Dealer Set-up Date
           03  PCDLRSET PIC S9(8).
      *    O : MAP Dealer Change Date
      *    Dealer Change Date
           03  PCDLRCHG PIC S9(8).
      *    O : MAP Dealer Cancel Date
      *    Dealer Cancel Date
           03  PCCNLDTE PIC S9(8).
      *    O : MAP Dealer Financial Status
      *    Dealer Financial Status
           03  PCDLFNST PIC X(1).
      *    O : MAP Dealer Record Status
      *    Dealer Record Status
           03  PCDLRCST PIC X(1).
      *    O : MAP BIR Address Identifier
      *    BIR Address Identifier
           03  PCBIRADR PIC X(7).
      *    O : MAP Dealer Address Line#1
      *    Dealer Address Line#1
           03  PCADDL1 PIC X(35).
      *    O : MAP Dealer Address Line#2
      *    Dealer Address Line#2
           03  PCADDL2 PIC X(35).
      *    O : MAP Dealer Address Line#3
      *    Dealer Address Line#3
           03  PCADDL3 PIC X(35).
      *    O : MAP Dealer Address Line#4
      *    Dealer Address Line#4
           03  PCADDL4 PIC X(35).
      *    O : MAP Dealer Postal Code
      *    Dealer Postal Code
           03  PCDLRPCODE PIC X(9).
      *    O : MAP Dealer Town
      *    Dealer Town
           03  PCDLRTOWN PIC X(35).
      *    O : MAP Dealer Telephone Number
      *    Dealer Telephone Number
           03  PCDLRTELNO PIC X(14).
      *    O : MAP Dealer Fax Number
      *    Dealer Fax Number
           03  PCDLRFAXNO PIC X(14).
      *    O : MAP Dealer Country Identifier
      *    Dealer Country Identifier
           03  PCDLRCTY PIC X(3).
      *    O : MAP Network/Non Network Ind
      *    Network/Non Network Ind
           03  PCNETIND PIC X(1).
      *    O : MAP Dealer Number (Numeric)
      *    Dealer Number (Numeric)
           03  PCDLRNONUM PIC S9(5).
      *    O : MAP Lead Dealer Number
      *    Lead Dealer Number
           03  PCLEADNUM PIC X(4).
      *    O : MAP Lead Dealer Number Suffix
      *    Lead Dealer Number Suffix
           03  PCLEADSFX PIC X(2).
      *    O : MAP Lead Dealer Nbr (Numeric)
      *    Lead Dealer Nbr (Numeric)
           03  PCLEADNO PIC S9(5).
      *    O : MAP Lead Country Identifier
      *    Lead Country Identifier
           03  PCLEADCTY PIC X(3).
      *    O : MAP Dealer Spare Flag 1
      *    Dealer Spare Flag 1
           03  PCDLRFLAG1 PIC X(1).
      *    O : MAP Dealer Spare Flag 2
      *    Dealer Spare Flag 2
           03  PCDLRFLAG2 PIC X(1).
      *    O : MAP Dealer Spare Flag 3
      *    Dealer Spare Flag 3
           03  PCDLRFLAG3 PIC X(1).
      *    O : MAP Dealer Spare Code 1
      *    Dealer Spare Code 1
           03  PCDLRCODE1 PIC X(2).
      *    O : MAP Dealer Spare Code 2
      *    Dealer Spare Code 2
           03  PCDLRCODE2 PIC X(2).
      *    O : MAP Dealer Percentage 1
      *    Dealer Percentage 1
           03  PCDLRPCT1 PIC S9(4)V9(3) COMP-3.
      *    O : MAP Dealer Percentage 2
      *    Dealer Percentage 2
           03  PCDLRPCT2 PIC S9(4)V9(3) COMP-3.
      *    O : MAP Dealer Percentage 3
      *    Dealer Percentage 3
           03  PCDLRPCT3 PIC S9(4)V9(3) COMP-3.
      *    O : MAP Dealer Percentage 4
      *    Dealer Percentage 4
           03  PCDLRPCT4 PIC S9(4)V9(3) COMP-3.
      *
      *    *Return code
       01  WQ0060 PIC X(7).
      *    *Return code
       01  WQ0061 PIC X(7).
      *    *Return code
       01  WQ0062 PIC X(7).
      *    Colour Code
       01  WQ0063 PIC X(3).
      *    Colour Marketing Desc
       01  WQ0064 PIC X(40).
      *    Colour Type Code
       01  WQ0065 PIC X(2).
      *    Vehicle MVRIS Colour Code
       01  WQ0066 PIC X(1).
      *    Vehicle MVRIS Colour Cde2
       01  WQ0067 PIC X(1).
      *    Vehicle MVRIS Colour Cde3
       01  WQ0068 PIC X(1).
      *    Colour Type Category Code
       01  WQ0069 PIC X(2).
      *    Vehicle Database Rec Sts
       01  WQ0070 PIC X(1).
      *    *Return code
       01  WQ0071 PIC X(7).
      *    SEDRE Fuel Code
       01  WQ0072 PIC X(1).
      *    SEDRE Fuel Description
       01  WQ0073 PIC X(25).
      *    MVRIS Fuel Description
       01  WQ0074 PIC X(25).
      *    MVRIS Fuel Code
       01  WQ0075 PIC X(1).
      *    Option Code ATR 01
       01  WN0056 PIC X(6).
      *    Option Desc ATR 01
       01  WN0057 PIC X(100).
      *    Option Code ATR 02
       01  WN0058 PIC X(6).
      *    Option Desc ATR 02
       01  WN0059 PIC X(100).
      *    Option Code ATR 03
       01  WN0060 PIC X(6).
      *    Option Desc ATR 03
       01  WN0061 PIC X(100).
      *    Option Code ATR 04
       01  WN0062 PIC X(6).
      *    Option Desc ATR 04
       01  WN0063 PIC X(100).
      *    Option Code ATR 05
       01  WN0064 PIC X(6).
      *    Option Desc ATR 05
       01  WN0065 PIC X(100).
      *    Option Code ATR 06
       01  WN0066 PIC X(6).
      *    Option Desc ATR 06
       01  WN0067 PIC X(100).
      *    Option Code ATR 07
       01  WN0068 PIC X(6).
      *    Option Desc ATR 07
       01  WN0069 PIC X(100).
      *    Option Code ATR 08
       01  WN0070 PIC X(6).
      *    Option Desc ATR 08
       01  WN0071 PIC X(100).
      *    Option Code ATR 09
       01  WN0072 PIC X(6).
      *    Option Desc ATR 09
       01  WN0073 PIC X(100).
      *    Option Code ATR 10
       01  WN0074 PIC X(6).
      *    Option Desc ATR 10
       01  WN0075 PIC X(100).
      *    Option Code ATR 11
       01  WN0076 PIC X(6).
      *    Option Desc ATR 11
       01  WN0077 PIC X(100).
      *    Option Code ATR 12
       01  WN0078 PIC X(6).
      *    Option Desc ATR 12
       01  WN0079 PIC X(100).
      *    Option Code ATR 13
       01  WN0080 PIC X(6).
      *    Option Desc ATR 13
       01  WN0081 PIC X(100).
      *    Option Code ATR 14
       01  WN0082 PIC X(6).
      *    Option Desc ATR 14
       01  WN0083 PIC X(100).
      *    Option Code ATR 15
       01  WN0084 PIC X(6).
      *    Option Desc ATR 15
       01  WN0085 PIC X(100).
      *    Option Code ATR 16
       01  WN0086 PIC X(6).
      *    Option Desc ATR 16
       01  WN0087 PIC X(100).
      *    Option Code ATR 17
       01  WN0088 PIC X(6).
      *    Option Desc ATR 17
       01  WN0089 PIC X(100).
      *    Option Code ATR 18
       01  WN0090 PIC X(6).
      *    Option Desc ATR 18
       01  WN0091 PIC X(100).
      *    Option Code ATR 19
       01  WN0092 PIC X(6).
      *    Option Desc ATR 19
       01  WN0093 PIC X(100).
      *    Option Code ATR 20
       01  WN0094 PIC X(6).
      *    Option Desc ATR 20
       01  WN0095 PIC X(100).
      *    Option Code ATR 21
       01  WN0096 PIC X(6).
      *    Option Desc ATR 21
       01  WN0097 PIC X(100).
      *    Option Code ATR 22
       01  WN0098 PIC X(6).
      *    Option Desc ATR 22
       01  WN0099 PIC X(100).
      *    Option Code ATR 23
       01  WN0100 PIC X(6).
      *    Option Desc ATR 23
       01  WN0101 PIC X(100).
      *    Option Code ATR 24
       01  WN0102 PIC X(6).
      *    Option Desc ATR 24
       01  WN0103 PIC X(100).
      *    Option Code ATR 25
       01  WN0104 PIC X(6).
      *    Option Desc ATR 25
       01  WN0105 PIC X(100).
      *    Option Code ATR 26
       01  WN0106 PIC X(6).
      *    Option Desc ATR 26
       01  WN0107 PIC X(100).
      *    Option Code ATR 27
       01  WN0108 PIC X(6).
      *    Option Desc ATR 27
       01  WN0109 PIC X(100).
      *    Option Code ATR 28
       01  WN0110 PIC X(6).
      *    Option Desc ATR 28
       01  WN0111 PIC X(100).
      *    Option Code ATR 29
       01  WN0112 PIC X(6).
      *    Option Desc ATR 29
       01  WN0113 PIC X(100).
      *    Option Code ATR 30
       01  WN0114 PIC X(6).
      *    Option Desc ATR 30
       01  WN0115 PIC X(100).
      *    *Return code
       01  WQ0076 PIC X(7).
      *    SCP Model code
       01  WQ0077 PIC X(3).
      *    Option Type
       01  WQ0078 PIC X(1).
      *    SC Option code
       01  WQ0079 PIC X(6).
      *    Model option description
       01  WQ0080 PIC X(100).
      *    Vehicle Database Rec Sts
       01  WQ0081 PIC X(1).
       01  Y2LSTN PIC S9(7) COMP-3.
       01  W0INVL PIC X(25).
       01  W0VLMP PIC X(1).
       01  W0CNNM PIC X(25).
      *    Outward parameters
       01  PDRC.
      *    RCD : STR Customer Order Alloc  Retrieval index
      *    B : MAP CA Owning Account
      *    CA Owning Account
           03  PDCAOWNACC PIC X(6).
      *    B : MAP CA Customer Ord Number
      *    CA Customer Ord Number
           03  PDCACUSORN PIC X(6).
      *    B : MAP CA Invariant BCV
      *    CA Invariant BCV
           03  PDCAINVBCV PIC X(15).
      *    O : MAP CA Order Allocation SeqNb
      *    CA Order Allocation SeqNb
           03  PDCAORALSQ PIC S9(3) COMP-3.
      *    B : MAP CA VIN
      *    CA VIN
           03  PDCAVIN PIC X(17).
      *    O : MAP CA Provisional Chass Flag
      *    CA Provisional Chass Flag
           03  PDCAPROCHS PIC X(1).
      *    O : MAP CA Registering Account
      *    CA Registering Account
           03  PDCAREGACC PIC X(6).
      *    O : MAP CA Secondary Network Acc
      *    CA Secondary Network Acc
           03  PDCASECACC PIC X(6).
      *    O : MAP CA SEDRE last message upd
      *    CA SEDRE last message upd
           03  PDCALSTMSG PIC X(3).
      *    O : MAP CA Dealer Order Number
      *    CA Dealer Order Number
           03  PDCADLORNB PIC X(6).
      *    O : MAP CA Order Type code
      *    CA Order Type code
           03  PDCAORTPCD PIC X(1).
      *    O : MAP CA Order Type(Central)
      *    CA Order Type(Central)
           03  PDCAORTPCN PIC X(2).
      *    O : MAP CA Order Type(Local)
      *    CA Order Type(Local)
           03  PDCAORTPLO PIC X(2).
      *    O : MAP CA SEDRE Customer Type
      *    CA SEDRE Customer Type
           03  PDCACSTTYP PIC X(1).
      *    O : MAP CA SD Order Status Code
      *    CA SD Order Status Code
           03  PDCASDORST PIC X(4).
      *    O : MAP CA SCP Model Code
      *    CA SCP Model Code
           03  PDCASCMDLC PIC X(3).
      *    O : MAP CA Model Phase
      *    CA Model Phase
           03  PDCAPHASE PIC X(1).
      *    O : MAP CA SCP Model Version Code
      *    CA SCP Model Version Code
           03  PDCASCMDVR PIC X(12).
      *    O : MAP CA Colour Code
      *    CA Colour Code
           03  PDCACLRCDE PIC X(3).
      *    O : MAP CA SCP Trim Type
      *    CA SCP Trim Type
           03  PDCASCTRTP PIC X(6).
      *    O : MAP CA Reg.Number
      *    CA Reg.Number
           03  PDCARGNNBR PIC X(7).
      *    O : MAP CA Cus Ord Allocation Dte
      *    CA Cus Ord Allocation Dte
           03  PDCAORALDT PIC S9(8) COMP-3.
      *    O : MAP CA Cus Ord Dealloc Dte
      *    CA Cus Ord Dealloc Dte
           03  PDCAORDLDT PIC S9(8) COMP-3.
      *    O : MAP CA Dealer Order Cancel Da
      *    CA Dealer Order Cancel Da
           03  PDCADLORCD PIC S9(8) COMP-3.
      *    O : MAP CA Cust Delivery Cancel D
      *    CA Cust Delivery Cancel D
           03  PDCACUDLCD PIC S9(8) COMP-3.
      *    O : MAP CA Registration Date 58
      *    CA Registration Date 58
           03  PDCARGDT58 PIC S9(8) COMP-3.
      *    O : MAP CA Registration Date 60
      *    CA Registration Date 60
           03  PDCARGDT60 PIC S9(8) COMP-3.
      *    O : MAP CA Date of Resale (SEDRE)
      *    CA Date of Resale (SEDRE)
           03  PDCARESDTE PIC S9(8) COMP-3.
      *    O : MAP CA Cust Order Alloc Sts
      *    CA Cust Order Alloc Sts
           03  PDCACOALST PIC X(1).
      *
      *    Outward parameters
       01  PERC.
      *    RCD : STR Customer Order        Retrieval index
      *    O : MAP CO Customer Order Date #
      *    CO Customer Order Date #
           03  PECOCORDD8 PIC S9(8) COMP-3.
      *    O : MAP CO Owning A/C Maille
      *    CO Owning A/C Maille
           03  PECOMAILLE PIC X(5).
      *    O : MAP CO Owning A/C Category
      *    CO Owning A/C Category
           03  PECOACCTG PIC X(2).
      *    O : MAP CO Sales Channel
      *    CO Sales Channel
           03  PECOSLSCNL PIC X(2).
      *    O : MAP CO cust type P/S-derived
      *    CO cust type P/S-derived
           03  PECOSICSTY PIC X(1).
      *    O : MAP CO OLD DVLA Flag
      *    CO OLD DVLA Flag
           03  PECODVLAFG PIC X(1).
      *    O : MAP CO Last Msg Sending Code
      *    CO Last Msg Sending Code
           03  PECOLSTEVT PIC X(8).
      *    O : MAP CO APL Code
      *    CO APL Code
           03  PECODAPL PIC X(6).
      *    O : MAP CO Colour Short Descr
      *    CO Colour Short Descr
           03  PECOBDYCLR PIC X(6).
      *    O : MAP CO SCP Options
      *    CO SCP Options
           03  PECOOPTSCP PIC X(120).
      *    O : MAP CO SCP Trim Colour
      *    CO SCP Trim Colour
           03  PECOTCLSCP PIC X(6).
      *    O : MAP CO Cust Desired Deliv Dte
      *    CO Cust Desired Deliv Dte
           03  PECOCUDDDT PIC S9(8) COMP-3.
      *    O : MAP CO Type VP/VU
      *    CO Type VP/VU
           03  PECOIDGENR PIC X(1).
      *    O : MAP CO Vehicle Fuel Code
      *    CO Vehicle Fuel Code
           03  PECOFTFUEL PIC X(1).
      *    O : MAP CO Order Changed Date
      *    CO Order Changed Date
           03  PECOORCHDT PIC S9(8) COMP-3.
      *    O : MAP CO Order Cancelled Date
      *    CO Order Cancelled Date
           03  PECOORCNDT PIC S9(8) COMP-3.
      *    O : MAP CO Order Cancellation Rsn
      *    CO Order Cancellation Rsn
           03  PECOORCNRS PIC X(4).
      *    O : MAP CO Salesperson Code
      *    CO Salesperson Code
           03  PECOSLPERC PIC X(13).
      *    O : MAP CO Fleet Operator Number
      *    CO Fleet Operator Number
           03  PECOFLOPNO PIC X(5).
      *    O : MAP CO SEDRE Customer Code
      *    CO SEDRE Customer Code
           03  PECOCUSCDE PIC X(6).
      *    O : MAP CO Surname/Company name
      *    CO Surname/Company name
           03  PECOCUSNAM PIC X(108).
      *    O : MAP CO Customer Forename
      *    CO Customer Forename
           03  PECOCUSFNM PIC X(25).
      *    O : MAP CO Initials
      *    CO Initials
           03  PECOINTLS PIC X(3).
      *    O : MAP CO Title Code
      *    CO Title Code
           03  PECOTTLCDE PIC X(4).
      *    O : MAP CO Address L1
      *    CO Address L1
           03  PECOADDRL1 PIC X(50).
      *    O : MAP CO Address L2
      *    CO Address L2
           03  PECOADDRL2 PIC X(40).
      *    O : MAP CO Address L3
      *    CO Address L3
           03  PECOADDRL3 PIC X(40).
      *    O : MAP CO Address Town (40)
      *    CO Address Town (40)
           03  PECOADDTWN PIC X(40).
      *    O : MAP CO Postcode
      *    CO Postcode
           03  PECOPFPCDE PIC X(8).
      *    O : MAP CO Gender
      *    CO Gender
           03  PECOSEXID PIC X(1).
      *    O : MAP CO Customer Date of Birth
      *    CO Customer Date of Birth
           03  PECOCUSDOB PIC S9(8) COMP-3.
      *    O : MAP CO Cust. day phone code
      *    CO Cust. day phone code
           03  PECODAYPHC PIC X(6).
      *    O : MAP CO Cust. day phone nbr
      *    CO Cust. day phone nbr
           03  PECODAYPHN PIC X(10).
      *    O : MAP CO Cust. eve phone code
      *    CO Cust. eve phone code
           03  PECOEVEPHC PIC X(6).
      *    O : MAP CO Cust. eve phone nbr
      *    CO Cust. eve phone nbr
           03  PECOEVEPHN PIC X(10).
      *    O : MAP CO Cust. mobile phone cde
      *    CO Cust. mobile phone cde
           03  PECOMOBCD PIC X(6).
      *    O : MAP CO Cust. mobile phone nbr
      *    CO Cust. mobile phone nbr
           03  PECOMOBNBR PIC X(10).
      *    O : MAP CO Cust. fax phone code
      *    CO Cust. fax phone code
           03  PECOFAXPHC PIC X(6).
      *    O : MAP CO Cust. fax phone nbr
      *    CO Cust. fax phone nbr
           03  PECOFAXPHN PIC X(10).
      *    O : MAP CO E-Mail Address
      *    CO E-Mail Address
           03  PECOEMAIL PIC X(100).
      *    O : MAP CO Annual Mileage
      *    CO Annual Mileage
           03  PECOANNMIL PIC S9(7).
      *    O : MAP CO OK to Mail?
      *    CO OK to Mail?
           03  PECOMAILOK PIC X(1).
      *    O : MAP CO OK to phone?
      *    CO OK to phone?
           03  PECOTELOK PIC X(1).
      *    O : MAP CO OK to email?
      *    CO OK to email?
           03  PECOEMLOK PIC X(1).
      *    O : MAP CO OK to text ?
      *    CO OK to text ?
           03  PECOTXTOK PIC X(1).
      *    O : MAP CO OK to fax?
      *    CO OK to fax?
           03  PECOFAXOK PIC X(1).
      *    O : MAP CO Share mail data?
      *    CO Share mail data?
           03  PECOSHRML PIC X(1).
      *    O : MAP CO Share email data?
      *    CO Share email data?
           03  PECOSHREML PIC X(1).
      *    O : MAP CO Profession
      *    CO Profession
           03  PECOPRFCDE PIC X(4).
      *    O : MAP CO Job Function
      *    CO Job Function
           03  PECOJOBCDE PIC X(4).
      *    O : MAP CO Customer Business Type
      *    CO Customer Business Type
           03  PECOBUSTYP PIC X(10).
      *    O : MAP CO Customer VAT Number
      *    CO Customer VAT Number
           03  PECOVATNBR PIC X(20).
      *    O : MAP CO VED Exempt Certificate
      *    CO VED Exempt Certificate
           03  PECOVDEXMC PIC X(7).
      *    O : MAP CO VED Exempt Expiry Date
      *    CO VED Exempt Expiry Date
           03  PECOVEDXMD PIC S9(8) COMP-3.
      *    O : MAP CO Social Security Number
      *    CO Social Security Number
           03  PECOSSECNB PIC X(9).
      *    O : MAP CO DVLA Fleet Number
      *    CO DVLA Fleet Number
           03  PECODVLFLT PIC X(6).
      *    O : MAP CO Part Ex-change Flag
      *    CO Part Ex-change Flag
           03  PECOPEXFLG PIC X(1).
      *    O : MAP CO Current Vehicle Model
      *    CO Current Vehicle Model
           03  PECOCUVEMD PIC X(4).
      *    O : MAP CO Current Vehicle Reg Nb
      *    CO Current Vehicle Reg Nb
           03  PECOCUVERG PIC X(8).
      *    O : MAP CO Part-Ex Veh Mileage
      *    CO Part-Ex Veh Mileage
           03  PECOPXMIL PIC S9(7).
      *    O : MAP CO Finance Period (Mnths)
      *    CO Finance Period (Mnths)
           03  PECOFNCPRD PIC S9(3) COMP-3.
      *    O : MAP CO No. Renaults Owned
      *    CO No. Renaults Owned
           03  PECORENOWN PIC S9(3).
      *    O : MAP CO No. Vehs in Household
      *    CO No. Vehs in Household
           03  PECOVEHSHH PIC S9(3).
      *    O : MAP CO Planned Retention Per
      *    CO Planned Retention Per
           03  PECOPLRTPR PIC S9(2).
      *    O : MAP CO Insurance Renewal Dat#
      *    CO Insurance Renewal Dat#
           03  PECOINRNDT PIC S9(8) COMP-3.
      *    O : MAP CO Paymemt/Finance Type
      *    CO Paymemt/Finance Type
           03  PECOFINTYP PIC X(3).
      *    O : MAP CO V55 Requested?
      *    CO V55 Requested?
           03  PECOV55REQ PIC X(1).
      *    O : MAP CO Offer Code 1
      *    CO Offer Code 1
           03  PECOOFFCD1 PIC X(4).
      *    O : MAP CO Offer Code 2
      *    CO Offer Code 2
           03  PECOOFFCD2 PIC X(4).
      *    O : MAP CO Prospect Lead Id
      *    CO Prospect Lead Id
           03  PECOPRLDID PIC X(10).
      *    O : MAP CO Customer Order Comment
      *    CO Customer Order Comment
           03  PECOCORCOM PIC X(50).
      *    O : MAP CO Customer Ref/P.O. Numb
      *    CO Customer Ref/P.O. Numb
           03  PECOCUSTPO PIC X(20).
      *    O : MAP CO Special Deal Id
      *    CO Special Deal Id
           03  PECOSPDEAL PIC X(1).
      *    O : MAP CO Fleet PCN
      *    CO Fleet PCN
           03  PECOFLTPCN PIC X(5).
      *    O : MAP CO Date of 1st Alloc
      *    CO Date of 1st Alloc
           03  PECO1STALC PIC S9(8) COMP-3.
      *    O : MAP CO Date of Last DeAlloc
      *    CO Date of Last DeAlloc
           03  PECOLSDALC PIC S9(8) COMP-3.
      *    O : MAP CO Buy/Lease Flag
      *    CO Buy/Lease Flag
           03  PECOSTS1 PIC X(1).
      *    O : MAP CO Spare Status 2
      *    CO Spare Status 2
           03  PECOSTS2 PIC X(1).
      *    O : MAP CO Spare Status 3
      *    CO Spare Status 3
           03  PECOSTS3 PIC X(1).
      *    O : MAP CO MR Contract date
      *    CO MR Contract date
           03  PECODAT1 PIC S9(8) COMP-3.
      *    O : MAP CO Spare Date 2
      *    CO Spare Date 2
           03  PECODAT2 PIC S9(8) COMP-3.
      *    O : MAP CO MR Contract number
      *    CO MR Contract number
           03  PECOCDE1 PIC X(6).
      *    O : MAP CO Spare Code 2
      *    CO Spare Code 2
           03  PECOCDE2 PIC X(6).
      *    O : MAP CO Spare Code 3
      *    CO Spare Code 3
           03  PECOCDE3 PIC X(6).
      *    O : MAP CO Agreement (DEFIPRO) No
      *    CO Agreement (DEFIPRO) No
           03  PECOTXT1 PIC X(20).
      *    O : MAP CO Spare Text 2
      *    CO Spare Text 2
           03  PECOTXT2 PIC X(20).
      *    O : MAP CO Spare Sts 4
      *    CO Spare Sts 4
           03  PECOSTS4 PIC X(1).
      *    O : MAP CO FM Fleet Acc Code
      *    CO FM Fleet Acc Code
           03  PECOFMFLCD PIC X(10).
      *    O : MAP CO FM Agreement No (FON)
      *    CO FM Agreement No (FON)
           03  PECOFMAGNB PIC X(10).
      *    O : MAP CO FM Agreement Vers No
      *    CO FM Agreement Vers No
           03  PECOFMAGVN PIC X(2).
      *
      *    *Return code
       01  WQ0082 PIC X(7).
      *    Retrieve by
       01  WQ0083 PIC X(1).
      *    Vehicle Chassis No
       01  WQ0084 PIC X(14).
      *    Cust Ord Alloc Exists
       01  WQ0085 PIC X(1).
      *    Define keylist
       01  KRSSB2.
      *    VIN
           03  J6VIN PIC X(17).
      *    Define keylist
       01  KRSSB2-TMP.
      *    VIN
           03  J6VIN PIC X(17).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSB2.
      *    VIN
           03  J6VIN PIC X(17).
      *..............................................................
      *    *Return code
       01  WQ0086 PIC X(7).
      *    *Return code
       01  WQ0087 PIC X(7).
      *    Colour Code
       01  WQ0088 PIC X(3).
      *    Colour Marketing Desc
       01  WQ0089 PIC X(40).
      *    Colour Type Code
       01  WQ0090 PIC X(2).
      *    Vehicle MVRIS Colour Code
       01  WQ0091 PIC X(1).
      *    Vehicle MVRIS Colour Cde2
       01  WQ0092 PIC X(1).
      *    Vehicle MVRIS Colour Cde3
       01  WQ0093 PIC X(1).
      *    Colour Type Category Code
       01  WQ0094 PIC X(2).
      *    Vehicle Database Rec Sts
       01  WQ0095 PIC X(1).
      *    Outward parameters
       01  PFRC.
      *    RCD : STR: VP Price Parm out v2
      *    O : MAP VP Option Price 1
      *    VP Option Price 1
           03  PFVPOPTP1 PIC S9(9)V9(2) COMP-3.
      *    O : MAP VP Option Price 2
      *    VP Option Price 2
           03  PFVPOPTP2 PIC S9(9)V9(2) COMP-3.
      *    O : MAP VP Option Price 3
      *    VP Option Price 3
           03  PFVPOPTP3 PIC S9(9)V9(2) COMP-3.
      *    O : MAP VP Option Price 4
      *    VP Option Price 4
           03  PFVPOPTP4 PIC S9(9)V9(2) COMP-3.
      *    O : MAP VP Option Price 5
      *    VP Option Price 5
           03  PFVPOPTP5 PIC S9(9)V9(2) COMP-3.
      *    O : MAP VP Option Price 6
      *    VP Option Price 6
           03  PFVPOPTP6 PIC S9(9)V9(2) COMP-3.
      *    O : MAP VP Option Price 7
      *    VP Option Price 7
           03  PFVPOPTP7 PIC S9(9)V9(2) COMP-3.
      *    O : MAP VP Option Price 8
      *    VP Option Price 8
           03  PFVPOPTP8 PIC S9(9)V9(2) COMP-3.
      *    O : MAP VP Option Price 9
      *    VP Option Price 9
           03  PFVPOPTP9 PIC S9(9)V9(2) COMP-3.
      *    O : MAP VP Option Price 10
      *    VP Option Price 10
           03  PFVPOPTP10 PIC S9(9)V9(2) COMP-3.
      *    O : MAP VP Option Price 11
      *    VP Option Price 11
           03  PFVPOPTP11 PIC S9(9)V9(2) COMP-3.
      *    O : MAP VP Option Price 12
      *    VP Option Price 12
           03  PFVPOPTP12 PIC S9(9)V9(2) COMP-3.
      *    O : MAP VP Option Price 13
      *    VP Option Price 13
           03  PFVPOPTP13 PIC S9(9)V9(2) COMP-3.
      *    O : MAP VP Option Price 14
      *    VP Option Price 14
           03  PFVPOPTP14 PIC S9(9)V9(2) COMP-3.
      *    O : MAP VP Option Price 15
      *    VP Option Price 15
           03  PFVPOPTP15 PIC S9(9)V9(2) COMP-3.
      *    O : MAP VP Option Price 16
      *    VP Option Price 16
           03  PFVPOPTP16 PIC S9(9)V9(2) COMP-3.
      *    O : MAP VP Option Price 17
      *    VP Option Price 17
           03  PFVPOPTP17 PIC S9(9)V9(2) COMP-3.
      *    O : MAP VP Option Price 18
      *    VP Option Price 18
           03  PFVPOPTP18 PIC S9(9)V9(2) COMP-3.
      *    O : MAP VP Option Price 19
      *    VP Option Price 19
           03  PFVPOPTP19 PIC S9(9)V9(2) COMP-3.
      *    O : MAP VP Option Price 20
      *    VP Option Price 20
           03  PFVPOPTP20 PIC S9(9)V9(2) COMP-3.
      *    O : MAP VP Option Price 21
      *    VP Option Price 21
           03  PFVPOPTP21 PIC S9(9)V9(2) COMP-3.
      *    O : MAP VP Option Price 22
      *    VP Option Price 22
           03  PFVPOPTP22 PIC S9(9)V9(2) COMP-3.
      *    O : MAP VP Option Price 23
      *    VP Option Price 23
           03  PFVPOPTP23 PIC S9(9)V9(2) COMP-3.
      *    O : MAP VP Option Price 24
      *    VP Option Price 24
           03  PFVPOPTP24 PIC S9(9)V9(2) COMP-3.
      *    O : MAP VP Option Price 25
      *    VP Option Price 25
           03  PFVPOPTP25 PIC S9(9)V9(2) COMP-3.
      *    O : MAP VP Option Price 26
      *    VP Option Price 26
           03  PFVPOPTP26 PIC S9(9)V9(2) COMP-3.
      *    O : MAP VP Option Price 27
      *    VP Option Price 27
           03  PFVPOPTP27 PIC S9(9)V9(2) COMP-3.
      *    O : MAP VP Option Price 28
      *    VP Option Price 28
           03  PFVPOPTP28 PIC S9(9)V9(2) COMP-3.
      *    O : MAP VP Option Price 29
      *    VP Option Price 29
           03  PFVPOPTP29 PIC S9(9)V9(2) COMP-3.
      *    O : MAP VP Option Price 30
      *    VP Option Price 30
           03  PFVPOPTP30 PIC S9(9)V9(2) COMP-3.
      *    O : MAP Vehicle Margin Value
      *    Vehicle Margin Value
           03  PFVEHMARGN PIC S9(9)V9(2) COMP-3.
      *    O : MAP VP Option Margin 1
      *    VP Option Margin 1
           03  PFVPOPM1 PIC S9(7)V9(2) COMP-3.
      *    O : MAP VP Option Margin 2
      *    VP Option Margin 2
           03  PFVPOPM2 PIC S9(7)V9(2) COMP-3.
      *    O : MAP VP Option Margin 3
      *    VP Option Margin 3
           03  PFVPOPM3 PIC S9(7)V9(2) COMP-3.
      *    O : MAP VP Option Margin 4
      *    VP Option Margin 4
           03  PFVPOPTMG PIC S9(7)V9(2) COMP-3.
      *    O : MAP VP Option Margin 5
      *    VP Option Margin 5
           03  PFVPOPTM5 PIC S9(7)V9(2) COMP-3.
      *    O : MAP VP Option Margin 6
      *    VP Option Margin 6
           03  PFVPOPTM6 PIC S9(7)V9(2) COMP-3.
      *    O : MAP VP Option Margin 7
      *    VP Option Margin 7
           03  PFVPOPTM7 PIC S9(7)V9(2) COMP-3.
      *    O : MAP VP Option Margin 8
      *    VP Option Margin 8
           03  PFVPOPTM8 PIC S9(7)V9(2) COMP-3.
      *    O : MAP VP Option Margin 9
      *    VP Option Margin 9
           03  PFVPOPTM9 PIC S9(7)V9(2) COMP-3.
      *    O : MAP VP Option Margin 10
      *    VP Option Margin 10
           03  PFVPOPTM10 PIC S9(7)V9(2) COMP-3.
      *    O : MAP VP Option Margin 11
      *    VP Option Margin 11
           03  PFVPOPTM11 PIC S9(7)V9(2) COMP-3.
      *    O : MAP VP Option Margin 12
      *    VP Option Margin 12
           03  PFVPOPTM12 PIC S9(7)V9(2) COMP-3.
      *    O : MAP VP Option Margin 13
      *    VP Option Margin 13
           03  PFVPOPTM13 PIC S9(7)V9(2) COMP-3.
      *    O : MAP VP Option Margin 14
      *    VP Option Margin 14
           03  PFVPOPTM14 PIC S9(7)V9(2) COMP-3.
      *    O : MAP VP Option Margin 15
      *    VP Option Margin 15
           03  PFVPOPTM15 PIC S9(7)V9(2) COMP-3.
      *    O : MAP VP Option Margin 16
      *    VP Option Margin 16
           03  PFVPOPTM16 PIC S9(7)V9(2) COMP-3.
      *    O : MAP VP Option Margin 17
      *    VP Option Margin 17
           03  PFVPOPTM17 PIC S9(7)V9(2) COMP-3.
      *    O : MAP VP Option Margin 18
      *    VP Option Margin 18
           03  PFVPOPTM18 PIC S9(7)V9(2) COMP-3.
      *    O : MAP VP Option Margin 19
      *    VP Option Margin 19
           03  PFVPOPTM19 PIC S9(7)V9(2) COMP-3.
      *    O : MAP VP Option Margin 20
      *    VP Option Margin 20
           03  PFVPOPTM20 PIC S9(7)V9(2) COMP-3.
      *    O : MAP VP Option Margin 21
      *    VP Option Margin 21
           03  PFVPOPTM21 PIC S9(7)V9(2) COMP-3.
      *    O : MAP VP Option Margin 22
      *    VP Option Margin 22
           03  PFVPOPTM22 PIC S9(7)V9(2) COMP-3.
      *    O : MAP VP Option Margin 23
      *    VP Option Margin 23
           03  PFVPOPTM23 PIC S9(7)V9(2) COMP-3.
      *    O : MAP VP Option Margin 24
      *    VP Option Margin 24
           03  PFVPOPTM24 PIC S9(7)V9(2) COMP-3.
      *    O : MAP VP Option Margin 25
      *    VP Option Margin 25
           03  PFVPOPTM25 PIC S9(7)V9(2) COMP-3.
      *    O : MAP VP Option Margin 26
      *    VP Option Margin 26
           03  PFVPOPTM26 PIC S9(7)V9(2) COMP-3.
      *    O : MAP VP Option Margin 27
      *    VP Option Margin 27
           03  PFVPOPTM27 PIC S9(7)V9(2) COMP-3.
      *    O : MAP Option Margin 28
      *    Option Margin 28
           03  PFVPOPTM28 PIC S9(7)V9(2) COMP-3.
      *    O : MAP VP Option Margin 29
      *    VP Option Margin 29
           03  PFVPOPTM29 PIC S9(7)V9(2) COMP-3.
      *    O : MAP VP Option Margin 30
      *    VP Option Margin 30
           03  PFVPOPTM30 PIC S9(7)V9(2) COMP-3.
      *    O : MAP Colour Margin
      *    Colour Margin
           03  PFVPCOLMGN PIC S9(7)V9(2) COMP-3.
      *    O : MAP Trim Margin
      *    Trim Margin
           03  PFVPTRMMGN PIC S9(7)V9(2) COMP-3.
      *    O : MAP V.A.T rate
      *    V.A.T rate
           03  PFVATRATE PIC S9(3)V9(4) COMP-3.
      *    O : MAP SC Option Code 1
      *    SC Option Code 1
           03  PFSCOPT1 PIC X(6).
      *    O : MAP SC Option Code 2
      *    SC Option Code 2
           03  PFSCOPT2 PIC X(6).
      *    O : MAP SC Option Code 3
      *    SC Option Code 3
           03  PFSCOPT3 PIC X(6).
      *    O : MAP SC Option Code 4
      *    SC Option Code 4
           03  PFSCOPT4 PIC X(6).
      *    O : MAP SC Option Code 5
      *    SC Option Code 5
           03  PFSCOPT5 PIC X(6).
      *    O : MAP SC Option Code 6
      *    SC Option Code 6
           03  PFSCOPT6 PIC X(6).
      *    O : MAP SC Option Code 7
      *    SC Option Code 7
           03  PFSCOPT7 PIC X(6).
      *    O : MAP SC Option Code 8
      *    SC Option Code 8
           03  PFSCOPT8 PIC X(6).
      *    O : MAP SC Option Code 9
      *    SC Option Code 9
           03  PFSCOPT9 PIC X(6).
      *    O : MAP SC Option Code 10
      *    SC Option Code 10
           03  PFSCOPT10 PIC X(6).
      *    O : MAP SC Option Code 11
      *    SC Option Code 11
           03  PFSCOPT11 PIC X(6).
      *    O : MAP SC Option Code 12
      *    SC Option Code 12
           03  PFSCOPT12 PIC X(6).
      *    O : MAP SC Option Code 13
      *    SC Option Code 13
           03  PFSCOPT13 PIC X(6).
      *    O : MAP SC Option Code 14
      *    SC Option Code 14
           03  PFSCOPT14 PIC X(6).
      *    O : MAP SC Option Code 15
      *    SC Option Code 15
           03  PFSCOPT15 PIC X(6).
      *    O : MAP SC Option Code 16
      *    SC Option Code 16
           03  PFSCOPT16 PIC X(6).
      *    O : MAP SC Option Code 17
      *    SC Option Code 17
           03  PFSCOPT17 PIC X(6).
      *    O : MAP SC Option Code 18
      *    SC Option Code 18
           03  PFSCOPT18 PIC X(6).
      *    O : MAP SC Option Code 19
      *    SC Option Code 19
           03  PFSCOPT19 PIC X(6).
      *    O : MAP SC Option Code 20
      *    SC Option Code 20
           03  PFSCOPT20 PIC X(6).
      *    O : MAP SC Option Code 21
      *    SC Option Code 21
           03  PFSCOPT21 PIC X(6).
      *    O : MAP SC Option Code 22
      *    SC Option Code 22
           03  PFSCOPT22 PIC X(6).
      *    O : MAP SC Option Code 23
      *    SC Option Code 23
           03  PFSCOPT23 PIC X(6).
      *    O : MAP SC Option Code 24
      *    SC Option Code 24
           03  PFSCOPT24 PIC X(6).
      *    O : MAP SC Option Code 25
      *    SC Option Code 25
           03  PFSCOPT25 PIC X(6).
      *    O : MAP SC Option Code 26
      *    SC Option Code 26
           03  PFSCOPT26 PIC X(6).
      *    O : MAP SC Option Code 27
      *    SC Option Code 27
           03  PFSCOPT27 PIC X(6).
      *    O : MAP SC Option Code 28
      *    SC Option Code 28
           03  PFSCOPT28 PIC X(6).
      *    O : MAP SC Option Code 29
      *    SC Option Code 29
           03  PFSCOPT29 PIC X(6).
      *    O : MAP SC Option Code 30
      *    SC Option Code 30
           03  PFSCOPT30 PIC X(6).
      *    O : MAP Error/Info Text
      *    Error/Info Text
           03  PFERRTXT PIC X(40).
      *    O : MAP U:Vehicle Pricing Status
      *    U:Vehicle Pricing Status
           03  PFVPSTS PIC X(4).
      *    O : MAP U:Option Pricing Status
      *    U:Option Pricing Status
           03  PFOPTPRCST PIC X(1).
      *
      *    Price Effective Date
       01  WQ0096 PIC S9(8) COMP-3.
      *    VIN
       01  WQ0097 PIC X(17).
      *    NV Basic Selling Price
       01  WQ0098 PIC S9(5)V9(2) COMP-3.
      *    NV Colour Price
       01  WQ0099 PIC S9(5)V9(2) COMP-3.
      *    NV Upholstery Price
       01  WQ0100 PIC S9(5)V9(2) COMP-3.
      *    NV Options Total Price
       01  WQ0101 PIC S9(5)V9(2) COMP-3.
      *    NV Sub-total 1
       01  WQ0102 PIC S9(5)V9(2) COMP-3.
      *    NV Dealer Margin
       01  WQ0103 PIC S9(5)V9(2) COMP-3.
      *    NV Sub-total 2
       01  WQ0104 PIC S9(5)V9(2) COMP-3.
      *    NV Other Vatable Charges
       01  WQ0105 PIC S9(5)V9(2) COMP-3.
      *    NV Sub-total 3
       01  WQ0106 PIC S9(5)V9(2) COMP-3.
      *    NV Accessory Retail Tot
       01  WQ0107 PIC S9(5)V9(2) COMP-3.
      *    NV Accessory Discount Tot
       01  WQ0108 PIC S9(5)V9(2) COMP-3.
      *    NV Accessory Net Total
       01  WQ0109 PIC S9(5)V9(2) COMP-3.
      *    NV Sub-Total 4
       01  WQ0110 PIC S9(5)V9(2) COMP-3.
      *    NV Other Vatable Discount
       01  WQ0111 PIC S9(5)V9(2) COMP-3.
      *    NV Sub-Total 5
       01  WQ0112 PIC S9(5)V9(2) COMP-3.
      *    NV VAT Amount
       01  WQ0113 PIC S9(5)V9(2) COMP-3.
      *    NV Non-vatable Charges
       01  WQ0114 PIC S9(5)V9(2) COMP-3.
      *    NV Non-vatable Discount
       01  WQ0115 PIC S9(5)V9(2) COMP-3.
      *    NV Total Amount
       01  WQ0116 PIC S9(5)V9(2) COMP-3.
      *    Options Total Margin
       01  WQ0117 PIC S9(9)V9(2) COMP-3.
      *    *Synon (17,7) work field
       01  W0WD01 PIC S9(10)V9(7) COMP-3.
      *    *Synon (17,7) work field
       01  W0WD02 PIC S9(10)V9(7) COMP-3.
      *    Define keylist
       01  KRSSB3.
      *    SCP Model code
           03  RCSCMDLCDE PIC X(3).
      *    Phase
           03  RCO2ST PIC X(1).
      *    SCP Model Version Code
           03  RCSCVERCDE PIC X(12).
      *    Define keylist
       01  KRSSB3-TMP.
      *    SCP Model code
           03  RCSCMDLCDE PIC X(3).
      *    Phase
           03  RCO2ST PIC X(1).
      *    SCP Model Version Code
           03  RCSCVERCDE PIC X(12).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSB3.
      *    SCP Model code
           03  RCSCMDLCDE PIC X(3).
      *    Phase
           03  RCO2ST PIC X(1).
      *    SCP Model Version Code
           03  RCSCVERCDE PIC X(12).
      *    Price Start Date - Dealer
           03  RCPRCDTDLR PIC S9(8) COMP-3.
      *..............................................................
      *    *Synon (17,7) work field
       01  W0WD03 PIC S9(10)V9(7) COMP-3.
      *    Define keylist
       01  KRSSB4.
      *    SCP Model code
           03  CMSCMDLCDE PIC X(3).
      *    Phase
           03  CMO2ST PIC X(1).
      *    Define keylist
       01  KRSSB4-TMP.
      *    SCP Model code
           03  CMSCMDLCDE PIC X(3).
      *    Phase
           03  CMO2ST PIC X(1).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSB4.
      *    SCP Model code
           03  CMSCMDLCDE PIC X(3).
      *    Phase
           03  CMO2ST PIC X(1).
      *..............................................................
      *    Category
       01  WN0116 PIC X(1).
      *    SCR Trim Colour (12)
       01  WN0117 PIC X(12).
      *    SCR Trim Type (12)
       01  WN0118 PIC X(12).
      *    Define keylist
       01  KRSSB5.
      *    SCP Model code
           03  BBSCMDLCDE PIC X(3).
      *    Phase
           03  BBO2ST PIC X(1).
      *    SCP Model Version Code
           03  BBSCVERCDE PIC X(12).
      *    Colour Code
           03  BBCLRCDE PIC X(3).
      *    Category
           03  BBCAT PIC X(1).
      *    Define keylist
       01  KRSSB5-TMP.
      *    SCP Model code
           03  BBSCMDLCDE PIC X(3).
      *    Phase
           03  BBO2ST PIC X(1).
      *    SCP Model Version Code
           03  BBSCVERCDE PIC X(12).
      *    Colour Code
           03  BBCLRCDE PIC X(3).
      *    Category
           03  BBCAT PIC X(1).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSB5.
      *    SCP Model code
           03  BBSCMDLCDE PIC X(3).
      *    Phase
           03  BBO2ST PIC X(1).
      *    SCP Model Version Code
           03  BBSCVERCDE PIC X(12).
      *    Colour Code
           03  BBCLRCDE PIC X(3).
      *    Category
           03  BBCAT PIC X(1).
      *..............................................................
      *    Define keylist
       01  KRSSB6.
      *    SCP Model code
           03  BBSCMDLCDE PIC X(3).
      *    Phase
           03  BBO2ST PIC X(1).
      *    SCP Model Version Code
           03  BBSCVERCDE PIC X(12).
      *    Colour Code
           03  BBCLRCDE PIC X(3).
      *    Category
           03  BBCAT PIC X(1).
      *    Define keylist
       01  KRSSB6-TMP.
      *    SCP Model code
           03  BBSCMDLCDE PIC X(3).
      *    Phase
           03  BBO2ST PIC X(1).
      *    SCP Model Version Code
           03  BBSCVERCDE PIC X(12).
      *    Colour Code
           03  BBCLRCDE PIC X(3).
      *    Category
           03  BBCAT PIC X(1).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSB6.
      *    SCP Model code
           03  BBSCMDLCDE PIC X(3).
      *    Phase
           03  BBO2ST PIC X(1).
      *    SCP Model Version Code
           03  BBSCVERCDE PIC X(12).
      *    Colour Code
           03  BBCLRCDE PIC X(3).
      *    Category
           03  BBCAT PIC X(1).
      *..............................................................
      *    Define keylist
       01  KRSSB7.
      *    SCP Model code
           03  BBSCMDLCDE PIC X(3).
      *    Phase
           03  BBO2ST PIC X(1).
      *    SCP Model Version Code
           03  BBSCVERCDE PIC X(12).
      *    Colour Code
           03  BBCLRCDE PIC X(3).
      *    Category
           03  BBCAT PIC X(1).
      *    Define keylist
       01  KRSSB7-TMP.
      *    SCP Model code
           03  BBSCMDLCDE PIC X(3).
      *    Phase
           03  BBO2ST PIC X(1).
      *    SCP Model Version Code
           03  BBSCVERCDE PIC X(12).
      *    Colour Code
           03  BBCLRCDE PIC X(3).
      *    Category
           03  BBCAT PIC X(1).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSB7.
      *    SCP Model code
           03  BBSCMDLCDE PIC X(3).
      *    Phase
           03  BBO2ST PIC X(1).
      *    SCP Model Version Code
           03  BBSCVERCDE PIC X(12).
      *    Colour Code
           03  BBCLRCDE PIC X(3).
      *    Category
           03  BBCAT PIC X(1).
      *..............................................................
      *    U:Return Code Id
       01  WQ0118 PIC X(7).
      *    Invariant BCV
       01  WQ0119 PIC X(15).
      *    U:I.C. Pack Desc All
       01  WQ0120 PIC X(600).
      *    U:I.C. Total Retail Price
       01  WQ0121 PIC S9(7)V9(2).
      *    U:Delimiter
       01  WQ0122 PIC X(1).
      *    *Synon (9999) work field
       01  YRSW0A PIC X(9999).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSB8.
      *    SCP Model code
           03  CFSCMDLCDE PIC X(3).
      *    Phase
           03  CFO2ST PIC X(1).
      *    VIN
           03  CFVIN PIC X(17).
      *..............................................................
      *    Define keylist
       01  KRSSB9.
      *    SCP Model code
           03  CFSCMDLCDE PIC X(3).
      *    Phase
           03  CFO2ST PIC X(1).
      *    Define keylist
       01  KRSSB9-TMP.
      *    SCP Model code
           03  CFSCMDLCDE PIC X(3).
      *    Phase
           03  CFO2ST PIC X(1).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSB9.
      *    SCP Model code
           03  CFSCMDLCDE PIC X(3).
      *    Phase
           03  CFO2ST PIC X(1).
      *    VIN
           03  CFVIN PIC X(17).
      *..............................................................
      *    Define keylist
       01  KRSSC1.
      *    SCP Model code
           03  CFSCMDLCDE PIC X(3).
      *    Phase
           03  CFO2ST PIC X(1).
      *    Define keylist
       01  KRSSC1-TMP.
      *    SCP Model code
           03  CFSCMDLCDE PIC X(3).
      *    Phase
           03  CFO2ST PIC X(1).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSC1.
      *    SCP Model code
           03  CFSCMDLCDE PIC X(3).
      *    Phase
           03  CFO2ST PIC X(1).
      *    VIN
           03  CFVIN PIC X(17).
      *..............................................................
      *    Define keylist
       01  KRSSC2.
      *    Dealer number (alpha)
           03  CLDLRNBRX PIC X(6).
      *    Define keylist
       01  KRSSC2-TMP.
      *    Dealer number (alpha)
           03  CLDLRNBRX PIC X(6).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSC2.
      *    Dealer number (alpha)
           03  CLDLRNBRX PIC X(6).
      *..............................................................
      *    Create Date D8#
       01  WN0119 PIC S9(8) COMP-3.
      *    Create Time
       01  WN0120 PIC S9(6) COMP-3.
      *    Create User
       01  WN0121 PIC X(10).
      *    Create Program
       01  WN0122 PIC X(10).
      *    Create Job
       01  WN0123 PIC X(10).
      *    Date Last Changed D8#
       01  WN0124 PIC S9(8) COMP-3.
      *    Time Last Changed
       01  WN0125 PIC S9(6) COMP-3.
      *    User Last Changed
       01  WN0126 PIC X(10).
      *    Program Last Changed
       01  WN0127 PIC X(10).
      *    Job Last Changed
       01  WN0128 PIC X(10).
      *    Create Date D8#
       01  WN0129 PIC S9(8) COMP-3.
      *    Create Time
       01  WN0130 PIC S9(6) COMP-3.
      *    Create User
       01  WN0131 PIC X(10).
      *    Create Program
       01  WN0132 PIC X(10).
      *    Create Job
       01  WN0133 PIC X(10).
      *    Date Last Changed D8#
       01  WN0134 PIC S9(8) COMP-3.
      *    Time Last Changed
       01  WN0135 PIC S9(6) COMP-3.
      *    User Last Changed
       01  WN0136 PIC X(10).
      *    Program Last Changed
       01  WN0137 PIC X(10).
      *    Job Last Changed
       01  WN0138 PIC X(10).
      *    Message data for message Y2U0009.
       01  MD0009.
           03  MDPGM PIC X(10).
           03  MDACP PIC X(10).
           03  MDFMT PIC X(10).
           03  MDACT PIC X(4).
           03  MDLBL PIC X(6).
      *    Define keylist
       01  KRSSC5.
      *    Record Processed Status
           03  B1RCDPSTS PIC X(1).
      *    Define keylist
       01  KRSSC5-TMP.
      *    Record Processed Status
           03  B1RCDPSTS PIC X(1).
      *
      *..............................................................
      *    Define Full Externally Described Keylist
       01  EXTSC5.
      *    Record Processed Status
           03  B1RCDPSTS PIC X(1).
      *    Brand 15
           03  B1BRAND15 PIC X(15).
      *    SCP Model code
           03  B1SCMDLCDE PIC X(3).
      *    Phase
           03  B1O2ST PIC X(1).
      *    Vehicle Model Trim Level
           03  B1VEHTRIML PIC X(50).
      *    SCP Model Version Code
           03  B1SCVERCDE PIC X(12).
      *    Owning Account
           03  B1OWNACC PIC X(6).
      *    Invariant BCV
           03  B1INVBCV PIC X(15).
      *..............................................................
      *    VIN
       01  WN0139 PIC X(17).
      *    Owning Account
       01  WN0140 PIC X(6).
      *    Dealer Name
       01  WN0141 PIC X(40).
      *    Brand 15
       01  WN0142 PIC X(15).
      *    SCP Model code
       01  WN0143 PIC X(3).
      *    Phase
       01  WN0144 PIC X(1).
      *    SCP Model Version Code
       01  WN0145 PIC X(12).
      *    Model Marketing Desc.
       01  WN0146 PIC X(40).
      *    Version Marketing Desc.
       01  WN0147 PIC X(50).
      *    Vehicle Model Trim Level
       01  WN0148 PIC X(50).
      *    CAP Vehicle Code
       01  WN0149 PIC X(20).
      *    CAP Vehicle ID Number
       01  WN0150 PIC S9(5).
      *    CAP Model Dsc Cleansed
       01  WN0151 PIC X(48).
      *    CAP Version Dsc Cleansed
       01  WN0152 PIC X(48).
      *    Autotrader Vehicle Type
       01  WN0153 PIC X(10).
      *    Vehicle Body Name ATR
       01  WN0154 PIC X(20).
      *    Vehicle Fuel Type
       01  WN0155 PIC X(25).
      *    Vehicle Drive System
       01  WN0156 PIC X(50).
      *    Vehicle Horse Power
       01  WN0157 PIC X(25).
      *    Veh Co2
       01  WN0158 PIC X(6).
      *    Vehicle Gearbox Type
       01  WN0159 PIC X(25).
      *    Colour Code
       01  WN0160 PIC X(3).
      *    Colour Description
       01  WN0161 PIC X(50).
      *    SCP Options
       01  WN0162 PIC X(120).
      *    SCR Trim Type
       01  WN0163 PIC X(6).
      *    SCR Trim Colour
       01  WN0164 PIC X(6).
      *    Trim Description (48)
       01  WN0165 PIC X(48).
      *    Vehicle Fuel Code
       01  WN0166 PIC X(1).
      *    Vehicle Engine Capacity
       01  WN0167 PIC S9(5).
      *    Vehicle Number of Doors
       01  WN0168 PIC S9(1).
      *    Vehicle Seating Capacity
       01  WN0169 PIC S9(5).
      *    Vehicle Mileage
       01  WN0170 PIC S9(7).
      *    Vehicle Top Speed
       01  WN0171 PIC X(25).
      *    Vehicle Fuel Tank Cap
       01  WN0172 PIC X(25).
      *    Vehicle Range
       01  WN0173 PIC X(25).
      *    Vehicle External Length
       01  WN0174 PIC X(25).
      *    Vehicle Ext Length Units
       01  WN0175 PIC X(25).
      *    Vehicle Ext Length AddTxt
       01  WN0176 PIC X(25).
      *    Vehicle External Width
       01  WN0177 PIC X(25).
      *    Vehicle External Height
       01  WN0178 PIC X(25).
      *    Vehicle Ext Height Units
       01  WN0179 PIC X(25).
      *    Vehicle Ext Height AddTxt
       01  WN0180 PIC X(25).
      *    Vehicle Gross Weight
       01  WN0181 PIC S9(4)V9(1).
      *    Vehicle Wheelbase
       01  WN0182 PIC X(25).
      *    TCM Date 07
       01  WN0183 PIC S9(8) COMP-3.
      *    PEC/MADC Date 10
       01  WN0184 PIC S9(8) COMP-3.
      *    Arrival at Dock Date 28
       01  WN0185 PIC S9(8) COMP-3.
      *    Exit Import Centre Dte 45
       01  WN0186 PIC S9(8) COMP-3.
      *    Transfer Date 55
       01  WN0187 PIC S9(8) COMP-3.
      *    Registration Date 58
       01  WN0188 PIC S9(8) COMP-3.
      *    Sedre Vehicle Status
       01  WN0189 PIC X(1).
      *    Sedre Vehicle Status Dsc
       01  WN0190 PIC X(25).
      *    Customer Order Number
       01  WN0191 PIC X(6).
      *    Customer Order Date #
       01  WN0192 PIC S9(8) COMP-3.
      *    Cust Allocation Date
       01  WN0193 PIC S9(8) COMP-3.
      *    SEDRE customer type
       01  WN0194 PIC X(1).
      *    Order Type Central
       01  WN0195 PIC X(2).
      *    SD Sales Channel Code ATR
       01  WN0196 PIC X(2).
      *    Vehicle List Price
       01  WN0197 PIC S9(7)V9(2).
      *    Vehicle Version Price
       01  WN0198 PIC S9(7)V9(2).
      *    Vehicle Delivery Price
       01  WN0199 PIC S9(7)V9(2).
      *    Vehicle Colour Price
       01  WN0200 PIC S9(7)V9(2).
      *    Vehicle Accessories Price
       01  WN0201 PIC S9(7)V9(2).
      *    Vehicle Options Price
       01  WN0202 PIC S9(7)V9(2).
      *    Vehicle First Reg Fee
       01  WN0203 PIC S9(9)V9(2).
      *    Vehicle Road Fun License
       01  WN0204 PIC S9(9)V9(2).
      *    Vehicle On The Road Price
       01  WN0205 PIC S9(7)V9(2).
      *    Vehicle All Options Dsc
       01  WN0206 PIC X(3000).
      *    Vehicle All Accessory Dsc
       01  WN0207 PIC X(600).
      *    Vehicle Version KSP All
       01  WN0208 PIC X(3000).
      *    Vehicle Options AXS Merge
       01  WN0209 PIC X(3400).
      *    Create Date D8#
       01  WN0210 PIC S9(8) COMP-3.
      *    Create Time
       01  WN0211 PIC S9(6) COMP-3.
      *    Create User
       01  WN0212 PIC X(10).
      *    Create Program
       01  WN0213 PIC X(10).
      *    Create Job
       01  WN0214 PIC X(10).
      *    Date Last Changed D8#
       01  WN0215 PIC S9(8) COMP-3.
      *    Time Last Changed
       01  WN0216 PIC S9(6) COMP-3.
      *    User Last Changed
       01  WN0217 PIC X(10).
      *    Program Last Changed
       01  WN0218 PIC X(10).
      *    Job Last Changed
       01  WN0219 PIC X(10).
       01  ZAPGMQ PIC X(10).
       01  ZAPGRL PIC X(5).
       01  ZAMSID PIC X(7).
       01  ZAMSGF PIC X(10).
       01  ZAMSDA PIC X(132).
       01  ZAMSTP PIC X(7).
       01  ZAFSMS PIC X(1).
       01  VAMDLREFL4-OPEN.
           COPY DDS-ALL-FORMATS OF Y2IOPEN.
      *    Open feedback area
      *
       01  VAVEHDTALE-OPEN.
           COPY DDS-ALL-FORMATS OF Y2IOPEN.
      *    Open feedback area
      *
       01  RAVERSETL6-OPEN.
           COPY DDS-ALL-FORMATS OF Y2IOPEN.
      *    Open feedback area
      *
       01  SFACAPXRL1-OPEN.
           COPY DDS-ALL-FORMATS OF Y2IOPEN.
      *    Open feedback area
      *
       01  VAMVVSCPL2-OPEN.
           COPY DDS-ALL-FORMATS OF Y2IOPEN.
      *    Open feedback area
      *
       01  VAMVFLSTL1-OPEN.
           COPY DDS-ALL-FORMATS OF Y2IOPEN.
      *    Open feedback area
      *
       01  RAAOCVPRL2-OPEN.
           COPY DDS-ALL-FORMATS OF Y2IOPEN.
      *    Open feedback area
      *
       01  AGRDLR10L1-OPEN.
           COPY DDS-ALL-FORMATS OF Y2IOPEN.
      *    Open feedback area
      *
       01  VAVEHDTAL2-OPEN.
           COPY DDS-ALL-FORMATS OF Y2IOPEN.
      *    Open feedback area
      *
       01  AGPICG00L1-OPEN.
           COPY DDS-ALL-FORMATS OF Y2IOPEN.
      *    Open feedback area
      *
       01  VAMVRTRML1-OPEN.
           COPY DDS-ALL-FORMATS OF Y2IOPEN.
      *    Open feedback area
      *
       01  VAVINATNL1-OPEN.
           COPY DDS-ALL-FORMATS OF Y2IOPEN.
      *    Open feedback area
      *
       01  AGRDLR00L1-OPEN.
           COPY DDS-ALL-FORMATS OF Y2IOPEN.
      *    Open feedback area
      *
       01  AGAUTOBUL2-OPEN.
           COPY DDS-ALL-FORMATS OF Y2IOPEN.
      *    Open feedback area
      *
       01  AGAUTOBUL0-OPEN.
           COPY DDS-ALL-FORMATS OF Y2IOPEN.
      *    Open feedback area
      *
       01  W0OPN PIC X(1).
       01  W0PMT PIC X(1).
      *    SCP Model code
       01  WORK-CONTEXT.
           03  YL0001 PIC X(3).
      *    Price Start Date - Dealer
           03  YL0002 PIC S9(8) COMP-3.
      *    U:Job date long (D8#)
           03  YL0003 PIC S9(8) COMP-3.
      *    Brand Code
           03  YL0004 PIC X(6).
      *    VEH-RETCODE
           03  YL0005 PIC X(2).
      *    VEH-RECORD-AVEHBR2CB
           03  YL0006 PIC X(81).
      *    U:Text (7) b
           03  YL0007 PIC X(7).
      *    VEH-APLCDE
           03  YL0008 PIC X(6).
      *    Brand 15
           03  YL0009 PIC X(15).
      *    Phase
           03  YL0010 PIC X(1).
      *    SCP Model Version Code
           03  YL0011 PIC X(12).
      *    Model Marketing Desc.
           03  YL0012 PIC X(40).
      *    Model Marketing Desc.
           03  WUMDLMRKD PIC X(40).
      *    U:Text (5)
           03  YL0013 PIC X(5).
      *    U:Model Year(millesme)
           03  YN0001 PIC X(2).
      *    U:Vehicle Database Rec
           03  YN0002 PIC X(1).
      *    Version Marketing Desc.
           03  YL0014 PIC X(50).
      *    Vehicle Model Trim Level
           03  YL0015 PIC X(50).
      *    Vehicle Model Trim Level
           03  WUVEHTRIML PIC X(50).
      *    U:Text (7)
           03  YL0016 PIC X(7).
      *    Vehicle Body Name ATR
           03  YL0017 PIC X(20).
      *    Vehicle Body Name ATR
           03  WUVEHBDYNM PIC X(20).
      *    Vehicle Body Class Code
           03  YL0018 PIC X(2).
      *    Autotrader Vehicle Type
           03  YL0019 PIC X(10).
      *    U:Text (4)
           03  YL0020 PIC X(4).
      *    U:Position Found (NBR)
           03  YL0021 PIC S9(3).
      *    V55 Model Version Desc
           03  YN0003 PIC X(20).
      *    Manufacturer Code
           03  YN0004 PIC X(3).
      *    SMMT MVRIS Make Code
           03  YN0005 PIC X(2).
      *    SMMT Model MVRIS Code
           03  YN0006 PIC X(3).
      *    DVLA Make Code
           03  YN0007 PIC X(2).
      *    SMMT Model Code
           03  YN0008 PIC X(3).
      *    Vehicle Body Code
           03  YN0009 PIC X(2).
      *    DVLA Type Approval Categ
           03  YN0010 PIC X(2).
      *    Vehicle Fuel Code
           03  YL0022 PIC X(1).
      *    Model Engine Capacity
           03  YL0023 PIC S9(5) COMP-3.
      *    Gross Weight
           03  YL0024 PIC S9(4)V9(1).
      *    Net Weight
           03  YN0011 PIC S9(4)V9(1).
      *    Typemines
           03  YN0012 PIC X(6).
      *    High Performance (Y/N)
           03  YN0013 PIC X(1).
      *    Special Edition (Y/N)
           03  YN0014 PIC X(1).
      *    Gearbox Type Sts
           03  YL0025 PIC X(1).
      *    Number of doors
           03  YL0026 PIC S9(1).
      *    Seating Capacity V55
           03  YL0027 PIC S9(5).
      *    Tax Class Code
           03  YN0015 PIC S9(2) COMP-3.
      *    Vehicle Database Rec Sts
           03  YN0016 PIC X(1).
      *    AOC Parent Set Descript
           03  YL0028 PIC X(48).
      *    AOC Set Description
           03  YL0029 PIC X(48).
      *    U:Found
           03  YL0030 PIC X(1).
      *    U:Continue (Y/N)
           03  YL0031 PIC X(1).
      *    U:Text (1)
           03  YL0032 PIC X(1).
      *    U:Position Start (NBR)
           03  YL0033 PIC S9(3).
      *    U:Length
           03  YL0034 PIC S9(3) COMP-3.
      *    CAP Vehicle Code
           03  YL0035 PIC X(20).
      *    CAP Vehicle ID Number
           03  YL0036 PIC S9(5).
      *    CAP Model Dsc Cleansed
           03  YL0037 PIC X(48).
      *    CAP Version Dsc Cleansed
           03  YL0038 PIC X(48).
      *    SCR Model Code
           03  YN0017 PIC X(3).
      *    SCR Model Version Code
           03  YN0018 PIC X(12).
      *    U:Text (100) From
           03  YL0039 PIC X(100).
      *    U:Text (100) To
           03  YL0040 PIC X(100).
      *    U:Return Code Id
           03  YL0041 PIC X(7).
      *    U:update (Y/N)
           03  YL0042 PIC X(1).
      *    Vehicle Version KSP All
           03  YL0043 PIC X(3000).
      *    Model Version KSP Spec
           03  YL0044 PIC X(200).
      *    U:Inspect tally
           03  YL0045 PIC S9(5) COMP-3.
      *    Vehicle First Reg Fee
           03  YL0046 PIC S9(9)V9(2).
      *    AOC Price/Pct Value
           03  YL0047 PIC S9(9)V9(2).
      *    Vehicle Road Fun License
           03  YL0048 PIC S9(9)V9(2).
      *    Technical Equipment Value
           03  YL0049 PIC X(200).
      *    Vehicle Horse Power
           03  YL0050 PIC X(25).
      *    Vehicle Drive System
           03  YL0051 PIC X(50).
      *    Vehicle Fuel Tank Cap
           03  YL0052 PIC X(25).
      *    Vehicle External Length
           03  YL0053 PIC X(25).
      *    Vehicle Ext Length Units
           03  YL0054 PIC X(25).
      *    Vehicle Ext Length AddTxt
           03  YL0055 PIC X(25).
      *    U:Length
           03  YL0056 PIC S9(3) COMP-3.
      *    U:Text (1)
           03  YL0057 PIC X(1).
      *    Vehicle External Length
           03  YL0058 PIC X(25).
      *    Vehicle Ext Length Units
           03  YL0059 PIC X(25).
      *    U:Length 3
           03  YL0060 PIC S9(3) COMP-3.
      *    U:Text (4)
           03  YL0061 PIC X(4).
      *    U:Position Found (NBR)
           03  YL0062 PIC S9(3).
      *    U:Found
           03  YL0063 PIC X(1).
      *    U:Continue (Y/N)
           03  YL0064 PIC X(1).
      *    U:Text (4)
           03  YL0065 PIC X(4).
      *    U:Position Start (NBR)
           03  YL0066 PIC S9(3).
      *    U:Length 2
           03  YL0067 PIC S9(3) COMP-3.
      *    Vehicle External Width
           03  YL0068 PIC X(25).
      *    Vehicle External Height
           03  YL0069 PIC X(25).
      *    Vehicle Ext Height Units
           03  YL0070 PIC X(25).
      *    Vehicle Ext Height AddTxt
           03  YL0071 PIC X(25).
      *    U:Length
           03  YL0072 PIC S9(3) COMP-3.
      *    U:Text (1)
           03  YL0073 PIC X(1).
      *    Vehicle External Height
           03  YL0074 PIC X(25).
      *    Vehicle Ext Height Units
           03  YL0075 PIC X(25).
      *    U:Length 3
           03  YL0076 PIC S9(3) COMP-3.
      *    U:Text (4)
           03  YL0077 PIC X(4).
      *    U:Position Found (NBR)
           03  YL0078 PIC S9(3).
      *    U:Found
           03  YL0079 PIC X(1).
      *    U:Length 2
           03  YL0080 PIC S9(3) COMP-3.
      *    Vehicle Top Speed
           03  YL0081 PIC X(25).
      *    Vehicle Wheelbase
           03  YL0082 PIC X(25).
      *    Vehicle Range
           03  YL0083 PIC X(25).
      *    Vehicle Chassis No
           03  YL0084 PIC X(14).
      *    Dealer Type Code
           03  YN0019 PIC X(1).
      *    Dealer number
           03  YL0085 PIC X(4).
      *    Dealer number suffix
           03  YL0086 PIC X(2).
      *    Dealer number (fin)
           03  YL0087 PIC X(6).
      *    Name Number
           03  YN0020 PIC X(9).
      *    Address Number
           03  YN0021 PIC X(7).
      *    Dealer Network Type
           03  YL0088 PIC X(1).
      *    Dealer Region Code
           03  YN0022 PIC X(2).
      *    Dealer Zone code
           03  YN0023 PIC X(2).
      *    Dealer Trading Name
           03  YN0024 PIC X(40).
      *    Dealer Short Name
           03  YN0025 PIC X(20).
      *    Dealer Activity Start Dte
           03  YN0026 PIC S9(8) COMP-3.
      *    Dealer Servicing End Date
           03  YN0027 PIC S9(8) COMP-3.
      *    Dealer Cancel Final Date
           03  YN0028 PIC S9(8) COMP-3.
      *    Dealer Set-up Date
           03  YN0029 PIC S9(8).
      *    Dealer Change Date
           03  YN0030 PIC S9(8).
      *    Dealer Cancel Date
           03  YN0031 PIC S9(8).
      *    Dealer Financial Status
           03  YN0032 PIC X(1).
      *    Dealer Record Status
           03  YN0033 PIC X(1).
      *    BIR Address Identifier
           03  YN0034 PIC X(7).
      *    Dealer Address Line#1
           03  YN0035 PIC X(35).
      *    Dealer Address Line#2
           03  YN0036 PIC X(35).
      *    Dealer Address Line#3
           03  YN0037 PIC X(35).
      *    Dealer Address Line#4
           03  YN0038 PIC X(35).
      *    Dealer Postal Code
           03  YN0039 PIC X(9).
      *    Dealer Town
           03  YN0040 PIC X(35).
      *    Dealer Telephone Number
           03  YN0041 PIC X(14).
      *    Dealer Fax Number
           03  YN0042 PIC X(14).
      *    Dealer Country Identifier
           03  YN0043 PIC X(3).
      *    Network/Non Network Ind
           03  YN0044 PIC X(1).
      *    Dealer Number (Numeric)
           03  YN0045 PIC S9(5).
      *    Lead Dealer Number
           03  YL0089 PIC X(4).
      *    Lead Dealer Number Suffix
           03  YL0090 PIC X(2).
      *    Lead Dealer Nbr (Numeric)
           03  YN0046 PIC S9(5).
      *    Lead Country Identifier
           03  YN0047 PIC X(3).
      *    Dealer Spare Flag 1
           03  YN0048 PIC X(1).
      *    Dealer Spare Flag 2
           03  YN0049 PIC X(1).
      *    Dealer Spare Flag 3
           03  YN0050 PIC X(1).
      *    Dealer Spare Code 1
           03  YN0051 PIC X(2).
      *    Dealer Spare Code 2
           03  YN0052 PIC X(2).
      *    Dealer Percentage 1
           03  YN0053 PIC S9(4)V9(3) COMP-3.
      *    Dealer Percentage 2
           03  YN0054 PIC S9(4)V9(3) COMP-3.
      *    Dealer Percentage 3
           03  YN0055 PIC S9(4)V9(3) COMP-3.
      *    Dealer Percentage 4
           03  YN0056 PIC S9(4)V9(3) COMP-3.
      *    Dealer Network Type
           03  WUDLRNET PIC X(1).
      *    Dealer Known By Name
           03  YN0057 PIC X(40).
      *    Lead Dealer Number
           03  YN0058 PIC X(4).
      *    Lead Dealer Number Suffix
           03  YN0059 PIC X(2).
      *    Colour Type Code
           03  YN0060 PIC X(2).
      *    Vehicle MVRIS Colour Code
           03  YN0061 PIC X(1).
      *    Vehicle MVRIS Colour Cde2
           03  YN0062 PIC X(1).
      *    Vehicle MVRIS Colour Cde3
           03  YN0063 PIC X(1).
      *    Colour Type Category Code
           03  YN0064 PIC X(2).
      *    MVRIS Fuel Description
           03  YN0065 PIC X(25).
      *    MVRIS Fuel Code
           03  YN0066 PIC X(1).
      *    U:Count (3.0)
           03  YL0091 PIC S9(3) COMP-3.
      *    U:Length
           03  YL0092 PIC S9(3) COMP-3.
      *    U:Length 2
           03  YL0093 PIC S9(3) COMP-3.
      *    U:Position Start (NBR)
           03  YL0094 PIC S9(3).
      *    U:Position Found (NBR)
           03  YL0095 PIC S9(3).
      *    U:Found
           03  YL0096 PIC X(1).
      *    *For length
           03  YL0097 PIC S9(5) COMP-3.
      *    SC Option code
           03  YL0098 PIC X(6).
      *    Model option description
           03  YL0099 PIC X(100).
      *    Vehicle Database Rec Sts
           03  YN0067 PIC X(1).
      *    U:Number (2.0)
           03  YL0100 PIC S9(2) COMP-3.
      *    U:Number (2.0) b
           03  YL0101 PIC S9(2) COMP-3.
      *    U:Number (2.0) c
           03  YL0102 PIC S9(2) COMP-3.
      *    U:Number (2.0) d
           03  YL0103 PIC S9(2) COMP-3.
      *    Option Desc ATR 02
           03  YL0104 PIC X(100).
      *    U:Inspect tally
           03  YL0105 PIC S9(5) COMP-3.
      *    CA Owning Account
           03  YL0106 PIC X(6).
      *    CA Customer Ord Number
           03  YL0107 PIC X(6).
      *    CA Invariant BCV
           03  YL0108 PIC X(15).
      *    CA Order Allocation SeqNb
           03  YL0109 PIC S9(3) COMP-3.
      *    CA VIN
           03  YL0110 PIC X(17).
      *    CA Provisional Chass Flag
           03  YN0068 PIC X(1).
      *    CA Registering Account
           03  YN0069 PIC X(6).
      *    CA Secondary Network Acc
           03  YN0070 PIC X(6).
      *    CA SEDRE last message upd
           03  YN0071 PIC X(3).
      *    CA Dealer Order Number
           03  YN0072 PIC X(6).
      *    CA Order Type code
           03  YL0111 PIC X(1).
      *    CA Order Type(Central)
           03  YL0112 PIC X(2).
      *    CA Order Type(Local)
           03  YL0113 PIC X(2).
      *    CA SEDRE Customer Type
           03  YL0114 PIC X(1).
      *    CA SD Order Status Code
           03  YN0073 PIC X(4).
      *    CA SCP Model Code
           03  YN0074 PIC X(3).
      *    CA Model Phase
           03  YN0075 PIC X(1).
      *    CA SCP Model Version Code
           03  YN0076 PIC X(12).
      *    CA Colour Code
           03  YN0077 PIC X(3).
      *    CA SCP Trim Type
           03  YN0078 PIC X(6).
      *    CA Reg.Number
           03  YN0079 PIC X(7).
      *    CA Cus Ord Allocation Dte
           03  YL0115 PIC S9(8) COMP-3.
      *    CA Cus Ord Dealloc Dte
           03  YL0116 PIC S9(8) COMP-3.
      *    CA Dealer Order Cancel Da
           03  YL0117 PIC S9(8) COMP-3.
      *    CA Cust Delivery Cancel D
           03  YN0080 PIC S9(8) COMP-3.
      *    CA Registration Date 58
           03  YN0081 PIC S9(8) COMP-3.
      *    CA Registration Date 60
           03  YN0082 PIC S9(8) COMP-3.
      *    CA Date of Resale (SEDRE)
           03  YN0083 PIC S9(8) COMP-3.
      *    CA Cust Order Alloc Sts
           03  YL0118 PIC X(1).
      *    CO Customer Order Date #
           03  YL0119 PIC S9(8) COMP-3.
      *    CO Owning A/C Maille
           03  YN0084 PIC X(5).
      *    CO Owning A/C Category
           03  YN0085 PIC X(2).
      *    CO Sales Channel
           03  YL0120 PIC X(2).
      *    CO cust type P/S-derived
           03  YN0086 PIC X(1).
      *    CO OLD DVLA Flag
           03  YN0087 PIC X(1).
      *    CO Last Msg Sending Code
           03  YN0088 PIC X(8).
      *    CO APL Code
           03  YN0089 PIC X(6).
      *    CO Colour Short Descr
           03  YN0090 PIC X(6).
      *    CO SCP Options
           03  YN0091 PIC X(120).
      *    CO SCP Trim Colour
           03  YN0092 PIC X(6).
      *    CO Cust Desired Deliv Dte
           03  YL0121 PIC S9(8) COMP-3.
      *    CO Type VP/VU
           03  YN0093 PIC X(1).
      *    CO Vehicle Fuel Code
           03  YN0094 PIC X(1).
      *    CO Order Changed Date
           03  YN0095 PIC S9(8) COMP-3.
      *    CO Order Cancelled Date
           03  YL0122 PIC S9(8) COMP-3.
      *    CO Order Cancellation Rsn
           03  YL0123 PIC X(4).
      *    CO Salesperson Code
           03  YN0096 PIC X(13).
      *    CO Fleet Operator Number
           03  YN0097 PIC X(5).
      *    CO SEDRE Customer Code
           03  YN0098 PIC X(6).
      *    CO Surname/Company name
           03  YN0099 PIC X(108).
      *    CO Customer Forename
           03  YN0100 PIC X(25).
      *    CO Initials
           03  YN0101 PIC X(3).
      *    CO Title Code
           03  YN0102 PIC X(4).
      *    CO Address L1
           03  YN0103 PIC X(50).
      *    CO Address L2
           03  YN0104 PIC X(40).
      *    CO Address L3
           03  YN0105 PIC X(40).
      *    CO Address Town (40)
           03  YN0106 PIC X(40).
      *    CO Postcode
           03  YN0107 PIC X(8).
      *    CO Gender
           03  YN0108 PIC X(1).
      *    CO Customer Date of Birth
           03  YN0109 PIC S9(8) COMP-3.
      *    CO Cust. day phone code
           03  YN0110 PIC X(6).
      *    CO Cust. day phone nbr
           03  YN0111 PIC X(10).
      *    CO Cust. eve phone code
           03  YN0112 PIC X(6).
      *    CO Cust. eve phone nbr
           03  YN0113 PIC X(10).
      *    CO Cust. mobile phone cde
           03  YN0114 PIC X(6).
      *    CO Cust. mobile phone nbr
           03  YN0115 PIC X(10).
      *    CO Cust. fax phone code
           03  YN0116 PIC X(6).
      *    CO Cust. fax phone nbr
           03  YN0117 PIC X(10).
      *    CO E-Mail Address
           03  YN0118 PIC X(100).
      *    CO Annual Mileage
           03  YN0119 PIC S9(7).
      *    CO OK to Mail?
           03  YN0120 PIC X(1).
      *    CO OK to phone?
           03  YN0121 PIC X(1).
      *    CO OK to email?
           03  YN0122 PIC X(1).
      *    CO OK to text ?
           03  YN0123 PIC X(1).
      *    CO OK to fax?
           03  YN0124 PIC X(1).
      *    CO Share mail data?
           03  YN0125 PIC X(1).
      *    CO Share email data?
           03  YN0126 PIC X(1).
      *    CO Profession
           03  YN0127 PIC X(4).
      *    CO Job Function
           03  YN0128 PIC X(4).
      *    CO Customer Business Type
           03  YN0129 PIC X(10).
      *    CO Customer VAT Number
           03  YN0130 PIC X(20).
      *    CO VED Exempt Certificate
           03  YN0131 PIC X(7).
      *    CO VED Exempt Expiry Date
           03  YN0132 PIC S9(8) COMP-3.
      *    CO Social Security Number
           03  YN0133 PIC X(9).
      *    CO DVLA Fleet Number
           03  YN0134 PIC X(6).
      *    CO Part Ex-change Flag
           03  YN0135 PIC X(1).
      *    CO Current Vehicle Model
           03  YN0136 PIC X(4).
      *    CO Current Vehicle Reg Nb
           03  YN0137 PIC X(8).
      *    CO Part-Ex Veh Mileage
           03  YN0138 PIC S9(7).
      *    CO Finance Period (Mnths)
           03  YN0139 PIC S9(3) COMP-3.
      *    CO No. Renaults Owned
           03  YN0140 PIC S9(3).
      *    CO No. Vehs in Household
           03  YN0141 PIC S9(3).
      *    CO Planned Retention Per
           03  YN0142 PIC S9(2).
      *    CO Insurance Renewal Dat#
           03  YN0143 PIC S9(8) COMP-3.
      *    CO Paymemt/Finance Type
           03  YN0144 PIC X(3).
      *    CO V55 Requested?
           03  YN0145 PIC X(1).
      *    CO Offer Code 1
           03  YN0146 PIC X(4).
      *    CO Offer Code 2
           03  YN0147 PIC X(4).
      *    CO Prospect Lead Id
           03  YN0148 PIC X(10).
      *    CO Customer Order Comment
           03  YN0149 PIC X(50).
      *    CO Customer Ref/P.O. Numb
           03  YN0150 PIC X(20).
      *    CO Special Deal Id
           03  YN0151 PIC X(1).
      *    CO Fleet PCN
           03  YN0152 PIC X(5).
      *    CO Date of 1st Alloc
           03  YN0153 PIC S9(8) COMP-3.
      *    CO Date of Last DeAlloc
           03  YN0154 PIC S9(8) COMP-3.
      *    CO Buy/Lease Flag
           03  YN0155 PIC X(1).
      *    CO Spare Status 2
           03  YN0156 PIC X(1).
      *    CO Spare Status 3
           03  YN0157 PIC X(1).
      *    CO MR Contract date
           03  YN0158 PIC S9(8) COMP-3.
      *    CO Spare Date 2
           03  YN0159 PIC S9(8) COMP-3.
      *    CO MR Contract number
           03  YN0160 PIC X(6).
      *    CO Spare Code 2
           03  YN0161 PIC X(6).
      *    CO Spare Code 3
           03  YN0162 PIC X(6).
      *    CO Agreement (DEFIPRO) No
           03  YN0163 PIC X(20).
      *    CO Spare Text 2
           03  YN0164 PIC X(20).
      *    CO Spare Sts 4
           03  YN0165 PIC X(1).
      *    CO FM Fleet Acc Code
           03  YN0166 PIC X(10).
      *    CO FM Agreement No (FON)
           03  YN0167 PIC X(10).
      *    CO FM Agreement Vers No
           03  YN0168 PIC X(2).
      *    Cust Ord Alloc Exists
           03  YL0124 PIC X(1).
      *    List price
           03  YL0125 PIC S9(7)V9(2).
      *    Version price
           03  YL0126 PIC S9(7)V9(2).
      *    Delivery price
           03  YL0127 PIC S9(7)V9(2).
      *    Color price
           03  YL0128 PIC S9(7)V9(2).
      *    Accessories
           03  YL0129 PIC S9(7)V9(2).
      *    Options price     0060545
           03  YL0130 PIC S9(7)V9(2).
      *    Invariant BCV
           03  YN0169 PIC X(15).
      *    Provisional Chassis Flag
           03  YN0170 PIC X(1).
      *    Invariant SED
           03  YN0171 PIC X(8).
      *    SD last message update
           03  YN0172 PIC X(3).
      *    Dealer Order Number
           03  YN0173 PIC X(6).
      *    Supplying Order Number
           03  YN0174 PIC X(6).
      *    Order Type code
           03  YN0175 PIC X(1).
      *    Order Type Central
           03  YN0176 PIC X(2).
      *    Order Type Local
           03  YN0177 PIC X(2).
      *    SD Customer type
           03  YN0178 PIC X(1).
      *    Order Status
           03  YN0179 PIC X(4).
      *    Owning Account
           03  YN0180 PIC X(6).
      *    Owning Account (Numeric)
           03  YN0181 PIC S9(6).
      *    Delivery Account
           03  YN0182 PIC X(6).
      *    Registering Account
           03  YN0183 PIC X(6).
      *    Invoice Account
           03  YN0184 PIC X(6).
      *    Supplying Account
           03  YN0185 PIC X(6).
      *    Commercial Area code
           03  YN0186 PIC X(2).
      *    SD Country code
           03  YN0187 PIC X(3).
      *    Commercial Region code
           03  YN0188 PIC X(2).
      *    SCP Model code
           03  YL0131 PIC X(3).
      *    SCP Model Version Code
           03  YL0132 PIC X(12).
      *    Colour Code
           03  YL0133 PIC X(3).
      *    SCP Body Colour
           03  YN0189 PIC X(6).
      *    SCP Options
           03  YL0134 PIC X(120).
      *    SCP Trim Type
           03  YL0135 PIC X(6).
      *    SCP Trim Colour
           03  YL0136 PIC X(6).
      *    SCR Model Year
           03  YL0137 PIC X(2).
      *    SCR Model Year Variation
           03  YL0138 PIC X(1).
      *    SCR Family
           03  YN0190 PIC X(8).
      *    SCR Model Code
           03  YN0191 PIC X(3).
      *    SCR Model Version Code
           03  YN0192 PIC X(12).
      *    SCR Body Colour
           03  YN0193 PIC X(6).
      *    SCR Options
           03  YN0194 PIC X(120).
      *    SCR Trim Type
           03  YN0195 PIC X(6).
      *    SCR Trim Colour
           03  YN0196 PIC X(6).
      *    Fiche Gamme Country Code
           03  YN0197 PIC X(4).
      *    Project Code
           03  YN0198 PIC X(3).
      *    Phase
           03  YL0139 PIC X(1).
      *    Fiche Gamme Type
           03  YL0140 PIC X(2).
      *    Fiche Gamme Version
           03  YL0141 PIC X(3).
      *    Type VP/VU
           03  YN0199 PIC X(2).
      *    Vehicle Fuel Code
           03  YN0200 PIC X(1).
      *    Registration number
           03  YN0201 PIC X(7).
      *    Fabrication No
           03  YN0202 PIC X(7).
      *    Engine number
           03  YN0203 PIC X(7).
      *    Gearbox Number
           03  YN0204 PIC X(8).
      *    SD after sales type
           03  YN0205 PIC X(10).
      *    Tachometer Units
           03  YN0206 PIC X(2).
      *    Homologated Colour
           03  YN0207 PIC X(2).
      *    SD Model type
           03  YN0208 PIC X(2).
      *    Dealer Comments
           03  YN0209 PIC X(20).
      *    Urgency Code
           03  YN0210 PIC X(1).
      *    Dealer Order Cancel Date
           03  YN0211 PIC S9(8) COMP-3.
      *    Vehicle Transfer Origin
           03  YN0212 PIC X(2).
      *    SD top countermark ver
           03  YN0213 PIC X(1).
      *    Equipment Level
           03  YN0214 PIC X(3).
      *    Engine Level
           03  YN0215 PIC X(3).
      *    Engine type
           03  YN0216 PIC X(8).
      *    Tyre Brand
           03  YN0217 PIC X(2).
      *    Contremarque Usine
           03  YN0218 PIC X(7).
      *    C.O.C
           03  YN0219 PIC X(26).
      *    Version TVV
           03  YN0220 PIC X(18).
      *    SD repre plaque
           03  YN0221 PIC X(5).
      *    Key Code 1
           03  YN0222 PIC X(8).
      *    Key Code 2
           03  YN0223 PIC X(8).
      *    Key Code 3
           03  YN0224 PIC X(8).
      *    Radio Code
           03  YN0225 PIC X(4).
      *    Build Identification
           03  YN0226 PIC X(4).
      *    Build Year
           03  YN0227 PIC S9(4) COMP-3.
      *    Build Week
           03  YN0228 PIC S9(2) COMP-3.
      *    Build Day
           03  YN0229 PIC X(1).
      *    PRODEM Build Year
           03  YN0230 PIC S9(4) COMP-3.
      *    PRODEM Build Week
           03  YN0231 PIC S9(2) COMP-3.
      *    Assembly Line
           03  YN0232 PIC X(3).
      *    ACARD Date 05
           03  YN0233 PIC S9(8) COMP-3.
      *    Production Start  Date 06
           03  YN0234 PIC S9(8) COMP-3.
      *    TCM Date 07
           03  YN0235 PIC S9(8) COMP-3.
      *    Planned PEC/MADC Date P10
           03  YN0236 PIC S9(8) COMP-3.
      *    PEC/MADC Date 10
           03  YN0237 PIC S9(8) COMP-3.
      *    MADC Admin Date 11
           03  YN0238 PIC S9(8) COMP-3.
      *    TELCLI Date 12
           03  YN0239 PIC S9(8) COMP-3.
      *    Vehicle Shipment Date 20
           03  YN0240 PIC S9(8) COMP-3.
      *    Arrival at Dock Date 28
           03  YN0241 PIC S9(8) COMP-3.
      *    Date 30 MADA (Real)
           03  YN0242 PIC S9(8) COMP-3.
      *    Enter Import Ctr Date 32
           03  YN0243 PIC S9(8) COMP-3.
      *    Block Start Date 33
           03  YN0244 PIC S9(8) COMP-3.
      *    Record Block End Date 34
           03  YN0245 PIC S9(8) COMP-3.
      *    Allocation Date 35
           03  YN0246 PIC S9(8) COMP-3.
      *    In Commercial Stk Date 39
           03  YN0247 PIC S9(8) COMP-3.
      *    Invoice After Date 40
           03  YN0248 PIC S9(8) COMP-3.
      *    Dealer Invoiced Date 42
           03  YN0249 PIC S9(8) COMP-3.
      *    Exit Import Centre Dte 45
           03  YN0250 PIC S9(8) COMP-3.
      *    Official AAD Date 50
           03  YN0251 PIC S9(8) COMP-3.
      *    Requested AAD Date 53
           03  YN0252 PIC S9(8) COMP-3.
      *    Send Finance I/F Date 54
           03  YN0253 PIC S9(8) COMP-3.
      *    Transfer Date 55
           03  YN0254 PIC S9(8) COMP-3.
      *    Official Doc Req Date 56
           03  YN0255 PIC S9(8) COMP-3.
      *    Registration Date 58
           03  YN0256 PIC S9(8) COMP-3.
      *    Registration Date 60
           03  YN0257 PIC S9(8) COMP-3.
      *    Veh Reg Cancelled Date
           03  YN0258 PIC S9(8) COMP-3.
      *    Last Monitor Point
           03  YN0259 PIC S9(2) COMP-3.
      *    SD customs information
           03  YN0260 PIC X(15).
      *    Customer Order Number
           03  YN0261 PIC X(6).
      *    Customer Order Date #
           03  YN0262 PIC S9(8) COMP-3.
      *    Cust Allocation Date
           03  YN0263 PIC S9(8) COMP-3.
      *    Cust 1st Allocation Date
           03  YN0264 PIC S9(8) COMP-3.
      *    Cust Lst Deallocation Dt
           03  YN0265 PIC S9(8) COMP-3.
      *    Veh ARC Planned Date
           03  YN0266 PIC S9(8) COMP-3.
      *    Veh ARC Planned Location
           03  YN0267 PIC X(6).
      *    Veh DDD Requested Date
           03  YN0268 PIC S9(8) COMP-3.
      *    Veh DDD Forecast Date
           03  YN0269 PIC S9(8) COMP-3.
      *    Veh AAD Promise Date
           03  YN0270 PIC S9(8) COMP-3.
      *    Veh AAD Planned Date
           03  YN0271 PIC S9(8) COMP-3.
      *    Veh AAD System Date
           03  YN0272 PIC S9(8) COMP-3.
      *    Veh AAD Actual Date
           03  YN0273 PIC S9(8) COMP-3.
      *    Veh AAD Flag
           03  YN0274 PIC X(1).
      *    Veh AAD Official Source
           03  YN0275 PIC X(1).
      *    Veh Stock Status
           03  YN0276 PIC X(1).
      *    Veh Transfer Reason
           03  YN0277 PIC X(1).
      *    Veh Destination TABEUROP
           03  YN0278 PIC X(1).
      *    Vehicle Location
           03  YN0279 PIC X(9).
      *    Vehicle Transport from
           03  YN0280 PIC X(9).
      *    Vehicle Transport to
           03  YN0281 PIC X(9).
      *    Import Centre (Destined)
           03  YN0282 PIC X(9).
      *    Import Centre (Actual)
           03  YN0283 PIC X(9).
      *    MAC Flag
           03  YN0284 PIC X(1).
      *    Mac number
           03  YN0285 PIC X(9).
      *    Submac number
           03  YN0286 PIC X(9).
      *    Submac Date #
           03  YN0287 PIC S9(8) COMP-3.
      *    Pre RVT V55
           03  YN0288 PIC X(1).
      *    Pre Rvt Date #
           03  YN0289 PIC S9(8) COMP-3.
      *    WLTP Flag
           03  YN0290 PIC X(1).
      *    Veh Spare Sts 2
           03  YN0291 PIC X(1).
      *    Veh Spare Sts 3
           03  YN0292 PIC X(1).
      *    Veh Spare Date 1
           03  YN0293 PIC S9(8) COMP-3.
      *    Veh Spare Date 2
           03  YN0294 PIC S9(8) COMP-3.
      *    Original Owning Account
           03  YN0295 PIC X(6).
      *    Original Dlr Order Number
           03  YN0296 PIC X(6).
      *    Veh Co2
           03  YN0297 PIC X(6).
      *    Family Code (Projet)
           03  YL0142 PIC X(6).
      *    Veh Spare Text
           03  YN0298 PIC X(15).
      *    Vehicle Cancellation Code
           03  YN0299 PIC X(1).
      *    Vehicle Cancellation Orig
           03  YN0300 PIC X(3).
      *    Veh Overall Block
           03  YN0301 PIC X(1).
      *    Veh Financial Block
           03  YN0302 PIC X(1).
      *    Veh Commercial Block
           03  YN0303 PIC X(1).
      *    Veh Quality/CAT Block
           03  YN0304 PIC X(1).
      *    SD flexibility status
           03  YN0305 PIC X(1).
      *    Veh End Date Full Flex
           03  YN0306 PIC S9(8) COMP-3.
      *    Veh End Date Partial Flex
           03  YN0307 PIC S9(8) COMP-3.
      *    SEDRE hdr APL code
           03  YN0308 PIC X(6).
      *    SEDRE hdr owner a/c type
           03  YN0309 PIC X(2).
      *    SEDRE hdr lead dealer no
           03  YN0310 PIC X(5).
      *    SEDRE hdr MQ sending code
           03  YN0311 PIC X(8).
      *    SEDRE hdr dealer country
           03  YN0312 PIC X(3).
      *    SD vehicle progress st
           03  YN0313 PIC X(3).
      *    Veh Purged from SEDRE
           03  YN0314 PIC X(1).
      *    Vehicle Error Status
           03  YN0315 PIC X(1).
      *    Version Marketing Desc
           03  YN0316 PIC X(50).
      *    V55 Model Version Desc
           03  YL0143 PIC X(20).
      *    Manufacturer Code
           03  YN0317 PIC X(3).
      *    SMMT MVRIS Make Code
           03  YN0318 PIC X(2).
      *    SMMT Model MVRIS Code
           03  YN0319 PIC X(3).
      *    DVLA Make Code
           03  YN0320 PIC X(2).
      *    SMMT Model Code
           03  YN0321 PIC X(3).
      *    Vehicle Body Class Code
           03  YN0322 PIC X(2).
      *    Vehicle Body Code
           03  YN0323 PIC X(2).
      *    Vehicle Body Name
           03  YN0324 PIC X(20).
      *    DVLA Type Approval Categ
           03  YN0325 PIC X(2).
      *    Model Engine Capacity
           03  YN0326 PIC S9(5) COMP-3.
      *    Gross Weight
           03  YN0327 PIC S9(4)V9(1).
      *    Net Weight
           03  YN0328 PIC S9(4)V9(1).
      *    Typemines
           03  YN0329 PIC X(6).
      *    High Performance (Y/N)
           03  YN0330 PIC X(1).
      *    Special Edition (Y/N)
           03  YN0331 PIC X(1).
      *    Gearbox Type Sts
           03  YN0332 PIC X(1).
      *    Number of doors
           03  YN0333 PIC S9(1).
      *    Seating Capacity V55
           03  YN0334 PIC S9(5).
      *    Tax Class Code
           03  YN0335 PIC S9(2) COMP-3.
      *    Vehicle Database Rec Sts
           03  YN0336 PIC X(1).
      *    Colour Marketing Desc
           03  YL0144 PIC X(40).
      *    Colour Type Code
           03  YN0337 PIC X(2).
      *    Vehicle MVRIS Colour Code
           03  YN0338 PIC X(1).
      *    Vehicle MVRIS Colour Cde2
           03  YN0339 PIC X(1).
      *    Vehicle MVRIS Colour Cde3
           03  YN0340 PIC X(1).
      *    Colour Type Category Code
           03  YN0341 PIC X(2).
      *    NV Basic Selling Price
           03  YL0145 PIC S9(5)V9(2) COMP-3.
      *    NV Colour Price
           03  YL0146 PIC S9(5)V9(2) COMP-3.
      *    NV Upholstery Price
           03  YL0147 PIC S9(5)V9(2) COMP-3.
      *    NV Options Total Price
           03  YL0148 PIC S9(5)V9(2) COMP-3.
      *    NV Sub-total 1
           03  YL0149 PIC S9(5)V9(2) COMP-3.
      *    NV Dealer Margin
           03  YL0150 PIC S9(5)V9(2) COMP-3.
      *    NV Sub-total 2
           03  YL0151 PIC S9(5)V9(2) COMP-3.
      *    NV Other Vatable Charges
           03  YL0152 PIC S9(5)V9(2) COMP-3.
      *    NV Sub-total 3
           03  YL0153 PIC S9(5)V9(2) COMP-3.
      *    NV Accessory Retail Tot
           03  YL0154 PIC S9(5)V9(2) COMP-3.
      *    NV Accessory Discount Tot
           03  YN0342 PIC S9(5)V9(2) COMP-3.
      *    NV Accessory Net Total
           03  YL0155 PIC S9(5)V9(2) COMP-3.
      *    NV Sub-Total 4
           03  YL0156 PIC S9(5)V9(2) COMP-3.
      *    NV Other Vatable Discount
           03  YL0157 PIC S9(5)V9(2) COMP-3.
      *    NV Sub-Total 5
           03  YL0158 PIC S9(5)V9(2) COMP-3.
      *    NV VAT Amount
           03  YL0159 PIC S9(5)V9(2) COMP-3.
      *    NV Non-vatable Charges
           03  YN0343 PIC S9(5)V9(2) COMP-3.
      *    NV Non-vatable Discount
           03  YN0344 PIC S9(5)V9(2) COMP-3.
      *    NV Total Amount
           03  YL0160 PIC S9(5)V9(2) COMP-3.
      *    VP Option Price 1
           03  YL0161 PIC S9(9)V9(2) COMP-3.
      *    VP Option Price 2
           03  YL0162 PIC S9(9)V9(2) COMP-3.
      *    VP Option Price 3
           03  YL0163 PIC S9(9)V9(2) COMP-3.
      *    VP Option Price 4
           03  YL0164 PIC S9(9)V9(2) COMP-3.
      *    VP Option Price 5
           03  YL0165 PIC S9(9)V9(2) COMP-3.
      *    VP Option Price 6
           03  YL0166 PIC S9(9)V9(2) COMP-3.
      *    VP Option Price 7
           03  YL0167 PIC S9(9)V9(2) COMP-3.
      *    VP Option Price 8
           03  YL0168 PIC S9(9)V9(2) COMP-3.
      *    VP Option Price 9
           03  YL0169 PIC S9(9)V9(2) COMP-3.
      *    VP Option Price 10
           03  YL0170 PIC S9(9)V9(2) COMP-3.
      *    VP Option Price 11
           03  YL0171 PIC S9(9)V9(2) COMP-3.
      *    VP Option Price 12
           03  YL0172 PIC S9(9)V9(2) COMP-3.
      *    VP Option Price 13
           03  YL0173 PIC S9(9)V9(2) COMP-3.
      *    VP Option Price 14
           03  YL0174 PIC S9(9)V9(2) COMP-3.
      *    VP Option Price 15
           03  YL0175 PIC S9(9)V9(2) COMP-3.
      *    VP Option Price 16
           03  YL0176 PIC S9(9)V9(2) COMP-3.
      *    VP Option Price 17
           03  YL0177 PIC S9(9)V9(2) COMP-3.
      *    VP Option Price 18
           03  YL0178 PIC S9(9)V9(2) COMP-3.
      *    VP Option Price 19
           03  YL0179 PIC S9(9)V9(2) COMP-3.
      *    VP Option Price 20
           03  YL0180 PIC S9(9)V9(2) COMP-3.
      *    VP Option Price 21
           03  YL0181 PIC S9(9)V9(2) COMP-3.
      *    VP Option Price 22
           03  YL0182 PIC S9(9)V9(2) COMP-3.
      *    VP Option Price 23
           03  YL0183 PIC S9(9)V9(2) COMP-3.
      *    VP Option Price 24
           03  YL0184 PIC S9(9)V9(2) COMP-3.
      *    VP Option Price 25
           03  YL0185 PIC S9(9)V9(2) COMP-3.
      *    VP Option Price 26
           03  YL0186 PIC S9(9)V9(2) COMP-3.
      *    VP Option Price 27
           03  YL0187 PIC S9(9)V9(2) COMP-3.
      *    VP Option Price 28
           03  YL0188 PIC S9(9)V9(2) COMP-3.
      *    VP Option Price 29
           03  YL0189 PIC S9(9)V9(2) COMP-3.
      *    VP Option Price 30
           03  YL0190 PIC S9(9)V9(2) COMP-3.
      *    U:Vehicle Margin Value
           03  YL0191 PIC S9(5)V9(2) COMP-3.
      *    VP Option Margin 1
           03  YL0192 PIC S9(7)V9(2) COMP-3.
      *    VP Option Margin 2
           03  YL0193 PIC S9(7)V9(2) COMP-3.
      *    VP Option Margin 3
           03  YL0194 PIC S9(7)V9(2) COMP-3.
      *    VP Option Margin 4
           03  YL0195 PIC S9(7)V9(2) COMP-3.
      *    VP Option Margin 5
           03  YL0196 PIC S9(7)V9(2) COMP-3.
      *    VP Option Margin 6
           03  YL0197 PIC S9(7)V9(2) COMP-3.
      *    VP Option Margin 7
           03  YL0198 PIC S9(7)V9(2) COMP-3.
      *    VP Option Margin 8
           03  YL0199 PIC S9(7)V9(2) COMP-3.
      *    VP Option Margin 9
           03  YL0200 PIC S9(7)V9(2) COMP-3.
      *    VP Option Margin 10
           03  YL0201 PIC S9(7)V9(2) COMP-3.
      *    VP Option Margin 11
           03  YL0202 PIC S9(7)V9(2) COMP-3.
      *    VP Option Margin 12
           03  YL0203 PIC S9(7)V9(2) COMP-3.
      *    VP Option Margin 13
           03  YL0204 PIC S9(7)V9(2) COMP-3.
      *    VP Option Margin 14
           03  YL0205 PIC S9(7)V9(2) COMP-3.
      *    VP Option Margin 15
           03  YL0206 PIC S9(7)V9(2) COMP-3.
      *    VP Option Margin 16
           03  YL0207 PIC S9(7)V9(2) COMP-3.
      *    VP Option Margin 17
           03  YL0208 PIC S9(7)V9(2) COMP-3.
      *    VP Option Margin 18
           03  YL0209 PIC S9(7)V9(2) COMP-3.
      *    VP Option Margin 19
           03  YL0210 PIC S9(7)V9(2) COMP-3.
      *    VP Option Margin 20
           03  YL0211 PIC S9(7)V9(2) COMP-3.
      *    VP Option Margin 21
           03  YL0212 PIC S9(7)V9(2) COMP-3.
      *    VP Option Margin 22
           03  YL0213 PIC S9(7)V9(2) COMP-3.
      *    VP Option Margin 23
           03  YL0214 PIC S9(7)V9(2) COMP-3.
      *    VP Option Margin 24
           03  YL0215 PIC S9(7)V9(2) COMP-3.
      *    VP Option Margin 25
           03  YL0216 PIC S9(7)V9(2) COMP-3.
      *    VP Option Margin 26
           03  YL0217 PIC S9(7)V9(2) COMP-3.
      *    VP Option Margin 27
           03  YL0218 PIC S9(7)V9(2) COMP-3.
      *    Option Margin 28
           03  YL0219 PIC S9(7)V9(2) COMP-3.
      *    VP Option Margin 29
           03  YL0220 PIC S9(7)V9(2) COMP-3.
      *    VP Option Margin 30
           03  YL0221 PIC S9(7)V9(2) COMP-3.
      *    U:Colour Price Marg Val
           03  YL0222 PIC S9(5)V9(2) COMP-3.
      *    U:Trim Margin Ntwk
           03  YL0223 PIC S9(5)V9(2) COMP-3.
      *    NV Basic VAT Rate
           03  YL0224 PIC S9(3)V9(2) COMP-3.
      *    SC Option Code 1
           03  YL0225 PIC X(6).
      *    SC Option Code 2
           03  YL0226 PIC X(6).
      *    SC Option Code 3
           03  YL0227 PIC X(6).
      *    SC Option Code 4
           03  YL0228 PIC X(6).
      *    SC Option Code 5
           03  YL0229 PIC X(6).
      *    SC Option Code 6
           03  YL0230 PIC X(6).
      *    SC Option Code 7
           03  YL0231 PIC X(6).
      *    SC Option Code 8
           03  YL0232 PIC X(6).
      *    SC Option Code 9
           03  YL0233 PIC X(6).
      *    SC Option Code 10
           03  YL0234 PIC X(6).
      *    SC Option Code 11
           03  YL0235 PIC X(6).
      *    SC Option Code 12
           03  YL0236 PIC X(6).
      *    SC Option Code 13
           03  YL0237 PIC X(6).
      *    SC Option Code 14
           03  YL0238 PIC X(6).
      *    SC Option Code 15
           03  YL0239 PIC X(6).
      *    SC Option Code 16
           03  YL0240 PIC X(6).
      *    SC Option Code 17
           03  YL0241 PIC X(6).
      *    SC Option Code 18
           03  YL0242 PIC X(6).
      *    SC Option Code 19
           03  YL0243 PIC X(6).
      *    SC Option Code 20
           03  YL0244 PIC X(6).
      *    SC Option Code 21
           03  YL0245 PIC X(6).
      *    SC Option Code 22
           03  YL0246 PIC X(6).
      *    SC Option Code 23
           03  YL0247 PIC X(6).
      *    SC Option Code 24
           03  YL0248 PIC X(6).
      *    SC Option Code 25
           03  YL0249 PIC X(6).
      *    SC Option Code 26
           03  YL0250 PIC X(6).
      *    SC Option Code 27
           03  YL0251 PIC X(6).
      *    SC Option Code 28
           03  YL0252 PIC X(6).
      *    SC Option Code 29
           03  YL0253 PIC X(6).
      *    SC Option Code 30
           03  YL0254 PIC X(6).
      *    Error/Info Text
           03  YL0255 PIC X(40).
      *    U:Vehicle Pricing Status
           03  YL0256 PIC X(4).
      *    U:Option Pricing Status
           03  YL0257 PIC X(1).
      *    U:Total Options Marg Val
           03  YL0258 PIC S9(5)V9(2) COMP-3.
      *    VAT Rate 1
           03  YL0259 PIC S9(3)V9(4) COMP-3.
      *    U:Option Price
           03  YL0260 PIC S9(5)V9(2) COMP-3.
      *    U:Option Code 5
           03  YL0261 PIC X(5).
      *    AOC Price/Pct Value
           03  YL0262 PIC S9(9)V9(2).
      *    PICG amount to deduc val
           03  YL0263 PIC S9(7)V9(2).
      *    PICG Grant Amount
           03  YL0264 PIC S9(7)V9(2).
      *    PICG amount to deduc val
           03  YL0265 PIC S9(7)V9(2).
      *    PICG Grant Amount
           03  YL0266 PIC S9(7)V9(2).
      *    U:Record found
           03  YL0267 PIC X(1).
      *    SCR Trim Colour (12)
           03  YL0268 PIC X(12).
      *    SCR Trim Type (12)
           03  YL0269 PIC X(12).
      *    U:I.C. Total Retail Price
           03  YL0270 PIC S9(7)V9(2).
      *    Veh Co2
           03  YL0271 PIC X(6).
      *    KSP Attn text
           03  YL0272 PIC X(200).
      *    KSP Attn expiry date txt
           03  YL0273 PIC X(10).
      *    KSP Attn expiry date
           03  YL0274 PIC S9(8) COMP-3.
      *    Error text
           03  YN0345 PIC X(40).
      *    U:Job date long (D8#)
           03  YL0275 PIC S9(8) COMP-3.
      *    U:Text (1)
           03  YL0276 PIC X(1).
      *    Record Processed Status
           03  YL0277 PIC X(1).
      *
      *    Indicators
       01  INDICS.
           03  IND PIC 1(1) OCCURS 99 INDICATOR 1.
           88  C-INDICATOR-ON VALUE B'1'.
           88  C-INDICATOR-OFF VALUE B'0'.
      *
      /EJECT
      *    Parameter declarations
      *    Input string whose length is to be calculated.
       01  WK-LN-INPUT-FIELD.
           03  WK-LN-IN-BYTE PIC X(1) OCCURS 132.
      *    Array counter, etc.
      *01  WK-LN-INDEX  PIC 99.
       01  WK-LN-INDEX  PIC 9(3).
      *    Structures to move work field from and to, omitting non-num.
       01  UN-WORK-FROM-FIELD.
           03  UN-FROM-BYTE PIC X(1) OCCURS 40.
       01  UN-WORK-TO-FIELD.
           03  UN-TO-BYTE   PIC X(1) OCCURS 40.
      *    Array indices when moving bytes from and to arrays.
       01  UN-FROM-INDEX PIC 999.
       01  UN-TO-INDEX   PIC 999.
      *.Rtn.remove.leading.-.Execute.user.source.......................
       01  U-UTLRMVLEDS.
           05  U-CNT                   PIC S9(5)      PACKED-DECIMAL.
      *.Rtn.remove.leading.-.End.of.user.source........................
      *
     **
     **
      *    Structures for checking for numeric chars.
       01  WK-INP-FIELD.
           03  WK-BYT PIC X(1) OCCURS 50.
      *    Array count
       01  WK-IND PIC 99.
      *
      *.Cvt.dd/mm/yyyy.to.DTX.-.Execute.user.source....................
       01  U-UDTCMDDT8S-WS.
           05  U-DATE-IN.
               10  U-DD                PIC X(2).
               10  FILLER              PIC X.
               10  U-MM                PIC X(2).
               10  FILLER              PIC X.
               10  U-YYYYY             PIC X(4).
           05  U-DATE-OUT              PIC 9(8).
           05  U-DATE-OUT-X            REDEFINES U-DATE-OUT.
               10  U-YYYYY             PIC X(4).
               10  U-MM                PIC X(2).
               10  U-DD                PIC X(2).
      *.Cvt.dd/mm/yyyy.to.DTX.-.End.of.user.source.....................
      *
     **
     **
      /EJECT
      ***************************************************************
       LINKAGE SECTION.
      *    Return code
       01  P0RTN PIC X(7).
      *    SCP Model code
       01  WP0001 PIC X(3).
      *    U:Display yes/no 1
       01  WP0002 PIC X(1).
      *    U:Run Mode
       01  WP0003 PIC X(1).
      *    U:Date (8) Char
       01  WP0004 PIC X(8).
      *    U:To Date (TXT)
       01  WP0005 PIC X(8).
      ***************************************************************
       PROCEDURE DIVISION USING
             P0RTN
      *    FLD: Autotrader Bulk Upload
      *    I :  SCP Model code
      *    I :  U:Display yes/no 1
      *    I :  U:Run Mode
      *    I :  U:Date (8) Char
      *    I :  U:To Date (TXT)
      *    N :  U:From Date (8.0)
      *    N :  U:To Date (8.0)
      *    SCP Model code
             WP0001
      *    U:Display yes/no 1
             WP0002
      *    U:Run Mode
             WP0003
      *    U:Date (8) Char
             WP0004
      *    U:To Date (TXT)
             WP0005
           .
      *    Initialise work fields from entry parameters
           MOVE WP0001 TO P1SCMDLCDE
           MOVE WP0002 TO P2UDSPYN1
           MOVE WP0003 TO P3URUNMODE
           MOVE WP0004 TO P4UDTECHR
           MOVE WP0005 TO P5Y3TX
      ***************************************************************
           CONTINUE.
       MAINLINE SECTION.
      *    Initialize
           PERFORM ZZINIT
      *
      *    Ext Crt Auto Bulk Upload
      *    Desc
           PERFORM UA1SUBR
      *    Initialise Date Range
           PERFORM UA2SUBR
      *    Rtv AutoTrader Bulk Ext - Vehicle Model X-Ref  *
           PERFORM SA1RVGN
      *    Check for Additional Extract Blocks
      *    CASE: PAR.U:Run Mode is 1 - All Vehicles
      *    *IF
           IF (P3URUNMODE = '1') THEN
               CONTINUE
           ELSE
      *        CASE: *OTHERWISE
      *        Rtv Check Block Miss KSP - Autotrader Bulk Upload  *
               PERFORM SC5RVGN
           END-IF
      *--------------------------------------------------------------
      *    Exit program
           CONTINUE.
       AAEXIT.
           MOVE SPACES TO P0RTN
           PERFORM ZYEXPG
      *==============================================================
      /EJECT
       SA1RVGN SECTION.
      *==============================================================
      *    Rtv AutoTrader Bulk Ext - Vehicle Model X-Ref  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    USER: Initialize routine
      *    SCP Model code
           MOVE SPACES TO YL0001 OF WORK-CONTEXT
           MOVE ' ' TO YL0001 OF WORK-CONTEXT
      *    Initialise Full Externally Described Keylist
      *    SCP Model code
           MOVE LOW-VALUES TO OXSCMDLCDE OF EXTSA1
      *    Phase
           MOVE LOW-VALUES TO OXO2ST OF EXTSA1
      *    SCP Model Version Code
           MOVE LOW-VALUES TO OXSCVERCDE OF EXTSA1
      *    SCP Version Last Acard
           MOVE 99999999 TO OXSCVERACD OF EXTSA1
           MOVE CORRESPONDING
             EXTSA1 TO
             VAMDLRREF4 OF VAMDLREFL4-R
           START VAMDLREFL4 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'VAMDLRREF4'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ VAMDLREFL4 NEXT
             FORMAT IS 'VAMDLRREF4'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               END-IF
           END-IF
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'JSM1914' TO W0RTN
           END-IF
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        CASE:
      *        - c1 OR c2
      *        |- c1    : PAR.SCP Model code is ** All Models **
      *        |- c2    : DB1.SCP Model code EQ PAR.SCP Model code
      *        '-
      *        *IF
               IF (P1SCMDLCDE = '***' OR
                   OXSCMDLCDE OF VAMDLRREF4 OF VAMDLREFL4-R =
                 P1SCMDLCDE) THEN
      *            CASE: DB1.SCP Model code NE LCL.SCP Model code
      *            *IF
                   IF (OXSCMDLCDE OF VAMDLRREF4 OF VAMDLREFL4-R NOT =
                     YL0001 OF WORK-CONTEXT) THEN
      *                Rtv Crt Autotrader Ext - Vehicle  *
                       PERFORM SA2RVGN
                   END-IF
      *            SCP Model code
                   MOVE OXSCMDLCDE OF VAMDLRREF4 OF VAMDLREFL4-R TO
                     YL0001 OF WORK-CONTEXT
               END-IF
               SET C-INDICATOR-OFF(90) TO TRUE
               READ VAMDLREFL4 NEXT
                 FORMAT IS 'VAMDLRREF4'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   END-IF
               END-IF
           END-PERFORM
      *==============================================================
           CONTINUE.
       SA1EXIT.
           EXIT.
      /EJECT
       SA2RVGN SECTION.
      *==============================================================
      *    Rtv Crt Autotrader Ext - Vehicle  *
      *==============================================================
      *    Clear all neither parameters
      *    Dealer Name
           MOVE SPACES TO WN0001
      *    Model Marketing Desc.
           MOVE SPACES TO WN0002
      *    Version Marketing Desc.
           MOVE SPACES TO WN0003
      *    Vehicle Model Trim Level
           MOVE SPACES TO WN0004
      *    CAP Vehicle Code
           MOVE SPACES TO WN0005
      *    CAP Vehicle ID Number
           MOVE ZEROS TO WN0006
      *    CAP Model Dsc Cleansed
           MOVE SPACES TO WN0007
      *    CAP Version Dsc Cleansed
           MOVE SPACES TO WN0008
      *    Autotrader Vehicle Type
           MOVE SPACES TO WN0009
      *    Vehicle Body Name ATR
           MOVE SPACES TO WN0010
      *    Vehicle Fuel Type
           MOVE SPACES TO WN0011
      *    Vehicle Drive System
           MOVE SPACES TO WN0012
      *    Vehicle Horse Power
           MOVE SPACES TO WN0013
      *    Vehicle Gearbox Type
           MOVE SPACES TO WN0014
      *    Colour Description
           MOVE SPACES TO WN0015
      *    Trim Description (48)
           MOVE SPACES TO WN0016
      *    Vehicle Engine Capacity
           MOVE ZEROS TO WN0017
      *    Vehicle Number of Doors
           MOVE ZEROS TO WN0018
      *    Vehicle Seating Capacity
           MOVE ZEROS TO WN0019
      *    Vehicle Mileage
           MOVE ZEROS TO WN0020
      *    Vehicle Top Speed
           MOVE SPACES TO WN0021
      *    Vehicle Fuel Tank Cap
           MOVE SPACES TO WN0022
      *    Vehicle Range
           MOVE SPACES TO WN0023
      *    Vehicle External Length
           MOVE SPACES TO WN0024
      *    Vehicle Ext Length Units
           MOVE SPACES TO WN0025
      *    Vehicle Ext Length AddTxt
           MOVE SPACES TO WN0026
      *    Vehicle External Width
           MOVE SPACES TO WN0027
      *    Vehicle External Height
           MOVE SPACES TO WN0028
      *    Vehicle Ext Height Units
           MOVE SPACES TO WN0029
      *    Vehicle Ext Height AddTxt
           MOVE SPACES TO WN0030
      *    Vehicle Gross Weight
           MOVE ZEROS TO WN0031
      *    Vehicle Wheelbase
           MOVE SPACES TO WN0032
      *    Sedre Vehicle Status
           MOVE SPACES TO WN0033
      *    Sedre Vehicle Status Dsc
           MOVE SPACES TO WN0034
      *    Customer Order Number
           MOVE SPACES TO WN0035
      *    Customer Order Date #
           MOVE ZEROS TO WN0036
      *    Cust Allocation Date
           MOVE ZEROS TO WN0037
      *    SEDRE customer type
           MOVE SPACES TO WN0038
      *    Order Type Central
           MOVE SPACES TO WN0039
      *    SD Sales Channel Code ATR
           MOVE SPACES TO WN0040
      *    Vehicle List Price
           MOVE ZEROS TO WN0041
      *    Vehicle Version Price
           MOVE ZEROS TO WN0042
      *    Vehicle Delivery Price
           MOVE ZEROS TO WN0043
      *    Vehicle Colour Price
           MOVE ZEROS TO WN0044
      *    Vehicle Accessories Price
           MOVE ZEROS TO WN0045
      *    Vehicle Options Price
           MOVE ZEROS TO WN0046
      *    Vehicle First Reg Fee
           MOVE ZEROS TO WN0047
      *    Vehicle Road Fun License
           MOVE ZEROS TO WN0048
      *    Vehicle On The Road Price
           MOVE ZEROS TO WN0049
      *    Vehicle All Options Dsc
           MOVE SPACES TO WN0050
      *    Vehicle All Accessory Dsc
           MOVE SPACES TO WN0051
      *    Vehicle Version KSP All
           MOVE SPACES TO WN0052
      *    Vehicle Options AXS Merge
           MOVE SPACES TO WN0053
      *    Record Processed Status
           MOVE SPACES TO WN0054
      *    U:Record Selected
           MOVE SPACES TO WN0055
      *
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    USER: Initialize routine
      *    Cvt DTE to DTX
      *    CASE: PAR.U:Date (CYYMMDD) is Not Zero
      *    *IF
           IF (ZZJDT OF JOB-CONTEXT NOT = 0) THEN
      *        U:Date YYYYMMDD
               ADD 19000000, ZZJDT OF JOB-CONTEXT GIVING YL0002 OF
                 WORK-CONTEXT
           ELSE
      *        CASE: *OTHERWISE
      *        U:Date YYYYMMDD
               MOVE ZEROS TO YL0002 OF WORK-CONTEXT
           END-IF
      *    LCL.U:Job date long (D8#) = JOB.*Job date
           IF (ZZJDT OF JOB-CONTEXT = ZERO) THEN
               MOVE ZEROS TO YL0003 OF WORK-CONTEXT
           ELSE
               ADD 19000000 TO ZZJDT OF JOB-CONTEXT GIVING YL0003 OF
                 WORK-CONTEXT
           END-IF
      *    Utl Manage Library List - #Standard Functions  *
           SET C-INDICATOR-OFF(90) TO TRUE
           MOVE 'VEHLIB' TO WQ0001
           MOVE 'A' TO WQ0002
           MOVE 'L' TO WQ0003
           MOVE ' ' TO WQ0004
           MOVE SPACES TO WQ0005
      *
           CALL 'SYS000101C' USING
      *    Library
             WQ0001
      *    U:Action
             WQ0002
      *    U:Pozition
             WQ0003
      *    Library Reference
             WQ0004
      *    *Return code
             WQ0005
                    ON OVERFLOW
                    SET C-INDICATOR-ON(90) TO TRUE
           END-CALL
      *
           MOVE WQ0005 TO W0RTN
      *
      *    Error on program call will terminate run unit
           IF (C-INDICATOR-ON(90)) THEN
               MOVE 'Y2U0032' TO W0RTN
               MOVE 'SYS000101C' TO W0CLPG
      *        Send message '*Error occured on CALL...'
      *        Message ID
               MOVE 'Y2U0032' TO ZAMSID
      *        Message file
               MOVE 'Y2USRMSG' TO ZAMSGF
      *        Message data
               MOVE W0CLPG TO ZAMSDA
               PERFORM ZASNMS
               SET C-INDICATOR-ON(99) TO TRUE
           END-IF
      *    Ext Rtv Model Brand - Vehicle Model X-Ref  *
           SET C-INDICATOR-OFF(90) TO TRUE
           MOVE OXSCMDLCDE OF VAMDLRREF4 OF VAMDLREFL4-R TO WQ0006
           MOVE SPACES TO WQ0007
      *
           CALL 'VAC001300S' USING
      *    Return code
             W0RTN
      *    SCP Model code
             WQ0006
      *    Brand Code
             WQ0007
                    ON OVERFLOW
                    SET C-INDICATOR-ON(90) TO TRUE
           END-CALL
      *
           MOVE WQ0007 TO YL0004 OF WORK-CONTEXT
      *
      *    Error on program call will terminate run unit
           IF (C-INDICATOR-ON(90)) THEN
               MOVE 'Y2U0032' TO W0RTN
               MOVE 'VAC001300S' TO W0CLPG
      *        Send message '*Error occured on CALL...'
      *        Message ID
               MOVE 'Y2U0032' TO ZAMSID
      *        Message file
               MOVE 'Y2USRMSG' TO ZAMSGF
      *        Message data
               MOVE W0CLPG TO ZAMSDA
               PERFORM ZASNMS
           END-IF
      *    Error detected?
           IF (W0RTN        NOT = SPACES) THEN
               SET C-INDICATOR-ON(99) TO TRUE
           END-IF
      *    VEH-RETCODE
           MOVE 'NN' TO YL0005 OF WORK-CONTEXT
      *    VEH-RECORD-AVEHBR2CB
           MOVE SPACES TO YL0006 OF WORK-CONTEXT
           MOVE ' ' TO YL0006 OF WORK-CONTEXT
           MOVE 'A' TO YRSW07
           MOVE ZEROS TO YRSW03
           MOVE 'T' TO YRSW05
           IF (YRSW07 = SPACES AND
               YRSW05 = 'T') THEN
               ADD  1 TO ZEROS GIVING YRSW04
           ELSE
               ADD  1 TO 00001 GIVING YRSW04
           END-IF
           MOVE 00001 TO YRSW02
           MOVE YRSW07 TO YRSW06
           PERFORM ZCATWK
           STRING YRSW06 DELIMITED BY X'FF',
                  YL0004 OF WORK-CONTEXT DELIMITED BY SIZE
           INTO   YRSW06
           MOVE YRSW06 TO YL0007 OF WORK-CONTEXT
           MOVE ZEROS TO YRSW03
           MOVE 'T' TO YRSW05
           IF (YL0007 OF WORK-CONTEXT = SPACES AND
               YRSW05 = 'T') THEN
               ADD  1 TO ZEROS GIVING YRSW04
           ELSE
               ADD  1 TO 00007 GIVING YRSW04
           END-IF
           MOVE 00007 TO YRSW02
           MOVE YL0007 OF WORK-CONTEXT TO YRSW06
           PERFORM ZCATWK
           STRING YRSW06 DELIMITED BY X'FF',
                  YL0006 OF WORK-CONTEXT DELIMITED BY SIZE
           INTO   YRSW06
           MOVE YRSW06 TO YL0006 OF WORK-CONTEXT
      *    API Rtv Brands for APLCDE - #Foreign model access  *
           SET C-INDICATOR-OFF(90) TO TRUE
           MOVE 'A' TO WQ0008
           MOVE YL0008 OF WORK-CONTEXT TO WQ0009
           MOVE SPACES TO WQ0010
           MOVE SPACES TO WQ0011
      *
           CALL 'AVEHBR2CB' USING
      *    VEH-ACTION
             WQ0008
      *    VEH-APLCDE
             WQ0009
      *    VEH-RECORD-AVEHBR2CB
             WQ0010
      *    VEH-RETCODE
             WQ0011
                    ON OVERFLOW
                    SET C-INDICATOR-ON(90) TO TRUE
           END-CALL
      *
           MOVE WQ0010 TO YL0006 OF WORK-CONTEXT
           MOVE WQ0011 TO YL0005 OF WORK-CONTEXT
      *
      *    Error on program call will terminate run unit
           IF (C-INDICATOR-ON(90)) THEN
               MOVE 'Y2U0032' TO W0RTN
               MOVE 'AVEHBR2CB' TO W0CLPG
      *        Send message '*Error occured on CALL...'
      *        Message ID
               MOVE 'Y2U0032' TO ZAMSID
      *        Message file
               MOVE 'Y2USRMSG' TO ZAMSGF
      *        Message data
               MOVE W0CLPG TO ZAMSDA
               PERFORM ZASNMS
               SET C-INDICATOR-ON(99) TO TRUE
           END-IF
      *    CASE:
      *    - c1 AND NOTc2
      *    |- c1    : LCL.VEH-RETCODE is Normal
      *    |- c2    : LCL.VEH-RECORD-AVEHBR2CB is Blank
      *    '-
      *    *IF
           IF (YL0005 OF WORK-CONTEXT = '00' AND
               NOT (YL0006 OF WORK-CONTEXT = ' ')) THEN
               MOVE 15 TO YRSW03
               MOVE 22 TO YRSW02
               IF (YRSW02 NOT > 0 OR
                   YRSW03 NOT > 0 OR
                   YRSW02 > 00081 OR
                   YRSW03 > 00081) THEN
                   MOVE 'Y2U0510' TO W0RTN
               ELSE
                   MOVE YL0006 OF WORK-CONTEXT TO W0STRNG
                   MOVE W0STRNG(YRSW02:YRSW03) TO YL0009 OF WORK-CONTEXT
               END-IF
           ELSE
      *        CASE: *OTHERWISE
      *        CASE: LCL.Brand Code is RENAULT
      *        *IF
               IF (YL0004 OF WORK-CONTEXT = 'APL03') THEN
      *            Brand 15
                   MOVE SPACES TO YL0009 OF WORK-CONTEXT
                   MOVE 'RENAULT' TO YL0009 OF WORK-CONTEXT
               ELSE
      *            CASE: LCL.Brand Code is Renault.
      *            *IF
                   IF (YL0004 OF WORK-CONTEXT = 'BRA03') THEN
      *                Brand 15
                       MOVE SPACES TO YL0009 OF WORK-CONTEXT
                       MOVE 'RENAULT' TO YL0009 OF WORK-CONTEXT
                   ELSE
      *                CASE: LCL.Brand Code is DACIA
      *                *IF
                       IF (YL0004 OF WORK-CONTEXT = 'APL05') THEN
      *                    Brand 15
                           MOVE SPACES TO YL0009 OF WORK-CONTEXT
                           MOVE 'DACIA' TO YL0009 OF WORK-CONTEXT
                       ELSE
      *                    CASE: LCL.Brand Code is Dacia.
      *                    *IF
                           IF (YL0004 OF WORK-CONTEXT = 'BRA05') THEN
      *                        Brand 15
                               MOVE SPACES TO YL0009 OF WORK-CONTEXT
                               MOVE 'DACIA' TO YL0009 OF WORK-CONTEXT
                           ELSE
      *                        CASE: LCL.Brand Code is ALPINE
      *                        *IF
                               IF (YL0004 OF WORK-CONTEXT = 'APL18')
                                 THEN
      *                        Brand 15
                               MOVE SPACES TO YL0009 OF WORK-CONTEXT
                               MOVE 'ALPINE' TO YL0009 OF WORK-CONTEXT
                               ELSE
      *                        CASE: LCL.Brand Code is Alpine.
      *                        *IF
                               IF (YL0004 OF WORK-CONTEXT = 'BRA18')
                                 THEN
      *                        Brand 15
                               MOVE SPACES TO YL0009 OF WORK-CONTEXT
                               MOVE 'ALPINE' TO YL0009 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
      *                        Brand 15
                               MOVE SPACES TO YL0009 OF WORK-CONTEXT
                               MOVE ' ' TO YL0009 OF WORK-CONTEXT
                               END-IF
                               END-IF
                           END-IF
                       END-IF
                   END-IF
               END-IF
           END-IF
      *    Setup key
      *    SCP Model code
           MOVE OXSCMDLCDE OF VAMDLRREF4 OF VAMDLREFL4-R TO J6SCMDLCDE
             OF KRSSA2
      *    Initialise Full Externally Described Keylist
      *    SCP Model code
           MOVE LOW-VALUES TO J6SCMDLCDE OF EXTSA2
      *    Phase
           MOVE LOW-VALUES TO J6O2ST OF EXTSA2
      *    SCP Model Version Code
           MOVE LOW-VALUES TO J6SCVERCDE OF EXTSA2
           MOVE CORRESPONDING
             EXTSA2 TO
             FVEHDF2 OF VAVEHDTALE-R
           MOVE CORRESPONDING
             KRSSA2 TO
             FVEHDF2 OF VAVEHDTALE-R
           START VAVEHDTALE KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'FVEHDF2'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ VAVEHDTALE NEXT
             FORMAT IS 'FVEHDF2'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     FVEHDF2 OF VAVEHDTALE-R TO
                     EXTSA2
                   MOVE EXTSA2 TO KRSSA2-TMP
                   IF (KRSSA2 NOT = KRSSA2-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    SCP Model code
           MOVE LOW-VALUES TO J6SCMDLCDE OF EXTSA2
      *    Phase
           MOVE LOW-VALUES TO J6O2ST OF EXTSA2
      *    SCP Model Version Code
           MOVE LOW-VALUES TO J6SCVERCDE OF EXTSA2
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'JSM1386' TO W0RTN
           END-IF
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = CON By name
      *        Dealer Name
               MOVE SPACES TO WN0001
      *        Model Marketing Desc.
               MOVE SPACES TO WN0002
      *        Version Marketing Desc.
               MOVE SPACES TO WN0003
      *        Vehicle Model Trim Level
               MOVE SPACES TO WN0004
      *        CAP Vehicle Code
               MOVE SPACES TO WN0005
      *        CAP Vehicle ID Number
               MOVE ZEROS TO WN0006
      *        CAP Model Dsc Cleansed
               MOVE SPACES TO WN0007
      *        CAP Version Dsc Cleansed
               MOVE SPACES TO WN0008
      *        Autotrader Vehicle Type
               MOVE SPACES TO WN0009
      *        Vehicle Body Name ATR
               MOVE SPACES TO WN0010
      *        Vehicle Fuel Type
               MOVE SPACES TO WN0011
      *        Vehicle Drive System
               MOVE SPACES TO WN0012
      *        Vehicle Horse Power
               MOVE SPACES TO WN0013
      *        Vehicle Gearbox Type
               MOVE SPACES TO WN0014
      *        Colour Description
               MOVE SPACES TO WN0015
      *        Trim Description (48)
               MOVE SPACES TO WN0016
      *        Vehicle Engine Capacity
               MOVE ZEROS TO WN0017
      *        Vehicle Number of Doors
               MOVE ZEROS TO WN0018
      *        Vehicle Seating Capacity
               MOVE ZEROS TO WN0019
      *        Vehicle Mileage
               MOVE ZEROS TO WN0020
      *        Vehicle Top Speed
               MOVE SPACES TO WN0021
      *        Vehicle Fuel Tank Cap
               MOVE SPACES TO WN0022
      *        Vehicle Range
               MOVE SPACES TO WN0023
      *        Vehicle External Length
               MOVE SPACES TO WN0024
      *        Vehicle Ext Length Units
               MOVE SPACES TO WN0025
      *        Vehicle Ext Length AddTxt
               MOVE SPACES TO WN0026
      *        Vehicle External Width
               MOVE SPACES TO WN0027
      *        Vehicle External Height
               MOVE SPACES TO WN0028
      *        Vehicle Ext Height Units
               MOVE SPACES TO WN0029
      *        Vehicle Ext Height AddTxt
               MOVE SPACES TO WN0030
      *        Vehicle Gross Weight
               MOVE ZEROS TO WN0031
      *        Vehicle Wheelbase
               MOVE SPACES TO WN0032
      *        Sedre Vehicle Status
               MOVE SPACES TO WN0033
      *        Sedre Vehicle Status Dsc
               MOVE SPACES TO WN0034
      *        Customer Order Number
               MOVE SPACES TO WN0035
      *        Customer Order Date #
               MOVE ZEROS TO WN0036
      *        Cust Allocation Date
               MOVE ZEROS TO WN0037
      *        SEDRE customer type
               MOVE SPACES TO WN0038
      *        Order Type Central
               MOVE SPACES TO WN0039
      *        SD Sales Channel Code ATR
               MOVE SPACES TO WN0040
      *        Vehicle List Price
               MOVE ZEROS TO WN0041
      *        Vehicle Version Price
               MOVE ZEROS TO WN0042
      *        Vehicle Delivery Price
               MOVE ZEROS TO WN0043
      *        Vehicle Colour Price
               MOVE ZEROS TO WN0044
      *        Vehicle Accessories Price
               MOVE ZEROS TO WN0045
      *        Vehicle Options Price
               MOVE ZEROS TO WN0046
      *        Vehicle First Reg Fee
               MOVE ZEROS TO WN0047
      *        Vehicle Road Fun License
               MOVE ZEROS TO WN0048
      *        Vehicle On The Road Price
               MOVE ZEROS TO WN0049
      *        Vehicle All Options Dsc
               MOVE SPACES TO WN0050
      *        Vehicle All Accessory Dsc
               MOVE SPACES TO WN0051
      *        Vehicle Version KSP All
               MOVE SPACES TO WN0052
      *        Vehicle Options AXS Merge
               MOVE SPACES TO WN0053
      *        Record Processed Status
               MOVE SPACES TO WN0054
      *        U:Record Selected
               MOVE SPACES TO WN0055
      *        Check Vehicle Arrived within Date Range
      *        CASE:
      *        - c1 AND c2
      *        |- c1    : DB1.Arrival at Dock Date 28 GE PAR.U:From
      *          Date (8.0)
      *        |- c2    : DB1.Arrival at Dock Date 28 LE PAR.U:To Date
      *          (8.0)
      *        '-
      *        *IF
               IF (J6DOCDT28 OF FVEHDF2 OF VAVEHDTALE-R NOT < P6E0DX AND
                   J6DOCDT28 OF FVEHDF2 OF VAVEHDTALE-R NOT > P7JXDX)
                 THEN
      *            CASE:
      *            - c1 OR c2
      *            |- c1    : DB1.Veh Purged from SEDRE is Not Purged
      *            |- c2    : PAR.U:Run Mode is 1 - All Vehicles
      *            '-
      *            *IF
                   IF (J6VPURGSED OF FVEHDF2 OF VAVEHDTALE-R = ' ' OR
                       P3URUNMODE = '1') THEN
      *                Change of Phase / Version Code - Derive Version
      *                  Details
      *                CASE:
      *                - c1 OR c2
      *                |- c1    : DB1.Phase NE LCL.Phase
      *                |- c2    : DB1.SCP Model Version Code NE
      *                  LCL.SCP Model Version Code
      *                '-
      *                *IF
                       IF (J6O2ST OF FVEHDF2 OF VAVEHDTALE-R NOT =
                         YL0010 OF WORK-CONTEXT OR
                           J6SCVERCDE OF FVEHDF2 OF VAVEHDTALE-R NOT =
                         YL0011 OF WORK-CONTEXT) THEN
      *                    Model Marketing Desc.
                           MOVE SPACES TO YL0012 OF WORK-CONTEXT
                           MOVE ' ' TO YL0012 OF WORK-CONTEXT
      *                    Model Marketing Desc.
                           MOVE SPACES TO WUMDLMRKD OF WORK-CONTEXT
                           MOVE ' ' TO WUMDLMRKD OF WORK-CONTEXT
      *                    U:Text (5)
                           MOVE SPACES TO YL0013 OF WORK-CONTEXT
                           MOVE ' ' TO YL0013 OF WORK-CONTEXT
      *                    Ext rtv vehicle model - #Foreign model
      *                      access  *
      *                    Clear array PARC
                           INITIALIZE PARC
      *                    SCP Model code
                           MOVE J6SCMDLCDE OF FVEHDF2 OF VAVEHDTALE-R
                             TO PASCMDLCDE
      *                    Phase
                           MOVE J6O2ST OF FVEHDF2 OF VAVEHDTALE-R TO
                             PAO2ST
      *
                           SET C-INDICATOR-OFF(90) TO TRUE
                           MOVE SPACES TO WQ0012
      *
                           CALL 'VAG001500S' USING
      *                    *Return code
                             WQ0012
      *                    RCD : *Arrays
                             PARC
                                    ON OVERFLOW
                                    SET C-INDICATOR-ON(90) TO TRUE
                           END-CALL
      *
                           MOVE WQ0012 TO W0RTN
      *
      *                    Model Marketing Desc
                           MOVE PAMODDSC TO WUMDLMRKD OF WORK-CONTEXT
      *
      *                    Error on program call will terminate run unit
                           IF (C-INDICATOR-ON(90)) THEN
                               MOVE 'Y2U0032' TO W0RTN
                               MOVE 'VAG001500S' TO W0CLPG
      *                        Send message '*Error occured on CALL...'
      *                        Message ID
                               MOVE 'Y2U0032' TO ZAMSID
      *                        Message file
                               MOVE 'Y2USRMSG' TO ZAMSGF
      *                        Message data
                               MOVE W0CLPG TO ZAMSDA
                               PERFORM ZASNMS
                               SET C-INDICATOR-ON(99) TO TRUE
                           END-IF
                           MOVE 5 TO YRSW03
                           MOVE 1 TO YRSW02
                           IF (YRSW02 NOT > 0 OR
                               YRSW03 NOT > 0 OR
                               YRSW02 > 00040 OR
                               YRSW03 > 00040) THEN
                               MOVE 'Y2U0510' TO W0RTN
                           ELSE
                               MOVE WUMDLMRKD OF WORK-CONTEXT TO W0STRNG
                               MOVE W0STRNG(YRSW02:YRSW03) TO YL0013 OF
                                 WORK-CONTEXT
                           END-IF
      *                    Cvt A$ = UPPER(A$) - #String Functions  *
     ** Function   : Convert text field to upper case
     ** System     : Multiple models
     ** Programmer : Maurice Mead
     ** Date       : 20/11/2003
     **................................................................
           INSPECT YL0013 OF WORK-CONTEXT
             CONVERTING 'abcdefghijklmnopqrstuvwxyz'
             TO         'ABCDEFGHIJKLMNOPQRSTUVWXYZ'
     **.End.of.User.Source.............................................
      *                    CASE: LCL.U:Text (5) is DACIA
      *                    *IF
                           IF (YL0013 OF WORK-CONTEXT = 'DACIA') THEN
                               MOVE 33 TO YRSW03
                               MOVE 7 TO YRSW02
                               IF (YRSW02 NOT > 0 OR
                                   YRSW03 NOT > 0 OR
                                   YRSW02 > 00040 OR
                                   YRSW03 > 00040) THEN
                               MOVE 'Y2U0510' TO W0RTN
                               ELSE
                               MOVE WUMDLMRKD OF WORK-CONTEXT TO W0STRNG
                               MOVE W0STRNG(YRSW02:YRSW03) TO YL0012 OF
                                 WORK-CONTEXT
                               END-IF
                           ELSE
      *                        CASE: *OTHERWISE
      *                        Model Marketing Desc.
                               MOVE WUMDLMRKD OF WORK-CONTEXT TO YL0012
                                 OF WORK-CONTEXT
                           END-IF
      *                    Version Marketing Desc.
                           MOVE SPACES TO YL0014 OF WORK-CONTEXT
                           MOVE ' ' TO YL0014 OF WORK-CONTEXT
      *                    Vehicle Model Trim Level
                           MOVE SPACES TO YL0015 OF WORK-CONTEXT
                           MOVE ' ' TO YL0015 OF WORK-CONTEXT
      *                    Vehicle Model Trim Level
                           MOVE SPACES TO WUVEHTRIML OF WORK-CONTEXT
                           MOVE ' ' TO WUVEHTRIML OF WORK-CONTEXT
      *                    U:Text (7)
                           MOVE SPACES TO YL0016 OF WORK-CONTEXT
                           MOVE ' ' TO YL0016 OF WORK-CONTEXT
      *                    U:Text (7) b
                           MOVE SPACES TO YL0007 OF WORK-CONTEXT
                           MOVE ' ' TO YL0007 OF WORK-CONTEXT
      *                    Vehicle Body Name ATR
                           MOVE SPACES TO YL0017 OF WORK-CONTEXT
                           MOVE ' ' TO YL0017 OF WORK-CONTEXT
      *                    Vehicle Body Name ATR
                           MOVE SPACES TO WUVEHBDYNM OF WORK-CONTEXT
                           MOVE ' ' TO WUVEHBDYNM OF WORK-CONTEXT
      *                    Vehicle Body Class Code
                           MOVE SPACES TO YL0018 OF WORK-CONTEXT
                           MOVE ' ' TO YL0018 OF WORK-CONTEXT
      *                    Autotrader Vehicle Type
                           MOVE SPACES TO YL0019 OF WORK-CONTEXT
                           MOVE ' ' TO YL0019 OF WORK-CONTEXT
      *                    U:Text (4)
                           MOVE SPACES TO YL0020 OF WORK-CONTEXT
                           MOVE ' ' TO YL0020 OF WORK-CONTEXT
      *                    U:Position Found (NBR)
                           MOVE ZEROS TO YL0021 OF WORK-CONTEXT
      *                    Ext Rtv Veh Model Version - #Foreign model
      *                      access  *
      *                    Clear array PBRC
                           INITIALIZE PBRC
      *                    SCP Model code
                           MOVE J6SCMDLCDE OF FVEHDF2 OF VAVEHDTALE-R
                             TO PBSCMDLCDE
      *                    Phase
                           MOVE J6O2ST OF FVEHDF2 OF VAVEHDTALE-R TO
                             PBO2ST
      *                    SCP Model Version Code
                           MOVE J6SCVERCDE OF FVEHDF2 OF VAVEHDTALE-R
                             TO PBSCVERCDE
      *
                           SET C-INDICATOR-OFF(90) TO TRUE
                           MOVE SPACES TO WQ0013
      *
                           CALL 'VAG005000S' USING
      *                    *Return code
                             WQ0013
      *                    RCD : *Arrays
                             PBRC
                                    ON OVERFLOW
                                    SET C-INDICATOR-ON(90) TO TRUE
                           END-CALL
      *
                           MOVE WQ0013 TO W0RTN
      *
      *                    Version Marketing Desc
                           MOVE PBVERMKDSC TO YL0014 OF WORK-CONTEXT
      *                    Vehicle Body Class Code
                           MOVE PBBCBDYCLS TO YL0018 OF WORK-CONTEXT
      *                    Vehicle Body Name
                           MOVE PBBTBDYNAM TO WUVEHBDYNM OF WORK-CONTEXT
      *                    Vehicle Fuel Code
                           MOVE PBFTFUEL TO YL0022 OF WORK-CONTEXT
      *                    Model Engine Capacity
                           MOVE PBENGC TO YL0023 OF WORK-CONTEXT
      *                    Gross Weight
                           MOVE PBGRWGHT TO YL0024 OF WORK-CONTEXT
      *                    Gearbox Type Sts
                           MOVE PBGBOXT TO YL0025 OF WORK-CONTEXT
      *                    Number of doors
                           MOVE PBNODRS TO YL0026 OF WORK-CONTEXT
      *                    Seating Capacity V55
                           MOVE PBSEAT TO YL0027 OF WORK-CONTEXT
      *
      *                    Error on program call will terminate run unit
                           IF (C-INDICATOR-ON(90)) THEN
                               MOVE 'Y2U0032' TO W0RTN
                               MOVE 'VAG005000S' TO W0CLPG
      *                        Send message '*Error occured on CALL...'
      *                        Message ID
                               MOVE 'Y2U0032' TO ZAMSID
      *                        Message file
                               MOVE 'Y2USRMSG' TO ZAMSGF
      *                        Message data
                               MOVE W0CLPG TO ZAMSDA
                               PERFORM ZASNMS
                               SET C-INDICATOR-ON(99) TO TRUE
                           END-IF
      *                    Set Autotrader Vehicle Type
      *                    CASE:
      *                    - c1 OR c2
      *                    |- c1    : LCL.Vehicle Body Class Code is Car
      *                    |- c2    : LCL.Vehicle Body Class Code is
      *                      Quadricycle
      *                    '-
      *                    *IF
                           IF (YL0018 OF WORK-CONTEXT = 'C' OR
                               YL0018 OF WORK-CONTEXT = 'Q') THEN
      *                        Autotrader Vehicle Type
                               MOVE SPACES TO YL0019 OF WORK-CONTEXT
                               MOVE 'CAR' TO YL0019 OF WORK-CONTEXT
                           ELSE
      *                        CASE:
      *                        - c1 OR c2
      *                        |- c1    : LCL.Vehicle Body Class Code
      *                          is HGV
      *                        |- c2    : LCL.Vehicle Body Class Code
      *                          is Van
      *                        '-
      *                        *IF
                               IF (YL0018 OF WORK-CONTEXT = 'H' OR
                                   YL0018 OF WORK-CONTEXT = 'V') THEN
      *                        Autotrader Vehicle Type
                               MOVE SPACES TO YL0019 OF WORK-CONTEXT
                               MOVE 'COMM' TO YL0019 OF WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
      *                        Autotrader Vehicle Type
                               MOVE SPACES TO YL0019 OF WORK-CONTEXT
                               MOVE 'UNDEFINED' TO YL0019 OF
                                 WORK-CONTEXT
                               END-IF
                           END-IF
                           MOVE 7 TO YRSW03
                           MOVE 1 TO YRSW02
                           IF (YRSW02 NOT > 0 OR
                               YRSW03 NOT > 0 OR
                               YRSW02 > 00050 OR
                               YRSW03 > 00050) THEN
                               MOVE 'Y2U0510' TO W0RTN
                           ELSE
                               MOVE YL0014 OF WORK-CONTEXT TO W0STRNG
                               MOVE W0STRNG(YRSW02:YRSW03) TO YL0016 OF
                                 WORK-CONTEXT
                           END-IF
      *                    U:Text (7) b
                           MOVE YL0016 OF WORK-CONTEXT TO YL0007 OF
                             WORK-CONTEXT
      *                    Cvt A$ = UPPER(A$) - #String Functions  *
     ** Function   : Convert text field to upper case
     ** System     : Multiple models
     ** Programmer : Maurice Mead
     ** Date       : 20/11/2003
     **................................................................
           INSPECT YL0016 OF WORK-CONTEXT
             CONVERTING 'abcdefghijklmnopqrstuvwxyz'
             TO         'ABCDEFGHIJKLMNOPQRSTUVWXYZ'
     **.End.of.User.Source.............................................
      *                    CASE: LCL.U:Text (7) is STEPWAY
      *                    *IF
                           IF (YL0016 OF WORK-CONTEXT = 'STEPWAY') THEN
                               MOVE 1 TO YRSW03
                               MOVE 'T' TO YRSW05
                               IF (YL0012 OF WORK-CONTEXT = SPACES AND
                                   YRSW05 = 'T') THEN
                               ADD  1 TO 1 GIVING YRSW04
                               ELSE
                               ADD  1 TO 00040 GIVING YRSW04
                               END-IF
                               MOVE 00040 TO YRSW02
                               MOVE YL0012 OF WORK-CONTEXT TO YRSW06
                               PERFORM ZCATWK
                               STRING YRSW06 DELIMITED BY X'FF',
                                      YL0007 OF WORK-CONTEXT DELIMITED
                                 BY SIZE
                               INTO   YRSW06
                               MOVE YRSW06 TO YL0012 OF WORK-CONTEXT
      *                        Rtv Set Descr by SCP code - AOC Set
      *                          Version  *
                               PERFORM SA3RVGN
      *                        Set Trim Level from AOC Set Version if
      *                          Available
      *                        CASE:
      *                        - c1 AND c2
      *                        |- c1    : PGM.*Return code is *Normal
      *                        |- c2    : LCL.AOC Set Description is
      *                          Not blank
      *                        '-
      *                        *IF
                               IF (W0RTN = ' ' AND
                                   YL0029 OF WORK-CONTEXT NOT = ' ')
                                 THEN
      *                        Vehicle Model Trim Level
                               MOVE SPACES TO YL0015 OF WORK-CONTEXT
                               MOVE YL0029 OF WORK-CONTEXT TO YL0015 OF
                                 WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
      *                        Find Chr in String 120
      *                        U:Position Found (NBR)
                               MOVE ZEROS TO YL0021 OF WORK-CONTEXT
      *                        U:Found
                               MOVE 'N' TO YL0030 OF WORK-CONTEXT
      *                        U:Continue (Y/N)
                               MOVE 'Y' TO YL0031 OF WORK-CONTEXT
      *                        CASE: PAR.U:Position Start (NBR) is *LE
      *                          120
      *                        *IF
                               IF (9 NOT > 120) THEN
      *                        U:Text (1)
                               MOVE ' ' TO YL0032 OF WORK-CONTEXT
      *                        U:Position Start (NBR)
                               MOVE 9 TO YL0033 OF WORK-CONTEXT
      *                        Loop Check for Character
      *                        DO WHILE: LCL.U:Continue (Y/N) is Y
      *                        *DOW
                               PERFORM UNTIL NOT (YL0031 OF
                                 WORK-CONTEXT = 'Y')
                               MOVE 1 TO YRSW03
                               MOVE YL0033 OF WORK-CONTEXT TO YRSW02
                               IF (YRSW02 NOT > 0 OR
                                   YRSW03 NOT > 0 OR
                                   YRSW02 > 00120 OR
                                   YRSW03 > 00120) THEN
                               MOVE 'Y2U0510' TO W0RTN
                               ELSE
                               MOVE YL0014 OF WORK-CONTEXT TO W0STRNG
                               MOVE W0STRNG(YRSW02:YRSW03) TO YL0032 OF
                                 WORK-CONTEXT
                               END-IF
      *                        Test to See if Character Found (Or Not
      *                          Found)
      *                        CASE: PAR.U:Find Type *EQ or *NE is
      *                          *Equals
      *                        *IF
                               IF ('*EQ' = '*EQ') THEN
      *                        CASE: LCL.U:Text (1) EQ PAR.U:Character
      *                          to Find
      *                        *IF
                               IF (YL0032 OF WORK-CONTEXT = ' ') THEN
      *                        U:Continue (Y/N)
                               MOVE 'N' TO YL0031 OF WORK-CONTEXT
      *                        U:Found
                               MOVE 'Y' TO YL0030 OF WORK-CONTEXT
      *                        U:Position Found (NBR)
                               MOVE YL0033 OF WORK-CONTEXT TO YL0021 OF
                                 WORK-CONTEXT
                               END-IF
                               ELSE
      *                        CASE: PAR.U:Find Type *EQ or *NE is
      *                          *Not Equals
      *                        *IF
                               IF ('*EQ' = '*NE') THEN
      *                        CASE: LCL.U:Text (1) NE PAR.U:Character
      *                          to Find
      *                        *IF
                               IF (YL0032 OF WORK-CONTEXT NOT = ' ')
                                 THEN
      *                        U:Continue (Y/N)
                               MOVE 'N' TO YL0031 OF WORK-CONTEXT
      *                        U:Found
                               MOVE 'Y' TO YL0030 OF WORK-CONTEXT
      *                        U:Position Found (NBR)
                               MOVE YL0033 OF WORK-CONTEXT TO YL0021 OF
                                 WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
      *                        U:Position Start (NBR)
                               ADD YL0033 OF WORK-CONTEXT, 1 GIVING
                                 YL0033 OF WORK-CONTEXT
      *                        Carry On Checking ?
      *                        CASE:
      *                        - c1 AND c2
      *                        |- c1    : LCL.U:Position Start (NBR)
      *                          is *LE 120
      *                        |- c2    : LCL.U:Continue (Y/N) is Y
      *                        '-
      *                        *IF
                               IF (YL0033 OF WORK-CONTEXT NOT > 120 AND
                                   YL0031 OF WORK-CONTEXT = 'Y') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue (Y/N)
                               MOVE 'N' TO YL0031 OF WORK-CONTEXT
                               END-IF
      *                        *ITR
                               END-PERFORM
                               END-IF
      *                        CASE: LCL.U:Position Found (NBR) is *GE 9
      *                        *IF
                               IF (YL0021 OF WORK-CONTEXT NOT < 9) THEN
      *                        U:Length
                               SUBTRACT 9 FROM YL0021 OF WORK-CONTEXT
                                 GIVING YL0034 OF WORK-CONTEXT
                               MOVE YL0034 OF WORK-CONTEXT TO YRSW03
                               MOVE 9 TO YRSW02
                               IF (YRSW02 NOT > 0 OR
                                   YRSW03 NOT > 0 OR
                                   YRSW02 > 00050 OR
                                   YRSW03 > 00050) THEN
                               MOVE 'Y2U0510' TO W0RTN
                               ELSE
                               MOVE YL0014 OF WORK-CONTEXT TO W0STRNG
                               MOVE W0STRNG(YRSW02:YRSW03) TO YL0015 OF
                                 WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
                           ELSE
      *                        CASE: *OTHERWISE
      *                        Rtv Set Descr by SCP code - AOC Set
      *                          Version  *
                               PERFORM SA4RVGN
      *                        Set Trim Level from AOC Set Version if
      *                          Available
      *                        CASE:
      *                        - c1 AND c2
      *                        |- c1    : PGM.*Return code is *Normal
      *                        |- c2    : LCL.AOC Set Description is
      *                          Not blank
      *                        '-
      *                        *IF
                               IF (W0RTN = ' ' AND
                                   YL0029 OF WORK-CONTEXT NOT = ' ')
                                 THEN
      *                        Vehicle Model Trim Level
                               MOVE SPACES TO YL0015 OF WORK-CONTEXT
                               MOVE YL0029 OF WORK-CONTEXT TO YL0015 OF
                                 WORK-CONTEXT
                               ELSE
      *                        CASE: *OTHERWISE
      *                        Find Chr in String 120
      *                        U:Position Found (NBR)
                               MOVE ZEROS TO YL0021 OF WORK-CONTEXT
      *                        U:Found
                               MOVE 'N' TO YL0030 OF WORK-CONTEXT
      *                        U:Continue (Y/N)
                               MOVE 'Y' TO YL0031 OF WORK-CONTEXT
      *                        CASE: PAR.U:Position Start (NBR) is *LE
      *                          120
      *                        *IF
                               IF (1 NOT > 120) THEN
      *                        U:Text (1)
                               MOVE ' ' TO YL0032 OF WORK-CONTEXT
      *                        U:Position Start (NBR)
                               MOVE 1 TO YL0033 OF WORK-CONTEXT
      *                        Loop Check for Character
      *                        DO WHILE: LCL.U:Continue (Y/N) is Y
      *                        *DOW
                               PERFORM UNTIL NOT (YL0031 OF
                                 WORK-CONTEXT = 'Y')
                               MOVE 1 TO YRSW03
                               MOVE YL0033 OF WORK-CONTEXT TO YRSW02
                               IF (YRSW02 NOT > 0 OR
                                   YRSW03 NOT > 0 OR
                                   YRSW02 > 00120 OR
                                   YRSW03 > 00120) THEN
                               MOVE 'Y2U0510' TO W0RTN
                               ELSE
                               MOVE YL0014 OF WORK-CONTEXT TO W0STRNG
                               MOVE W0STRNG(YRSW02:YRSW03) TO YL0032 OF
                                 WORK-CONTEXT
                               END-IF
      *                        Test to See if Character Found (Or Not
      *                          Found)
      *                        CASE: PAR.U:Find Type *EQ or *NE is
      *                          *Equals
      *                        *IF
                               IF ('*EQ' = '*EQ') THEN
      *                        CASE: LCL.U:Text (1) EQ PAR.U:Character
      *                          to Find
      *                        *IF
                               IF (YL0032 OF WORK-CONTEXT = ' ') THEN
      *                        U:Continue (Y/N)
                               MOVE 'N' TO YL0031 OF WORK-CONTEXT
      *                        U:Found
                               MOVE 'Y' TO YL0030 OF WORK-CONTEXT
      *                        U:Position Found (NBR)
                               MOVE YL0033 OF WORK-CONTEXT TO YL0021 OF
                                 WORK-CONTEXT
                               END-IF
                               ELSE
      *                        CASE: PAR.U:Find Type *EQ or *NE is
      *                          *Not Equals
      *                        *IF
                               IF ('*EQ' = '*NE') THEN
      *                        CASE: LCL.U:Text (1) NE PAR.U:Character
      *                          to Find
      *                        *IF
                               IF (YL0032 OF WORK-CONTEXT NOT = ' ')
                                 THEN
      *                        U:Continue (Y/N)
                               MOVE 'N' TO YL0031 OF WORK-CONTEXT
      *                        U:Found
                               MOVE 'Y' TO YL0030 OF WORK-CONTEXT
      *                        U:Position Found (NBR)
                               MOVE YL0033 OF WORK-CONTEXT TO YL0021 OF
                                 WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
      *                        U:Position Start (NBR)
                               ADD YL0033 OF WORK-CONTEXT, 1 GIVING
                                 YL0033 OF WORK-CONTEXT
      *                        Carry On Checking ?
      *                        CASE:
      *                        - c1 AND c2
      *                        |- c1    : LCL.U:Position Start (NBR)
      *                          is *LE 120
      *                        |- c2    : LCL.U:Continue (Y/N) is Y
      *                        '-
      *                        *IF
                               IF (YL0033 OF WORK-CONTEXT NOT > 120 AND
                                   YL0031 OF WORK-CONTEXT = 'Y') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue (Y/N)
                               MOVE 'N' TO YL0031 OF WORK-CONTEXT
                               END-IF
      *                        *ITR
                               END-PERFORM
                               END-IF
      *                        CASE: LCL.U:Position Found (NBR) is *GT 1
      *                        *IF
                               IF (YL0021 OF WORK-CONTEXT > 1) THEN
                               MOVE YL0021 OF WORK-CONTEXT TO YRSW03
                               MOVE 1 TO YRSW02
                               IF (YRSW02 NOT > 0 OR
                                   YRSW03 NOT > 0 OR
                                   YRSW02 > 00050 OR
                                   YRSW03 > 00050) THEN
                               MOVE 'Y2U0510' TO W0RTN
                               ELSE
                               MOVE YL0014 OF WORK-CONTEXT TO W0STRNG
                               MOVE W0STRNG(YRSW02:YRSW03) TO YL0015 OF
                                 WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
                           END-IF
      *                    Retrieve CAP Data
      *                    Rtv CAP Fields - SFA CAP Xref  *
                           PERFORM SA5RVGN
      *                    Check Ensure something also contained in
      *                      Cleansed Field
      *                    CASE: LCL.CAP Model Dsc Cleansed is *Blank
      *                    *IF
                           IF (YL0037 OF WORK-CONTEXT = ' ') THEN
      *                        U:Text (100) From
                               MOVE SPACES TO YL0039 OF WORK-CONTEXT
                               MOVE ' ' TO YL0039 OF WORK-CONTEXT
      *                        U:Text (100) To
                               MOVE SPACES TO YL0040 OF WORK-CONTEXT
                               MOVE ' ' TO YL0040 OF WORK-CONTEXT
      *                        U:Text (100) From
                               MOVE SPACES TO YL0039 OF WORK-CONTEXT
                               MOVE YL0012 OF WORK-CONTEXT TO YL0039 OF
                                 WORK-CONTEXT
      *                        Ext Check/Conv String - #Foreign model
      *                          access  *
                               SET C-INDICATOR-OFF(90) TO TRUE
                               MOVE SPACES TO WQ0014
                               MOVE 'MDLVER' TO WQ0015
                               MOVE YL0039 OF WORK-CONTEXT TO WQ0016
                               MOVE YL0040 OF WORK-CONTEXT TO WQ0017
                               MOVE YL0042 OF WORK-CONTEXT TO WQ0018
      *
                               CALL 'SYCKCNVSTS' USING
      *                        U:Return Code Id
                                 WQ0014
      *                        U:Character Conv Code
                                 WQ0015
      *                        U:Text (100) From
                                 WQ0016
      *                        U:Text (100) To
                                 WQ0017
      *                        U:update (Y/N)
                                 WQ0018
                                        ON OVERFLOW
                                        SET C-INDICATOR-ON(90) TO TRUE
                               END-CALL
      *
                               MOVE WQ0014 TO YL0041 OF WORK-CONTEXT
                               MOVE WQ0017 TO YL0040 OF WORK-CONTEXT
                               MOVE WQ0018 TO YL0042 OF WORK-CONTEXT
      *
      *                        Error on program call will terminate
      *                          run unit
                               IF (C-INDICATOR-ON(90)) THEN
                               MOVE 'Y2U0032' TO W0RTN
                               MOVE 'SYCKCNVSTS' TO W0CLPG
      *                        Send message '*Error occured on CALL...'
      *                        Message ID
                               MOVE 'Y2U0032' TO ZAMSID
      *                        Message file
                               MOVE 'Y2USRMSG' TO ZAMSGF
      *                        Message data
                               MOVE W0CLPG TO ZAMSDA
                               PERFORM ZASNMS
                               SET C-INDICATOR-ON(99) TO TRUE
                               END-IF
      *                        CAP Model Dsc Cleansed
                               MOVE YL0040 OF WORK-CONTEXT TO YL0037 OF
                                 WORK-CONTEXT
                           END-IF
      *                    Check Ensure something also contained in
      *                      Cleansed Field
      *                    CASE: LCL.CAP Version Dsc Cleansed is *Blank
      *                    *IF
                           IF (YL0038 OF WORK-CONTEXT = ' ') THEN
      *                        U:Text (100) From
                               MOVE SPACES TO YL0039 OF WORK-CONTEXT
                               MOVE ' ' TO YL0039 OF WORK-CONTEXT
      *                        U:Text (100) To
                               MOVE SPACES TO YL0040 OF WORK-CONTEXT
                               MOVE ' ' TO YL0040 OF WORK-CONTEXT
      *                        U:Text (100) From
                               MOVE SPACES TO YL0039 OF WORK-CONTEXT
                               MOVE YL0014 OF WORK-CONTEXT TO YL0039 OF
                                 WORK-CONTEXT
      *                        Ext Check/Conv String - #Foreign model
      *                          access  *
                               SET C-INDICATOR-OFF(90) TO TRUE
                               MOVE SPACES TO WQ0019
                               MOVE 'MDLVER' TO WQ0020
                               MOVE YL0039 OF WORK-CONTEXT TO WQ0021
                               MOVE YL0040 OF WORK-CONTEXT TO WQ0022
                               MOVE YL0042 OF WORK-CONTEXT TO WQ0023
      *
                               CALL 'SYCKCNVSTS' USING
      *                        U:Return Code Id
                                 WQ0019
      *                        U:Character Conv Code
                                 WQ0020
      *                        U:Text (100) From
                                 WQ0021
      *                        U:Text (100) To
                                 WQ0022
      *                        U:update (Y/N)
                                 WQ0023
                                        ON OVERFLOW
                                        SET C-INDICATOR-ON(90) TO TRUE
                               END-CALL
      *
                               MOVE WQ0019 TO YL0041 OF WORK-CONTEXT
                               MOVE WQ0022 TO YL0040 OF WORK-CONTEXT
                               MOVE WQ0023 TO YL0042 OF WORK-CONTEXT
      *
      *                        Error on program call will terminate
      *                          run unit
                               IF (C-INDICATOR-ON(90)) THEN
                               MOVE 'Y2U0032' TO W0RTN
                               MOVE 'SYCKCNVSTS' TO W0CLPG
      *                        Send message '*Error occured on CALL...'
      *                        Message ID
                               MOVE 'Y2U0032' TO ZAMSID
      *                        Message file
                               MOVE 'Y2USRMSG' TO ZAMSGF
      *                        Message data
                               MOVE W0CLPG TO ZAMSDA
                               PERFORM ZASNMS
                               SET C-INDICATOR-ON(99) TO TRUE
                               END-IF
      *                        CAP Version Dsc Cleansed
                               MOVE YL0040 OF WORK-CONTEXT TO YL0038 OF
                                 WORK-CONTEXT
                           END-IF
      *                    Retrieve Version KSP Details
      *                    Vehicle Version KSP All
                           MOVE SPACES TO YL0043 OF WORK-CONTEXT
                           MOVE ' ' TO YL0043 OF WORK-CONTEXT
      *                    Int Rtv KSP All
      *                    Rtv KSP Features for SCP - Model Varient
      *                      KSP  *
                           PERFORM SA6RVGN
                           MOVE 4 TO YRSW03
                           MOVE 3 TO YRSW02
                           IF (YRSW02 NOT > 0 OR
                               YRSW03 NOT > 0 OR
                               YRSW02 > 00020 OR
                               YRSW03 > 00020) THEN
                               MOVE 'Y2U0510' TO W0RTN
                           ELSE
                               MOVE WUVEHBDYNM OF WORK-CONTEXT TO
                                 W0STRNG
                               MOVE W0STRNG(YRSW02:YRSW03) TO YL0020 OF
                                 WORK-CONTEXT
                           END-IF
      *                    Cvt A$ = UPPER(A$) - #String Functions  *
     ** Function   : Convert text field to upper case
     ** System     : Multiple models
     ** Programmer : Maurice Mead
     ** Date       : 20/11/2003
     **................................................................
           INSPECT YL0020 OF WORK-CONTEXT
             CONVERTING 'abcdefghijklmnopqrstuvwxyz'
             TO         'ABCDEFGHIJKLMNOPQRSTUVWXYZ'
     **.End.of.User.Source.............................................
      *                    Set Bodytype
      *                    CASE: LCL.U:Text (4) is DOOR
      *                    *IF
                           IF (YL0020 OF WORK-CONTEXT = 'DOOR') THEN
                               MOVE 12 TO YRSW03
                               MOVE 8 TO YRSW02
                               IF (YRSW02 NOT > 0 OR
                                   YRSW03 NOT > 0 OR
                                   YRSW02 > 00020 OR
                                   YRSW03 > 00020) THEN
                               MOVE 'Y2U0510' TO W0RTN
                               ELSE
                               MOVE WUVEHBDYNM OF WORK-CONTEXT TO
                                 W0STRNG
                               MOVE W0STRNG(YRSW02:YRSW03) TO YL0017 OF
                                 WORK-CONTEXT
                               END-IF
                           ELSE
      *                        CASE: *OTHERWISE
      *                        Vehicle Body Name ATR
                               MOVE WUVEHBDYNM OF WORK-CONTEXT TO
                                 YL0017 OF WORK-CONTEXT
                           END-IF
      *                    Vehicle First Reg Fee
                           MOVE ZEROS TO YL0046 OF WORK-CONTEXT
      *                    Rtv by Mdl/Phs/Ver/Dte - AOC Version Price
      *                      * FRF First Reg Fee
                           PERFORM SA8RVGN
      *                    Vehicle First Reg Fee
                           MULTIPLY YL0047 OF WORK-CONTEXT BY 1 GIVING
                             YL0046 OF WORK-CONTEXT
      *                    Vehicle Road Fun License
                           MOVE ZEROS TO YL0048 OF WORK-CONTEXT
      *                    Rtv by Mdl/Phs/Ver/Dte - AOC Version Price
      *                      * FVIGN Road Fund License
                           PERFORM SA9RVGN
      *                    Vehicle Road Fun License
                           MULTIPLY YL0047 OF WORK-CONTEXT BY 1 GIVING
                             YL0048 OF WORK-CONTEXT
      *                    Utl Rtv BMO Vers Equip - BMO Vers. Techn
      *                      Equipment  * 1623 Maxium Power
                           SET C-INDICATOR-OFF(90) TO TRUE
                           MOVE J6SCMDLCDE OF FVEHDF2 OF VAVEHDTALE-R
                             TO WQ0024
                           MOVE J6SCVERCDE OF FVEHDF2 OF VAVEHDTALE-R
                             TO WQ0025
                           MOVE '1623' TO WQ0026
                           MOVE SPACES TO WQ0027
      *
                           CALL 'RAB000180S' USING
      *                    Return code
                             W0RTN
      *                    SCP Model code
                             WQ0024
      *                    SCP Model Version Code
                             WQ0025
      *                    Technical Equipment Code
                             WQ0026
      *                    Technical Equipment Value
                             WQ0027
                                    ON OVERFLOW
                                    SET C-INDICATOR-ON(90) TO TRUE
                           END-CALL
      *
                           MOVE WQ0027 TO YL0049 OF WORK-CONTEXT
      *
      *                    Error on program call will terminate run unit
                           IF (C-INDICATOR-ON(90)) THEN
                               MOVE 'Y2U0032' TO W0RTN
                               MOVE 'RAB000180S' TO W0CLPG
      *                        Send message '*Error occured on CALL...'
      *                        Message ID
                               MOVE 'Y2U0032' TO ZAMSID
      *                        Message file
                               MOVE 'Y2USRMSG' TO ZAMSGF
      *                        Message data
                               MOVE W0CLPG TO ZAMSDA
                               PERFORM ZASNMS
                           END-IF
      *                    Error detected?
                           IF (W0RTN        NOT = SPACES) THEN
                               SET C-INDICATOR-ON(99) TO TRUE
                           END-IF
      *                    Vehicle Horse Power
                           MOVE YL0049 OF WORK-CONTEXT TO YL0050 OF
                             WORK-CONTEXT
      *                    Utl Rtv BMO Vers Equip - BMO Vers. Techn
      *                      Equipment  * 21   Drive System
                           SET C-INDICATOR-OFF(90) TO TRUE
                           MOVE J6SCMDLCDE OF FVEHDF2 OF VAVEHDTALE-R
                             TO WQ0028
                           MOVE J6SCVERCDE OF FVEHDF2 OF VAVEHDTALE-R
                             TO WQ0029
                           MOVE '21' TO WQ0030
                           MOVE SPACES TO WQ0031
      *
                           CALL 'RAB000180S' USING
      *                    Return code
                             W0RTN
      *                    SCP Model code
                             WQ0028
      *                    SCP Model Version Code
                             WQ0029
      *                    Technical Equipment Code
                             WQ0030
      *                    Technical Equipment Value
                             WQ0031
                                    ON OVERFLOW
                                    SET C-INDICATOR-ON(90) TO TRUE
                           END-CALL
      *
                           MOVE WQ0031 TO YL0049 OF WORK-CONTEXT
      *
      *                    Error on program call will terminate run unit
                           IF (C-INDICATOR-ON(90)) THEN
                               MOVE 'Y2U0032' TO W0RTN
                               MOVE 'RAB000180S' TO W0CLPG
      *                        Send message '*Error occured on CALL...'
      *                        Message ID
                               MOVE 'Y2U0032' TO ZAMSID
      *                        Message file
                               MOVE 'Y2USRMSG' TO ZAMSGF
      *                        Message data
                               MOVE W0CLPG TO ZAMSDA
                               PERFORM ZASNMS
                           END-IF
      *                    Error detected?
                           IF (W0RTN        NOT = SPACES) THEN
                               SET C-INDICATOR-ON(99) TO TRUE
                           END-IF
      *                    Vehicle Drive System
                           MOVE YL0049 OF WORK-CONTEXT TO YL0051 OF
                             WORK-CONTEXT
      *                    Utl Rtv BMO Vers Equip - BMO Vers. Techn
      *                      Equipment  * 301  Fuel Tank Capacity
                           SET C-INDICATOR-OFF(90) TO TRUE
                           MOVE J6SCMDLCDE OF FVEHDF2 OF VAVEHDTALE-R
                             TO WQ0032
                           MOVE J6SCVERCDE OF FVEHDF2 OF VAVEHDTALE-R
                             TO WQ0033
                           MOVE '301' TO WQ0034
                           MOVE SPACES TO WQ0035
      *
                           CALL 'RAB000180S' USING
      *                    Return code
                             W0RTN
      *                    SCP Model code
                             WQ0032
      *                    SCP Model Version Code
                             WQ0033
      *                    Technical Equipment Code
                             WQ0034
      *                    Technical Equipment Value
                             WQ0035
                                    ON OVERFLOW
                                    SET C-INDICATOR-ON(90) TO TRUE
                           END-CALL
      *
                           MOVE WQ0035 TO YL0049 OF WORK-CONTEXT
      *
      *                    Error on program call will terminate run unit
                           IF (C-INDICATOR-ON(90)) THEN
                               MOVE 'Y2U0032' TO W0RTN
                               MOVE 'RAB000180S' TO W0CLPG
      *                        Send message '*Error occured on CALL...'
      *                        Message ID
                               MOVE 'Y2U0032' TO ZAMSID
      *                        Message file
                               MOVE 'Y2USRMSG' TO ZAMSGF
      *                        Message data
                               MOVE W0CLPG TO ZAMSDA
                               PERFORM ZASNMS
                           END-IF
      *                    Error detected?
                           IF (W0RTN        NOT = SPACES) THEN
                               SET C-INDICATOR-ON(99) TO TRUE
                           END-IF
      *                    Vehicle Fuel Tank Cap
                           MOVE YL0049 OF WORK-CONTEXT TO YL0052 OF
                             WORK-CONTEXT
      *                    Utl Rtv BMO Vers Equip - BMO Vers. Techn
      *                      Equipment  * 1118 Length of Vehicle
                           SET C-INDICATOR-OFF(90) TO TRUE
                           MOVE J6SCMDLCDE OF FVEHDF2 OF VAVEHDTALE-R
                             TO WQ0036
                           MOVE J6SCVERCDE OF FVEHDF2 OF VAVEHDTALE-R
                             TO WQ0037
                           MOVE '1118' TO WQ0038
                           MOVE SPACES TO WQ0039
      *
                           CALL 'RAB000180S' USING
      *                    Return code
                             W0RTN
      *                    SCP Model code
                             WQ0036
      *                    SCP Model Version Code
                             WQ0037
      *                    Technical Equipment Code
                             WQ0038
      *                    Technical Equipment Value
                             WQ0039
                                    ON OVERFLOW
                                    SET C-INDICATOR-ON(90) TO TRUE
                           END-CALL
      *
                           MOVE WQ0039 TO YL0049 OF WORK-CONTEXT
      *
      *                    Error on program call will terminate run unit
                           IF (C-INDICATOR-ON(90)) THEN
                               MOVE 'Y2U0032' TO W0RTN
                               MOVE 'RAB000180S' TO W0CLPG
      *                        Send message '*Error occured on CALL...'
      *                        Message ID
                               MOVE 'Y2U0032' TO ZAMSID
      *                        Message file
                               MOVE 'Y2USRMSG' TO ZAMSGF
      *                        Message data
                               MOVE W0CLPG TO ZAMSDA
                               PERFORM ZASNMS
                           END-IF
      *                    Error detected?
                           IF (W0RTN        NOT = SPACES) THEN
                               SET C-INDICATOR-ON(99) TO TRUE
                           END-IF
      *                    Vehicle External Length
                           MOVE YL0049 OF WORK-CONTEXT TO YL0053 OF
                             WORK-CONTEXT
      *                    Int Drv Ext Length Fields
      *                    PAR = CON By name
      *                    Vehicle Ext Length Units
                           MOVE SPACES TO YL0054 OF WORK-CONTEXT
      *                    Vehicle Ext Length AddTxt
                           MOVE SPACES TO YL0055 OF WORK-CONTEXT
      *                    Rtn Length of a String - #String Functions
      *                      *
     ** Function   : Return length of a string.
     ** System     : Renault Applications
     ** Programmer : Brian Etheridge
     ** Date       : 24/03/92
     **
     ** Date       : 18/02/04
     ** Programmer : H Ghaffari
     ** Description: size of index field was 2 where as the maximum
      *              search size allowed is 132!
     **.................................................................
      *.Start.of.User.source.interface..................................
      *    Initialise work fields
           MOVE SPACES TO WK-LN-INPUT-FIELD
           MOVE YL0053 OF WORK-CONTEXT  TO WK-LN-INPUT-FIELD
      *    Examine the string.
           PERFORM RTV-TEXT-LENGTH
           MOVE WK-LN-INDEX TO YL0056 OF WORK-CONTEXT
      *.End.of.User.source.interace.....................................
      *                    CASE: LCL.U:Length is Four
      *                    *IF
                           IF (YL0056 OF WORK-CONTEXT = 4) THEN
      *                        Vehicle Ext Length Units
                               MOVE YL0053 OF WORK-CONTEXT TO YL0054 OF
                                 WORK-CONTEXT
                           ELSE
      *                        CASE: LCL.U:Length is LE Three
      *                        *IF
                               IF (YL0056 OF WORK-CONTEXT NOT > 3) THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
                               MOVE 1 TO YRSW03
                               MOVE 4 TO YRSW02
                               IF (YRSW02 NOT > 0 OR
                                   YRSW03 NOT > 0 OR
                                   YRSW02 > 00025 OR
                                   YRSW03 > 00025) THEN
                               MOVE 'Y2U0510' TO W0RTN
                               ELSE
                               MOVE YL0053 OF WORK-CONTEXT TO W0STRNG
                               MOVE W0STRNG(YRSW02:YRSW03) TO YL0057 OF
                                 WORK-CONTEXT
                               END-IF
      *                        CASE: LCL.U:Text (1) is -
      *                        *IF
                               IF (YL0057 OF WORK-CONTEXT = '-') THEN
                               MOVE 20 TO YRSW03
                               MOVE 6 TO YRSW02
                               IF (YRSW02 NOT > 0 OR
                                   YRSW03 NOT > 0 OR
                                   YRSW02 > 00025 OR
                                   YRSW03 > 00025) THEN
                               MOVE 'Y2U0510' TO W0RTN
                               ELSE
                               MOVE YL0053 OF WORK-CONTEXT TO W0STRNG
                               MOVE W0STRNG(YRSW02:YRSW03) TO YL0058 OF
                                 WORK-CONTEXT
                               END-IF
                               ELSE
      *                        CASE: *OTHERWISE
      *                        Vehicle External Length
                               MOVE YL0053 OF WORK-CONTEXT TO YL0058 OF
                                 WORK-CONTEXT
                               END-IF
      *                        Rtn Remove Non-Numeric - #String
      *                          Functions  *
     ** Function   : Remove non-numeric characters.
     ** System     : Renault Applications
     ** Programmer : Steve Bucktrout (CONSYSE)
     ** Date       : 12/10/93
     **.................................................................
     **.................................................................
     **        Remove non-alphanumeric characters from field.
      *.Start.of.User.Source............................................
           MOVE SPACES TO UN-WORK-FROM-FIELD
           MOVE SPACES TO UN-WORK-TO-FIELD
           MOVE YL0058 OF WORK-CONTEXT TO UN-WORK-FROM-FIELD
           MOVE 1 TO UN-FROM-INDEX
           MOVE 1 TO UN-TO-INDEX
      *    Move bytes from source array to target array.
           PERFORM UNTIL (UN-FROM-INDEX = 41)
      *       Move byte if eqUNl to an alphabetic character.
              IF (( UN-FROM-BYTE(UN-FROM-INDEX) >= '0'
                AND UN-FROM-BYTE(UN-FROM-INDEX) <= '9')
                OR (UN-FROM-BYTE(UN-FROM-INDEX) = ' '))
      *       Move byte if eq to a numeric character.
                 MOVE UN-FROM-BYTE(UN-FROM-INDEX) TO
                    UN-TO-BYTE(UN-TO-INDEX)
      *          Next To byte.
                 ADD 1, UN-TO-INDEX GIVING UN-TO-INDEX
              END-IF
      *       Next From byte.
              ADD 1, UN-FROM-INDEX GIVING UN-FROM-INDEX
           END-PERFORM
      *    Finished, move result of endeavour.
           MOVE UN-WORK-TO-FIELD TO YL0059 OF WORK-CONTEXT
      *.End.of.User.source..............................................
      *                        Rtn remove leading - #String Functions
      *                          *
     **----------------------------------------------------------------
     **  Remove leading character from a text field by moving the
     **    following characters to the left.
     **
     ** Called from multiple models
     **----------------------------------------------------------------
           IF  YL0059 OF WORK-CONTEXT  NOT =  SPACES
               MOVE ZEROS  TO U-CNT OF U-UTLRMVLEDS
               INSPECT YL0059 OF WORK-CONTEXT
                 TALLYING U-CNT OF U-UTLRMVLEDS
                 FOR      LEADING ' '
               IF  U-CNT OF U-UTLRMVLEDS  >  ZERO
                   IF  U-CNT  <  25
                       MOVE YL0059 OF WORK-CONTEXT
                              (U-CNT OF U-UTLRMVLEDS + 1:
                               25 - U-CNT OF U-UTLRMVLEDS)
                         TO YL0059 OF WORK-CONTEXT
                   ELSE
                       MOVE SPACES TO YL0059 OF WORK-CONTEXT
                   END-IF
               END-IF
           END-IF
      *.Rtn.remove.leading.-.End.of.user.source........................
      *
      *                        Rtn Length of a String - #String
      *                          Functions  *
     ** Function   : Return length of a string.
     ** System     : Renault Applications
     ** Programmer : Brian Etheridge
     ** Date       : 24/03/92
     **
     ** Date       : 18/02/04
     ** Programmer : H Ghaffari
     ** Description: size of index field was 2 where as the maximum
      *              search size allowed is 132!
     **.................................................................
      *.Start.of.User.source.interface..................................
      *    Initialise work fields
           MOVE SPACES TO WK-LN-INPUT-FIELD
           MOVE YL0059 OF WORK-CONTEXT  TO WK-LN-INPUT-FIELD
      *    Examine the string.
           PERFORM RTV-TEXT-LENGTH
           MOVE WK-LN-INDEX TO YL0060 OF WORK-CONTEXT
      *.End.of.User.source.interace.....................................
      *                        CASE: LCL.U:Length 3 is Four
      *                        *IF
                               IF (YL0060 OF WORK-CONTEXT = 4) THEN
                               MOVE 4 TO YRSW03
                               MOVE 1 TO YRSW02
                               IF (YRSW02 NOT > 0 OR
                                   YRSW03 NOT > 0 OR
                                   YRSW02 > 00025 OR
                                   YRSW03 > 00025) THEN
                               MOVE 'Y2U0510' TO W0RTN
                               ELSE
                               MOVE YL0059 OF WORK-CONTEXT TO W0STRNG
                               MOVE W0STRNG(YRSW02:YRSW03) TO YL0054 OF
                                 WORK-CONTEXT
                               END-IF
      *                        U:Text (4)
                               MOVE YL0054 OF WORK-CONTEXT TO YL0061 OF
                                 WORK-CONTEXT
      *                        Find Text4 in String 25
      *                        U:Position Found (NBR)
                               MOVE ZEROS TO YL0062 OF WORK-CONTEXT
      *                        U:Found
                               MOVE 'N' TO YL0063 OF WORK-CONTEXT
      *                        U:Continue (Y/N)
                               MOVE 'Y' TO YL0064 OF WORK-CONTEXT
      *                        CASE: PAR.U:Position Start (NBR) is *LE
      *                          22
      *                        *IF
                               IF (1 NOT > 22) THEN
      *                        U:Text (4)
                               MOVE SPACES TO YL0065 OF WORK-CONTEXT
                               MOVE ' ' TO YL0065 OF WORK-CONTEXT
      *                        U:Position Start (NBR)
                               MOVE 1 TO YL0066 OF WORK-CONTEXT
      *                        Loop Check for Character String
      *                        DO WHILE: LCL.U:Continue (Y/N) is Y
      *                        *DOW
                               PERFORM UNTIL NOT (YL0064 OF
                                 WORK-CONTEXT = 'Y')
                               MOVE 4 TO YRSW03
                               MOVE YL0066 OF WORK-CONTEXT TO YRSW02
                               IF (YRSW02 NOT > 0 OR
                                   YRSW03 NOT > 0 OR
                                   YRSW02 > 00025 OR
                                   YRSW03 > 00025) THEN
                               MOVE 'Y2U0510' TO W0RTN
                               ELSE
                               MOVE YL0058 OF WORK-CONTEXT TO W0STRNG
                               MOVE W0STRNG(YRSW02:YRSW03) TO YL0065 OF
                                 WORK-CONTEXT
                               END-IF
      *                        Test to See if Character String Found
      *                          (Or Not Found)
      *                        CASE: PAR.U:Find Type *EQ or *NE is
      *                          *Equals
      *                        *IF
                               IF ('*EQ' = '*EQ') THEN
      *                        CASE: LCL.U:Text (4) EQ PAR.U:Text (4)
      *                        *IF
                               IF (YL0065 OF WORK-CONTEXT = YL0061 OF
                                 WORK-CONTEXT) THEN
      *                        U:Continue (Y/N)
                               MOVE 'N' TO YL0064 OF WORK-CONTEXT
      *                        U:Found
                               MOVE 'Y' TO YL0063 OF WORK-CONTEXT
      *                        U:Position Found (NBR)
                               MOVE YL0066 OF WORK-CONTEXT TO YL0062 OF
                                 WORK-CONTEXT
                               END-IF
                               ELSE
      *                        CASE: PAR.U:Find Type *EQ or *NE is
      *                          *Not Equals
      *                        *IF
                               IF ('*EQ' = '*NE') THEN
      *                        CASE: LCL.U:Text (4) NE PAR.U:Text (4)
      *                        *IF
                               IF (YL0065 OF WORK-CONTEXT NOT = YL0061
                                 OF WORK-CONTEXT) THEN
      *                        U:Continue (Y/N)
                               MOVE 'N' TO YL0064 OF WORK-CONTEXT
      *                        U:Found
                               MOVE 'Y' TO YL0063 OF WORK-CONTEXT
      *                        U:Position Found (NBR)
                               MOVE YL0066 OF WORK-CONTEXT TO YL0062 OF
                                 WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
      *                        U:Position Start (NBR)
                               ADD YL0066 OF WORK-CONTEXT, 1 GIVING
                                 YL0066 OF WORK-CONTEXT
      *                        Carry On Checking ?
      *                        CASE:
      *                        - c1 AND c2
      *                        |- c1    : LCL.U:Position Start (NBR)
      *                          is *LE 22
      *                        |- c2    : LCL.U:Continue (Y/N) is Y
      *                        '-
      *                        *IF
                               IF (YL0066 OF WORK-CONTEXT NOT > 22 AND
                                   YL0064 OF WORK-CONTEXT = 'Y') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue (Y/N)
                               MOVE 'N' TO YL0064 OF WORK-CONTEXT
                               END-IF
      *                        *ITR
                               END-PERFORM
                               END-IF
      *                        CASE: LCL.U:Found is Y
      *                        *IF
                               IF (YL0063 OF WORK-CONTEXT = 'Y') THEN
      *                        LCL.U:Length 2 =
      *                        *COMPUTE (x1 - x2)
      *                        x1    : LCL.U:Position Found (NBR)
      *                        -     : PGM.*Synon (17,7) work field
      *                        x2    : CON.3
      *                        *Synon (17,7) work field
                               SUBTRACT 3 FROM YL0062 OF WORK-CONTEXT
                                 GIVING W0WD00
      *                        U:Length 2
                               MOVE W0WD00 TO YL0067 OF WORK-CONTEXT
                               MOVE YL0067 OF WORK-CONTEXT TO YRSW03
                               MOVE 1 TO YRSW02
                               IF (YRSW02 NOT > 0 OR
                                   YRSW03 NOT > 0 OR
                                   YRSW02 > 00025 OR
                                   YRSW03 > 00025) THEN
                               MOVE 'Y2U0510' TO W0RTN
                               ELSE
                               MOVE YL0058 OF WORK-CONTEXT TO W0STRNG
                               MOVE W0STRNG(YRSW02:YRSW03) TO YL0055 OF
                                 WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                           END-IF
      *                    Utl Rtv BMO Vers Equip - BMO Vers. Techn
      *                      Equipment  * 1119 Width of Vehicle
                           SET C-INDICATOR-OFF(90) TO TRUE
                           MOVE J6SCMDLCDE OF FVEHDF2 OF VAVEHDTALE-R
                             TO WQ0040
                           MOVE J6SCVERCDE OF FVEHDF2 OF VAVEHDTALE-R
                             TO WQ0041
                           MOVE '1119' TO WQ0042
                           MOVE SPACES TO WQ0043
      *
                           CALL 'RAB000180S' USING
      *                    Return code
                             W0RTN
      *                    SCP Model code
                             WQ0040
      *                    SCP Model Version Code
                             WQ0041
      *                    Technical Equipment Code
                             WQ0042
      *                    Technical Equipment Value
                             WQ0043
                                    ON OVERFLOW
                                    SET C-INDICATOR-ON(90) TO TRUE
                           END-CALL
      *
                           MOVE WQ0043 TO YL0049 OF WORK-CONTEXT
      *
      *                    Error on program call will terminate run unit
                           IF (C-INDICATOR-ON(90)) THEN
                               MOVE 'Y2U0032' TO W0RTN
                               MOVE 'RAB000180S' TO W0CLPG
      *                        Send message '*Error occured on CALL...'
      *                        Message ID
                               MOVE 'Y2U0032' TO ZAMSID
      *                        Message file
                               MOVE 'Y2USRMSG' TO ZAMSGF
      *                        Message data
                               MOVE W0CLPG TO ZAMSDA
                               PERFORM ZASNMS
                           END-IF
      *                    Error detected?
                           IF (W0RTN        NOT = SPACES) THEN
                               SET C-INDICATOR-ON(99) TO TRUE
                           END-IF
      *                    Vehicle External Width
                           MOVE YL0049 OF WORK-CONTEXT TO YL0068 OF
                             WORK-CONTEXT
      *                    Utl Rtv BMO Vers Equip - BMO Vers. Techn
      *                      Equipment  * 1120 Height of Vehicle
                           SET C-INDICATOR-OFF(90) TO TRUE
                           MOVE J6SCMDLCDE OF FVEHDF2 OF VAVEHDTALE-R
                             TO WQ0044
                           MOVE J6SCVERCDE OF FVEHDF2 OF VAVEHDTALE-R
                             TO WQ0045
                           MOVE '1120' TO WQ0046
                           MOVE SPACES TO WQ0047
      *
                           CALL 'RAB000180S' USING
      *                    Return code
                             W0RTN
      *                    SCP Model code
                             WQ0044
      *                    SCP Model Version Code
                             WQ0045
      *                    Technical Equipment Code
                             WQ0046
      *                    Technical Equipment Value
                             WQ0047
                                    ON OVERFLOW
                                    SET C-INDICATOR-ON(90) TO TRUE
                           END-CALL
      *
                           MOVE WQ0047 TO YL0049 OF WORK-CONTEXT
      *
      *                    Error on program call will terminate run unit
                           IF (C-INDICATOR-ON(90)) THEN
                               MOVE 'Y2U0032' TO W0RTN
                               MOVE 'RAB000180S' TO W0CLPG
      *                        Send message '*Error occured on CALL...'
      *                        Message ID
                               MOVE 'Y2U0032' TO ZAMSID
      *                        Message file
                               MOVE 'Y2USRMSG' TO ZAMSGF
      *                        Message data
                               MOVE W0CLPG TO ZAMSDA
                               PERFORM ZASNMS
                           END-IF
      *                    Error detected?
                           IF (W0RTN        NOT = SPACES) THEN
                               SET C-INDICATOR-ON(99) TO TRUE
                           END-IF
      *                    Vehicle External Height
                           MOVE YL0049 OF WORK-CONTEXT TO YL0069 OF
                             WORK-CONTEXT
      *                    Int Drv Ext Height Fields
      *                    PAR = CON By name
      *                    Vehicle Ext Height Units
                           MOVE SPACES TO YL0070 OF WORK-CONTEXT
      *                    Vehicle Ext Height AddTxt
                           MOVE SPACES TO YL0071 OF WORK-CONTEXT
      *                    Rtn Length of a String - #String Functions
      *                      *
     ** Function   : Return length of a string.
     ** System     : Renault Applications
     ** Programmer : Brian Etheridge
     ** Date       : 24/03/92
     **
     ** Date       : 18/02/04
     ** Programmer : H Ghaffari
     ** Description: size of index field was 2 where as the maximum
      *              search size allowed is 132!
     **.................................................................
      *.Start.of.User.source.interface..................................
      *    Initialise work fields
           MOVE SPACES TO WK-LN-INPUT-FIELD
           MOVE YL0069 OF WORK-CONTEXT  TO WK-LN-INPUT-FIELD
      *    Examine the string.
           PERFORM RTV-TEXT-LENGTH
           MOVE WK-LN-INDEX TO YL0072 OF WORK-CONTEXT
      *.End.of.User.source.interace.....................................
      *                    CASE: LCL.U:Length is Four
      *                    *IF
                           IF (YL0072 OF WORK-CONTEXT = 4) THEN
      *                        Vehicle Ext Height Units
                               MOVE YL0069 OF WORK-CONTEXT TO YL0070 OF
                                 WORK-CONTEXT
                           ELSE
      *                        CASE: LCL.U:Length is LE Three
      *                        *IF
                               IF (YL0072 OF WORK-CONTEXT NOT > 3) THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
                               MOVE 1 TO YRSW03
                               MOVE 4 TO YRSW02
                               IF (YRSW02 NOT > 0 OR
                                   YRSW03 NOT > 0 OR
                                   YRSW02 > 00025 OR
                                   YRSW03 > 00025) THEN
                               MOVE 'Y2U0510' TO W0RTN
                               ELSE
                               MOVE YL0069 OF WORK-CONTEXT TO W0STRNG
                               MOVE W0STRNG(YRSW02:YRSW03) TO YL0073 OF
                                 WORK-CONTEXT
                               END-IF
      *                        CASE: LCL.U:Text (1) is -
      *                        *IF
                               IF (YL0073 OF WORK-CONTEXT = '-') THEN
                               MOVE 20 TO YRSW03
                               MOVE 6 TO YRSW02
                               IF (YRSW02 NOT > 0 OR
                                   YRSW03 NOT > 0 OR
                                   YRSW02 > 00025 OR
                                   YRSW03 > 00025) THEN
                               MOVE 'Y2U0510' TO W0RTN
                               ELSE
                               MOVE YL0069 OF WORK-CONTEXT TO W0STRNG
                               MOVE W0STRNG(YRSW02:YRSW03) TO YL0074 OF
                                 WORK-CONTEXT
                               END-IF
                               ELSE
      *                        CASE: *OTHERWISE
      *                        Vehicle External Height
                               MOVE YL0069 OF WORK-CONTEXT TO YL0074 OF
                                 WORK-CONTEXT
                               END-IF
      *                        Rtn Remove Non-Numeric - #String
      *                          Functions  *
     ** Function   : Remove non-numeric characters.
     ** System     : Renault Applications
     ** Programmer : Steve Bucktrout (CONSYSE)
     ** Date       : 12/10/93
     **.................................................................
     **.................................................................
     **        Remove non-alphanumeric characters from field.
      *.Start.of.User.Source............................................
           MOVE SPACES TO UN-WORK-FROM-FIELD
           MOVE SPACES TO UN-WORK-TO-FIELD
           MOVE YL0074 OF WORK-CONTEXT TO UN-WORK-FROM-FIELD
           MOVE 1 TO UN-FROM-INDEX
           MOVE 1 TO UN-TO-INDEX
      *    Move bytes from source array to target array.
           PERFORM UNTIL (UN-FROM-INDEX = 41)
      *       Move byte if eqUNl to an alphabetic character.
              IF (( UN-FROM-BYTE(UN-FROM-INDEX) >= '0'
                AND UN-FROM-BYTE(UN-FROM-INDEX) <= '9')
                OR (UN-FROM-BYTE(UN-FROM-INDEX) = ' '))
      *       Move byte if eq to a numeric character.
                 MOVE UN-FROM-BYTE(UN-FROM-INDEX) TO
                    UN-TO-BYTE(UN-TO-INDEX)
      *          Next To byte.
                 ADD 1, UN-TO-INDEX GIVING UN-TO-INDEX
              END-IF
      *       Next From byte.
              ADD 1, UN-FROM-INDEX GIVING UN-FROM-INDEX
           END-PERFORM
      *    Finished, move result of endeavour.
           MOVE UN-WORK-TO-FIELD TO YL0075 OF WORK-CONTEXT
      *.End.of.User.source..............................................
      *                        Rtn remove leading - #String Functions
      *                          *
     **----------------------------------------------------------------
     **  Remove leading character from a text field by moving the
     **    following characters to the left.
     **
     ** Called from multiple models
     **----------------------------------------------------------------
           IF  YL0075 OF WORK-CONTEXT  NOT =  SPACES
               MOVE ZEROS  TO U-CNT OF U-UTLRMVLEDS
               INSPECT YL0075 OF WORK-CONTEXT
                 TALLYING U-CNT OF U-UTLRMVLEDS
                 FOR      LEADING ' '
               IF  U-CNT OF U-UTLRMVLEDS  >  ZERO
                   IF  U-CNT  <  25
                       MOVE YL0075 OF WORK-CONTEXT
                              (U-CNT OF U-UTLRMVLEDS + 1:
                               25 - U-CNT OF U-UTLRMVLEDS)
                         TO YL0075 OF WORK-CONTEXT
                   ELSE
                       MOVE SPACES TO YL0075 OF WORK-CONTEXT
                   END-IF
               END-IF
           END-IF
      *.Rtn.remove.leading.-.End.of.user.source........................
      *
      *                        Rtn Length of a String - #String
      *                          Functions  *
     ** Function   : Return length of a string.
     ** System     : Renault Applications
     ** Programmer : Brian Etheridge
     ** Date       : 24/03/92
     **
     ** Date       : 18/02/04
     ** Programmer : H Ghaffari
     ** Description: size of index field was 2 where as the maximum
      *              search size allowed is 132!
     **.................................................................
      *.Start.of.User.source.interface..................................
      *    Initialise work fields
           MOVE SPACES TO WK-LN-INPUT-FIELD
           MOVE YL0075 OF WORK-CONTEXT  TO WK-LN-INPUT-FIELD
      *    Examine the string.
           PERFORM RTV-TEXT-LENGTH
           MOVE WK-LN-INDEX TO YL0076 OF WORK-CONTEXT
      *.End.of.User.source.interace.....................................
      *                        CASE: LCL.U:Length 3 is Four
      *                        *IF
                               IF (YL0076 OF WORK-CONTEXT = 4) THEN
                               MOVE 4 TO YRSW03
                               MOVE 1 TO YRSW02
                               IF (YRSW02 NOT > 0 OR
                                   YRSW03 NOT > 0 OR
                                   YRSW02 > 00025 OR
                                   YRSW03 > 00025) THEN
                               MOVE 'Y2U0510' TO W0RTN
                               ELSE
                               MOVE YL0075 OF WORK-CONTEXT TO W0STRNG
                               MOVE W0STRNG(YRSW02:YRSW03) TO YL0070 OF
                                 WORK-CONTEXT
                               END-IF
      *                        U:Text (4)
                               MOVE YL0070 OF WORK-CONTEXT TO YL0077 OF
                                 WORK-CONTEXT
      *                        Find Text4 in String 25
      *                        U:Position Found (NBR)
                               MOVE ZEROS TO YL0078 OF WORK-CONTEXT
      *                        U:Found
                               MOVE 'N' TO YL0079 OF WORK-CONTEXT
      *                        U:Continue (Y/N)
                               MOVE 'Y' TO YL0064 OF WORK-CONTEXT
      *                        CASE: PAR.U:Position Start (NBR) is *LE
      *                          22
      *                        *IF
                               IF (1 NOT > 22) THEN
      *                        U:Text (4)
                               MOVE SPACES TO YL0065 OF WORK-CONTEXT
                               MOVE ' ' TO YL0065 OF WORK-CONTEXT
      *                        U:Position Start (NBR)
                               MOVE 1 TO YL0066 OF WORK-CONTEXT
      *                        Loop Check for Character String
      *                        DO WHILE: LCL.U:Continue (Y/N) is Y
      *                        *DOW
                               PERFORM UNTIL NOT (YL0064 OF
                                 WORK-CONTEXT = 'Y')
                               MOVE 4 TO YRSW03
                               MOVE YL0066 OF WORK-CONTEXT TO YRSW02
                               IF (YRSW02 NOT > 0 OR
                                   YRSW03 NOT > 0 OR
                                   YRSW02 > 00025 OR
                                   YRSW03 > 00025) THEN
                               MOVE 'Y2U0510' TO W0RTN
                               ELSE
                               MOVE YL0074 OF WORK-CONTEXT TO W0STRNG
                               MOVE W0STRNG(YRSW02:YRSW03) TO YL0065 OF
                                 WORK-CONTEXT
                               END-IF
      *                        Test to See if Character String Found
      *                          (Or Not Found)
      *                        CASE: PAR.U:Find Type *EQ or *NE is
      *                          *Equals
      *                        *IF
                               IF ('*EQ' = '*EQ') THEN
      *                        CASE: LCL.U:Text (4) EQ PAR.U:Text (4)
      *                        *IF
                               IF (YL0065 OF WORK-CONTEXT = YL0077 OF
                                 WORK-CONTEXT) THEN
      *                        U:Continue (Y/N)
                               MOVE 'N' TO YL0064 OF WORK-CONTEXT
      *                        U:Found
                               MOVE 'Y' TO YL0079 OF WORK-CONTEXT
      *                        U:Position Found (NBR)
                               MOVE YL0066 OF WORK-CONTEXT TO YL0078 OF
                                 WORK-CONTEXT
                               END-IF
                               ELSE
      *                        CASE: PAR.U:Find Type *EQ or *NE is
      *                          *Not Equals
      *                        *IF
                               IF ('*EQ' = '*NE') THEN
      *                        CASE: LCL.U:Text (4) NE PAR.U:Text (4)
      *                        *IF
                               IF (YL0065 OF WORK-CONTEXT NOT = YL0077
                                 OF WORK-CONTEXT) THEN
      *                        U:Continue (Y/N)
                               MOVE 'N' TO YL0064 OF WORK-CONTEXT
      *                        U:Found
                               MOVE 'Y' TO YL0079 OF WORK-CONTEXT
      *                        U:Position Found (NBR)
                               MOVE YL0066 OF WORK-CONTEXT TO YL0078 OF
                                 WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
      *                        U:Position Start (NBR)
                               ADD YL0066 OF WORK-CONTEXT, 1 GIVING
                                 YL0066 OF WORK-CONTEXT
      *                        Carry On Checking ?
      *                        CASE:
      *                        - c1 AND c2
      *                        |- c1    : LCL.U:Position Start (NBR)
      *                          is *LE 22
      *                        |- c2    : LCL.U:Continue (Y/N) is Y
      *                        '-
      *                        *IF
                               IF (YL0066 OF WORK-CONTEXT NOT > 22 AND
                                   YL0064 OF WORK-CONTEXT = 'Y') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue (Y/N)
                               MOVE 'N' TO YL0064 OF WORK-CONTEXT
                               END-IF
      *                        *ITR
                               END-PERFORM
                               END-IF
      *                        CASE: LCL.U:Found is Y
      *                        *IF
                               IF (YL0079 OF WORK-CONTEXT = 'Y') THEN
      *                        LCL.U:Length 2 =
      *                        *COMPUTE (x1 - x2)
      *                        x1    : LCL.U:Position Found (NBR)
      *                        -     : PGM.*Synon (17,7) work field
      *                        x2    : CON.3
      *                        *Synon (17,7) work field
                               SUBTRACT 3 FROM YL0078 OF WORK-CONTEXT
                                 GIVING W0WD00
      *                        U:Length 2
                               MOVE W0WD00 TO YL0080 OF WORK-CONTEXT
                               MOVE YL0080 OF WORK-CONTEXT TO YRSW03
                               MOVE 1 TO YRSW02
                               IF (YRSW02 NOT > 0 OR
                                   YRSW03 NOT > 0 OR
                                   YRSW02 > 00025 OR
                                   YRSW03 > 00025) THEN
                               MOVE 'Y2U0510' TO W0RTN
                               ELSE
                               MOVE YL0074 OF WORK-CONTEXT TO W0STRNG
                               MOVE W0STRNG(YRSW02:YRSW03) TO YL0071 OF
                                 WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                           END-IF
      *                    Utl Rtv BMO Vers Equip - BMO Vers. Techn
      *                      Equipment  * 1121 Max Speed
                           SET C-INDICATOR-OFF(90) TO TRUE
                           MOVE J6SCMDLCDE OF FVEHDF2 OF VAVEHDTALE-R
                             TO WQ0048
                           MOVE J6SCVERCDE OF FVEHDF2 OF VAVEHDTALE-R
                             TO WQ0049
                           MOVE '1121' TO WQ0050
                           MOVE SPACES TO WQ0051
      *
                           CALL 'RAB000180S' USING
      *                    Return code
                             W0RTN
      *                    SCP Model code
                             WQ0048
      *                    SCP Model Version Code
                             WQ0049
      *                    Technical Equipment Code
                             WQ0050
      *                    Technical Equipment Value
                             WQ0051
                                    ON OVERFLOW
                                    SET C-INDICATOR-ON(90) TO TRUE
                           END-CALL
      *
                           MOVE WQ0051 TO YL0049 OF WORK-CONTEXT
      *
      *                    Error on program call will terminate run unit
                           IF (C-INDICATOR-ON(90)) THEN
                               MOVE 'Y2U0032' TO W0RTN
                               MOVE 'RAB000180S' TO W0CLPG
      *                        Send message '*Error occured on CALL...'
      *                        Message ID
                               MOVE 'Y2U0032' TO ZAMSID
      *                        Message file
                               MOVE 'Y2USRMSG' TO ZAMSGF
      *                        Message data
                               MOVE W0CLPG TO ZAMSDA
                               PERFORM ZASNMS
                           END-IF
      *                    Error detected?
                           IF (W0RTN        NOT = SPACES) THEN
                               SET C-INDICATOR-ON(99) TO TRUE
                           END-IF
      *                    Vehicle Top Speed
                           MOVE YL0049 OF WORK-CONTEXT TO YL0081 OF
                             WORK-CONTEXT
      *                    Utl Rtv BMO Vers Equip - BMO Vers. Techn
      *                      Equipment  * 1664 Wheelbase
                           SET C-INDICATOR-OFF(90) TO TRUE
                           MOVE J6SCMDLCDE OF FVEHDF2 OF VAVEHDTALE-R
                             TO WQ0052
                           MOVE J6SCVERCDE OF FVEHDF2 OF VAVEHDTALE-R
                             TO WQ0053
                           MOVE '1664' TO WQ0054
                           MOVE SPACES TO WQ0055
      *
                           CALL 'RAB000180S' USING
      *                    Return code
                             W0RTN
      *                    SCP Model code
                             WQ0052
      *                    SCP Model Version Code
                             WQ0053
      *                    Technical Equipment Code
                             WQ0054
      *                    Technical Equipment Value
                             WQ0055
                                    ON OVERFLOW
                                    SET C-INDICATOR-ON(90) TO TRUE
                           END-CALL
      *
                           MOVE WQ0055 TO YL0049 OF WORK-CONTEXT
      *
      *                    Error on program call will terminate run unit
                           IF (C-INDICATOR-ON(90)) THEN
                               MOVE 'Y2U0032' TO W0RTN
                               MOVE 'RAB000180S' TO W0CLPG
      *                        Send message '*Error occured on CALL...'
      *                        Message ID
                               MOVE 'Y2U0032' TO ZAMSID
      *                        Message file
                               MOVE 'Y2USRMSG' TO ZAMSGF
      *                        Message data
                               MOVE W0CLPG TO ZAMSDA
                               PERFORM ZASNMS
                           END-IF
      *                    Error detected?
                           IF (W0RTN        NOT = SPACES) THEN
                               SET C-INDICATOR-ON(99) TO TRUE
                           END-IF
      *                    Vehicle Wheelbase
                           MOVE YL0049 OF WORK-CONTEXT TO YL0082 OF
                             WORK-CONTEXT
      *                    Utl Rtv BMO Vers Equip - BMO Vers. Techn
      *                      Equipment  * 5546 Driving Range
                           SET C-INDICATOR-OFF(90) TO TRUE
                           MOVE J6SCMDLCDE OF FVEHDF2 OF VAVEHDTALE-R
                             TO WQ0056
                           MOVE J6SCVERCDE OF FVEHDF2 OF VAVEHDTALE-R
                             TO WQ0057
                           MOVE '5546' TO WQ0058
                           MOVE SPACES TO WQ0059
      *
                           CALL 'RAB000180S' USING
      *                    Return code
                             W0RTN
      *                    SCP Model code
                             WQ0056
      *                    SCP Model Version Code
                             WQ0057
      *                    Technical Equipment Code
                             WQ0058
      *                    Technical Equipment Value
                             WQ0059
                                    ON OVERFLOW
                                    SET C-INDICATOR-ON(90) TO TRUE
                           END-CALL
      *
                           MOVE WQ0059 TO YL0049 OF WORK-CONTEXT
      *
      *                    Error on program call will terminate run unit
                           IF (C-INDICATOR-ON(90)) THEN
                               MOVE 'Y2U0032' TO W0RTN
                               MOVE 'RAB000180S' TO W0CLPG
      *                        Send message '*Error occured on CALL...'
      *                        Message ID
                               MOVE 'Y2U0032' TO ZAMSID
      *                        Message file
                               MOVE 'Y2USRMSG' TO ZAMSGF
      *                        Message data
                               MOVE W0CLPG TO ZAMSDA
                               PERFORM ZASNMS
                           END-IF
      *                    Error detected?
                           IF (W0RTN        NOT = SPACES) THEN
                               SET C-INDICATOR-ON(99) TO TRUE
                           END-IF
      *                    Vehicle Range
                           MOVE YL0049 OF WORK-CONTEXT TO YL0083 OF
                             WORK-CONTEXT
                       END-IF
      *                Set Parm Fields
                       PERFORM UA3SUBR
      *                Crt/Chg Autotrader Bulk U - Autotrader Bulk
      *                  Upload  *
                       PERFORM SC3CRRC
      *                Phase
                       MOVE J6O2ST OF FVEHDF2 OF VAVEHDTALE-R TO YL0010
                         OF WORK-CONTEXT
      *                SCP Model Version Code
                       MOVE J6SCVERCDE OF FVEHDF2 OF VAVEHDTALE-R TO
                         YL0011 OF WORK-CONTEXT
                   END-IF
               END-IF
               SET C-INDICATOR-OFF(90) TO TRUE
               READ VAVEHDTALE NEXT
                 FORMAT IS 'FVEHDF2'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         FVEHDF2 OF VAVEHDTALE-R TO
                         EXTSA2
                       MOVE EXTSA2 TO KRSSA2-TMP
                       IF (KRSSA2 NOT = KRSSA2-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        SCP Model code
               MOVE LOW-VALUES TO J6SCMDLCDE OF EXTSA2
      *        Phase
               MOVE LOW-VALUES TO J6O2ST OF EXTSA2
      *        SCP Model Version Code
               MOVE LOW-VALUES TO J6SCVERCDE OF EXTSA2
           END-PERFORM
      *==============================================================
           CONTINUE.
       SA2EXIT.
           EXIT.
      /EJECT
       SA3RVGN SECTION.
      *==============================================================
      *    Rtv Set Descr by SCP code - AOC Set Version  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    SCP Model code
           MOVE J6SCMDLCDE OF FVEHDF2 OF VAVEHDTALE-R TO SLSCMDLCDE OF
             KRSSA3
      *    Phase
           MOVE J6O2ST OF FVEHDF2 OF VAVEHDTALE-R TO SLO2ST OF KRSSA3
      *    SCP Model Version Code
           MOVE J6SCVERCDE OF FVEHDF2 OF VAVEHDTALE-R TO SLSCVERCDE OF
             KRSSA3
      *    Initialise Full Externally Described Keylist
      *    SCP Model code
           MOVE LOW-VALUES TO SLSCMDLCDE OF EXTSA3
      *    Phase
           MOVE LOW-VALUES TO SLO2ST OF EXTSA3
      *    SCP Model Version Code
           MOVE LOW-VALUES TO SLSCVERCDE OF EXTSA3
           MOVE CORRESPONDING
             EXTSA3 TO
             FVERSYY OF RAVERSETL6-R
           MOVE CORRESPONDING
             KRSSA3 TO
             FVERSYY OF RAVERSETL6-R
           START RAVERSETL6 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'FVERSYY'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ RAVERSETL6 NEXT
             FORMAT IS 'FVERSYY'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     FVERSYY OF RAVERSETL6-R TO
                     EXTSA3
                   MOVE EXTSA3 TO KRSSA3-TMP
                   IF (KRSSA3 NOT = KRSSA3-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    SCP Model code
           MOVE LOW-VALUES TO SLSCMDLCDE OF EXTSA3
      *    Phase
           MOVE LOW-VALUES TO SLO2ST OF EXTSA3
      *    SCP Model Version Code
           MOVE LOW-VALUES TO SLSCVERCDE OF EXTSA3
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'JSM2169' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        AOC Parent Set Descript
               MOVE SPACES TO YL0028 OF WORK-CONTEXT
      *        AOC Set Description
               MOVE SPACES TO YL0029 OF WORK-CONTEXT
               GO SA3EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        AOC Parent Set Descript
               MOVE SLAOCPSTD OF FVERSYY OF RAVERSETL6-R TO YL0028 OF
                 WORK-CONTEXT
      *        AOC Set Description
               MOVE SLAOCSETD OF FVERSYY OF RAVERSETL6-R TO YL0029 OF
                 WORK-CONTEXT
               SET C-INDICATOR-OFF(90) TO TRUE
               READ RAVERSETL6 NEXT
                 FORMAT IS 'FVERSYY'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         FVERSYY OF RAVERSETL6-R TO
                         EXTSA3
                       MOVE EXTSA3 TO KRSSA3-TMP
                       IF (KRSSA3 NOT = KRSSA3-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        SCP Model code
               MOVE LOW-VALUES TO SLSCMDLCDE OF EXTSA3
      *        Phase
               MOVE LOW-VALUES TO SLO2ST OF EXTSA3
      *        SCP Model Version Code
               MOVE LOW-VALUES TO SLSCVERCDE OF EXTSA3
           END-PERFORM
      *==============================================================
           CONTINUE.
       SA3EXIT.
           EXIT.
      /EJECT
       SA4RVGN SECTION.
      *==============================================================
      *    Rtv Set Descr by SCP code - AOC Set Version  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    SCP Model code
           MOVE J6SCMDLCDE OF FVEHDF2 OF VAVEHDTALE-R TO SLSCMDLCDE OF
             KRSSA4
      *    Phase
           MOVE J6O2ST OF FVEHDF2 OF VAVEHDTALE-R TO SLO2ST OF KRSSA4
      *    SCP Model Version Code
           MOVE J6SCVERCDE OF FVEHDF2 OF VAVEHDTALE-R TO SLSCVERCDE OF
             KRSSA4
      *    Initialise Full Externally Described Keylist
      *    SCP Model code
           MOVE LOW-VALUES TO SLSCMDLCDE OF EXTSA4
      *    Phase
           MOVE LOW-VALUES TO SLO2ST OF EXTSA4
      *    SCP Model Version Code
           MOVE LOW-VALUES TO SLSCVERCDE OF EXTSA4
           MOVE CORRESPONDING
             EXTSA4 TO
             FVERSYY OF RAVERSETL6-R
           MOVE CORRESPONDING
             KRSSA4 TO
             FVERSYY OF RAVERSETL6-R
           START RAVERSETL6 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'FVERSYY'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ RAVERSETL6 NEXT
             FORMAT IS 'FVERSYY'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     FVERSYY OF RAVERSETL6-R TO
                     EXTSA4
                   MOVE EXTSA4 TO KRSSA4-TMP
                   IF (KRSSA4 NOT = KRSSA4-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    SCP Model code
           MOVE LOW-VALUES TO SLSCMDLCDE OF EXTSA4
      *    Phase
           MOVE LOW-VALUES TO SLO2ST OF EXTSA4
      *    SCP Model Version Code
           MOVE LOW-VALUES TO SLSCVERCDE OF EXTSA4
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'JSM2169' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        AOC Parent Set Descript
               MOVE SPACES TO YL0028 OF WORK-CONTEXT
      *        AOC Set Description
               MOVE SPACES TO YL0029 OF WORK-CONTEXT
               GO SA4EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        AOC Parent Set Descript
               MOVE SLAOCPSTD OF FVERSYY OF RAVERSETL6-R TO YL0028 OF
                 WORK-CONTEXT
      *        AOC Set Description
               MOVE SLAOCSETD OF FVERSYY OF RAVERSETL6-R TO YL0029 OF
                 WORK-CONTEXT
               SET C-INDICATOR-OFF(90) TO TRUE
               READ RAVERSETL6 NEXT
                 FORMAT IS 'FVERSYY'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         FVERSYY OF RAVERSETL6-R TO
                         EXTSA4
                       MOVE EXTSA4 TO KRSSA4-TMP
                       IF (KRSSA4 NOT = KRSSA4-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        SCP Model code
               MOVE LOW-VALUES TO SLSCMDLCDE OF EXTSA4
      *        Phase
               MOVE LOW-VALUES TO SLO2ST OF EXTSA4
      *        SCP Model Version Code
               MOVE LOW-VALUES TO SLSCVERCDE OF EXTSA4
           END-PERFORM
      *==============================================================
           CONTINUE.
       SA4EXIT.
           EXIT.
      /EJECT
       SA5RVGN SECTION.
      *==============================================================
      *    Rtv CAP Fields - SFA CAP Xref  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    SCP Model code
           MOVE J6SCMDLCDE OF FVEHDF2 OF VAVEHDTALE-R TO SJSCMDLCDE OF
             KRSSA5
      *    SCP Model Version Code
           MOVE J6SCVERCDE OF FVEHDF2 OF VAVEHDTALE-R TO SJSCVERCDE OF
             KRSSA5
      *    Initialise Full Externally Described Keylist
      *    SCP Model code
           MOVE LOW-VALUES TO SJSCMDLCDE OF EXTSA5
      *    SCP Model Version Code
           MOVE LOW-VALUES TO SJSCVERCDE OF EXTSA5
           MOVE CORRESPONDING
             KRSSA5 TO
             SFACAPXRF1 OF SFACAPXRL1-R
           SET C-INDICATOR-OFF(90) TO TRUE
           READ SFACAPXRL1
             FORMAT IS 'SFACAPXRF1'
           END-READ
           IF (C-NO-RECORD) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               END-IF
           END-IF
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'JSM2164' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        CAP Vehicle Code
               MOVE SPACES TO YL0035 OF WORK-CONTEXT
      *        CAP Vehicle ID Number
               MOVE ZEROS TO YL0036 OF WORK-CONTEXT
      *        CAP Model Dsc Cleansed
               MOVE SPACES TO YL0037 OF WORK-CONTEXT
      *        CAP Version Dsc Cleansed
               MOVE SPACES TO YL0038 OF WORK-CONTEXT
               GO SA5EXIT
           END-IF
      *
           IF (C-INDICATOR-OFF(90)) THEN
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        CAP Vehicle Code
               MOVE SJCAPVEHCD OF SFACAPXRF1 OF SFACAPXRL1-R TO YL0035
                 OF WORK-CONTEXT
      *        CAP Vehicle ID Number
               MOVE SJCAPVEHNB OF SFACAPXRF1 OF SFACAPXRL1-R TO YL0036
                 OF WORK-CONTEXT
      *        CAP Model Dsc Cleansed
               MOVE SJCAPMDLDC OF SFACAPXRF1 OF SFACAPXRL1-R TO YL0037
                 OF WORK-CONTEXT
      *        CAP Version Dsc Cleansed
               MOVE SJCAPVERDC OF SFACAPXRF1 OF SFACAPXRL1-R TO YL0038
                 OF WORK-CONTEXT
           END-IF
      *==============================================================
           CONTINUE.
       SA5EXIT.
           EXIT.
      /EJECT
       SA6RVGN SECTION.
      *==============================================================
      *    Rtv KSP Features for SCP - Model Varient KSP  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    SCP Model code
           MOVE J6SCMDLCDE OF FVEHDF2 OF VAVEHDTALE-R TO B7SCMDLCDE OF
             KRSSA6
      *    Phase
           MOVE J6O2ST OF FVEHDF2 OF VAVEHDTALE-R TO B7O2ST OF KRSSA6
      *    SCP Model Version Code
           MOVE J6SCVERCDE OF FVEHDF2 OF VAVEHDTALE-R TO B7SCVERCDE OF
             KRSSA6
      *    Initialise Full Externally Described Keylist
      *    SCP Model code
           MOVE LOW-VALUES TO B7SCMDLCDE OF EXTSA6
      *    Phase
           MOVE LOW-VALUES TO B7O2ST OF EXTSA6
      *    SCP Model Version Code
           MOVE LOW-VALUES TO B7SCVERCDE OF EXTSA6
           MOVE CORRESPONDING
             EXTSA6 TO
             VAMVVSCPF2 OF VAMVVSCPL2-R
           MOVE CORRESPONDING
             KRSSA6 TO
             VAMVVSCPF2 OF VAMVVSCPL2-R
           START VAMVVSCPL2 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'VAMVVSCPF2'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ VAMVVSCPL2 NEXT
             FORMAT IS 'VAMVVSCPF2'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     VAMVVSCPF2 OF VAMVVSCPL2-R TO
                     EXTSA6
                   MOVE EXTSA6 TO KRSSA6-TMP
                   IF (KRSSA6 NOT = KRSSA6-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    SCP Model code
           MOVE LOW-VALUES TO B7SCMDLCDE OF EXTSA6
      *    Phase
           MOVE LOW-VALUES TO B7O2ST OF EXTSA6
      *    SCP Model Version Code
           MOVE LOW-VALUES TO B7SCVERCDE OF EXTSA6
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'JSM2474' TO W0RTN
           END-IF
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
     W* Y2W0053 - One or more arguments defaulted to available contexts
      *        Field '(PAR) YL0043 OF WORK-CONTEXT' defaulted for
      *          'Vehicle Version KSP All'.
      *        Field '(PAR) ','' defaulted for 'U:Delimiter'.
      *        Field '(PAR) ','' defaulted for 'U:Text to inspect for'.
      *        Field '(PAR) ' '' defaulted for 'U:Text to replace by'.
      *        Rtv KSP Features All - Model Varient KSP Fea Lst  *
               PERFORM SA7RVGN
      *        *QUIT
               GO SA6EXIT
               SET C-INDICATOR-OFF(90) TO TRUE
               READ VAMVVSCPL2 NEXT
                 FORMAT IS 'VAMVVSCPF2'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         VAMVVSCPF2 OF VAMVVSCPL2-R TO
                         EXTSA6
                       MOVE EXTSA6 TO KRSSA6-TMP
                       IF (KRSSA6 NOT = KRSSA6-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        SCP Model code
               MOVE LOW-VALUES TO B7SCMDLCDE OF EXTSA6
      *        Phase
               MOVE LOW-VALUES TO B7O2ST OF EXTSA6
      *        SCP Model Version Code
               MOVE LOW-VALUES TO B7SCVERCDE OF EXTSA6
           END-PERFORM
      *==============================================================
           CONTINUE.
       SA6EXIT.
           EXIT.
      /EJECT
       SA7RVGN SECTION.
      *==============================================================
      *    Rtv KSP Features All - Model Varient KSP Fea Lst  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    SCP Model code
           MOVE B7SCMDLCDE OF VAMVVSCPF2 OF VAMVVSCPL2-R TO B8SCMDLCDE
             OF KRSSA7
      *    Phase
           MOVE B7O2ST OF VAMVVSCPF2 OF VAMVVSCPL2-R TO B8O2ST OF KRSSA7
      *    Vehicle Model KSP Varient
           MOVE B7MVKSPVAR OF VAMVVSCPF2 OF VAMVVSCPL2-R TO B8MVKSPVAR
             OF KRSSA7
      *    Initialise Full Externally Described Keylist
      *    SCP Model code
           MOVE LOW-VALUES TO B8SCMDLCDE OF EXTSA7
      *    Phase
           MOVE LOW-VALUES TO B8O2ST OF EXTSA7
      *    Vehicle Model KSP Varient
           MOVE LOW-VALUES TO B8MVKSPVAR OF EXTSA7
      *    Model Version KSP Seq
           MOVE -999 TO B8MVKSPSEQ OF EXTSA7
           MOVE CORRESPONDING
             EXTSA7 TO
             VAMVLSTF1 OF VAMVFLSTL1-R
           MOVE CORRESPONDING
             KRSSA7 TO
             VAMVLSTF1 OF VAMVFLSTL1-R
           START VAMVFLSTL1 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'VAMVLSTF1'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ VAMVFLSTL1 NEXT
             FORMAT IS 'VAMVLSTF1'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     VAMVLSTF1 OF VAMVFLSTL1-R TO
                     EXTSA7
                   MOVE EXTSA7 TO KRSSA7-TMP
                   IF (KRSSA7 NOT = KRSSA7-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    SCP Model code
           MOVE LOW-VALUES TO B8SCMDLCDE OF EXTSA7
      *    Phase
           MOVE LOW-VALUES TO B8O2ST OF EXTSA7
      *    Vehicle Model KSP Varient
           MOVE LOW-VALUES TO B8MVKSPVAR OF EXTSA7
      *    Model Version KSP Seq
           MOVE -999 TO B8MVKSPSEQ OF EXTSA7
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'JSM2476' TO W0RTN
           END-IF
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        CASE: DB1.Model Version KSP Spec is *Not Blank
      *        *IF
               IF (B8MVKSPSPC OF VAMVLSTF1 OF VAMVFLSTL1-R NOT = ' ')
                 THEN
      *            Model Version KSP Spec
                   MOVE B8MVKSPSPC OF VAMVLSTF1 OF VAMVFLSTL1-R TO
                     YL0044 OF WORK-CONTEXT
      *            Rtn Inspect replacing - #String Functions  *
     ***-------------------------------------------------------------**
     ***   COBOL inspect replacing statement                         **
     ***                                                             **
     ***   System  . . . . . :   Renault UK utilties                 **
     ***   User source name  :   RAUINSRPLS                          **
     ***   Author  . . . . . :   Maurice Mead                        **
     ***   Date written  . . :   14/04/2009                          **
     ***   Request . . . . . :   RN-CHG-425505                       **
     ***                                                             **
     ***   See the SYNON/2 narrative text for full details and the   **
     ***     maintenance log.                                        **
     ***-------------------------------------------------------------**
           MOVE ZEROS   TO YL0045 OF WORK-CONTEXT
           INSPECT YL0044 OF WORK-CONTEXT
             TALLYING YL0045 OF WORK-CONTEXT
             FOR ALL ','
             REPLACING ALL ','
             BY ' '
      *.Rtn.Inspect.replacing.-.End.of.user.source.....................
      *            CASE: PAR.Vehicle Version KSP All is *Not Blank
      *            *IF
                   IF (YL0043 OF WORK-CONTEXT NOT = ' ') THEN
                       MOVE ZEROS TO YRSW03
                       MOVE 'T' TO YRSW05
                       IF (YL0043 OF WORK-CONTEXT = SPACES AND
                           YRSW05 = 'T') THEN
                           ADD  1 TO ZEROS GIVING YRSW04
                       ELSE
                           ADD  1 TO 03000 GIVING YRSW04
                       END-IF
                       MOVE 03000 TO YRSW02
                       MOVE YL0043 OF WORK-CONTEXT TO YRSW06
                       PERFORM ZCATWK
                       STRING YRSW06 DELIMITED BY X'FF',
                              ',' DELIMITED BY SIZE
                       INTO   YRSW06
                       MOVE YRSW06 TO YL0043 OF WORK-CONTEXT
                   END-IF
                   MOVE ZEROS TO YRSW03
                   MOVE 'T' TO YRSW05
                   IF (YL0043 OF WORK-CONTEXT = SPACES AND
                       YRSW05 = 'T') THEN
                       ADD  1 TO ZEROS GIVING YRSW04
                   ELSE
                       ADD  1 TO 03000 GIVING YRSW04
                   END-IF
                   MOVE 03000 TO YRSW02
                   MOVE YL0043 OF WORK-CONTEXT TO YRSW06
                   PERFORM ZCATWK
                   STRING YRSW06 DELIMITED BY X'FF',
                          YL0044 OF WORK-CONTEXT DELIMITED BY SIZE
                   INTO   YRSW06
                   MOVE YRSW06 TO YL0043 OF WORK-CONTEXT
               END-IF
               SET C-INDICATOR-OFF(90) TO TRUE
               READ VAMVFLSTL1 NEXT
                 FORMAT IS 'VAMVLSTF1'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         VAMVLSTF1 OF VAMVFLSTL1-R TO
                         EXTSA7
                       MOVE EXTSA7 TO KRSSA7-TMP
                       IF (KRSSA7 NOT = KRSSA7-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        SCP Model code
               MOVE LOW-VALUES TO B8SCMDLCDE OF EXTSA7
      *        Phase
               MOVE LOW-VALUES TO B8O2ST OF EXTSA7
      *        Vehicle Model KSP Varient
               MOVE LOW-VALUES TO B8MVKSPVAR OF EXTSA7
      *        Model Version KSP Seq
               MOVE -999 TO B8MVKSPSEQ OF EXTSA7
           END-PERFORM
      *==============================================================
           CONTINUE.
       SA7EXIT.
           EXIT.
      /EJECT
       SA8RVGN SECTION.
      *==============================================================
      *    Rtv by Mdl/Phs/Ver/Dte - AOC Version Price  * FRF First Reg
      *      Fee
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    USER: Initialize routine
      *    PAR = CON By name
      *    AOC Price/Pct Value
           MOVE ZEROS TO YL0047 OF WORK-CONTEXT
      *    Setup key
      *    SCP Model code
           MOVE J6SCMDLCDE OF FVEHDF2 OF VAVEHDTALE-R TO RCSCMDLCDE OF
             KRSSA8
      *    Phase
           MOVE J6O2ST OF FVEHDF2 OF VAVEHDTALE-R TO RCO2ST OF KRSSA8
      *    SCP Model Version Code
           MOVE J6SCVERCDE OF FVEHDF2 OF VAVEHDTALE-R TO RCSCVERCDE OF
             KRSSA8
      *    Initialise Full Externally Described Keylist
      *    SCP Model code
           MOVE LOW-VALUES TO RCSCMDLCDE OF EXTSA8
      *    Phase
           MOVE LOW-VALUES TO RCO2ST OF EXTSA8
      *    SCP Model Version Code
           MOVE LOW-VALUES TO RCSCVERCDE OF EXTSA8
      *    Price Start Date - Dealer
           MOVE 99999999 TO RCPRCDTDLR OF EXTSA8
           MOVE CORRESPONDING
             EXTSA8 TO
             FAOCVR7 OF RAAOCVPRL2-R
           MOVE CORRESPONDING
             KRSSA8 TO
             FAOCVR7 OF RAAOCVPRL2-R
           START RAAOCVPRL2 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'FAOCVR7'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ RAAOCVPRL2 NEXT
             FORMAT IS 'FAOCVR7'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     FAOCVR7 OF RAAOCVPRL2-R TO
                     EXTSA8
                   MOVE EXTSA8 TO KRSSA8-TMP
                   IF (KRSSA8 NOT = KRSSA8-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    SCP Model code
           MOVE LOW-VALUES TO RCSCMDLCDE OF EXTSA8
      *    Phase
           MOVE LOW-VALUES TO RCO2ST OF EXTSA8
      *    SCP Model Version Code
           MOVE LOW-VALUES TO RCSCVERCDE OF EXTSA8
      *    Price Start Date - Dealer
           MOVE 99999999 TO RCPRCDTDLR OF EXTSA8
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'JSM2071' TO W0RTN
           END-IF
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        CASE: DB1.AOC Spec ID EQ PAR.AOC Spec ID
      *        *IF
               IF (RCBMOSPEC OF FAOCVR7 OF RAAOCVPRL2-R = 'FRF') THEN
      *            PAR = DB1 By name
      *            AOC Price/Pct Value
                   MOVE RCBMOVAL OF FAOCVR7 OF RAAOCVPRL2-R TO YL0047
                     OF WORK-CONTEXT
      *            *QUIT
                   GO SA8EXIT
               END-IF
               SET C-INDICATOR-OFF(90) TO TRUE
               READ RAAOCVPRL2 NEXT
                 FORMAT IS 'FAOCVR7'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         FAOCVR7 OF RAAOCVPRL2-R TO
                         EXTSA8
                       MOVE EXTSA8 TO KRSSA8-TMP
                       IF (KRSSA8 NOT = KRSSA8-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        SCP Model code
               MOVE LOW-VALUES TO RCSCMDLCDE OF EXTSA8
      *        Phase
               MOVE LOW-VALUES TO RCO2ST OF EXTSA8
      *        SCP Model Version Code
               MOVE LOW-VALUES TO RCSCVERCDE OF EXTSA8
      *        Price Start Date - Dealer
               MOVE 99999999 TO RCPRCDTDLR OF EXTSA8
           END-PERFORM
      *    USER: Exit processing
      *    *Return code
           MOVE 'Y2U0005' TO W0RTN
      *==============================================================
           CONTINUE.
       SA8EXIT.
           EXIT.
      /EJECT
       SA9RVGN SECTION.
      *==============================================================
      *    Rtv by Mdl/Phs/Ver/Dte - AOC Version Price  * FVIGN Road
      *      Fund License
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    USER: Initialize routine
      *    PAR = CON By name
      *    AOC Price/Pct Value
           MOVE ZEROS TO YL0047 OF WORK-CONTEXT
      *    Setup key
      *    SCP Model code
           MOVE J6SCMDLCDE OF FVEHDF2 OF VAVEHDTALE-R TO RCSCMDLCDE OF
             KRSSA9
      *    Phase
           MOVE J6O2ST OF FVEHDF2 OF VAVEHDTALE-R TO RCO2ST OF KRSSA9
      *    SCP Model Version Code
           MOVE J6SCVERCDE OF FVEHDF2 OF VAVEHDTALE-R TO RCSCVERCDE OF
             KRSSA9
      *    Initialise Full Externally Described Keylist
      *    SCP Model code
           MOVE LOW-VALUES TO RCSCMDLCDE OF EXTSA9
      *    Phase
           MOVE LOW-VALUES TO RCO2ST OF EXTSA9
      *    SCP Model Version Code
           MOVE LOW-VALUES TO RCSCVERCDE OF EXTSA9
      *    Price Start Date - Dealer
           MOVE 99999999 TO RCPRCDTDLR OF EXTSA9
           MOVE CORRESPONDING
             EXTSA9 TO
             FAOCVR7 OF RAAOCVPRL2-R
           MOVE CORRESPONDING
             KRSSA9 TO
             FAOCVR7 OF RAAOCVPRL2-R
           START RAAOCVPRL2 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'FAOCVR7'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ RAAOCVPRL2 NEXT
             FORMAT IS 'FAOCVR7'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     FAOCVR7 OF RAAOCVPRL2-R TO
                     EXTSA9
                   MOVE EXTSA9 TO KRSSA9-TMP
                   IF (KRSSA9 NOT = KRSSA9-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    SCP Model code
           MOVE LOW-VALUES TO RCSCMDLCDE OF EXTSA9
      *    Phase
           MOVE LOW-VALUES TO RCO2ST OF EXTSA9
      *    SCP Model Version Code
           MOVE LOW-VALUES TO RCSCVERCDE OF EXTSA9
      *    Price Start Date - Dealer
           MOVE 99999999 TO RCPRCDTDLR OF EXTSA9
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'JSM2071' TO W0RTN
           END-IF
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        CASE: DB1.AOC Spec ID EQ PAR.AOC Spec ID
      *        *IF
               IF (RCBMOSPEC OF FAOCVR7 OF RAAOCVPRL2-R = 'FVIGN') THEN
      *            PAR = DB1 By name
      *            AOC Price/Pct Value
                   MOVE RCBMOVAL OF FAOCVR7 OF RAAOCVPRL2-R TO YL0047
                     OF WORK-CONTEXT
      *            *QUIT
                   GO SA9EXIT
               END-IF
               SET C-INDICATOR-OFF(90) TO TRUE
               READ RAAOCVPRL2 NEXT
                 FORMAT IS 'FAOCVR7'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         FAOCVR7 OF RAAOCVPRL2-R TO
                         EXTSA9
                       MOVE EXTSA9 TO KRSSA9-TMP
                       IF (KRSSA9 NOT = KRSSA9-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        SCP Model code
               MOVE LOW-VALUES TO RCSCMDLCDE OF EXTSA9
      *        Phase
               MOVE LOW-VALUES TO RCO2ST OF EXTSA9
      *        SCP Model Version Code
               MOVE LOW-VALUES TO RCSCVERCDE OF EXTSA9
      *        Price Start Date - Dealer
               MOVE 99999999 TO RCPRCDTDLR OF EXTSA9
           END-PERFORM
      *    USER: Exit processing
      *    *Return code
           MOVE 'Y2U0005' TO W0RTN
      *==============================================================
           CONTINUE.
       SA9EXIT.
           EXIT.
      /EJECT
       SB1RVGN SECTION.
      *==============================================================
      *    Rtv Retail/Second Dealer - Autotrader Ret/Sec Dealer  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    Dealer number (alpha)
           MOVE J6DLVACC OF FVEHDF2 OF VAVEHDTALE-R TO CODLRNBRX OF
             KRSSB1
      *    Initialise Full Externally Described Keylist
      *    Dealer number (alpha)
           MOVE LOW-VALUES TO CODLRNBRX OF EXTSB1
           MOVE CORRESPONDING
             KRSSB1 TO
             FRDLRM2 OF AGRDLR10L1-R
           SET C-INDICATOR-OFF(90) TO TRUE
           READ AGRDLR10L1
             FORMAT IS 'FRDLRM2'
           END-READ
           IF (C-NO-RECORD) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               END-IF
           END-IF
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'JSM2508' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SB1EXIT
           END-IF
      *
           IF (C-INDICATOR-OFF(90)) THEN
      *        USER: Process Data record
      *        PAR = DB1 By name
               CONTINUE
           END-IF
      *==============================================================
           CONTINUE.
       SB1EXIT.
           EXIT.
      /EJECT
       SB2RVGN SECTION.
      *==============================================================
      *    Rtv Vehicle by VIN - Vehicle  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    USER: Initialize routine
      *    Maintenance:-
      *    CASE: *OTHERWISE
      *    -------------------------------------------------------------
      *    29/01/2014  RN-CHG-674846         Maurice Mead
      *    New fields added to the Vehicle file.
      *    -------------------------------------------------------------
      *    Setup key
      *    VIN
           MOVE J6VIN OF FVEHDF2 OF VAVEHDTALE-R TO J6VIN OF KRSSB2
      *    Initialise Full Externally Described Keylist
      *    VIN
           MOVE LOW-VALUES TO J6VIN OF EXTSB2
           MOVE CORRESPONDING
             EXTSB2 TO
             FVEHDQB OF VAVEHDTAL2-R
           MOVE CORRESPONDING
             KRSSB2 TO
             FVEHDQB OF VAVEHDTAL2-R
           START VAVEHDTAL2 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'FVEHDQB'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ VAVEHDTAL2 NEXT
             FORMAT IS 'FVEHDQB'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     FVEHDQB OF VAVEHDTAL2-R TO
                     EXTSB2
                   MOVE EXTSB2 TO KRSSB2-TMP
                   IF (KRSSB2 NOT = KRSSB2-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    VIN
           MOVE LOW-VALUES TO J6VIN OF EXTSB2
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'JSM1386' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        SCP Model code
               MOVE SPACES TO YL0131 OF WORK-CONTEXT
      *        SCP Model Version Code
               MOVE SPACES TO YL0132 OF WORK-CONTEXT
      *        Colour Code
               MOVE SPACES TO YL0133 OF WORK-CONTEXT
      *        SCP Options
               MOVE SPACES TO YL0134 OF WORK-CONTEXT
      *        SCP Trim Type
               MOVE SPACES TO YL0135 OF WORK-CONTEXT
      *        SCP Trim Colour
               MOVE SPACES TO YL0136 OF WORK-CONTEXT
      *        SCR Model Year
               MOVE SPACES TO YL0137 OF WORK-CONTEXT
      *        SCR Model Year Variation
               MOVE SPACES TO YL0138 OF WORK-CONTEXT
      *        Phase
               MOVE SPACES TO YL0139 OF WORK-CONTEXT
      *        Fiche Gamme Type
               MOVE SPACES TO YL0140 OF WORK-CONTEXT
      *        Fiche Gamme Version
               MOVE SPACES TO YL0141 OF WORK-CONTEXT
      *        Veh Project Code Extn
               MOVE SPACES TO YL0142 OF WORK-CONTEXT
               GO SB2EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        SCP Model code
               MOVE J6SCMDLCDE OF FVEHDQB OF VAVEHDTAL2-R TO YL0131 OF
                 WORK-CONTEXT
      *        SCP Model Version Code
               MOVE J6SCVERCDE OF FVEHDQB OF VAVEHDTAL2-R TO YL0132 OF
                 WORK-CONTEXT
      *        Colour Code
               MOVE J6CLRCDE OF FVEHDQB OF VAVEHDTAL2-R TO YL0133 OF
                 WORK-CONTEXT
      *        SCP Options
               MOVE J6OPTSCP OF FVEHDQB OF VAVEHDTAL2-R TO YL0134 OF
                 WORK-CONTEXT
      *        SCP Trim Type
               MOVE J6TRMTYSCP OF FVEHDQB OF VAVEHDTAL2-R TO YL0135 OF
                 WORK-CONTEXT
      *        SCP Trim Colour
               MOVE J6TRMCLSCP OF FVEHDQB OF VAVEHDTAL2-R TO YL0136 OF
                 WORK-CONTEXT
      *        SCR Model Year
               MOVE J6MDLYRSCR OF FVEHDQB OF VAVEHDTAL2-R TO YL0137 OF
                 WORK-CONTEXT
      *        SCR Model Year Variation
               MOVE J6MDLYRVAR OF FVEHDQB OF VAVEHDTAL2-R TO YL0138 OF
                 WORK-CONTEXT
      *        Phase
               MOVE J6O2ST OF FVEHDQB OF VAVEHDTAL2-R TO YL0139 OF
                 WORK-CONTEXT
      *        Fiche Gamme Type
               MOVE J6GENREFG OF FVEHDQB OF VAVEHDTAL2-R TO YL0140 OF
                 WORK-CONTEXT
      *        Fiche Gamme Version
               MOVE J6VERFG OF FVEHDQB OF VAVEHDTAL2-R TO YL0141 OF
                 WORK-CONTEXT
      *        Veh Project Code Extn
               MOVE J6VCODE4 OF FVEHDQB OF VAVEHDTAL2-R TO YL0142 OF
                 WORK-CONTEXT
      *        *QUIT
               GO SB2EXIT
               SET C-INDICATOR-OFF(90) TO TRUE
               READ VAVEHDTAL2 NEXT
                 FORMAT IS 'FVEHDQB'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         FVEHDQB OF VAVEHDTAL2-R TO
                         EXTSB2
                       MOVE EXTSB2 TO KRSSB2-TMP
                       IF (KRSSB2 NOT = KRSSB2-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        VIN
               MOVE LOW-VALUES TO J6VIN OF EXTSB2
           END-PERFORM
      *==============================================================
           CONTINUE.
       SB2EXIT.
           EXIT.
      /EJECT
       SB3RVGN SECTION.
      *==============================================================
      *    Rtv by Mdl/Phs/Ver/Dte - AOC Version Price  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    USER: Initialize routine
      *    PAR = CON By name
      *    AOC Price/Pct Value
           MOVE ZEROS TO YL0262 OF WORK-CONTEXT
      *    Setup key
      *    SCP Model code
           MOVE YL0131 OF WORK-CONTEXT TO RCSCMDLCDE OF KRSSB3
      *    Phase
           MOVE YL0139 OF WORK-CONTEXT TO RCO2ST OF KRSSB3
      *    SCP Model Version Code
           MOVE YL0132 OF WORK-CONTEXT TO RCSCVERCDE OF KRSSB3
      *    Initialise Full Externally Described Keylist
      *    SCP Model code
           MOVE LOW-VALUES TO RCSCMDLCDE OF EXTSB3
      *    Phase
           MOVE LOW-VALUES TO RCO2ST OF EXTSB3
      *    SCP Model Version Code
           MOVE LOW-VALUES TO RCSCVERCDE OF EXTSB3
      *    Price Start Date - Dealer
           MOVE 99999999 TO RCPRCDTDLR OF EXTSB3
           MOVE CORRESPONDING
             EXTSB3 TO
             FAOCVR7 OF RAAOCVPRL2-R
           MOVE CORRESPONDING
             KRSSB3 TO
             FAOCVR7 OF RAAOCVPRL2-R
           START RAAOCVPRL2 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'FAOCVR7'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ RAAOCVPRL2 NEXT
             FORMAT IS 'FAOCVR7'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     FAOCVR7 OF RAAOCVPRL2-R TO
                     EXTSB3
                   MOVE EXTSB3 TO KRSSB3-TMP
                   IF (KRSSB3 NOT = KRSSB3-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    SCP Model code
           MOVE LOW-VALUES TO RCSCMDLCDE OF EXTSB3
      *    Phase
           MOVE LOW-VALUES TO RCO2ST OF EXTSB3
      *    SCP Model Version Code
           MOVE LOW-VALUES TO RCSCVERCDE OF EXTSB3
      *    Price Start Date - Dealer
           MOVE 99999999 TO RCPRCDTDLR OF EXTSB3
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'JSM2071' TO W0RTN
           END-IF
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        CASE: DB1.AOC Spec ID EQ PAR.AOC Spec ID
      *        *IF
               IF (RCBMOSPEC OF FAOCVR7 OF RAAOCVPRL2-R = 'FLIVR') THEN
      *            PAR = DB1 By name
      *            AOC Price/Pct Value
                   MOVE RCBMOVAL OF FAOCVR7 OF RAAOCVPRL2-R TO YL0262
                     OF WORK-CONTEXT
      *            *QUIT
                   GO SB3EXIT
               END-IF
               SET C-INDICATOR-OFF(90) TO TRUE
               READ RAAOCVPRL2 NEXT
                 FORMAT IS 'FAOCVR7'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         FAOCVR7 OF RAAOCVPRL2-R TO
                         EXTSB3
                       MOVE EXTSB3 TO KRSSB3-TMP
                       IF (KRSSB3 NOT = KRSSB3-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        SCP Model code
               MOVE LOW-VALUES TO RCSCMDLCDE OF EXTSB3
      *        Phase
               MOVE LOW-VALUES TO RCO2ST OF EXTSB3
      *        SCP Model Version Code
               MOVE LOW-VALUES TO RCSCVERCDE OF EXTSB3
      *        Price Start Date - Dealer
               MOVE 99999999 TO RCPRCDTDLR OF EXTSB3
           END-PERFORM
      *    USER: Exit processing
      *    *Return code
           MOVE 'Y2U0005' TO W0RTN
      *==============================================================
           CONTINUE.
       SB3EXIT.
           EXIT.
      /EJECT
       SB4RVGN SECTION.
      *==============================================================
      *    rtv Autotrader PICG Price - Autotrader PICG Price  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    SCP Model code
           MOVE J6SCMDLCDE OF FVEHDF2 OF VAVEHDTALE-R TO CMSCMDLCDE OF
             KRSSB4
      *    Phase
           MOVE J6O2ST OF FVEHDF2 OF VAVEHDTALE-R TO CMO2ST OF KRSSB4
      *    Initialise Full Externally Described Keylist
      *    SCP Model code
           MOVE LOW-VALUES TO CMSCMDLCDE OF EXTSB4
      *    Phase
           MOVE LOW-VALUES TO CMO2ST OF EXTSB4
           MOVE CORRESPONDING
             KRSSB4 TO
             FPICGMW OF AGPICG00L1-R
           SET C-INDICATOR-OFF(90) TO TRUE
           READ AGPICG00L1
             FORMAT IS 'FPICGMW'
           END-READ
           IF (C-NO-RECORD) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               END-IF
           END-IF
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'JSM2504' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        PICG amount to deduc val
               MOVE ZEROS TO YL0263 OF WORK-CONTEXT
      *        PICG Grant Amount
               MOVE ZEROS TO YL0264 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SB4EXIT
           END-IF
      *
           IF (C-INDICATOR-OFF(90)) THEN
      *        USER: Process Data record
      *        CASE:
      *        - NOTc1
      *        |- c1    : DB1.Error text is present
      *        '-
      *        *IF
               IF (NOT (CMURTX OF FPICGMW OF AGPICG00L1-R NOT = ' '))
                 THEN
                   IF (CMPICGADE OF FPICGMW OF AGPICG00L1-R = SPACES)
                     THEN
                       MOVE ZERO TO YL0265 OF WORK-CONTEXT
                   ELSE
                       MOVE CMPICGADE OF FPICGMW OF AGPICG00L1-R TO
                         YL0265 OF WORK-CONTEXT
                   END-IF
      *            PICG amount to deduc val
                   DIVIDE 100 INTO YL0265 OF WORK-CONTEXT GIVING YL0263
                     OF WORK-CONTEXT
                   IF (CMPICGGAC OF FPICGMW OF AGPICG00L1-R = SPACES)
                     THEN
                       MOVE ZERO TO YL0266 OF WORK-CONTEXT
                   ELSE
                       MOVE CMPICGGAC OF FPICGMW OF AGPICG00L1-R TO
                         YL0266 OF WORK-CONTEXT
                   END-IF
      *            PICG Grant Amount
                   DIVIDE 100 INTO YL0266 OF WORK-CONTEXT GIVING YL0264
                     OF WORK-CONTEXT
      *            *QUIT
                   GO SB4EXIT
               ELSE
      *            CASE: *OTHERWISE
      *            PAR = CON By name
      *            PICG amount to deduc val
                   MOVE ZEROS TO YL0263 OF WORK-CONTEXT
      *            PICG Grant Amount
                   MOVE ZEROS TO YL0264 OF WORK-CONTEXT
               END-IF
           END-IF
      *==============================================================
           CONTINUE.
       SB4EXIT.
           EXIT.
      /EJECT
       SB5RVGN SECTION.
      *==============================================================
      *    Rtv Trim Description - Model Version Colour Trim  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    USER: Initialize routine
      *    PAR = CON By name
      *    Trim Description (48)
           MOVE SPACES TO WN0016
      *    U:Record found
           MOVE SPACES TO YL0267 OF WORK-CONTEXT
      *    U:Record found
           MOVE 'N' TO YL0267 OF WORK-CONTEXT
      *    Setup key
      *    SCP Model code
           MOVE J6SCMDLCDE OF FVEHDF2 OF VAVEHDTALE-R TO BBSCMDLCDE OF
             KRSSB5
      *    Phase
           MOVE J6O2ST OF FVEHDF2 OF VAVEHDTALE-R TO BBO2ST OF KRSSB5
      *    SCP Model Version Code
           MOVE J6SCVERCDE OF FVEHDF2 OF VAVEHDTALE-R TO BBSCVERCDE OF
             KRSSB5
      *    Colour Code
           MOVE J6CLRCDE OF FVEHDF2 OF VAVEHDTALE-R TO BBCLRCDE OF
             KRSSB5
      *    Category
           MOVE WN0116 TO BBCAT OF KRSSB5
      *    Initialise Full Externally Described Keylist
      *    SCP Model code
           MOVE LOW-VALUES TO BBSCMDLCDE OF EXTSB5
      *    Phase
           MOVE LOW-VALUES TO BBO2ST OF EXTSB5
      *    SCP Model Version Code
           MOVE LOW-VALUES TO BBSCVERCDE OF EXTSB5
      *    Colour Code
           MOVE LOW-VALUES TO BBCLRCDE OF EXTSB5
      *    Category
           MOVE LOW-VALUES TO BBCAT OF EXTSB5
           MOVE CORRESPONDING
             KRSSB5 TO
             FMVRTGW OF VAMVRTRML1-R
           SET C-INDICATOR-OFF(90) TO TRUE
           READ VAMVRTRML1
             FORMAT IS 'FMVRTGW'
           END-READ
           IF (C-NO-RECORD) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               END-IF
           END-IF
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'JSM2404' TO W0RTN
           END-IF
           IF (C-INDICATOR-OFF(90)) THEN
      *        USER: Process Data record
      *        CASE:
      *        - c1 AND c2
      *        |- c1    : PAR.SCR Trim Colour (12) EQ DB1.SCR Trim
      *          Colour (12)
      *        |- c2    : PAR.SCR Trim Type (12) EQ DB1.SCR Trim Type
      *          (12)
      *        '-
      *        *IF
               IF (WN0117 = BBSCRTRMCL OF FMVRTGW OF VAMVRTRML1-R AND
                   WN0118 = BBSCRTRMTY OF FMVRTGW OF VAMVRTRML1-R) THEN
      *            Trim Description (48)
                   MOVE BBTRIMDES OF FMVRTGW OF VAMVRTRML1-R TO WN0016
      *            U:Record found
                   MOVE 'Y' TO YL0267 OF WORK-CONTEXT
      *            *QUIT
                   GO SB5EXIT
               END-IF
           END-IF
      *==============================================================
           CONTINUE.
       SB5EXIT.
           EXIT.
      /EJECT
       SB6RVGN SECTION.
      *==============================================================
      *    Rtv trim - Model Version Colour Trim  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    SCP Model code
           MOVE J6SCMDLCDE OF FVEHDF2 OF VAVEHDTALE-R TO BBSCMDLCDE OF
             KRSSB6
      *    Phase
           MOVE J6O2ST OF FVEHDF2 OF VAVEHDTALE-R TO BBO2ST OF KRSSB6
      *    SCP Model Version Code
           MOVE J6SCVERCDE OF FVEHDF2 OF VAVEHDTALE-R TO BBSCVERCDE OF
             KRSSB6
      *    Colour Code
           MOVE J6CLRCDE OF FVEHDF2 OF VAVEHDTALE-R TO BBCLRCDE OF
             KRSSB6
      *    Category
           MOVE 'B' TO BBCAT OF KRSSB6
      *    Initialise Full Externally Described Keylist
      *    SCP Model code
           MOVE LOW-VALUES TO BBSCMDLCDE OF EXTSB6
      *    Phase
           MOVE LOW-VALUES TO BBO2ST OF EXTSB6
      *    SCP Model Version Code
           MOVE LOW-VALUES TO BBSCVERCDE OF EXTSB6
      *    Colour Code
           MOVE LOW-VALUES TO BBCLRCDE OF EXTSB6
      *    Category
           MOVE LOW-VALUES TO BBCAT OF EXTSB6
           MOVE CORRESPONDING
             KRSSB6 TO
             FMVRTGW OF VAMVRTRML1-R
           SET C-INDICATOR-OFF(90) TO TRUE
           READ VAMVRTRML1
             FORMAT IS 'FMVRTGW'
           END-READ
           IF (C-NO-RECORD) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               END-IF
           END-IF
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'JSM2404' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        SCR Trim Colour (12)
               MOVE SPACES TO YL0268 OF WORK-CONTEXT
      *        SCR Trim Type (12)
               MOVE SPACES TO YL0269 OF WORK-CONTEXT
      *        Trim Description (48)
               MOVE SPACES TO WN0016
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SB6EXIT
           END-IF
      *
           IF (C-INDICATOR-OFF(90)) THEN
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        SCR Trim Colour (12)
               MOVE BBSCRTRMCL OF FMVRTGW OF VAMVRTRML1-R TO YL0268 OF
                 WORK-CONTEXT
      *        SCR Trim Type (12)
               MOVE BBSCRTRMTY OF FMVRTGW OF VAMVRTRML1-R TO YL0269 OF
                 WORK-CONTEXT
      *        Trim Description (48)
               MOVE BBTRIMDES OF FMVRTGW OF VAMVRTRML1-R TO WN0016
           END-IF
      *==============================================================
           CONTINUE.
       SB6EXIT.
           EXIT.
      /EJECT
       SB7RVGN SECTION.
      *==============================================================
      *    Rtv trim - Model Version Colour Trim  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    SCP Model code
           MOVE J6SCMDLCDE OF FVEHDF2 OF VAVEHDTALE-R TO BBSCMDLCDE OF
             KRSSB7
      *    Phase
           MOVE J6O2ST OF FVEHDF2 OF VAVEHDTALE-R TO BBO2ST OF KRSSB7
      *    SCP Model Version Code
           MOVE J6SCVERCDE OF FVEHDF2 OF VAVEHDTALE-R TO BBSCVERCDE OF
             KRSSB7
      *    Colour Code
           MOVE J6CLRCDE OF FVEHDF2 OF VAVEHDTALE-R TO BBCLRCDE OF
             KRSSB7
      *    Category
           MOVE 'B' TO BBCAT OF KRSSB7
      *    Initialise Full Externally Described Keylist
      *    SCP Model code
           MOVE LOW-VALUES TO BBSCMDLCDE OF EXTSB7
      *    Phase
           MOVE LOW-VALUES TO BBO2ST OF EXTSB7
      *    SCP Model Version Code
           MOVE LOW-VALUES TO BBSCVERCDE OF EXTSB7
      *    Colour Code
           MOVE LOW-VALUES TO BBCLRCDE OF EXTSB7
      *    Category
           MOVE LOW-VALUES TO BBCAT OF EXTSB7
           MOVE CORRESPONDING
             KRSSB7 TO
             FMVRTGW OF VAMVRTRML1-R
           SET C-INDICATOR-OFF(90) TO TRUE
           READ VAMVRTRML1
             FORMAT IS 'FMVRTGW'
           END-READ
           IF (C-NO-RECORD) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               END-IF
           END-IF
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'JSM2404' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        SCR Trim Colour (12)
               MOVE SPACES TO YL0268 OF WORK-CONTEXT
      *        SCR Trim Type (12)
               MOVE SPACES TO YL0269 OF WORK-CONTEXT
      *        Trim Description (48)
               MOVE SPACES TO WN0016
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SB7EXIT
           END-IF
      *
           IF (C-INDICATOR-OFF(90)) THEN
      *        USER: Process Data record
      *        PAR = DB1 By name
      *        SCR Trim Colour (12)
               MOVE BBSCRTRMCL OF FMVRTGW OF VAMVRTRML1-R TO YL0268 OF
                 WORK-CONTEXT
      *        SCR Trim Type (12)
               MOVE BBSCRTRMTY OF FMVRTGW OF VAMVRTRML1-R TO YL0269 OF
                 WORK-CONTEXT
      *        Trim Description (48)
               MOVE BBTRIMDES OF FMVRTGW OF VAMVRTRML1-R TO WN0016
           END-IF
      *==============================================================
           CONTINUE.
       SB7EXIT.
           EXIT.
      /EJECT
       SB8RVGN SECTION.
      *==============================================================
      *    Rtv KSP text by vin - KSP VIN Attn text  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Initialise Full Externally Described Keylist
      *    SCP Model code
           MOVE LOW-VALUES TO CFSCMDLCDE OF EXTSB8
      *    Phase
           MOVE LOW-VALUES TO CFO2ST OF EXTSB8
      *    VIN
           MOVE LOW-VALUES TO CFVIN OF EXTSB8
           MOVE CORRESPONDING
             EXTSB8 TO
             FVINAL9 OF VAVINATNL1-R
           START VAVINATNL1 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'FVINAL9'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ VAVINATNL1 NEXT
             FORMAT IS 'FVINAL9'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               END-IF
           END-IF
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'JSM2490' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        KSP Attn text
               MOVE SPACES TO YL0272 OF WORK-CONTEXT
      *        KSP Attn expiry date txt
               MOVE SPACES TO YL0273 OF WORK-CONTEXT
               GO SB8EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        CASE:
      *        - c1 AND c2 AND NOTc3 AND NOTc4
      *        |- c1    : DB1.VIN is Not Blank
      *        |- c2    : DB1.VIN EQ PAR.VIN
      *        |- c3    : DB1.VIN is ***************
      *        |- c4    : DB1.Error text is present
      *        '-
      *        *IF
               IF (CFVIN OF FVINAL9 OF VAVINATNL1-R NOT = ' ' AND
                   CFVIN OF FVINAL9 OF VAVINATNL1-R = J6VIN OF FVEHDF2
                 OF VAVEHDTALE-R AND
                   NOT (CFVIN OF FVINAL9 OF VAVINATNL1-R = '************
      -         '****') AND
                   NOT (CFURTX OF FVINAL9 OF VAVINATNL1-R NOT = ' '))
                 THEN
      *            PAR = DB1 By name
      *            KSP Attn text
                   MOVE CFKSPATNTX OF FVINAL9 OF VAVINATNL1-R TO YL0272
                     OF WORK-CONTEXT
      *            KSP Attn expiry date txt
                   MOVE CFKSPEXPTX OF FVINAL9 OF VAVINATNL1-R TO YL0273
                     OF WORK-CONTEXT
      *            *Return code
                   MOVE SPACES TO W0RTN
                   MOVE ' ' TO W0RTN
      *            *QUIT
                   GO SB8EXIT
               ELSE
      *            CASE: *OTHERWISE
      *            PAR = CON By name
      *            KSP Attn text
                   MOVE SPACES TO YL0272 OF WORK-CONTEXT
      *            KSP Attn expiry date txt
                   MOVE SPACES TO YL0273 OF WORK-CONTEXT
      *            *Return code
                   MOVE 'Y2U0005' TO W0RTN
               END-IF
               SET C-INDICATOR-OFF(90) TO TRUE
               READ VAVINATNL1 NEXT
                 FORMAT IS 'FVINAL9'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   END-IF
               END-IF
           END-PERFORM
      *==============================================================
           CONTINUE.
       SB8EXIT.
           EXIT.
      /EJECT
       SB9RVGN SECTION.
      *==============================================================
      *    Rtv KSP text by mod ,pha - KSP VIN Attn text  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    SCP Model code
           MOVE J6SCMDLCDE OF FVEHDF2 OF VAVEHDTALE-R TO CFSCMDLCDE OF
             KRSSB9
      *    Phase
           MOVE J6O2ST OF FVEHDF2 OF VAVEHDTALE-R TO CFO2ST OF KRSSB9
      *    Initialise Full Externally Described Keylist
      *    SCP Model code
           MOVE LOW-VALUES TO CFSCMDLCDE OF EXTSB9
      *    Phase
           MOVE LOW-VALUES TO CFO2ST OF EXTSB9
      *    VIN
           MOVE LOW-VALUES TO CFVIN OF EXTSB9
           MOVE CORRESPONDING
             EXTSB9 TO
             FVINAL9 OF VAVINATNL1-R
           MOVE CORRESPONDING
             KRSSB9 TO
             FVINAL9 OF VAVINATNL1-R
           START VAVINATNL1 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'FVINAL9'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ VAVINATNL1 NEXT
             FORMAT IS 'FVINAL9'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     FVINAL9 OF VAVINATNL1-R TO
                     EXTSB9
                   MOVE EXTSB9 TO KRSSB9-TMP
                   IF (KRSSB9 NOT = KRSSB9-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    SCP Model code
           MOVE LOW-VALUES TO CFSCMDLCDE OF EXTSB9
      *    Phase
           MOVE LOW-VALUES TO CFO2ST OF EXTSB9
      *    VIN
           MOVE LOW-VALUES TO CFVIN OF EXTSB9
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'JSM2490' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        KSP Attn text
               MOVE SPACES TO YL0272 OF WORK-CONTEXT
      *        KSP Attn expiry date txt
               MOVE SPACES TO YL0273 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SB9EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        CASE:
      *        - (c1 OR c2 ) ANDNOTc3
      *        |- c1    : DB1.VIN is Blank
      *        |- c2    : DB1.VIN is ***************
      *        |- c3    : DB1.Error text is present
      *        '-
      *        *IF
               IF ((CFVIN OF FVINAL9 OF VAVINATNL1-R = ' ' OR
                    CFVIN OF FVINAL9 OF VAVINATNL1-R = '****************
      -         '') AND
                   NOT (CFURTX OF FVINAL9 OF VAVINATNL1-R NOT = ' '))
                 THEN
      *            PAR = DB1 By name
      *            KSP Attn text
                   MOVE CFKSPATNTX OF FVINAL9 OF VAVINATNL1-R TO YL0272
                     OF WORK-CONTEXT
      *            KSP Attn expiry date txt
                   MOVE CFKSPEXPTX OF FVINAL9 OF VAVINATNL1-R TO YL0273
                     OF WORK-CONTEXT
      *            *Return code
                   MOVE SPACES TO W0RTN
                   MOVE ' ' TO W0RTN
      *            *QUIT
                   GO SB9EXIT
               ELSE
      *            CASE: *OTHERWISE
      *            PAR = CON By name
      *            KSP Attn text
                   MOVE SPACES TO YL0272 OF WORK-CONTEXT
      *            KSP Attn expiry date txt
                   MOVE SPACES TO YL0273 OF WORK-CONTEXT
      *            *Return code
                   MOVE 'Y2U0005' TO W0RTN
               END-IF
               SET C-INDICATOR-OFF(90) TO TRUE
               READ VAVINATNL1 NEXT
                 FORMAT IS 'FVINAL9'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         FVINAL9 OF VAVINATNL1-R TO
                         EXTSB9
                       MOVE EXTSB9 TO KRSSB9-TMP
                       IF (KRSSB9 NOT = KRSSB9-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        SCP Model code
               MOVE LOW-VALUES TO CFSCMDLCDE OF EXTSB9
      *        Phase
               MOVE LOW-VALUES TO CFO2ST OF EXTSB9
      *        VIN
               MOVE LOW-VALUES TO CFVIN OF EXTSB9
           END-PERFORM
      *==============================================================
           CONTINUE.
       SB9EXIT.
           EXIT.
      /EJECT
       SC1RVGN SECTION.
      *==============================================================
      *    Rtv KSP text by mod - KSP VIN Attn text  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    SCP Model code
           MOVE J6SCMDLCDE OF FVEHDF2 OF VAVEHDTALE-R TO CFSCMDLCDE OF
             KRSSC1
      *    Phase
           MOVE J6O2ST OF FVEHDF2 OF VAVEHDTALE-R TO CFO2ST OF KRSSC1
      *    Initialise Full Externally Described Keylist
      *    SCP Model code
           MOVE LOW-VALUES TO CFSCMDLCDE OF EXTSC1
      *    Phase
           MOVE LOW-VALUES TO CFO2ST OF EXTSC1
      *    VIN
           MOVE LOW-VALUES TO CFVIN OF EXTSC1
           MOVE CORRESPONDING
             EXTSC1 TO
             FVINAL9 OF VAVINATNL1-R
           MOVE CORRESPONDING
             KRSSC1 TO
             FVINAL9 OF VAVINATNL1-R
           START VAVINATNL1 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'FVINAL9'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ VAVINATNL1 NEXT
             FORMAT IS 'FVINAL9'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     FVINAL9 OF VAVINATNL1-R TO
                     EXTSC1
                   MOVE EXTSC1 TO KRSSC1-TMP
                   IF (KRSSC1 NOT = KRSSC1-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    SCP Model code
           MOVE LOW-VALUES TO CFSCMDLCDE OF EXTSC1
      *    Phase
           MOVE LOW-VALUES TO CFO2ST OF EXTSC1
      *    VIN
           MOVE LOW-VALUES TO CFVIN OF EXTSC1
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'JSM2490' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        KSP Attn text
               MOVE SPACES TO YL0272 OF WORK-CONTEXT
      *        KSP Attn expiry date txt
               MOVE SPACES TO YL0273 OF WORK-CONTEXT
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SC1EXIT
           END-IF
      *
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        CASE:
      *        - ( c1 OR c2 ) AND (c3 ORc4 ) ANDNOTc5
      *        |- c1    : DB1.VIN is Blank
      *        |- c2    : DB1.VIN is ***************
      *        |- c3    : DB1.Phase is All Phases
      *        |- c4    : DB1.Phase is Blank
      *        |- c5    : DB1.Error text is present
      *        '-
      *        *IF
               IF ((CFVIN OF FVINAL9 OF VAVINATNL1-R = ' ' OR
                    CFVIN OF FVINAL9 OF VAVINATNL1-R = '****************
      -         '') AND
                   (CFO2ST OF FVINAL9 OF VAVINATNL1-R = '*' OR
                   CFO2ST OF FVINAL9 OF VAVINATNL1-R = ' ') AND
                   NOT (CFURTX OF FVINAL9 OF VAVINATNL1-R NOT = ' '))
                 THEN
      *            PAR = DB1 By name
      *            KSP Attn text
                   MOVE CFKSPATNTX OF FVINAL9 OF VAVINATNL1-R TO YL0272
                     OF WORK-CONTEXT
      *            KSP Attn expiry date txt
                   MOVE CFKSPEXPTX OF FVINAL9 OF VAVINATNL1-R TO YL0273
                     OF WORK-CONTEXT
      *            *Return code
                   MOVE SPACES TO W0RTN
                   MOVE ' ' TO W0RTN
      *            *QUIT
                   GO SC1EXIT
               ELSE
      *            CASE: *OTHERWISE
      *            PAR = CON By name
      *            KSP Attn text
                   MOVE SPACES TO YL0272 OF WORK-CONTEXT
      *            KSP Attn expiry date txt
                   MOVE SPACES TO YL0273 OF WORK-CONTEXT
      *            *Return code
                   MOVE 'Y2U0005' TO W0RTN
               END-IF
               SET C-INDICATOR-OFF(90) TO TRUE
               READ VAVINATNL1 NEXT
                 FORMAT IS 'FVINAL9'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         FVINAL9 OF VAVINATNL1-R TO
                         EXTSC1
                       MOVE EXTSC1 TO KRSSC1-TMP
                       IF (KRSSC1 NOT = KRSSC1-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        SCP Model code
               MOVE LOW-VALUES TO CFSCMDLCDE OF EXTSC1
      *        Phase
               MOVE LOW-VALUES TO CFO2ST OF EXTSC1
      *        VIN
               MOVE LOW-VALUES TO CFVIN OF EXTSC1
           END-PERFORM
      *==============================================================
           CONTINUE.
       SC1EXIT.
           EXIT.
      /EJECT
       SC2RVGN SECTION.
      *==============================================================
      *    Rtv dealer - Autotrader Dealer  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Setup key
      *    Dealer number (alpha)
           MOVE YL0087 OF WORK-CONTEXT TO CLDLRNBRX OF KRSSC2
      *    Initialise Full Externally Described Keylist
      *    Dealer number (alpha)
           MOVE LOW-VALUES TO CLDLRNBRX OF EXTSC2
           MOVE CORRESPONDING
             KRSSC2 TO
             FRDR0MT OF AGRDLR00L1-R
           SET C-INDICATOR-OFF(90) TO TRUE
           READ AGRDLR00L1
             FORMAT IS 'FRDR0MT'
           END-READ
           IF (C-NO-RECORD) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               END-IF
           END-IF
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'JSM2502' TO W0RTN
      *        USER: Processing if Data record not found
      *        PAR = CON By name
      *        *Return code
               MOVE 'Y2U0005' TO W0RTN
               GO SC2EXIT
           END-IF
      *
           IF (C-INDICATOR-OFF(90)) THEN
      *        USER: Process Data record
      *        CASE:
      *        - NOTc1
      *        |- c1    : DB1.Error text is present
      *        '-
      *        *IF
               IF (NOT (CLURTX OF FRDR0MT OF AGRDLR00L1-R NOT = ' '))
                 THEN
      *            PAR = DB1 By name
      *            *Return code
                   MOVE SPACES TO W0RTN
                   MOVE ' ' TO W0RTN
      *            *QUIT
                   GO SC2EXIT
               ELSE
      *            CASE: *OTHERWISE
      *            PAR = CON By name
      *            *Return code
                   MOVE 'JSM0904' TO W0RTN
               END-IF
           END-IF
      *==============================================================
           CONTINUE.
       SC2EXIT.
           EXIT.
      /EJECT
       SC3CRRC SECTION.
      *==============================================================
      *    Crt/Chg Autotrader Bulk U - Autotrader Bulk Upload  *
      *==============================================================
      *    Clear all neither parameters
      *    Create Date D8#
           MOVE ZEROS TO WN0119
      *    Create Time
           MOVE ZEROS TO WN0120
      *    Create User
           MOVE SPACES TO WN0121
      *    Create Program
           MOVE SPACES TO WN0122
      *    Create Job
           MOVE SPACES TO WN0123
      *    Date Last Changed D8#
           MOVE ZEROS TO WN0124
      *    Time Last Changed
           MOVE ZEROS TO WN0125
      *    User Last Changed
           MOVE SPACES TO WN0126
      *    Program Last Changed
           MOVE SPACES TO WN0127
      *    Job Last Changed
           MOVE SPACES TO WN0128
      *
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *
      *    Move all fields to AGAUTOBUF0
      *    Invariant BCV
           MOVE J6INVBCV OF FVEHDF2 OF VAVEHDTALE-R TO B1INVBCV OF
             AGAUTOBUL0-R
      *    VIN
           MOVE J6VIN OF FVEHDF2 OF VAVEHDTALE-R TO B1VIN OF
             AGAUTOBUL0-R
      *    Owning Account
           MOVE YL0087 OF WORK-CONTEXT TO B1OWNACC OF AGAUTOBUL0-R
      *    Dealer Name
           MOVE WN0001 TO B1DETT OF AGAUTOBUL0-R
      *    Brand 15
           MOVE YL0009 OF WORK-CONTEXT TO B1BRAND15 OF AGAUTOBUL0-R
      *    SCP Model code
           MOVE J6SCMDLCDE OF FVEHDF2 OF VAVEHDTALE-R TO B1SCMDLCDE OF
             AGAUTOBUL0-R
      *    Phase
           MOVE J6O2ST OF FVEHDF2 OF VAVEHDTALE-R TO B1O2ST OF
             AGAUTOBUL0-R
      *    SCP Model Version Code
           MOVE J6SCVERCDE OF FVEHDF2 OF VAVEHDTALE-R TO B1SCVERCDE OF
             AGAUTOBUL0-R
      *    Model Marketing Desc.
           MOVE WN0002 TO B1MDLMRKD OF AGAUTOBUL0-R
      *    Version Marketing Desc.
           MOVE WN0003 TO B1VSNMKDSC OF AGAUTOBUL0-R
      *    Vehicle Model Trim Level
           MOVE WN0004 TO B1VEHTRIML OF AGAUTOBUL0-R
      *    CAP Vehicle Code
           MOVE WN0005 TO B1CAPVEHCD OF AGAUTOBUL0-R
      *    CAP Vehicle ID Number
           MOVE WN0006 TO B1CAPVEHNB OF AGAUTOBUL0-R
      *    CAP Model Dsc Cleansed
           MOVE WN0007 TO B1CAPMDLDC OF AGAUTOBUL0-R
      *    CAP Version Dsc Cleansed
           MOVE WN0008 TO B1CAPVERDC OF AGAUTOBUL0-R
      *    Autotrader Vehicle Type
           MOVE WN0009 TO B1AUTVEHTY OF AGAUTOBUL0-R
      *    Vehicle Body Name ATR
           MOVE WN0010 TO B1VEHBDYNM OF AGAUTOBUL0-R
      *    Vehicle Fuel Type
           MOVE WN0011 TO B1VEHFUELT OF AGAUTOBUL0-R
      *    Vehicle Drive System
           MOVE WN0012 TO B1VEHDRVSY OF AGAUTOBUL0-R
      *    Vehicle Horse Power
           MOVE WN0013 TO B1VEHPOWER OF AGAUTOBUL0-R
      *    Veh Co2
           MOVE YL0271 OF WORK-CONTEXT TO B1VCODE3 OF AGAUTOBUL0-R
      *    Vehicle Gearbox Type
           MOVE WN0014 TO B1VEHGRBTY OF AGAUTOBUL0-R
      *    Colour Code
           MOVE J6CLRCDE OF FVEHDF2 OF VAVEHDTALE-R TO B1CLRCDE OF
             AGAUTOBUL0-R
      *    Colour Description
           MOVE WN0015 TO B1CLRDES OF AGAUTOBUL0-R
      *    SCP Options
           MOVE J6OPTSCP OF FVEHDF2 OF VAVEHDTALE-R TO B1OPTSCP OF
             AGAUTOBUL0-R
      *    SCR Trim Type
           MOVE J6TRMTYSCR OF FVEHDF2 OF VAVEHDTALE-R TO B1TRMTYSCR OF
             AGAUTOBUL0-R
      *    SCR Trim Colour
           MOVE J6TRMCLSCR OF FVEHDF2 OF VAVEHDTALE-R TO B1TRMCLSCR OF
             AGAUTOBUL0-R
      *    Trim Description (48)
           MOVE WN0016 TO B1TRIMDES OF AGAUTOBUL0-R
      *    Vehicle Fuel Code
           MOVE J6FTFUEL OF FVEHDF2 OF VAVEHDTALE-R TO B1FTFUEL OF
             AGAUTOBUL0-R
      *    Vehicle Engine Capacity
           MOVE WN0017 TO B1VEHENGCP OF AGAUTOBUL0-R
      *    Vehicle Number of Doors
           MOVE WN0018 TO B1VEHNODRS OF AGAUTOBUL0-R
      *    Vehicle Seating Capacity
           MOVE WN0019 TO B1VEHSEATS OF AGAUTOBUL0-R
      *    Vehicle Mileage
           MOVE WN0020 TO B1VEHMILES OF AGAUTOBUL0-R
      *    Vehicle Top Speed
           MOVE WN0021 TO B1VEHTOPSP OF AGAUTOBUL0-R
      *    Vehicle Fuel Tank Cap
           MOVE WN0022 TO B1VEHFTKCP OF AGAUTOBUL0-R
      *    Vehicle Range
           MOVE WN0023 TO B1VEHRANGE OF AGAUTOBUL0-R
      *    Vehicle External Length
           MOVE WN0024 TO B1VEHEXTLN OF AGAUTOBUL0-R
      *    Vehicle Ext Length Units
           MOVE WN0025 TO B1VEHEXTLU OF AGAUTOBUL0-R
      *    Vehicle Ext Length AddTxt
           MOVE WN0026 TO B1VEHEXTLT OF AGAUTOBUL0-R
      *    Vehicle External Width
           MOVE WN0027 TO B1VEHEXTWD OF AGAUTOBUL0-R
      *    Vehicle External Height
           MOVE WN0028 TO B1VEHEXTHT OF AGAUTOBUL0-R
      *    Vehicle Ext Height Units
           MOVE WN0029 TO B1VEHEXTHU OF AGAUTOBUL0-R
      *    Vehicle Ext Height AddTxt
           MOVE WN0030 TO B1VEHEXTHX OF AGAUTOBUL0-R
      *    Vehicle Gross Weight
           MOVE WN0031 TO B1VEHGWGHT OF AGAUTOBUL0-R
      *    Vehicle Wheelbase
           MOVE WN0032 TO B1VEHWHLBS OF AGAUTOBUL0-R
      *    TCM Date 07
           MOVE J6TCMDT07 OF FVEHDF2 OF VAVEHDTALE-R TO B1TCMDT07 OF
             AGAUTOBUL0-R
      *    PEC/MADC Date 10
           MOVE J6PECDT10 OF FVEHDF2 OF VAVEHDTALE-R TO B1PECDT10 OF
             AGAUTOBUL0-R
      *    Arrival at Dock Date 28
           MOVE J6DOCDT28 OF FVEHDF2 OF VAVEHDTALE-R TO B1DOCDT28 OF
             AGAUTOBUL0-R
      *    Exit Import Centre Dte 45
           MOVE J6EXICDT45 OF FVEHDF2 OF VAVEHDTALE-R TO B1EXICDT45 OF
             AGAUTOBUL0-R
      *    Transfer Date 55
           MOVE J6TFRDT55 OF FVEHDF2 OF VAVEHDTALE-R TO B1TFRDT55 OF
             AGAUTOBUL0-R
      *    Registration Date 58
           MOVE J6REGDT58 OF FVEHDF2 OF VAVEHDTALE-R TO B1REGDT58 OF
             AGAUTOBUL0-R
      *    Sedre Vehicle Status
           MOVE WN0033 TO B1SEDVEHST OF AGAUTOBUL0-R
      *    Sedre Vehicle Status Dsc
           MOVE WN0034 TO B1SEDVEHSD OF AGAUTOBUL0-R
      *    Customer Order Number
           MOVE WN0035 TO B1CUSORDNB OF AGAUTOBUL0-R
      *    Customer Order Date #
           MOVE WN0036 TO B1CUSORDD8 OF AGAUTOBUL0-R
      *    Cust Allocation Date
           MOVE WN0037 TO B1CUSALCD8 OF AGAUTOBUL0-R
      *    SEDRE customer type
           MOVE WN0038 TO B1TCCSTTYP OF AGAUTOBUL0-R
      *    Order Type Central
           MOVE WN0039 TO B1ORDTYPCN OF AGAUTOBUL0-R
      *    SD Sales Channel Code ATR
           MOVE WN0040 TO B1SDSLCHNA OF AGAUTOBUL0-R
      *    Vehicle List Price
           MOVE WN0041 TO B1VEHLSTPR OF AGAUTOBUL0-R
      *    Vehicle Version Price
           MOVE WN0042 TO B1VEHVERPR OF AGAUTOBUL0-R
      *    Vehicle Delivery Price
           MOVE WN0043 TO B1VEHDLVPR OF AGAUTOBUL0-R
      *    Vehicle Colour Price
           MOVE WN0044 TO B1VEHCOLPR OF AGAUTOBUL0-R
      *    Vehicle Accessories Price
           MOVE WN0045 TO B1VEHACCPR OF AGAUTOBUL0-R
      *    Vehicle Options Price
           MOVE WN0046 TO B1VEHOPTPR OF AGAUTOBUL0-R
      *    Vehicle First Reg Fee
           MOVE WN0047 TO B1VEHFRF OF AGAUTOBUL0-R
      *    Vehicle Road Fun License
           MOVE WN0048 TO B1VEHFVIGN OF AGAUTOBUL0-R
      *    Vehicle On The Road Price
           MOVE WN0049 TO B1VEHOTRPR OF AGAUTOBUL0-R
      *    Vehicle All Options Dsc
           MOVE WN0050 TO B1OPTDSCAL OF AGAUTOBUL0-R
      *    Vehicle All Accessory Dsc
           MOVE WN0051 TO B1VEHAXSDA OF AGAUTOBUL0-R
      *    Vehicle Version KSP All
           MOVE WN0052 TO B1KSPDSCAL OF AGAUTOBUL0-R
      *    Vehicle Options AXS Merge
           MOVE WN0053 TO B1VEHOPTAX OF AGAUTOBUL0-R
      *    KSP Attn text
           MOVE YL0272 OF WORK-CONTEXT TO B1KSPATNTX OF AGAUTOBUL0-R
      *    PICG Grant Amount
           MOVE YL0264 OF WORK-CONTEXT TO B1PICGGA OF AGAUTOBUL0-R
      *    Record Processed Status
           MOVE WN0054 TO B1RCDPSTS OF AGAUTOBUL0-R
      *    USER: Processing before Data update
      *    Rtn Update Audit for Crt
      *    LCL.U:Job date long (D8#) = JOB.*Job date
           IF (ZZJDT OF JOB-CONTEXT = ZERO) THEN
               MOVE ZEROS TO YL0275 OF WORK-CONTEXT
           ELSE
               ADD 19000000 TO ZZJDT OF JOB-CONTEXT GIVING YL0275 OF
                 WORK-CONTEXT
           END-IF
      *    Create Date D8#
           MOVE YL0275 OF WORK-CONTEXT TO B1CRTDTD8 OF AGAUTOBUF0 OF
             AGAUTOBUL0-R
      *    Create Time
           MOVE ZZJTM OF JOB-CONTEXT TO B1CRTTME OF AGAUTOBUF0 OF
             AGAUTOBUL0-R
      *    Create User
           MOVE ZZUSR OF JOB-CONTEXT TO B1CRTUSER OF AGAUTOBUF0 OF
             AGAUTOBUL0-R
      *    Create Program
           MOVE ZZPGM OF JOB-CONTEXT TO B1CRTPGM OF AGAUTOBUF0 OF
             AGAUTOBUL0-R
      *    Create Job
           MOVE ZZJOB OF JOB-CONTEXT TO B1CRTJOB OF AGAUTOBUF0 OF
             AGAUTOBUL0-R
      *    Date Last Changed D8#
           MOVE YL0275 OF WORK-CONTEXT TO B1CHGDT8 OF AGAUTOBUF0 OF
             AGAUTOBUL0-R
      *    Time Last Changed
           MOVE ZZJTM OF JOB-CONTEXT TO B1CHGTME OF AGAUTOBUF0 OF
             AGAUTOBUL0-R
      *    User Last Changed
           MOVE ZZUSR OF JOB-CONTEXT TO B1USERCHGD OF AGAUTOBUF0 OF
             AGAUTOBUL0-R
      *    Program Last Changed
           MOVE ZZPGM OF JOB-CONTEXT TO B1PGMCHG OF AGAUTOBUF0 OF
             AGAUTOBUL0-R
      *    Job Last Changed
           MOVE ZZJOB OF JOB-CONTEXT TO B1JOBCHG OF AGAUTOBUF0 OF
             AGAUTOBUL0-R
      *    Check for duplicate primary key
           START AGAUTOBUL0 KEY = EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'AGAUTOBUF0'
           END-START
           IF (NOT C-NO-RECORD) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               SET C-INDICATOR-OFF(90) TO TRUE
           END-IF
           IF (C-INDICATOR-ON(90)) THEN
               MOVE 'JSM2459' TO W0RTN
      *        USER: Processing if Data record already exists
      *        Change Autotrader Bulk Up - Autotrader Bulk Upload  *
               PERFORM SC4CHRC
               GO SC3EXIT
           END-IF
      *
           WRITE AGAUTOBUL0-R END-WRITE
           IF (C-IO-ERR) THEN
               SET C-INDICATOR-ON(91) TO TRUE
           ELSE
               SET C-INDICATOR-OFF(91) TO TRUE
           END-IF
      *
           IF (C-INDICATOR-ON(91)) THEN
      *        Write error detected
               MOVE 'Y2U0004' TO W0RTN
           ELSE
      *        DBF write successful
               CONTINUE
           END-IF
      *==============================================================
           CONTINUE.
       SC3EXIT.
           EXIT.
      /EJECT
       SC4CHRC SECTION.
      *==============================================================
      *    Change Autotrader Bulk Up - Autotrader Bulk Upload  *
      *==============================================================
      *    Clear all neither parameters
      *    Create Date D8#
           MOVE ZEROS TO WN0129
      *    Create Time
           MOVE ZEROS TO WN0130
      *    Create User
           MOVE SPACES TO WN0131
      *    Create Program
           MOVE SPACES TO WN0132
      *    Create Job
           MOVE SPACES TO WN0133
      *    Date Last Changed D8#
           MOVE ZEROS TO WN0134
      *    Time Last Changed
           MOVE ZEROS TO WN0135
      *    User Last Changed
           MOVE SPACES TO WN0136
      *    Program Last Changed
           MOVE SPACES TO WN0137
      *    Job Last Changed
           MOVE SPACES TO WN0138
      *
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Move key fields to AGAUTOBUF0
      *    Invariant BCV
           MOVE J6INVBCV OF FVEHDF2 OF VAVEHDTALE-R TO B1INVBCV OF
             AGAUTOBUL0-R
      *
           READ AGAUTOBUL0 END-READ
           IF (C-NO-RECORD) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               SET C-INDICATOR-OFF(90) TO TRUE
           END-IF
           IF (C-IO-ERR OR
               C-RECORD-LOCKED) THEN
               SET C-INDICATOR-ON(91) TO TRUE
           ELSE
               SET C-INDICATOR-OFF(91) TO TRUE
           END-IF
      *
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'Y2U0009' TO W0RTN
               MOVE ZZPGM  OF JOB-CONTEXT TO MDPGM OF MD0009
               MOVE 'AGAUTOBUL0' TO MDACP OF MD0009
               MOVE 'AGAUTOBUF0' TO MDFMT OF MD0009
               MOVE '*CHG' TO MDACT OF MD0009
      *        Record not found label: LBL001.
               MOVE 'LBL001' TO MDLBL OF MD0009
      *        Send message '*Record no longer on file'
      *        Message ID
               MOVE 'Y2U0009' TO ZAMSID
      *        Message file
               MOVE 'Y2USRMSG' TO ZAMSGF
      *        Message data
               MOVE MD0009 TO ZAMSDA
               PERFORM ZASNMS
               MOVE SPACES TO MD0009
               GO SC4EXIT
           END-IF
      *
           IF (C-INDICATOR-ON(91)) THEN
      *        Record locked
               MOVE 'Y2U0004' TO W0RTN
      *        Send message '*Database operation error'
      *        Message ID
               MOVE 'Y2U0004' TO ZAMSID
      *        Message file
               MOVE 'Y2USRMSG' TO ZAMSGF
               PERFORM ZASNMS
               GO SC4EXIT
           END-IF
      *
      *    Move all fields to AGAUTOBUF0
      *    VIN
           MOVE J6VIN OF FVEHDF2 OF VAVEHDTALE-R TO B1VIN OF
             AGAUTOBUL0-R
      *    Owning Account
           MOVE YL0087 OF WORK-CONTEXT TO B1OWNACC OF AGAUTOBUL0-R
      *    Dealer Name
           MOVE WN0001 TO B1DETT OF AGAUTOBUL0-R
      *    Brand 15
           MOVE YL0009 OF WORK-CONTEXT TO B1BRAND15 OF AGAUTOBUL0-R
      *    SCP Model code
           MOVE J6SCMDLCDE OF FVEHDF2 OF VAVEHDTALE-R TO B1SCMDLCDE OF
             AGAUTOBUL0-R
      *    Phase
           MOVE J6O2ST OF FVEHDF2 OF VAVEHDTALE-R TO B1O2ST OF
             AGAUTOBUL0-R
      *    SCP Model Version Code
           MOVE J6SCVERCDE OF FVEHDF2 OF VAVEHDTALE-R TO B1SCVERCDE OF
             AGAUTOBUL0-R
      *    Model Marketing Desc.
           MOVE WN0002 TO B1MDLMRKD OF AGAUTOBUL0-R
      *    Version Marketing Desc.
           MOVE WN0003 TO B1VSNMKDSC OF AGAUTOBUL0-R
      *    Vehicle Model Trim Level
           MOVE WN0004 TO B1VEHTRIML OF AGAUTOBUL0-R
      *    CAP Vehicle Code
           MOVE WN0005 TO B1CAPVEHCD OF AGAUTOBUL0-R
      *    CAP Vehicle ID Number
           MOVE WN0006 TO B1CAPVEHNB OF AGAUTOBUL0-R
      *    CAP Model Dsc Cleansed
           MOVE WN0007 TO B1CAPMDLDC OF AGAUTOBUL0-R
      *    CAP Version Dsc Cleansed
           MOVE WN0008 TO B1CAPVERDC OF AGAUTOBUL0-R
      *    Autotrader Vehicle Type
           MOVE WN0009 TO B1AUTVEHTY OF AGAUTOBUL0-R
      *    Vehicle Body Name ATR
           MOVE WN0010 TO B1VEHBDYNM OF AGAUTOBUL0-R
      *    Vehicle Fuel Type
           MOVE WN0011 TO B1VEHFUELT OF AGAUTOBUL0-R
      *    Vehicle Drive System
           MOVE WN0012 TO B1VEHDRVSY OF AGAUTOBUL0-R
      *    Vehicle Horse Power
           MOVE WN0013 TO B1VEHPOWER OF AGAUTOBUL0-R
      *    Veh Co2
           MOVE YL0271 OF WORK-CONTEXT TO B1VCODE3 OF AGAUTOBUL0-R
      *    Vehicle Gearbox Type
           MOVE WN0014 TO B1VEHGRBTY OF AGAUTOBUL0-R
      *    Colour Code
           MOVE J6CLRCDE OF FVEHDF2 OF VAVEHDTALE-R TO B1CLRCDE OF
             AGAUTOBUL0-R
      *    Colour Description
           MOVE WN0015 TO B1CLRDES OF AGAUTOBUL0-R
      *    SCP Options
           MOVE J6OPTSCP OF FVEHDF2 OF VAVEHDTALE-R TO B1OPTSCP OF
             AGAUTOBUL0-R
      *    SCR Trim Type
           MOVE J6TRMTYSCR OF FVEHDF2 OF VAVEHDTALE-R TO B1TRMTYSCR OF
             AGAUTOBUL0-R
      *    SCR Trim Colour
           MOVE J6TRMCLSCR OF FVEHDF2 OF VAVEHDTALE-R TO B1TRMCLSCR OF
             AGAUTOBUL0-R
      *    Trim Description (48)
           MOVE WN0016 TO B1TRIMDES OF AGAUTOBUL0-R
      *    Vehicle Fuel Code
           MOVE J6FTFUEL OF FVEHDF2 OF VAVEHDTALE-R TO B1FTFUEL OF
             AGAUTOBUL0-R
      *    Vehicle Engine Capacity
           MOVE WN0017 TO B1VEHENGCP OF AGAUTOBUL0-R
      *    Vehicle Number of Doors
           MOVE WN0018 TO B1VEHNODRS OF AGAUTOBUL0-R
      *    Vehicle Seating Capacity
           MOVE WN0019 TO B1VEHSEATS OF AGAUTOBUL0-R
      *    Vehicle Mileage
           MOVE WN0020 TO B1VEHMILES OF AGAUTOBUL0-R
      *    Vehicle Top Speed
           MOVE WN0021 TO B1VEHTOPSP OF AGAUTOBUL0-R
      *    Vehicle Fuel Tank Cap
           MOVE WN0022 TO B1VEHFTKCP OF AGAUTOBUL0-R
      *    Vehicle Range
           MOVE WN0023 TO B1VEHRANGE OF AGAUTOBUL0-R
      *    Vehicle External Length
           MOVE WN0024 TO B1VEHEXTLN OF AGAUTOBUL0-R
      *    Vehicle Ext Length Units
           MOVE WN0025 TO B1VEHEXTLU OF AGAUTOBUL0-R
      *    Vehicle Ext Length AddTxt
           MOVE WN0026 TO B1VEHEXTLT OF AGAUTOBUL0-R
      *    Vehicle External Width
           MOVE WN0027 TO B1VEHEXTWD OF AGAUTOBUL0-R
      *    Vehicle External Height
           MOVE WN0028 TO B1VEHEXTHT OF AGAUTOBUL0-R
      *    Vehicle Ext Height Units
           MOVE WN0029 TO B1VEHEXTHU OF AGAUTOBUL0-R
      *    Vehicle Ext Height AddTxt
           MOVE WN0030 TO B1VEHEXTHX OF AGAUTOBUL0-R
      *    Vehicle Gross Weight
           MOVE WN0031 TO B1VEHGWGHT OF AGAUTOBUL0-R
      *    Vehicle Wheelbase
           MOVE WN0032 TO B1VEHWHLBS OF AGAUTOBUL0-R
      *    TCM Date 07
           MOVE J6TCMDT07 OF FVEHDF2 OF VAVEHDTALE-R TO B1TCMDT07 OF
             AGAUTOBUL0-R
      *    PEC/MADC Date 10
           MOVE J6PECDT10 OF FVEHDF2 OF VAVEHDTALE-R TO B1PECDT10 OF
             AGAUTOBUL0-R
      *    Arrival at Dock Date 28
           MOVE J6DOCDT28 OF FVEHDF2 OF VAVEHDTALE-R TO B1DOCDT28 OF
             AGAUTOBUL0-R
      *    Exit Import Centre Dte 45
           MOVE J6EXICDT45 OF FVEHDF2 OF VAVEHDTALE-R TO B1EXICDT45 OF
             AGAUTOBUL0-R
      *    Transfer Date 55
           MOVE J6TFRDT55 OF FVEHDF2 OF VAVEHDTALE-R TO B1TFRDT55 OF
             AGAUTOBUL0-R
      *    Registration Date 58
           MOVE J6REGDT58 OF FVEHDF2 OF VAVEHDTALE-R TO B1REGDT58 OF
             AGAUTOBUL0-R
      *    Sedre Vehicle Status
           MOVE WN0033 TO B1SEDVEHST OF AGAUTOBUL0-R
      *    Sedre Vehicle Status Dsc
           MOVE WN0034 TO B1SEDVEHSD OF AGAUTOBUL0-R
      *    Customer Order Number
           MOVE WN0035 TO B1CUSORDNB OF AGAUTOBUL0-R
      *    Customer Order Date #
           MOVE WN0036 TO B1CUSORDD8 OF AGAUTOBUL0-R
      *    Cust Allocation Date
           MOVE WN0037 TO B1CUSALCD8 OF AGAUTOBUL0-R
      *    SEDRE customer type
           MOVE WN0038 TO B1TCCSTTYP OF AGAUTOBUL0-R
      *    Order Type Central
           MOVE WN0039 TO B1ORDTYPCN OF AGAUTOBUL0-R
      *    SD Sales Channel Code ATR
           MOVE WN0040 TO B1SDSLCHNA OF AGAUTOBUL0-R
      *    Vehicle List Price
           MOVE WN0041 TO B1VEHLSTPR OF AGAUTOBUL0-R
      *    Vehicle Version Price
           MOVE WN0042 TO B1VEHVERPR OF AGAUTOBUL0-R
      *    Vehicle Delivery Price
           MOVE WN0043 TO B1VEHDLVPR OF AGAUTOBUL0-R
      *    Vehicle Colour Price
           MOVE WN0044 TO B1VEHCOLPR OF AGAUTOBUL0-R
      *    Vehicle Accessories Price
           MOVE WN0045 TO B1VEHACCPR OF AGAUTOBUL0-R
      *    Vehicle Options Price
           MOVE WN0046 TO B1VEHOPTPR OF AGAUTOBUL0-R
      *    Vehicle First Reg Fee
           MOVE WN0047 TO B1VEHFRF OF AGAUTOBUL0-R
      *    Vehicle Road Fun License
           MOVE WN0048 TO B1VEHFVIGN OF AGAUTOBUL0-R
      *    Vehicle On The Road Price
           MOVE WN0049 TO B1VEHOTRPR OF AGAUTOBUL0-R
      *    Vehicle All Options Dsc
           MOVE WN0050 TO B1OPTDSCAL OF AGAUTOBUL0-R
      *    Vehicle All Accessory Dsc
           MOVE WN0051 TO B1VEHAXSDA OF AGAUTOBUL0-R
      *    Vehicle Version KSP All
           MOVE WN0052 TO B1KSPDSCAL OF AGAUTOBUL0-R
      *    Vehicle Options AXS Merge
           MOVE WN0053 TO B1VEHOPTAX OF AGAUTOBUL0-R
      *    KSP Attn text
           MOVE YL0272 OF WORK-CONTEXT TO B1KSPATNTX OF AGAUTOBUL0-R
      *    PICG Grant Amount
           MOVE YL0264 OF WORK-CONTEXT TO B1PICGGA OF AGAUTOBUL0-R
      *    Record Processed Status
           MOVE WN0054 TO B1RCDPSTS OF AGAUTOBUL0-R
      *
      *    USER: Processing before Data update
      *    Rtn Update Audit Structur
      *    PAR.Date Last Changed D8# = JOB.*Job date
           IF (ZZJDT OF JOB-CONTEXT = ZERO) THEN
               MOVE ZEROS TO B1CHGDT8 OF AGAUTOBUF0 OF AGAUTOBUL0-R
           ELSE
               ADD 19000000 TO ZZJDT OF JOB-CONTEXT GIVING B1CHGDT8 OF
                 AGAUTOBUF0 OF AGAUTOBUL0-R
           END-IF
      *    Time Last Changed
           MOVE ZZJTM OF JOB-CONTEXT TO B1CHGTME OF AGAUTOBUF0 OF
             AGAUTOBUL0-R
      *    User Last Changed
           MOVE ZZUSR OF JOB-CONTEXT TO B1USERCHGD OF AGAUTOBUF0 OF
             AGAUTOBUL0-R
      *    Program Last Changed
           MOVE ZZPGM OF JOB-CONTEXT TO B1PGMCHG OF AGAUTOBUF0 OF
             AGAUTOBUL0-R
      *    Job Last Changed
           MOVE ZZJOB OF JOB-CONTEXT TO B1JOBCHG OF AGAUTOBUF0 OF
             AGAUTOBUL0-R
           REWRITE AGAUTOBUL0-R END-REWRITE
           IF (NOT C-IO-OK) THEN
               SET C-INDICATOR-ON(91) TO TRUE
           ELSE
               SET C-INDICATOR-OFF(91) TO TRUE
           END-IF
           IF (C-INDICATOR-ON(91)) THEN
      *        Change error detected
               MOVE 'Y2U0004' TO W0RTN
           ELSE
      *        DBF change successful
               CONTINUE
           END-IF
      *==============================================================
           CONTINUE.
       SC4EXIT.
           EXIT.
      /EJECT
       SC5RVGN SECTION.
      *==============================================================
      *    Rtv Check Block Miss KSP - Autotrader Bulk Upload  *
      *==============================================================
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    USER: Initialize routine
      *    Sttaus K : Missing KSP Settings
      *    U:Text (1)
           MOVE 'K' TO YL0276 OF WORK-CONTEXT
      *    Setup key
      *    Record Processed Status
           MOVE '5' TO B1RCDPSTS OF KRSSC5
      *    Initialise Full Externally Described Keylist
      *    Record Processed Status
           MOVE LOW-VALUES TO B1RCDPSTS OF EXTSC5
      *    Brand 15
           MOVE LOW-VALUES TO B1BRAND15 OF EXTSC5
      *    SCP Model code
           MOVE LOW-VALUES TO B1SCMDLCDE OF EXTSC5
      *    Phase
           MOVE LOW-VALUES TO B1O2ST OF EXTSC5
      *    Vehicle Model Trim Level
           MOVE LOW-VALUES TO B1VEHTRIML OF EXTSC5
      *    SCP Model Version Code
           MOVE LOW-VALUES TO B1SCVERCDE OF EXTSC5
      *    Owning Account
           MOVE LOW-VALUES TO B1OWNACC OF EXTSC5
      *    Invariant BCV
           MOVE LOW-VALUES TO B1INVBCV OF EXTSC5
           MOVE CORRESPONDING
             EXTSC5 TO
             AGAUTOBUF2 OF AGAUTOBUL2-R
           MOVE CORRESPONDING
             KRSSC5 TO
             AGAUTOBUF2 OF AGAUTOBUL2-R
           START AGAUTOBUL2 KEY NOT < EXTERNALLY-DESCRIBED-KEY
             FORMAT IS 'AGAUTOBUF2'
           END-START
           IF (C-IO-ERR) THEN
               STOP RUN
           END-IF
           SET C-INDICATOR-OFF(90) TO TRUE
           READ AGAUTOBUL2 NEXT
             FORMAT IS 'AGAUTOBUF2'
           END-READ
           IF (C-EOF) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               IF (C-IO-ERR) THEN
                   STOP RUN
               ELSE
                   MOVE CORRESPONDING
                     AGAUTOBUF2 OF AGAUTOBUL2-R TO
                     EXTSC5
                   MOVE EXTSC5 TO KRSSC5-TMP
                   IF (KRSSC5 NOT = KRSSC5-TMP) THEN
                       SET C-INDICATOR-ON(90) TO TRUE
                   END-IF
               END-IF
           END-IF
      *    Initialise Full Externally Described Keylist
      *    Record Processed Status
           MOVE LOW-VALUES TO B1RCDPSTS OF EXTSC5
      *    Brand 15
           MOVE LOW-VALUES TO B1BRAND15 OF EXTSC5
      *    SCP Model code
           MOVE LOW-VALUES TO B1SCMDLCDE OF EXTSC5
      *    Phase
           MOVE LOW-VALUES TO B1O2ST OF EXTSC5
      *    Vehicle Model Trim Level
           MOVE LOW-VALUES TO B1VEHTRIML OF EXTSC5
      *    SCP Model Version Code
           MOVE LOW-VALUES TO B1SCVERCDE OF EXTSC5
      *    Owning Account
           MOVE LOW-VALUES TO B1OWNACC OF EXTSC5
      *    Invariant BCV
           MOVE LOW-VALUES TO B1INVBCV OF EXTSC5
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'JSM2458' TO W0RTN
           END-IF
           PERFORM UNTIL NOT (C-INDICATOR-OFF(90))
      *        USER: Process Data record
      *        CASE: DB1.Vehicle Version KSP All is *Blank
      *        *IF
               IF (B1KSPDSCAL OF AGAUTOBUF2 OF AGAUTOBUL2-R = ' ') THEN
      *            Record Processed Status
                   MOVE YL0276 OF WORK-CONTEXT TO YL0277 OF WORK-CONTEXT
     W* Y2W0053 - One or more arguments defaulted to available contexts
      *            Field '(DB1) B1KSPATNTX OF AGAUTOBUF2' defaulted
      *              for 'KSP Attn text'.
      *            Field '(DB1) B1PICGGA OF AGAUTOBUF2 OF' defaulted
      *              for 'PICG Grant Amount'.
      *            Change Status Only - Autotrader Bulk Upload  *
                   PERFORM SC6CHRC
               END-IF
               SET C-INDICATOR-OFF(90) TO TRUE
               READ AGAUTOBUL2 NEXT
                 FORMAT IS 'AGAUTOBUF2'
               END-READ
               IF (C-EOF) THEN
                   SET C-INDICATOR-ON(90) TO TRUE
               ELSE
                   IF (C-IO-ERR) THEN
                       STOP RUN
                   ELSE
                       MOVE CORRESPONDING
                         AGAUTOBUF2 OF AGAUTOBUL2-R TO
                         EXTSC5
                       MOVE EXTSC5 TO KRSSC5-TMP
                       IF (KRSSC5 NOT = KRSSC5-TMP) THEN
                           SET C-INDICATOR-ON(90) TO TRUE
                       END-IF
                   END-IF
               END-IF
      *        Initialise Full Externally Described Keylist
      *        Record Processed Status
               MOVE LOW-VALUES TO B1RCDPSTS OF EXTSC5
      *        Brand 15
               MOVE LOW-VALUES TO B1BRAND15 OF EXTSC5
      *        SCP Model code
               MOVE LOW-VALUES TO B1SCMDLCDE OF EXTSC5
      *        Phase
               MOVE LOW-VALUES TO B1O2ST OF EXTSC5
      *        Vehicle Model Trim Level
               MOVE LOW-VALUES TO B1VEHTRIML OF EXTSC5
      *        SCP Model Version Code
               MOVE LOW-VALUES TO B1SCVERCDE OF EXTSC5
      *        Owning Account
               MOVE LOW-VALUES TO B1OWNACC OF EXTSC5
      *        Invariant BCV
               MOVE LOW-VALUES TO B1INVBCV OF EXTSC5
           END-PERFORM
      *==============================================================
           CONTINUE.
       SC5EXIT.
           EXIT.
      /EJECT
       SC6CHRC SECTION.
      *==============================================================
      *    Change Status Only - Autotrader Bulk Upload  *
      *==============================================================
      *    Clear all neither parameters
      *    VIN
           MOVE SPACES TO WN0139
      *    Owning Account
           MOVE SPACES TO WN0140
      *    Dealer Name
           MOVE SPACES TO WN0141
      *    Brand 15
           MOVE SPACES TO WN0142
      *    SCP Model code
           MOVE SPACES TO WN0143
      *    Phase
           MOVE SPACES TO WN0144
      *    SCP Model Version Code
           MOVE SPACES TO WN0145
      *    Model Marketing Desc.
           MOVE SPACES TO WN0146
      *    Version Marketing Desc.
           MOVE SPACES TO WN0147
      *    Vehicle Model Trim Level
           MOVE SPACES TO WN0148
      *    CAP Vehicle Code
           MOVE SPACES TO WN0149
      *    CAP Vehicle ID Number
           MOVE ZEROS TO WN0150
      *    CAP Model Dsc Cleansed
           MOVE SPACES TO WN0151
      *    CAP Version Dsc Cleansed
           MOVE SPACES TO WN0152
      *    Autotrader Vehicle Type
           MOVE SPACES TO WN0153
      *    Vehicle Body Name ATR
           MOVE SPACES TO WN0154
      *    Vehicle Fuel Type
           MOVE SPACES TO WN0155
      *    Vehicle Drive System
           MOVE SPACES TO WN0156
      *    Vehicle Horse Power
           MOVE SPACES TO WN0157
      *    Veh Co2
           MOVE SPACES TO WN0158
      *    Vehicle Gearbox Type
           MOVE SPACES TO WN0159
      *    Colour Code
           MOVE SPACES TO WN0160
      *    Colour Description
           MOVE SPACES TO WN0161
      *    SCP Options
           MOVE SPACES TO WN0162
      *    SCR Trim Type
           MOVE SPACES TO WN0163
      *    SCR Trim Colour
           MOVE SPACES TO WN0164
      *    Trim Description (48)
           MOVE SPACES TO WN0165
      *    Vehicle Fuel Code
           MOVE SPACES TO WN0166
      *    Vehicle Engine Capacity
           MOVE ZEROS TO WN0167
      *    Vehicle Number of Doors
           MOVE ZEROS TO WN0168
      *    Vehicle Seating Capacity
           MOVE ZEROS TO WN0169
      *    Vehicle Mileage
           MOVE ZEROS TO WN0170
      *    Vehicle Top Speed
           MOVE SPACES TO WN0171
      *    Vehicle Fuel Tank Cap
           MOVE SPACES TO WN0172
      *    Vehicle Range
           MOVE SPACES TO WN0173
      *    Vehicle External Length
           MOVE SPACES TO WN0174
      *    Vehicle Ext Length Units
           MOVE SPACES TO WN0175
      *    Vehicle Ext Length AddTxt
           MOVE SPACES TO WN0176
      *    Vehicle External Width
           MOVE SPACES TO WN0177
      *    Vehicle External Height
           MOVE SPACES TO WN0178
      *    Vehicle Ext Height Units
           MOVE SPACES TO WN0179
      *    Vehicle Ext Height AddTxt
           MOVE SPACES TO WN0180
      *    Vehicle Gross Weight
           MOVE ZEROS TO WN0181
      *    Vehicle Wheelbase
           MOVE SPACES TO WN0182
      *    TCM Date 07
           MOVE ZEROS TO WN0183
      *    PEC/MADC Date 10
           MOVE ZEROS TO WN0184
      *    Arrival at Dock Date 28
           MOVE ZEROS TO WN0185
      *    Exit Import Centre Dte 45
           MOVE ZEROS TO WN0186
      *    Transfer Date 55
           MOVE ZEROS TO WN0187
      *    Registration Date 58
           MOVE ZEROS TO WN0188
      *    Sedre Vehicle Status
           MOVE SPACES TO WN0189
      *    Sedre Vehicle Status Dsc
           MOVE SPACES TO WN0190
      *    Customer Order Number
           MOVE SPACES TO WN0191
      *    Customer Order Date #
           MOVE ZEROS TO WN0192
      *    Cust Allocation Date
           MOVE ZEROS TO WN0193
      *    SEDRE customer type
           MOVE SPACES TO WN0194
      *    Order Type Central
           MOVE SPACES TO WN0195
      *    SD Sales Channel Code ATR
           MOVE SPACES TO WN0196
      *    Vehicle List Price
           MOVE ZEROS TO WN0197
      *    Vehicle Version Price
           MOVE ZEROS TO WN0198
      *    Vehicle Delivery Price
           MOVE ZEROS TO WN0199
      *    Vehicle Colour Price
           MOVE ZEROS TO WN0200
      *    Vehicle Accessories Price
           MOVE ZEROS TO WN0201
      *    Vehicle Options Price
           MOVE ZEROS TO WN0202
      *    Vehicle First Reg Fee
           MOVE ZEROS TO WN0203
      *    Vehicle Road Fun License
           MOVE ZEROS TO WN0204
      *    Vehicle On The Road Price
           MOVE ZEROS TO WN0205
      *    Vehicle All Options Dsc
           MOVE SPACES TO WN0206
      *    Vehicle All Accessory Dsc
           MOVE SPACES TO WN0207
      *    Vehicle Version KSP All
           MOVE SPACES TO WN0208
      *    Vehicle Options AXS Merge
           MOVE SPACES TO WN0209
      *    Create Date D8#
           MOVE ZEROS TO WN0210
      *    Create Time
           MOVE ZEROS TO WN0211
      *    Create User
           MOVE SPACES TO WN0212
      *    Create Program
           MOVE SPACES TO WN0213
      *    Create Job
           MOVE SPACES TO WN0214
      *    Date Last Changed D8#
           MOVE ZEROS TO WN0215
      *    Time Last Changed
           MOVE ZEROS TO WN0216
      *    User Last Changed
           MOVE SPACES TO WN0217
      *    Program Last Changed
           MOVE SPACES TO WN0218
      *    Job Last Changed
           MOVE SPACES TO WN0219
      *
      *    Initialize return code
           MOVE SPACES TO W0RTN
      *    Move key fields to AGAUTOBUF0
      *    Invariant BCV
           MOVE B1INVBCV OF AGAUTOBUF2 OF AGAUTOBUL2-R TO B1INVBCV OF
             AGAUTOBUL0-R
      *
           READ AGAUTOBUL0 END-READ
           IF (C-NO-RECORD) THEN
               SET C-INDICATOR-ON(90) TO TRUE
           ELSE
               SET C-INDICATOR-OFF(90) TO TRUE
           END-IF
           IF (C-IO-ERR OR
               C-RECORD-LOCKED) THEN
               SET C-INDICATOR-ON(91) TO TRUE
           ELSE
               SET C-INDICATOR-OFF(91) TO TRUE
           END-IF
      *
           IF (C-INDICATOR-ON(90)) THEN
      *        Data record not found
               MOVE 'Y2U0009' TO W0RTN
               MOVE ZZPGM  OF JOB-CONTEXT TO MDPGM OF MD0009
               MOVE 'AGAUTOBUL0' TO MDACP OF MD0009
               MOVE 'AGAUTOBUF0' TO MDFMT OF MD0009
               MOVE '*CHG' TO MDACT OF MD0009
      *        Record not found label: LBL002.
               MOVE 'LBL002' TO MDLBL OF MD0009
      *        Send message '*Record no longer on file'
      *        Message ID
               MOVE 'Y2U0009' TO ZAMSID
      *        Message file
               MOVE 'Y2USRMSG' TO ZAMSGF
      *        Message data
               MOVE MD0009 TO ZAMSDA
               PERFORM ZASNMS
               MOVE SPACES TO MD0009
               GO SC6EXIT
           END-IF
      *
           IF (C-INDICATOR-ON(91)) THEN
      *        Record locked
               MOVE 'Y2U0004' TO W0RTN
      *        Send message '*Database operation error'
      *        Message ID
               MOVE 'Y2U0004' TO ZAMSID
      *        Message file
               MOVE 'Y2USRMSG' TO ZAMSGF
               PERFORM ZASNMS
               GO SC6EXIT
           END-IF
      *
      *    Move all fields to AGAUTOBUF0
      *    KSP Attn text
           MOVE B1KSPATNTX OF AGAUTOBUF2 OF AGAUTOBUL2-R TO B1KSPATNTX
             OF AGAUTOBUL0-R
      *    PICG Grant Amount
           MOVE B1PICGGA OF AGAUTOBUF2 OF AGAUTOBUL2-R TO B1PICGGA OF
             AGAUTOBUL0-R
      *    Record Processed Status
           MOVE YL0277 OF WORK-CONTEXT TO B1RCDPSTS OF AGAUTOBUL0-R
      *
      *    USER: Processing before Data update
      *    Rtn Update Audit Structur
      *    PAR.Date Last Changed D8# = JOB.*Job date
           IF (ZZJDT OF JOB-CONTEXT = ZERO) THEN
               MOVE ZEROS TO B1CHGDT8 OF AGAUTOBUF0 OF AGAUTOBUL0-R
           ELSE
               ADD 19000000 TO ZZJDT OF JOB-CONTEXT GIVING B1CHGDT8 OF
                 AGAUTOBUF0 OF AGAUTOBUL0-R
           END-IF
      *    Time Last Changed
           MOVE ZZJTM OF JOB-CONTEXT TO B1CHGTME OF AGAUTOBUF0 OF
             AGAUTOBUL0-R
      *    User Last Changed
           MOVE ZZUSR OF JOB-CONTEXT TO B1USERCHGD OF AGAUTOBUF0 OF
             AGAUTOBUL0-R
      *    Program Last Changed
           MOVE ZZPGM OF JOB-CONTEXT TO B1PGMCHG OF AGAUTOBUF0 OF
             AGAUTOBUL0-R
      *    Job Last Changed
           MOVE ZZJOB OF JOB-CONTEXT TO B1JOBCHG OF AGAUTOBUF0 OF
             AGAUTOBUL0-R
           REWRITE AGAUTOBUL0-R END-REWRITE
           IF (NOT C-IO-OK) THEN
               SET C-INDICATOR-ON(91) TO TRUE
           ELSE
               SET C-INDICATOR-OFF(91) TO TRUE
           END-IF
           IF (C-INDICATOR-ON(91)) THEN
      *        Change error detected
               MOVE 'Y2U0004' TO W0RTN
           ELSE
      *        DBF change successful
               CONTINUE
           END-IF
      *==============================================================
           CONTINUE.
       SC6EXIT.
           EXIT.
      /EJECT
       UA1SUBR SECTION.
      *==============================================================
      *    Desc
      *==============================================================
      *    Application: VOR
      *    Created:  2019.09.05
      *    Desc:  Create Export AutoTrader Bulk
      *    ------------------------------------------------------------
      *      --------------
      *    Changes:
      *    2020.10.19 JLT  BZ:  98855   add fuel type from file
      *    2021.04.15 JLT  EDH-197      Exlude dealer list
      *    2021.10.07 JLT  EDH-1738     Corect Sedre fuel description
      *    Utl @Copyright - #Standard Functions  *
     ** Function   : Copyright
     ** System     : All models
     ** Programmer : UKNOWN
     ** Date       : 2021
     **.................................................................
      *==============================================================
           CONTINUE.
       UA1EXIT.
           EXIT.
      /EJECT
       UA2SUBR SECTION.
      *==============================================================
      *    Initialise Date Range
      *==============================================================
      *    From Date
      *    CASE: PAR.U:Date (8) Char is *Blank
      *    *IF
           IF (P4UDTECHR = SPACES) THEN
      *        U:From Date (8.0)
               MOVE 19000101 TO P6E0DX
           ELSE
      *        CASE: *OTHERWISE
               IF (P4UDTECHR = SPACES) THEN
                   MOVE ZERO TO P6E0DX
               ELSE
                   MOVE P4UDTECHR TO P6E0DX
               END-IF
           END-IF
      *    To Date
      *    CASE: PAR.U:To Date (TXT) is *Blank
      *    *IF
           IF (P5Y3TX = SPACES) THEN
      *        U:To Date (8.0)
               MOVE 29991231 TO P7JXDX
           ELSE
      *        CASE: *OTHERWISE
               IF (P5Y3TX = SPACES) THEN
                   MOVE ZERO TO P7JXDX
               ELSE
                   MOVE P5Y3TX TO P7JXDX
               END-IF
           END-IF
      *==============================================================
           CONTINUE.
       UA2EXIT.
           EXIT.
      /EJECT
       UA3SUBR SECTION.
      *==============================================================
      *    Set Parm Fields
      *==============================================================
           MOVE 14 TO YRSW03
           MOVE 4 TO YRSW02
           IF (YRSW02 NOT > 0 OR
               YRSW03 NOT > 0 OR
               YRSW02 > 00017 OR
               YRSW03 > 00017) THEN
               MOVE 'Y2U0510' TO W0RTN
           ELSE
               MOVE J6VIN OF FVEHDF2 OF VAVEHDTALE-R TO W0STRNG
               MOVE W0STRNG(YRSW02:YRSW03) TO YL0084 OF WORK-CONTEXT
           END-IF
      *    dealer
           PERFORM UA4SUBR
      *    Autotrader Vehicle Type
           MOVE YL0019 OF WORK-CONTEXT TO WN0009
      *    CAP Vehicle Code
           MOVE YL0035 OF WORK-CONTEXT TO WN0005
      *    CAP Vehicle ID Number
           MOVE YL0036 OF WORK-CONTEXT TO WN0006
      *    CAP Model Dsc Cleansed
           MOVE YL0037 OF WORK-CONTEXT TO WN0007
      *    CAP Version Dsc Cleansed
           MOVE YL0038 OF WORK-CONTEXT TO WN0008
      *    Exc Rtv Vehicle Colour - #Foreign model access  *
           SET C-INDICATOR-OFF(90) TO TRUE
           MOVE SPACES TO WQ0062
           MOVE J6CLRCDE OF FVEHDF2 OF VAVEHDTALE-R TO WQ0063
           MOVE SPACES TO WQ0064
           MOVE SPACES TO WQ0065
           MOVE SPACES TO WQ0066
           MOVE SPACES TO WQ0067
           MOVE SPACES TO WQ0068
           MOVE SPACES TO WQ0069
           MOVE SPACES TO WQ0070
      *
           CALL 'VAG004000S' USING
      *    *Return code
             WQ0062
      *    Colour Code
             WQ0063
      *    Colour Marketing Desc
             WQ0064
      *    Colour Type Code
             WQ0065
      *    Vehicle MVRIS Colour Code
             WQ0066
      *    Vehicle MVRIS Colour Cde2
             WQ0067
      *    Vehicle MVRIS Colour Cde3
             WQ0068
      *    Colour Type Category Code
             WQ0069
      *    Vehicle Database Rec Sts
             WQ0070
                    ON OVERFLOW
                    SET C-INDICATOR-ON(90) TO TRUE
           END-CALL
      *
           MOVE WQ0062 TO W0RTN
           MOVE WQ0064 TO WN0015
      *
      *    Error on program call will terminate run unit
           IF (C-INDICATOR-ON(90)) THEN
               MOVE 'Y2U0032' TO W0RTN
               MOVE 'VAG004000S' TO W0CLPG
      *        Send message '*Error occured on CALL...'
      *        Message ID
               MOVE 'Y2U0032' TO ZAMSID
      *        Message file
               MOVE 'Y2USRMSG' TO ZAMSGF
      *        Message data
               MOVE W0CLPG TO ZAMSDA
               PERFORM ZASNMS
               SET C-INDICATOR-ON(99) TO TRUE
           END-IF
      *    Vehicle Model Trim Level
           MOVE YL0015 OF WORK-CONTEXT TO WN0004
      *    Model Marketing Desc.
           MOVE YL0012 OF WORK-CONTEXT TO WN0002
      *    Version Marketing Desc.
           MOVE YL0014 OF WORK-CONTEXT TO WN0003
      *    Vehicle Body Name ATR
           MOVE YL0017 OF WORK-CONTEXT TO WN0010
      *    Vehicle Number of Doors
           MULTIPLY YL0026 OF WORK-CONTEXT BY 1 GIVING WN0018
      *    Vehicle Seating Capacity
           MULTIPLY YL0027 OF WORK-CONTEXT BY 1 GIVING WN0019
      *    Vehicle Engine Capacity
           MULTIPLY YL0023 OF WORK-CONTEXT BY 1 GIVING WN0017
      *    Vehicle Gross Weight
           MULTIPLY YL0024 OF WORK-CONTEXT BY 1 GIVING WN0031
      *    Ext rtv Veh Fuel DesSEDRE - #Foreign model access  *
           SET C-INDICATOR-OFF(90) TO TRUE
           MOVE SPACES TO WQ0071
           MOVE J6FTFUEL OF FVEHDF2 OF VAVEHDTALE-R TO WQ0072
           MOVE SPACES TO WQ0073
           MOVE SPACES TO WQ0074
           MOVE SPACES TO WQ0075
      *
           CALL 'VAMF00600S' USING
      *    *Return code
             WQ0071
      *    SEDRE Fuel Code
             WQ0072
      *    SEDRE Fuel Description
             WQ0073
      *    MVRIS Fuel Description
             WQ0074
      *    MVRIS Fuel Code
             WQ0075
                    ON OVERFLOW
                    SET C-INDICATOR-ON(90) TO TRUE
           END-CALL
      *
           MOVE WQ0071 TO W0RTN
           MOVE WQ0073 TO WN0011
      *
      *    Error on program call will terminate run unit
           IF (C-INDICATOR-ON(90)) THEN
               MOVE 'Y2U0032' TO W0RTN
               MOVE 'VAMF00600S' TO W0CLPG
      *        Send message '*Error occured on CALL...'
      *        Message ID
               MOVE 'Y2U0032' TO ZAMSID
      *        Message file
               MOVE 'Y2USRMSG' TO ZAMSGF
      *        Message data
               MOVE W0CLPG TO ZAMSDA
               PERFORM ZASNMS
               SET C-INDICATOR-ON(99) TO TRUE
           END-IF
      *    Set Gearbox Type
      *    CASE: LCL.Gearbox Type Sts is Automatic
      *    *IF
           IF (YL0025 OF WORK-CONTEXT = 'A') THEN
      *        Vehicle Gearbox Type
               MOVE SPACES TO WN0014
               MOVE 'Automatic' TO WN0014
           ELSE
      *        CASE: LCL.Gearbox Type Sts is Manual
      *        *IF
               IF (YL0025 OF WORK-CONTEXT = 'M') THEN
      *            Vehicle Gearbox Type
                   MOVE SPACES TO WN0014
                   MOVE 'Manual' TO WN0014
               ELSE
      *            CASE: LCL.Gearbox Type Sts is Semi-Automatic
      *            *IF
                   IF (YL0025 OF WORK-CONTEXT = 'S') THEN
      *                Vehicle Gearbox Type
                       MOVE SPACES TO WN0014
                       MOVE 'Semi-Automatic' TO WN0014
                   ELSE
      *                CASE: *OTHERWISE
      *                Vehicle Gearbox Type
                       MOVE SPACES TO WN0014
                       MOVE 'Undefined' TO WN0014
                   END-IF
               END-IF
           END-IF
      *    Vehicle Horse Power
           MOVE YL0050 OF WORK-CONTEXT TO WN0013
      *    Vehicle Drive System
           MOVE YL0051 OF WORK-CONTEXT TO WN0012
      *    Vehicle Top Speed
           MOVE YL0081 OF WORK-CONTEXT TO WN0021
      *    Vehicle Fuel Tank Cap
           MOVE YL0052 OF WORK-CONTEXT TO WN0022
      *    Vehicle Range
           MOVE YL0083 OF WORK-CONTEXT TO WN0023
      *    Vehicle External Length
           MOVE YL0053 OF WORK-CONTEXT TO WN0024
      *    Vehicle Ext Length Units
           MOVE YL0054 OF WORK-CONTEXT TO WN0025
      *    Vehicle Ext Length AddTxt
           MOVE YL0055 OF WORK-CONTEXT TO WN0026
      *    Vehicle External Width
           MOVE YL0068 OF WORK-CONTEXT TO WN0027
      *    Vehicle External Height
           MOVE YL0069 OF WORK-CONTEXT TO WN0028
      *    Vehicle Ext Height Units
           MOVE YL0070 OF WORK-CONTEXT TO WN0029
      *    Vehicle Ext Height AddTxt
           MOVE YL0071 OF WORK-CONTEXT TO WN0030
      *    Vehicle Wheelbase
           MOVE YL0082 OF WORK-CONTEXT TO WN0032
      *    Clear all neither parameters
      *    Option Code ATR 01
           MOVE SPACES TO WN0056
      *    Option Desc ATR 01
           MOVE SPACES TO WN0057
      *    Option Code ATR 02
           MOVE SPACES TO WN0058
      *    Option Desc ATR 02
           MOVE SPACES TO WN0059
      *    Option Code ATR 03
           MOVE SPACES TO WN0060
      *    Option Desc ATR 03
           MOVE SPACES TO WN0061
      *    Option Code ATR 04
           MOVE SPACES TO WN0062
      *    Option Desc ATR 04
           MOVE SPACES TO WN0063
      *    Option Code ATR 05
           MOVE SPACES TO WN0064
      *    Option Desc ATR 05
           MOVE SPACES TO WN0065
      *    Option Code ATR 06
           MOVE SPACES TO WN0066
      *    Option Desc ATR 06
           MOVE SPACES TO WN0067
      *    Option Code ATR 07
           MOVE SPACES TO WN0068
      *    Option Desc ATR 07
           MOVE SPACES TO WN0069
      *    Option Code ATR 08
           MOVE SPACES TO WN0070
      *    Option Desc ATR 08
           MOVE SPACES TO WN0071
      *    Option Code ATR 09
           MOVE SPACES TO WN0072
      *    Option Desc ATR 09
           MOVE SPACES TO WN0073
      *    Option Code ATR 10
           MOVE SPACES TO WN0074
      *    Option Desc ATR 10
           MOVE SPACES TO WN0075
      *    Option Code ATR 11
           MOVE SPACES TO WN0076
      *    Option Desc ATR 11
           MOVE SPACES TO WN0077
      *    Option Code ATR 12
           MOVE SPACES TO WN0078
      *    Option Desc ATR 12
           MOVE SPACES TO WN0079
      *    Option Code ATR 13
           MOVE SPACES TO WN0080
      *    Option Desc ATR 13
           MOVE SPACES TO WN0081
      *    Option Code ATR 14
           MOVE SPACES TO WN0082
      *    Option Desc ATR 14
           MOVE SPACES TO WN0083
      *    Option Code ATR 15
           MOVE SPACES TO WN0084
      *    Option Desc ATR 15
           MOVE SPACES TO WN0085
      *    Option Code ATR 16
           MOVE SPACES TO WN0086
      *    Option Desc ATR 16
           MOVE SPACES TO WN0087
      *    Option Code ATR 17
           MOVE SPACES TO WN0088
      *    Option Desc ATR 17
           MOVE SPACES TO WN0089
      *    Option Code ATR 18
           MOVE SPACES TO WN0090
      *    Option Desc ATR 18
           MOVE SPACES TO WN0091
      *    Option Code ATR 19
           MOVE SPACES TO WN0092
      *    Option Desc ATR 19
           MOVE SPACES TO WN0093
      *    Option Code ATR 20
           MOVE SPACES TO WN0094
      *    Option Desc ATR 20
           MOVE SPACES TO WN0095
      *    Option Code ATR 21
           MOVE SPACES TO WN0096
      *    Option Desc ATR 21
           MOVE SPACES TO WN0097
      *    Option Code ATR 22
           MOVE SPACES TO WN0098
      *    Option Desc ATR 22
           MOVE SPACES TO WN0099
      *    Option Code ATR 23
           MOVE SPACES TO WN0100
      *    Option Desc ATR 23
           MOVE SPACES TO WN0101
      *    Option Code ATR 24
           MOVE SPACES TO WN0102
      *    Option Desc ATR 24
           MOVE SPACES TO WN0103
      *    Option Code ATR 25
           MOVE SPACES TO WN0104
      *    Option Desc ATR 25
           MOVE SPACES TO WN0105
      *    Option Code ATR 26
           MOVE SPACES TO WN0106
      *    Option Desc ATR 26
           MOVE SPACES TO WN0107
      *    Option Code ATR 27
           MOVE SPACES TO WN0108
      *    Option Desc ATR 27
           MOVE SPACES TO WN0109
      *    Option Code ATR 28
           MOVE SPACES TO WN0110
      *    Option Desc ATR 28
           MOVE SPACES TO WN0111
      *    Option Code ATR 29
           MOVE SPACES TO WN0112
      *    Option Desc ATR 29
           MOVE SPACES TO WN0113
      *    Option Code ATR 30
           MOVE SPACES TO WN0114
      *    Option Desc ATR 30
           MOVE SPACES TO WN0115
      *
      *    Int Drv Option String All
      *    PAR = CON By name
      *    Option Code ATR 01
           MOVE SPACES TO WN0056
      *    Option Desc ATR 01
           MOVE SPACES TO WN0057
      *    Option Code ATR 02
           MOVE SPACES TO WN0058
      *    Option Desc ATR 02
           MOVE SPACES TO WN0059
      *    Option Code ATR 03
           MOVE SPACES TO WN0060
      *    Option Desc ATR 03
           MOVE SPACES TO WN0061
      *    Option Code ATR 04
           MOVE SPACES TO WN0062
      *    Option Desc ATR 04
           MOVE SPACES TO WN0063
      *    Option Code ATR 05
           MOVE SPACES TO WN0064
      *    Option Desc ATR 05
           MOVE SPACES TO WN0065
      *    Option Code ATR 06
           MOVE SPACES TO WN0066
      *    Option Desc ATR 06
           MOVE SPACES TO WN0067
      *    Option Code ATR 07
           MOVE SPACES TO WN0068
      *    Option Desc ATR 07
           MOVE SPACES TO WN0069
      *    Option Code ATR 08
           MOVE SPACES TO WN0070
      *    Option Desc ATR 08
           MOVE SPACES TO WN0071
      *    Option Code ATR 09
           MOVE SPACES TO WN0072
      *    Option Desc ATR 09
           MOVE SPACES TO WN0073
      *    Option Code ATR 10
           MOVE SPACES TO WN0074
      *    Option Desc ATR 10
           MOVE SPACES TO WN0075
      *    Option Code ATR 11
           MOVE SPACES TO WN0076
      *    Option Desc ATR 11
           MOVE SPACES TO WN0077
      *    Option Code ATR 12
           MOVE SPACES TO WN0078
      *    Option Desc ATR 12
           MOVE SPACES TO WN0079
      *    Option Code ATR 13
           MOVE SPACES TO WN0080
      *    Option Desc ATR 13
           MOVE SPACES TO WN0081
      *    Option Code ATR 14
           MOVE SPACES TO WN0082
      *    Option Desc ATR 14
           MOVE SPACES TO WN0083
      *    Option Code ATR 15
           MOVE SPACES TO WN0084
      *    Option Desc ATR 15
           MOVE SPACES TO WN0085
      *    Option Code ATR 16
           MOVE SPACES TO WN0086
      *    Option Desc ATR 16
           MOVE SPACES TO WN0087
      *    Option Code ATR 17
           MOVE SPACES TO WN0088
      *    Option Desc ATR 17
           MOVE SPACES TO WN0089
      *    Option Code ATR 18
           MOVE SPACES TO WN0090
      *    Option Desc ATR 18
           MOVE SPACES TO WN0091
      *    Option Code ATR 19
           MOVE SPACES TO WN0092
      *    Option Desc ATR 19
           MOVE SPACES TO WN0093
      *    Option Code ATR 20
           MOVE SPACES TO WN0094
      *    Option Desc ATR 20
           MOVE SPACES TO WN0095
      *    Option Code ATR 21
           MOVE SPACES TO WN0096
      *    Option Desc ATR 21
           MOVE SPACES TO WN0097
      *    Option Code ATR 22
           MOVE SPACES TO WN0098
      *    Option Desc ATR 22
           MOVE SPACES TO WN0099
      *    Option Code ATR 23
           MOVE SPACES TO WN0100
      *    Option Desc ATR 23
           MOVE SPACES TO WN0101
      *    Option Code ATR 24
           MOVE SPACES TO WN0102
      *    Option Desc ATR 24
           MOVE SPACES TO WN0103
      *    Option Code ATR 25
           MOVE SPACES TO WN0104
      *    Option Desc ATR 25
           MOVE SPACES TO WN0105
      *    Option Code ATR 26
           MOVE SPACES TO WN0106
      *    Option Desc ATR 26
           MOVE SPACES TO WN0107
      *    Option Code ATR 27
           MOVE SPACES TO WN0108
      *    Option Desc ATR 27
           MOVE SPACES TO WN0109
      *    Option Code ATR 28
           MOVE SPACES TO WN0110
      *    Option Desc ATR 28
           MOVE SPACES TO WN0111
      *    Option Code ATR 29
           MOVE SPACES TO WN0112
      *    Option Desc ATR 29
           MOVE SPACES TO WN0113
      *    Option Code ATR 30
           MOVE SPACES TO WN0114
      *    Option Desc ATR 30
           MOVE SPACES TO WN0115
      *    U:Vehicle All Options Dsc
           MOVE SPACES TO WN0050
      *    CASE: PAR.SCP Options is NE *Blank
      *    *IF
           IF (J6OPTSCP OF FVEHDF2 OF VAVEHDTALE-R NOT = ' ') THEN
      *        Int Drv Option Desc
      *        PAR = CON By name
      *        Option Code ATR 01
               MOVE SPACES TO WN0056
      *        Option Desc ATR 01
               MOVE SPACES TO WN0057
      *        Option Code ATR 02
               MOVE SPACES TO WN0058
      *        Option Desc ATR 02
               MOVE SPACES TO WN0059
      *        Option Code ATR 03
               MOVE SPACES TO WN0060
      *        Option Desc ATR 03
               MOVE SPACES TO WN0061
      *        Option Code ATR 04
               MOVE SPACES TO WN0062
      *        Option Desc ATR 04
               MOVE SPACES TO WN0063
      *        Option Code ATR 05
               MOVE SPACES TO WN0064
      *        Option Desc ATR 05
               MOVE SPACES TO WN0065
      *        Option Code ATR 06
               MOVE SPACES TO WN0066
      *        Option Desc ATR 06
               MOVE SPACES TO WN0067
      *        Option Code ATR 07
               MOVE SPACES TO WN0068
      *        Option Desc ATR 07
               MOVE SPACES TO WN0069
      *        Option Code ATR 08
               MOVE SPACES TO WN0070
      *        Option Desc ATR 08
               MOVE SPACES TO WN0071
      *        Option Code ATR 09
               MOVE SPACES TO WN0072
      *        Option Desc ATR 09
               MOVE SPACES TO WN0073
      *        Option Code ATR 10
               MOVE SPACES TO WN0074
      *        Option Desc ATR 10
               MOVE SPACES TO WN0075
      *        Option Code ATR 11
               MOVE SPACES TO WN0076
      *        Option Desc ATR 11
               MOVE SPACES TO WN0077
      *        Option Code ATR 12
               MOVE SPACES TO WN0078
      *        Option Desc ATR 12
               MOVE SPACES TO WN0079
      *        Option Code ATR 13
               MOVE SPACES TO WN0080
      *        Option Desc ATR 13
               MOVE SPACES TO WN0081
      *        Option Code ATR 14
               MOVE SPACES TO WN0082
      *        Option Desc ATR 14
               MOVE SPACES TO WN0083
      *        Option Code ATR 15
               MOVE SPACES TO WN0084
      *        Option Desc ATR 15
               MOVE SPACES TO WN0085
      *        Option Code ATR 16
               MOVE SPACES TO WN0086
      *        Option Desc ATR 16
               MOVE SPACES TO WN0087
      *        Option Code ATR 17
               MOVE SPACES TO WN0088
      *        Option Desc ATR 17
               MOVE SPACES TO WN0089
      *        Option Code ATR 18
               MOVE SPACES TO WN0090
      *        Option Desc ATR 18
               MOVE SPACES TO WN0091
      *        Option Code ATR 19
               MOVE SPACES TO WN0092
      *        Option Desc ATR 19
               MOVE SPACES TO WN0093
      *        Option Code ATR 20
               MOVE SPACES TO WN0094
      *        Option Desc ATR 20
               MOVE SPACES TO WN0095
      *        Option Code ATR 21
               MOVE SPACES TO WN0096
      *        Option Desc ATR 21
               MOVE SPACES TO WN0097
      *        Option Code ATR 22
               MOVE SPACES TO WN0098
      *        Option Desc ATR 22
               MOVE SPACES TO WN0099
      *        Option Code ATR 23
               MOVE SPACES TO WN0100
      *        Option Desc ATR 23
               MOVE SPACES TO WN0101
      *        Option Code ATR 24
               MOVE SPACES TO WN0102
      *        Option Desc ATR 24
               MOVE SPACES TO WN0103
      *        Option Code ATR 25
               MOVE SPACES TO WN0104
      *        Option Desc ATR 25
               MOVE SPACES TO WN0105
      *        Option Code ATR 26
               MOVE SPACES TO WN0106
      *        Option Desc ATR 26
               MOVE SPACES TO WN0107
      *        Option Code ATR 27
               MOVE SPACES TO WN0108
      *        Option Desc ATR 27
               MOVE SPACES TO WN0109
      *        Option Code ATR 28
               MOVE SPACES TO WN0110
      *        Option Desc ATR 28
               MOVE SPACES TO WN0111
      *        Option Code ATR 29
               MOVE SPACES TO WN0112
      *        Option Desc ATR 29
               MOVE SPACES TO WN0113
      *        Option Code ATR 30
               MOVE SPACES TO WN0114
      *        Option Desc ATR 30
               MOVE SPACES TO WN0115
      *        U:Count (3.0)
               MOVE ZEROS TO YL0091 OF WORK-CONTEXT
      *        U:Length
               MOVE ZEROS TO YL0092 OF WORK-CONTEXT
      *        U:Length 2
               MOVE ZEROS TO YL0093 OF WORK-CONTEXT
      *        U:Position Start (NBR)
               MOVE 1 TO YL0094 OF WORK-CONTEXT
      *        CASE: PAR.SCP Options is NE *Blank
      *        *IF
               IF (J6OPTSCP OF FVEHDF2 OF VAVEHDTALE-R NOT = ' ') THEN
      *            Rtn Length of a String - #String Functions  *
     ** Function   : Return length of a string.
     ** System     : Renault Applications
     ** Programmer : Brian Etheridge
     ** Date       : 24/03/92
     **
     ** Date       : 18/02/04
     ** Programmer : H Ghaffari
     ** Description: size of index field was 2 where as the maximum
      *              search size allowed is 132!
     **.................................................................
      *.Start.of.User.source.interface..................................
      *    Initialise work fields
           MOVE SPACES TO WK-LN-INPUT-FIELD
           MOVE J6OPTSCP OF FVEHDF2 OF VAVEHDTALE-R  TO
       WK-LN-INPUT-FIELD
      *    Examine the string.
           PERFORM RTV-TEXT-LENGTH
           MOVE WK-LN-INDEX TO YL0093 OF WORK-CONTEXT
      *.End.of.User.source.interace.....................................
      *            CASE: LCL.U:Length 2 is LT 120
      *            *IF
                   IF (YL0093 OF WORK-CONTEXT < 120) THEN
      *                U:Length 2
                       ADD YL0093 OF WORK-CONTEXT, 1 GIVING YL0093 OF
                         WORK-CONTEXT
                   END-IF
      *            DO WHILE: LCL.U:Position Start (NBR) LT
      *              LCL.U:Length 2
      *            *DOW
                   PERFORM UNTIL NOT (YL0094 OF WORK-CONTEXT < YL0093
                     OF WORK-CONTEXT)
      *                Find Chr in String 120
      *                U:Position Found (NBR)
                       MOVE ZEROS TO YL0095 OF WORK-CONTEXT
      *                U:Found
                       MOVE 'N' TO YL0096 OF WORK-CONTEXT
      *                U:Continue (Y/N)
                       MOVE 'Y' TO YL0031 OF WORK-CONTEXT
      *                CASE: PAR.U:Position Start (NBR) is *LE 120
      *                *IF
                       IF (YL0094 OF WORK-CONTEXT NOT > 120) THEN
      *                    U:Text (1)
                           MOVE ' ' TO YL0032 OF WORK-CONTEXT
      *                    U:Position Start (NBR)
                           MOVE YL0094 OF WORK-CONTEXT TO YL0033 OF
                             WORK-CONTEXT
      *                    Loop Check for Character
      *                    DO WHILE: LCL.U:Continue (Y/N) is Y
      *                    *DOW
                           PERFORM UNTIL NOT (YL0031 OF WORK-CONTEXT = '
      -                     'Y')
                               MOVE 1 TO YRSW03
                               MOVE YL0033 OF WORK-CONTEXT TO YRSW02
                               IF (YRSW02 NOT > 0 OR
                                   YRSW03 NOT > 0 OR
                                   YRSW02 > 00120 OR
                                   YRSW03 > 00120) THEN
                               MOVE 'Y2U0510' TO W0RTN
                               ELSE
                               MOVE J6OPTSCP OF FVEHDF2 OF VAVEHDTALE-R
                                 TO W0STRNG
                               MOVE W0STRNG(YRSW02:YRSW03) TO YL0032 OF
                                 WORK-CONTEXT
                               END-IF
      *                        Test to See if Character Found (Or Not
      *                          Found)
      *                        CASE: PAR.U:Find Type *EQ or *NE is
      *                          *Equals
      *                        *IF
                               IF ('*EQ' = '*EQ') THEN
      *                        CASE: LCL.U:Text (1) EQ PAR.U:Character
      *                          to Find
      *                        *IF
                               IF (YL0032 OF WORK-CONTEXT = ' ') THEN
      *                        U:Continue (Y/N)
                               MOVE 'N' TO YL0031 OF WORK-CONTEXT
      *                        U:Found
                               MOVE 'Y' TO YL0096 OF WORK-CONTEXT
      *                        U:Position Found (NBR)
                               MOVE YL0033 OF WORK-CONTEXT TO YL0095 OF
                                 WORK-CONTEXT
                               END-IF
                               ELSE
      *                        CASE: PAR.U:Find Type *EQ or *NE is
      *                          *Not Equals
      *                        *IF
                               IF ('*EQ' = '*NE') THEN
      *                        CASE: LCL.U:Text (1) NE PAR.U:Character
      *                          to Find
      *                        *IF
                               IF (YL0032 OF WORK-CONTEXT NOT = ' ')
                                 THEN
      *                        U:Continue (Y/N)
                               MOVE 'N' TO YL0031 OF WORK-CONTEXT
      *                        U:Found
                               MOVE 'Y' TO YL0096 OF WORK-CONTEXT
      *                        U:Position Found (NBR)
                               MOVE YL0033 OF WORK-CONTEXT TO YL0095 OF
                                 WORK-CONTEXT
                               END-IF
                               END-IF
                               END-IF
      *                        U:Position Start (NBR)
                               ADD YL0033 OF WORK-CONTEXT, 1 GIVING
                                 YL0033 OF WORK-CONTEXT
      *                        Carry On Checking ?
      *                        CASE:
      *                        - c1 AND c2
      *                        |- c1    : LCL.U:Position Start (NBR)
      *                          is *LE 120
      *                        |- c2    : LCL.U:Continue (Y/N) is Y
      *                        '-
      *                        *IF
                               IF (YL0033 OF WORK-CONTEXT NOT > 120 AND
                                   YL0031 OF WORK-CONTEXT = 'Y') THEN
                               CONTINUE
                               ELSE
      *                        CASE: *OTHERWISE
      *                        U:Continue (Y/N)
                               MOVE 'N' TO YL0031 OF WORK-CONTEXT
                               END-IF
      *                        *ITR
                           END-PERFORM
                       END-IF
      *                If String Found then Substring it to Output
      *                  Parameter
      *                CASE:
      *                - c1 AND c2
      *                |- c1    : LCL.U:Found is Y
      *                |- c2    : LCL.U:Position Found (NBR) LE
      *                  LCL.U:Length 2
      *                '-
      *                *IF
                       IF (YL0096 OF WORK-CONTEXT = 'Y' AND
                           YL0095 OF WORK-CONTEXT NOT > YL0093 OF
                         WORK-CONTEXT) THEN
      *                    U:Count (3.0)
                           ADD YL0091 OF WORK-CONTEXT, 1 GIVING YL0091
                             OF WORK-CONTEXT
      *                    *For length
                           SUBTRACT YL0094 OF WORK-CONTEXT FROM YL0095
                             OF WORK-CONTEXT GIVING YL0097 OF
                             WORK-CONTEXT
                           MOVE YL0097 OF WORK-CONTEXT TO YRSW03
                           MOVE YL0094 OF WORK-CONTEXT TO YRSW02
                           IF (YRSW02 NOT > 0 OR
                               YRSW03 NOT > 0 OR
                               YRSW02 > 00120 OR
                               YRSW03 > 00120) THEN
                               MOVE 'Y2U0510' TO W0RTN
                           ELSE
                               MOVE J6OPTSCP OF FVEHDF2 OF VAVEHDTALE-R
                                 TO W0STRNG
                               MOVE W0STRNG(YRSW02:YRSW03) TO YL0098 OF
                                 WORK-CONTEXT
                           END-IF
      *                    Ext Rtv Veh Mdl Option - #Foreign model
      *                      access  *
                           SET C-INDICATOR-OFF(90) TO TRUE
                           MOVE W0RTN TO WQ0076
                           MOVE J6SCMDLCDE OF FVEHDF2 OF VAVEHDTALE-R
                             TO WQ0077
                           MOVE '1' TO WQ0078
                           MOVE YL0098 OF WORK-CONTEXT TO WQ0079
                           MOVE SPACES TO WQ0080
                           MOVE SPACES TO WQ0081
      *
                           CALL 'VAG008000S' USING
      *                    *Return code
                             WQ0076
      *                    SCP Model code
                             WQ0077
      *                    Option Type
                             WQ0078
      *                    SC Option code
                             WQ0079
      *                    Model option description
                             WQ0080
      *                    Vehicle Database Rec Sts
                             WQ0081
                                    ON OVERFLOW
                                    SET C-INDICATOR-ON(90) TO TRUE
                           END-CALL
      *
                           MOVE WQ0076 TO W0RTN
                           MOVE WQ0080 TO YL0099 OF WORK-CONTEXT
      *
      *                    Error on program call will terminate run unit
                           IF (C-INDICATOR-ON(90)) THEN
                               MOVE 'Y2U0032' TO W0RTN
                               MOVE 'VAG008000S' TO W0CLPG
      *                        Send message '*Error occured on CALL...'
      *                        Message ID
                               MOVE 'Y2U0032' TO ZAMSID
      *                        Message file
                               MOVE 'Y2USRMSG' TO ZAMSGF
      *                        Message data
                               MOVE W0CLPG TO ZAMSDA
                               PERFORM ZASNMS
                               SET C-INDICATOR-ON(99) TO TRUE
                           END-IF
      *                    Set the Output Code & Description Code 001
      *                      thru 015
      *                    CASE: LCL.U:Count (3.0) is *001
      *                    *IF
                           IF (YL0091 OF WORK-CONTEXT = 1) THEN
      *                        Option Code ATR 01
                               MOVE YL0098 OF WORK-CONTEXT TO WN0056
                               MOVE YL0099 OF WORK-CONTEXT TO WN0057
                           ELSE
      *                        CASE: LCL.U:Count (3.0) is *002
      *                        *IF
                               IF (YL0091 OF WORK-CONTEXT = 2) THEN
      *                        Option Code ATR 02
                               MOVE YL0098 OF WORK-CONTEXT TO WN0058
                               MOVE YL0099 OF WORK-CONTEXT TO WN0059
                               ELSE
      *                        CASE: LCL.U:Count (3.0) is *003
      *                        *IF
                               IF (YL0091 OF WORK-CONTEXT = 3) THEN
      *                        Option Code ATR 03
                               MOVE YL0098 OF WORK-CONTEXT TO WN0060
                               MOVE YL0099 OF WORK-CONTEXT TO WN0061
                               ELSE
      *                        CASE: LCL.U:Count (3.0) is *004
      *                        *IF
                               IF (YL0091 OF WORK-CONTEXT = 4) THEN
      *                        Option Code ATR 04
                               MOVE YL0098 OF WORK-CONTEXT TO WN0062
                               MOVE YL0099 OF WORK-CONTEXT TO WN0063
                               ELSE
      *                        CASE: LCL.U:Count (3.0) is *005
      *                        *IF
                               IF (YL0091 OF WORK-CONTEXT = 5) THEN
      *                        Option Code ATR 05
                               MOVE YL0098 OF WORK-CONTEXT TO WN0064
                               MOVE YL0099 OF WORK-CONTEXT TO WN0065
                               ELSE
      *                        CASE: LCL.U:Count (3.0) is *006
      *                        *IF
                               IF (YL0091 OF WORK-CONTEXT = 6) THEN
      *                        Option Code ATR 06
                               MOVE YL0098 OF WORK-CONTEXT TO WN0066
                               MOVE YL0099 OF WORK-CONTEXT TO WN0067
                               ELSE
      *                        CASE: LCL.U:Count (3.0) is *007
      *                        *IF
                               IF (YL0091 OF WORK-CONTEXT = 7) THEN
      *                        Option Code ATR 07
                               MOVE YL0098 OF WORK-CONTEXT TO WN0068
                               MOVE YL0099 OF WORK-CONTEXT TO WN0069
                               ELSE
      *                        CASE: LCL.U:Count (3.0) is *008
      *                        *IF
                               IF (YL0091 OF WORK-CONTEXT = 8) THEN
      *                        Option Code ATR 08
                               MOVE YL0098 OF WORK-CONTEXT TO WN0070
                               MOVE YL0099 OF WORK-CONTEXT TO WN0071
                               ELSE
      *                        CASE: LCL.U:Count (3.0) is *009
      *                        *IF
                               IF (YL0091 OF WORK-CONTEXT = 9) THEN
      *                        Option Code ATR 09
                               MOVE YL0098 OF WORK-CONTEXT TO WN0072
                               MOVE YL0099 OF WORK-CONTEXT TO WN0073
                               ELSE
      *                        CASE: LCL.U:Count (3.0) is *010
      *                        *IF
                               IF (YL0091 OF WORK-CONTEXT = 10) THEN
      *                        Option Code ATR 10
                               MOVE YL0098 OF WORK-CONTEXT TO WN0074
                               MOVE YL0099 OF WORK-CONTEXT TO WN0075
                               ELSE
      *                        CASE: LCL.U:Count (3.0) is *011
      *                        *IF
                               IF (YL0091 OF WORK-CONTEXT = 11) THEN
      *                        Option Code ATR 11
                               MOVE YL0098 OF WORK-CONTEXT TO WN0076
                               MOVE YL0099 OF WORK-CONTEXT TO WN0077
                               ELSE
      *                        CASE: LCL.U:Count (3.0) is *012
      *                        *IF
                               IF (YL0091 OF WORK-CONTEXT = 12) THEN
      *                        Option Code ATR 12
                               MOVE YL0098 OF WORK-CONTEXT TO WN0078
                               MOVE YL0099 OF WORK-CONTEXT TO WN0079
                               ELSE
      *                        CASE: LCL.U:Count (3.0) is *013
      *                        *IF
                               IF (YL0091 OF WORK-CONTEXT = 13) THEN
      *                        Option Code ATR 13
                               MOVE YL0098 OF WORK-CONTEXT TO WN0080
                               MOVE YL0099 OF WORK-CONTEXT TO WN0081
                               ELSE
      *                        CASE: LCL.U:Count (3.0) is *014
      *                        *IF
                               IF (YL0091 OF WORK-CONTEXT = 14) THEN
      *                        Option Code ATR 14
                               MOVE YL0098 OF WORK-CONTEXT TO WN0082
                               MOVE YL0099 OF WORK-CONTEXT TO WN0083
                               ELSE
      *                        CASE: LCL.U:Count (3.0) is *015
      *                        *IF
                               IF (YL0091 OF WORK-CONTEXT = 15) THEN
      *                        Option Code ATR 15
                               MOVE YL0098 OF WORK-CONTEXT TO WN0084
                               MOVE YL0099 OF WORK-CONTEXT TO WN0085
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                           END-IF
      *                    Set the Output Code & Description Code 016
      *                      thru 030
      *                    CASE: LCL.U:Count (3.0) is *016
      *                    *IF
                           IF (YL0091 OF WORK-CONTEXT = 16) THEN
      *                        Option Code ATR 16
                               MOVE YL0098 OF WORK-CONTEXT TO WN0086
                               MOVE YL0099 OF WORK-CONTEXT TO WN0087
                           ELSE
      *                        CASE: LCL.U:Count (3.0) is *017
      *                        *IF
                               IF (YL0091 OF WORK-CONTEXT = 17) THEN
      *                        Option Code ATR 17
                               MOVE YL0098 OF WORK-CONTEXT TO WN0088
                               MOVE YL0099 OF WORK-CONTEXT TO WN0089
                               ELSE
      *                        CASE: LCL.U:Count (3.0) is *018
      *                        *IF
                               IF (YL0091 OF WORK-CONTEXT = 18) THEN
      *                        Option Code ATR 18
                               MOVE YL0098 OF WORK-CONTEXT TO WN0090
                               MOVE YL0099 OF WORK-CONTEXT TO WN0091
                               ELSE
      *                        CASE: LCL.U:Count (3.0) is *019
      *                        *IF
                               IF (YL0091 OF WORK-CONTEXT = 19) THEN
      *                        Option Code ATR 19
                               MOVE YL0098 OF WORK-CONTEXT TO WN0092
                               MOVE YL0099 OF WORK-CONTEXT TO WN0093
                               ELSE
      *                        CASE: LCL.U:Count (3.0) is *020
      *                        *IF
                               IF (YL0091 OF WORK-CONTEXT = 20) THEN
      *                        Option Code ATR 20
                               MOVE YL0098 OF WORK-CONTEXT TO WN0094
                               MOVE YL0099 OF WORK-CONTEXT TO WN0095
                               ELSE
      *                        CASE: LCL.U:Count (3.0) is *021
      *                        *IF
                               IF (YL0091 OF WORK-CONTEXT = 21) THEN
      *                        Option Code ATR 21
                               MOVE YL0098 OF WORK-CONTEXT TO WN0096
                               MOVE YL0099 OF WORK-CONTEXT TO WN0097
                               ELSE
      *                        CASE: LCL.U:Count (3.0) is *022
      *                        *IF
                               IF (YL0091 OF WORK-CONTEXT = 22) THEN
      *                        Option Code ATR 22
                               MOVE YL0098 OF WORK-CONTEXT TO WN0098
                               MOVE YL0099 OF WORK-CONTEXT TO WN0099
                               ELSE
      *                        CASE: LCL.U:Count (3.0) is *023
      *                        *IF
                               IF (YL0091 OF WORK-CONTEXT = 23) THEN
      *                        Option Code ATR 23
                               MOVE YL0098 OF WORK-CONTEXT TO WN0100
                               MOVE YL0099 OF WORK-CONTEXT TO WN0101
                               ELSE
      *                        CASE: LCL.U:Count (3.0) is *024
      *                        *IF
                               IF (YL0091 OF WORK-CONTEXT = 24) THEN
      *                        Option Code ATR 24
                               MOVE YL0098 OF WORK-CONTEXT TO WN0102
                               MOVE YL0099 OF WORK-CONTEXT TO WN0103
                               ELSE
      *                        CASE: LCL.U:Count (3.0) is *025
      *                        *IF
                               IF (YL0091 OF WORK-CONTEXT = 25) THEN
      *                        Option Code ATR 25
                               MOVE YL0098 OF WORK-CONTEXT TO WN0104
                               MOVE YL0099 OF WORK-CONTEXT TO WN0105
                               ELSE
      *                        CASE: LCL.U:Count (3.0) is *026
      *                        *IF
                               IF (YL0091 OF WORK-CONTEXT = 26) THEN
      *                        Option Code ATR 26
                               MOVE YL0098 OF WORK-CONTEXT TO WN0106
                               MOVE YL0099 OF WORK-CONTEXT TO WN0107
                               ELSE
      *                        CASE: LCL.U:Count (3.0) is *027
      *                        *IF
                               IF (YL0091 OF WORK-CONTEXT = 27) THEN
      *                        Option Code ATR 27
                               MOVE YL0098 OF WORK-CONTEXT TO WN0108
                               MOVE YL0099 OF WORK-CONTEXT TO WN0109
                               ELSE
      *                        CASE: LCL.U:Count (3.0) is *028
      *                        *IF
                               IF (YL0091 OF WORK-CONTEXT = 28) THEN
      *                        Option Code ATR 28
                               MOVE YL0098 OF WORK-CONTEXT TO WN0110
                               MOVE YL0099 OF WORK-CONTEXT TO WN0111
                               ELSE
      *                        CASE: LCL.U:Count (3.0) is *029
      *                        *IF
                               IF (YL0091 OF WORK-CONTEXT = 29) THEN
      *                        Option Code ATR 29
                               MOVE YL0098 OF WORK-CONTEXT TO WN0112
                               MOVE YL0099 OF WORK-CONTEXT TO WN0113
                               ELSE
      *                        CASE: LCL.U:Count (3.0) is *030
      *                        *IF
                               IF (YL0091 OF WORK-CONTEXT = 30) THEN
      *                        Option Code ATR 30
                               MOVE YL0098 OF WORK-CONTEXT TO WN0114
                               MOVE YL0099 OF WORK-CONTEXT TO WN0115
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                               END-IF
                           END-IF
      *                    U:Position Start (NBR)
                           ADD YL0095 OF WORK-CONTEXT, 1 GIVING YL0094
                             OF WORK-CONTEXT
                       ELSE
      *                    CASE: *OTHERWISE
      *                    U:Position Start (NBR)
                           MOVE YL0093 OF WORK-CONTEXT TO YL0094 OF
                             WORK-CONTEXT
                       END-IF
      *                *ITR
                   END-PERFORM
               END-IF
      *        Int Chk Option String Apn
      *        Append Description to Output string :
      *        CASE: PAR.Option Desc ATR 02 is Not Blank
      *        *IF
               IF (WN0057 NOT = ' ') THEN
      *            U:Number (2.0)
                   MOVE ZEROS TO YL0100 OF WORK-CONTEXT
      *            U:Number (2.0) b
                   MOVE ZEROS TO YL0101 OF WORK-CONTEXT
      *            U:Number (2.0) c
                   MOVE ZEROS TO YL0102 OF WORK-CONTEXT
      *            U:Number (2.0) d
                   MOVE ZEROS TO YL0103 OF WORK-CONTEXT
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0057
                TALLYING YL0100 OF WORK-CONTEXT
                FOR ALL 'Admin Code'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0057
                TALLYING YL0101 OF WORK-CONTEXT
                FOR ALL 'Admin only'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0057
                TALLYING YL0102 OF WORK-CONTEXT
                FOR ALL 'Admin code'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0057
                TALLYING YL0103 OF WORK-CONTEXT
                FOR ALL 'Battery Hire'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            CASE:
      *            - c1 AND c2 AND c3 AND c4
      *            |- c1    : LCL.U:Number (2.0) is Zero
      *            |- c2    : LCL.U:Number (2.0) b is Zero
      *            |- c3    : LCL.U:Number (2.0) c is Zero
      *            |- c4    : LCL.U:Number (2.0) d is Zero
      *            '-
      *            *IF
                   IF (YL0100 OF WORK-CONTEXT = 0 AND
                       YL0101 OF WORK-CONTEXT = 0 AND
                       YL0102 OF WORK-CONTEXT = 0 AND
                       YL0103 OF WORK-CONTEXT = 0) THEN
      *                Option Desc ATR 02
                       MOVE WN0057 TO YL0104 OF WORK-CONTEXT
      *                Rtn Inspect replacing - #String Functions  *
     ***-------------------------------------------------------------**
     ***   COBOL inspect replacing statement                         **
     ***                                                             **
     ***   System  . . . . . :   Renault UK utilties                 **
     ***   User source name  :   RAUINSRPLS                          **
     ***   Author  . . . . . :   Maurice Mead                        **
     ***   Date written  . . :   14/04/2009                          **
     ***   Request . . . . . :   RN-CHG-425505                       **
     ***                                                             **
     ***   See the SYNON/2 narrative text for full details and the   **
     ***     maintenance log.                                        **
     ***-------------------------------------------------------------**
           MOVE ZEROS   TO YL0105 OF WORK-CONTEXT
           INSPECT YL0104 OF WORK-CONTEXT
             TALLYING YL0105 OF WORK-CONTEXT
             FOR ALL ','
             REPLACING ALL ','
             BY ' '
      *.Rtn.Inspect.replacing.-.End.of.user.source.....................
      *                CASE: PAR.U:Vehicle All Options Dsc is *Not Blank
      *                *IF
                       IF (WN0050 NOT = ' ') THEN
                           MOVE ZEROS TO YRSW03
                           MOVE 'T' TO YRSW05
                           IF (WN0050 = SPACES AND
                               YRSW05 = 'T') THEN
                               ADD  1 TO ZEROS GIVING YRSW04
                           ELSE
                               ADD  1 TO 03000 GIVING YRSW04
                           END-IF
                           MOVE 03000 TO YRSW02
                           MOVE WN0050 TO YRSW06
                           PERFORM ZCATWK
                           STRING YRSW06 DELIMITED BY X'FF',
                                  ',' DELIMITED BY SIZE
                           INTO   YRSW06
                           MOVE YRSW06 TO WN0050
                       END-IF
                       MOVE ZEROS TO YRSW03
                       MOVE 'T' TO YRSW05
                       IF (WN0050 = SPACES AND
                           YRSW05 = 'T') THEN
                           ADD  1 TO ZEROS GIVING YRSW04
                       ELSE
                           ADD  1 TO 03000 GIVING YRSW04
                       END-IF
                       MOVE 03000 TO YRSW02
                       MOVE WN0050 TO YRSW06
                       PERFORM ZCATWK
                       STRING YRSW06 DELIMITED BY X'FF',
                              YL0104 OF WORK-CONTEXT DELIMITED BY SIZE
                       INTO   YRSW06
                       MOVE YRSW06 TO WN0050
                   END-IF
               END-IF
      *        Int Chk Option String Apn
      *        Append Description to Output string :
      *        CASE: PAR.Option Desc ATR 02 is Not Blank
      *        *IF
               IF (WN0059 NOT = ' ') THEN
      *            U:Number (2.0)
                   MOVE ZEROS TO YL0100 OF WORK-CONTEXT
      *            U:Number (2.0) b
                   MOVE ZEROS TO YL0101 OF WORK-CONTEXT
      *            U:Number (2.0) c
                   MOVE ZEROS TO YL0102 OF WORK-CONTEXT
      *            U:Number (2.0) d
                   MOVE ZEROS TO YL0103 OF WORK-CONTEXT
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0059
                TALLYING YL0100 OF WORK-CONTEXT
                FOR ALL 'Admin Code'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0059
                TALLYING YL0101 OF WORK-CONTEXT
                FOR ALL 'Admin only'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0059
                TALLYING YL0102 OF WORK-CONTEXT
                FOR ALL 'Admin code'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0059
                TALLYING YL0103 OF WORK-CONTEXT
                FOR ALL 'Battery Hire'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            CASE:
      *            - c1 AND c2 AND c3 AND c4
      *            |- c1    : LCL.U:Number (2.0) is Zero
      *            |- c2    : LCL.U:Number (2.0) b is Zero
      *            |- c3    : LCL.U:Number (2.0) c is Zero
      *            |- c4    : LCL.U:Number (2.0) d is Zero
      *            '-
      *            *IF
                   IF (YL0100 OF WORK-CONTEXT = 0 AND
                       YL0101 OF WORK-CONTEXT = 0 AND
                       YL0102 OF WORK-CONTEXT = 0 AND
                       YL0103 OF WORK-CONTEXT = 0) THEN
      *                Option Desc ATR 02
                       MOVE WN0059 TO YL0104 OF WORK-CONTEXT
      *                Rtn Inspect replacing - #String Functions  *
     ***-------------------------------------------------------------**
     ***   COBOL inspect replacing statement                         **
     ***                                                             **
     ***   System  . . . . . :   Renault UK utilties                 **
     ***   User source name  :   RAUINSRPLS                          **
     ***   Author  . . . . . :   Maurice Mead                        **
     ***   Date written  . . :   14/04/2009                          **
     ***   Request . . . . . :   RN-CHG-425505                       **
     ***                                                             **
     ***   See the SYNON/2 narrative text for full details and the   **
     ***     maintenance log.                                        **
     ***-------------------------------------------------------------**
           MOVE ZEROS   TO YL0105 OF WORK-CONTEXT
           INSPECT YL0104 OF WORK-CONTEXT
             TALLYING YL0105 OF WORK-CONTEXT
             FOR ALL ','
             REPLACING ALL ','
             BY ' '
      *.Rtn.Inspect.replacing.-.End.of.user.source.....................
      *                CASE: PAR.U:Vehicle All Options Dsc is *Not Blank
      *                *IF
                       IF (WN0050 NOT = ' ') THEN
                           MOVE ZEROS TO YRSW03
                           MOVE 'T' TO YRSW05
                           IF (WN0050 = SPACES AND
                               YRSW05 = 'T') THEN
                               ADD  1 TO ZEROS GIVING YRSW04
                           ELSE
                               ADD  1 TO 03000 GIVING YRSW04
                           END-IF
                           MOVE 03000 TO YRSW02
                           MOVE WN0050 TO YRSW06
                           PERFORM ZCATWK
                           STRING YRSW06 DELIMITED BY X'FF',
                                  ',' DELIMITED BY SIZE
                           INTO   YRSW06
                           MOVE YRSW06 TO WN0050
                       END-IF
                       MOVE ZEROS TO YRSW03
                       MOVE 'T' TO YRSW05
                       IF (WN0050 = SPACES AND
                           YRSW05 = 'T') THEN
                           ADD  1 TO ZEROS GIVING YRSW04
                       ELSE
                           ADD  1 TO 03000 GIVING YRSW04
                       END-IF
                       MOVE 03000 TO YRSW02
                       MOVE WN0050 TO YRSW06
                       PERFORM ZCATWK
                       STRING YRSW06 DELIMITED BY X'FF',
                              YL0104 OF WORK-CONTEXT DELIMITED BY SIZE
                       INTO   YRSW06
                       MOVE YRSW06 TO WN0050
                   END-IF
               END-IF
      *        Int Chk Option String Apn
      *        Append Description to Output string :
      *        CASE: PAR.Option Desc ATR 02 is Not Blank
      *        *IF
               IF (WN0061 NOT = ' ') THEN
      *            U:Number (2.0)
                   MOVE ZEROS TO YL0100 OF WORK-CONTEXT
      *            U:Number (2.0) b
                   MOVE ZEROS TO YL0101 OF WORK-CONTEXT
      *            U:Number (2.0) c
                   MOVE ZEROS TO YL0102 OF WORK-CONTEXT
      *            U:Number (2.0) d
                   MOVE ZEROS TO YL0103 OF WORK-CONTEXT
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0061
                TALLYING YL0100 OF WORK-CONTEXT
                FOR ALL 'Admin Code'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0061
                TALLYING YL0101 OF WORK-CONTEXT
                FOR ALL 'Admin only'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0061
                TALLYING YL0102 OF WORK-CONTEXT
                FOR ALL 'Admin code'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0061
                TALLYING YL0103 OF WORK-CONTEXT
                FOR ALL 'Battery Hire'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            CASE:
      *            - c1 AND c2 AND c3 AND c4
      *            |- c1    : LCL.U:Number (2.0) is Zero
      *            |- c2    : LCL.U:Number (2.0) b is Zero
      *            |- c3    : LCL.U:Number (2.0) c is Zero
      *            |- c4    : LCL.U:Number (2.0) d is Zero
      *            '-
      *            *IF
                   IF (YL0100 OF WORK-CONTEXT = 0 AND
                       YL0101 OF WORK-CONTEXT = 0 AND
                       YL0102 OF WORK-CONTEXT = 0 AND
                       YL0103 OF WORK-CONTEXT = 0) THEN
      *                Option Desc ATR 02
                       MOVE WN0061 TO YL0104 OF WORK-CONTEXT
      *                Rtn Inspect replacing - #String Functions  *
     ***-------------------------------------------------------------**
     ***   COBOL inspect replacing statement                         **
     ***                                                             **
     ***   System  . . . . . :   Renault UK utilties                 **
     ***   User source name  :   RAUINSRPLS                          **
     ***   Author  . . . . . :   Maurice Mead                        **
     ***   Date written  . . :   14/04/2009                          **
     ***   Request . . . . . :   RN-CHG-425505                       **
     ***                                                             **
     ***   See the SYNON/2 narrative text for full details and the   **
     ***     maintenance log.                                        **
     ***-------------------------------------------------------------**
           MOVE ZEROS   TO YL0105 OF WORK-CONTEXT
           INSPECT YL0104 OF WORK-CONTEXT
             TALLYING YL0105 OF WORK-CONTEXT
             FOR ALL ','
             REPLACING ALL ','
             BY ' '
      *.Rtn.Inspect.replacing.-.End.of.user.source.....................
      *                CASE: PAR.U:Vehicle All Options Dsc is *Not Blank
      *                *IF
                       IF (WN0050 NOT = ' ') THEN
                           MOVE ZEROS TO YRSW03
                           MOVE 'T' TO YRSW05
                           IF (WN0050 = SPACES AND
                               YRSW05 = 'T') THEN
                               ADD  1 TO ZEROS GIVING YRSW04
                           ELSE
                               ADD  1 TO 03000 GIVING YRSW04
                           END-IF
                           MOVE 03000 TO YRSW02
                           MOVE WN0050 TO YRSW06
                           PERFORM ZCATWK
                           STRING YRSW06 DELIMITED BY X'FF',
                                  ',' DELIMITED BY SIZE
                           INTO   YRSW06
                           MOVE YRSW06 TO WN0050
                       END-IF
                       MOVE ZEROS TO YRSW03
                       MOVE 'T' TO YRSW05
                       IF (WN0050 = SPACES AND
                           YRSW05 = 'T') THEN
                           ADD  1 TO ZEROS GIVING YRSW04
                       ELSE
                           ADD  1 TO 03000 GIVING YRSW04
                       END-IF
                       MOVE 03000 TO YRSW02
                       MOVE WN0050 TO YRSW06
                       PERFORM ZCATWK
                       STRING YRSW06 DELIMITED BY X'FF',
                              YL0104 OF WORK-CONTEXT DELIMITED BY SIZE
                       INTO   YRSW06
                       MOVE YRSW06 TO WN0050
                   END-IF
               END-IF
      *        Int Chk Option String Apn
      *        Append Description to Output string :
      *        CASE: PAR.Option Desc ATR 02 is Not Blank
      *        *IF
               IF (WN0063 NOT = ' ') THEN
      *            U:Number (2.0)
                   MOVE ZEROS TO YL0100 OF WORK-CONTEXT
      *            U:Number (2.0) b
                   MOVE ZEROS TO YL0101 OF WORK-CONTEXT
      *            U:Number (2.0) c
                   MOVE ZEROS TO YL0102 OF WORK-CONTEXT
      *            U:Number (2.0) d
                   MOVE ZEROS TO YL0103 OF WORK-CONTEXT
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0063
                TALLYING YL0100 OF WORK-CONTEXT
                FOR ALL 'Admin Code'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0063
                TALLYING YL0101 OF WORK-CONTEXT
                FOR ALL 'Admin only'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0063
                TALLYING YL0102 OF WORK-CONTEXT
                FOR ALL 'Admin code'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0063
                TALLYING YL0103 OF WORK-CONTEXT
                FOR ALL 'Battery Hire'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            CASE:
      *            - c1 AND c2 AND c3 AND c4
      *            |- c1    : LCL.U:Number (2.0) is Zero
      *            |- c2    : LCL.U:Number (2.0) b is Zero
      *            |- c3    : LCL.U:Number (2.0) c is Zero
      *            |- c4    : LCL.U:Number (2.0) d is Zero
      *            '-
      *            *IF
                   IF (YL0100 OF WORK-CONTEXT = 0 AND
                       YL0101 OF WORK-CONTEXT = 0 AND
                       YL0102 OF WORK-CONTEXT = 0 AND
                       YL0103 OF WORK-CONTEXT = 0) THEN
      *                Option Desc ATR 02
                       MOVE WN0063 TO YL0104 OF WORK-CONTEXT
      *                Rtn Inspect replacing - #String Functions  *
     ***-------------------------------------------------------------**
     ***   COBOL inspect replacing statement                         **
     ***                                                             **
     ***   System  . . . . . :   Renault UK utilties                 **
     ***   User source name  :   RAUINSRPLS                          **
     ***   Author  . . . . . :   Maurice Mead                        **
     ***   Date written  . . :   14/04/2009                          **
     ***   Request . . . . . :   RN-CHG-425505                       **
     ***                                                             **
     ***   See the SYNON/2 narrative text for full details and the   **
     ***     maintenance log.                                        **
     ***-------------------------------------------------------------**
           MOVE ZEROS   TO YL0105 OF WORK-CONTEXT
           INSPECT YL0104 OF WORK-CONTEXT
             TALLYING YL0105 OF WORK-CONTEXT
             FOR ALL ','
             REPLACING ALL ','
             BY ' '
      *.Rtn.Inspect.replacing.-.End.of.user.source.....................
      *                CASE: PAR.U:Vehicle All Options Dsc is *Not Blank
      *                *IF
                       IF (WN0050 NOT = ' ') THEN
                           MOVE ZEROS TO YRSW03
                           MOVE 'T' TO YRSW05
                           IF (WN0050 = SPACES AND
                               YRSW05 = 'T') THEN
                               ADD  1 TO ZEROS GIVING YRSW04
                           ELSE
                               ADD  1 TO 03000 GIVING YRSW04
                           END-IF
                           MOVE 03000 TO YRSW02
                           MOVE WN0050 TO YRSW06
                           PERFORM ZCATWK
                           STRING YRSW06 DELIMITED BY X'FF',
                                  ',' DELIMITED BY SIZE
                           INTO   YRSW06
                           MOVE YRSW06 TO WN0050
                       END-IF
                       MOVE ZEROS TO YRSW03
                       MOVE 'T' TO YRSW05
                       IF (WN0050 = SPACES AND
                           YRSW05 = 'T') THEN
                           ADD  1 TO ZEROS GIVING YRSW04
                       ELSE
                           ADD  1 TO 03000 GIVING YRSW04
                       END-IF
                       MOVE 03000 TO YRSW02
                       MOVE WN0050 TO YRSW06
                       PERFORM ZCATWK
                       STRING YRSW06 DELIMITED BY X'FF',
                              YL0104 OF WORK-CONTEXT DELIMITED BY SIZE
                       INTO   YRSW06
                       MOVE YRSW06 TO WN0050
                   END-IF
               END-IF
      *        Int Chk Option String Apn
      *        Append Description to Output string :
      *        CASE: PAR.Option Desc ATR 02 is Not Blank
      *        *IF
               IF (WN0065 NOT = ' ') THEN
      *            U:Number (2.0)
                   MOVE ZEROS TO YL0100 OF WORK-CONTEXT
      *            U:Number (2.0) b
                   MOVE ZEROS TO YL0101 OF WORK-CONTEXT
      *            U:Number (2.0) c
                   MOVE ZEROS TO YL0102 OF WORK-CONTEXT
      *            U:Number (2.0) d
                   MOVE ZEROS TO YL0103 OF WORK-CONTEXT
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0065
                TALLYING YL0100 OF WORK-CONTEXT
                FOR ALL 'Admin Code'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0065
                TALLYING YL0101 OF WORK-CONTEXT
                FOR ALL 'Admin only'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0065
                TALLYING YL0102 OF WORK-CONTEXT
                FOR ALL 'Admin code'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0065
                TALLYING YL0103 OF WORK-CONTEXT
                FOR ALL 'Battery Hire'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            CASE:
      *            - c1 AND c2 AND c3 AND c4
      *            |- c1    : LCL.U:Number (2.0) is Zero
      *            |- c2    : LCL.U:Number (2.0) b is Zero
      *            |- c3    : LCL.U:Number (2.0) c is Zero
      *            |- c4    : LCL.U:Number (2.0) d is Zero
      *            '-
      *            *IF
                   IF (YL0100 OF WORK-CONTEXT = 0 AND
                       YL0101 OF WORK-CONTEXT = 0 AND
                       YL0102 OF WORK-CONTEXT = 0 AND
                       YL0103 OF WORK-CONTEXT = 0) THEN
      *                Option Desc ATR 02
                       MOVE WN0065 TO YL0104 OF WORK-CONTEXT
      *                Rtn Inspect replacing - #String Functions  *
     ***-------------------------------------------------------------**
     ***   COBOL inspect replacing statement                         **
     ***                                                             **
     ***   System  . . . . . :   Renault UK utilties                 **
     ***   User source name  :   RAUINSRPLS                          **
     ***   Author  . . . . . :   Maurice Mead                        **
     ***   Date written  . . :   14/04/2009                          **
     ***   Request . . . . . :   RN-CHG-425505                       **
     ***                                                             **
     ***   See the SYNON/2 narrative text for full details and the   **
     ***     maintenance log.                                        **
     ***-------------------------------------------------------------**
           MOVE ZEROS   TO YL0105 OF WORK-CONTEXT
           INSPECT YL0104 OF WORK-CONTEXT
             TALLYING YL0105 OF WORK-CONTEXT
             FOR ALL ','
             REPLACING ALL ','
             BY ' '
      *.Rtn.Inspect.replacing.-.End.of.user.source.....................
      *                CASE: PAR.U:Vehicle All Options Dsc is *Not Blank
      *                *IF
                       IF (WN0050 NOT = ' ') THEN
                           MOVE ZEROS TO YRSW03
                           MOVE 'T' TO YRSW05
                           IF (WN0050 = SPACES AND
                               YRSW05 = 'T') THEN
                               ADD  1 TO ZEROS GIVING YRSW04
                           ELSE
                               ADD  1 TO 03000 GIVING YRSW04
                           END-IF
                           MOVE 03000 TO YRSW02
                           MOVE WN0050 TO YRSW06
                           PERFORM ZCATWK
                           STRING YRSW06 DELIMITED BY X'FF',
                                  ',' DELIMITED BY SIZE
                           INTO   YRSW06
                           MOVE YRSW06 TO WN0050
                       END-IF
                       MOVE ZEROS TO YRSW03
                       MOVE 'T' TO YRSW05
                       IF (WN0050 = SPACES AND
                           YRSW05 = 'T') THEN
                           ADD  1 TO ZEROS GIVING YRSW04
                       ELSE
                           ADD  1 TO 03000 GIVING YRSW04
                       END-IF
                       MOVE 03000 TO YRSW02
                       MOVE WN0050 TO YRSW06
                       PERFORM ZCATWK
                       STRING YRSW06 DELIMITED BY X'FF',
                              YL0104 OF WORK-CONTEXT DELIMITED BY SIZE
                       INTO   YRSW06
                       MOVE YRSW06 TO WN0050
                   END-IF
               END-IF
      *        Int Chk Option String Apn
      *        Append Description to Output string :
      *        CASE: PAR.Option Desc ATR 02 is Not Blank
      *        *IF
               IF (WN0067 NOT = ' ') THEN
      *            U:Number (2.0)
                   MOVE ZEROS TO YL0100 OF WORK-CONTEXT
      *            U:Number (2.0) b
                   MOVE ZEROS TO YL0101 OF WORK-CONTEXT
      *            U:Number (2.0) c
                   MOVE ZEROS TO YL0102 OF WORK-CONTEXT
      *            U:Number (2.0) d
                   MOVE ZEROS TO YL0103 OF WORK-CONTEXT
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0067
                TALLYING YL0100 OF WORK-CONTEXT
                FOR ALL 'Admin Code'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0067
                TALLYING YL0101 OF WORK-CONTEXT
                FOR ALL 'Admin only'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0067
                TALLYING YL0102 OF WORK-CONTEXT
                FOR ALL 'Admin code'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0067
                TALLYING YL0103 OF WORK-CONTEXT
                FOR ALL 'Battery Hire'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            CASE:
      *            - c1 AND c2 AND c3 AND c4
      *            |- c1    : LCL.U:Number (2.0) is Zero
      *            |- c2    : LCL.U:Number (2.0) b is Zero
      *            |- c3    : LCL.U:Number (2.0) c is Zero
      *            |- c4    : LCL.U:Number (2.0) d is Zero
      *            '-
      *            *IF
                   IF (YL0100 OF WORK-CONTEXT = 0 AND
                       YL0101 OF WORK-CONTEXT = 0 AND
                       YL0102 OF WORK-CONTEXT = 0 AND
                       YL0103 OF WORK-CONTEXT = 0) THEN
      *                Option Desc ATR 02
                       MOVE WN0067 TO YL0104 OF WORK-CONTEXT
      *                Rtn Inspect replacing - #String Functions  *
     ***-------------------------------------------------------------**
     ***   COBOL inspect replacing statement                         **
     ***                                                             **
     ***   System  . . . . . :   Renault UK utilties                 **
     ***   User source name  :   RAUINSRPLS                          **
     ***   Author  . . . . . :   Maurice Mead                        **
     ***   Date written  . . :   14/04/2009                          **
     ***   Request . . . . . :   RN-CHG-425505                       **
     ***                                                             **
     ***   See the SYNON/2 narrative text for full details and the   **
     ***     maintenance log.                                        **
     ***-------------------------------------------------------------**
           MOVE ZEROS   TO YL0105 OF WORK-CONTEXT
           INSPECT YL0104 OF WORK-CONTEXT
             TALLYING YL0105 OF WORK-CONTEXT
             FOR ALL ','
             REPLACING ALL ','
             BY ' '
      *.Rtn.Inspect.replacing.-.End.of.user.source.....................
      *                CASE: PAR.U:Vehicle All Options Dsc is *Not Blank
      *                *IF
                       IF (WN0050 NOT = ' ') THEN
                           MOVE ZEROS TO YRSW03
                           MOVE 'T' TO YRSW05
                           IF (WN0050 = SPACES AND
                               YRSW05 = 'T') THEN
                               ADD  1 TO ZEROS GIVING YRSW04
                           ELSE
                               ADD  1 TO 03000 GIVING YRSW04
                           END-IF
                           MOVE 03000 TO YRSW02
                           MOVE WN0050 TO YRSW06
                           PERFORM ZCATWK
                           STRING YRSW06 DELIMITED BY X'FF',
                                  ',' DELIMITED BY SIZE
                           INTO   YRSW06
                           MOVE YRSW06 TO WN0050
                       END-IF
                       MOVE ZEROS TO YRSW03
                       MOVE 'T' TO YRSW05
                       IF (WN0050 = SPACES AND
                           YRSW05 = 'T') THEN
                           ADD  1 TO ZEROS GIVING YRSW04
                       ELSE
                           ADD  1 TO 03000 GIVING YRSW04
                       END-IF
                       MOVE 03000 TO YRSW02
                       MOVE WN0050 TO YRSW06
                       PERFORM ZCATWK
                       STRING YRSW06 DELIMITED BY X'FF',
                              YL0104 OF WORK-CONTEXT DELIMITED BY SIZE
                       INTO   YRSW06
                       MOVE YRSW06 TO WN0050
                   END-IF
               END-IF
      *        Int Chk Option String Apn
      *        Append Description to Output string :
      *        CASE: PAR.Option Desc ATR 02 is Not Blank
      *        *IF
               IF (WN0069 NOT = ' ') THEN
      *            U:Number (2.0)
                   MOVE ZEROS TO YL0100 OF WORK-CONTEXT
      *            U:Number (2.0) b
                   MOVE ZEROS TO YL0101 OF WORK-CONTEXT
      *            U:Number (2.0) c
                   MOVE ZEROS TO YL0102 OF WORK-CONTEXT
      *            U:Number (2.0) d
                   MOVE ZEROS TO YL0103 OF WORK-CONTEXT
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0069
                TALLYING YL0100 OF WORK-CONTEXT
                FOR ALL 'Admin Code'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0069
                TALLYING YL0101 OF WORK-CONTEXT
                FOR ALL 'Admin only'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0069
                TALLYING YL0102 OF WORK-CONTEXT
                FOR ALL 'Admin code'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0069
                TALLYING YL0103 OF WORK-CONTEXT
                FOR ALL 'Battery Hire'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            CASE:
      *            - c1 AND c2 AND c3 AND c4
      *            |- c1    : LCL.U:Number (2.0) is Zero
      *            |- c2    : LCL.U:Number (2.0) b is Zero
      *            |- c3    : LCL.U:Number (2.0) c is Zero
      *            |- c4    : LCL.U:Number (2.0) d is Zero
      *            '-
      *            *IF
                   IF (YL0100 OF WORK-CONTEXT = 0 AND
                       YL0101 OF WORK-CONTEXT = 0 AND
                       YL0102 OF WORK-CONTEXT = 0 AND
                       YL0103 OF WORK-CONTEXT = 0) THEN
      *                Option Desc ATR 02
                       MOVE WN0069 TO YL0104 OF WORK-CONTEXT
      *                Rtn Inspect replacing - #String Functions  *
     ***-------------------------------------------------------------**
     ***   COBOL inspect replacing statement                         **
     ***                                                             **
     ***   System  . . . . . :   Renault UK utilties                 **
     ***   User source name  :   RAUINSRPLS                          **
     ***   Author  . . . . . :   Maurice Mead                        **
     ***   Date written  . . :   14/04/2009                          **
     ***   Request . . . . . :   RN-CHG-425505                       **
     ***                                                             **
     ***   See the SYNON/2 narrative text for full details and the   **
     ***     maintenance log.                                        **
     ***-------------------------------------------------------------**
           MOVE ZEROS   TO YL0105 OF WORK-CONTEXT
           INSPECT YL0104 OF WORK-CONTEXT
             TALLYING YL0105 OF WORK-CONTEXT
             FOR ALL ','
             REPLACING ALL ','
             BY ' '
      *.Rtn.Inspect.replacing.-.End.of.user.source.....................
      *                CASE: PAR.U:Vehicle All Options Dsc is *Not Blank
      *                *IF
                       IF (WN0050 NOT = ' ') THEN
                           MOVE ZEROS TO YRSW03
                           MOVE 'T' TO YRSW05
                           IF (WN0050 = SPACES AND
                               YRSW05 = 'T') THEN
                               ADD  1 TO ZEROS GIVING YRSW04
                           ELSE
                               ADD  1 TO 03000 GIVING YRSW04
                           END-IF
                           MOVE 03000 TO YRSW02
                           MOVE WN0050 TO YRSW06
                           PERFORM ZCATWK
                           STRING YRSW06 DELIMITED BY X'FF',
                                  ',' DELIMITED BY SIZE
                           INTO   YRSW06
                           MOVE YRSW06 TO WN0050
                       END-IF
                       MOVE ZEROS TO YRSW03
                       MOVE 'T' TO YRSW05
                       IF (WN0050 = SPACES AND
                           YRSW05 = 'T') THEN
                           ADD  1 TO ZEROS GIVING YRSW04
                       ELSE
                           ADD  1 TO 03000 GIVING YRSW04
                       END-IF
                       MOVE 03000 TO YRSW02
                       MOVE WN0050 TO YRSW06
                       PERFORM ZCATWK
                       STRING YRSW06 DELIMITED BY X'FF',
                              YL0104 OF WORK-CONTEXT DELIMITED BY SIZE
                       INTO   YRSW06
                       MOVE YRSW06 TO WN0050
                   END-IF
               END-IF
      *        Int Chk Option String Apn
      *        Append Description to Output string :
      *        CASE: PAR.Option Desc ATR 02 is Not Blank
      *        *IF
               IF (WN0071 NOT = ' ') THEN
      *            U:Number (2.0)
                   MOVE ZEROS TO YL0100 OF WORK-CONTEXT
      *            U:Number (2.0) b
                   MOVE ZEROS TO YL0101 OF WORK-CONTEXT
      *            U:Number (2.0) c
                   MOVE ZEROS TO YL0102 OF WORK-CONTEXT
      *            U:Number (2.0) d
                   MOVE ZEROS TO YL0103 OF WORK-CONTEXT
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0071
                TALLYING YL0100 OF WORK-CONTEXT
                FOR ALL 'Admin Code'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0071
                TALLYING YL0101 OF WORK-CONTEXT
                FOR ALL 'Admin only'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0071
                TALLYING YL0102 OF WORK-CONTEXT
                FOR ALL 'Admin code'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0071
                TALLYING YL0103 OF WORK-CONTEXT
                FOR ALL 'Battery Hire'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            CASE:
      *            - c1 AND c2 AND c3 AND c4
      *            |- c1    : LCL.U:Number (2.0) is Zero
      *            |- c2    : LCL.U:Number (2.0) b is Zero
      *            |- c3    : LCL.U:Number (2.0) c is Zero
      *            |- c4    : LCL.U:Number (2.0) d is Zero
      *            '-
      *            *IF
                   IF (YL0100 OF WORK-CONTEXT = 0 AND
                       YL0101 OF WORK-CONTEXT = 0 AND
                       YL0102 OF WORK-CONTEXT = 0 AND
                       YL0103 OF WORK-CONTEXT = 0) THEN
      *                Option Desc ATR 02
                       MOVE WN0071 TO YL0104 OF WORK-CONTEXT
      *                Rtn Inspect replacing - #String Functions  *
     ***-------------------------------------------------------------**
     ***   COBOL inspect replacing statement                         **
     ***                                                             **
     ***   System  . . . . . :   Renault UK utilties                 **
     ***   User source name  :   RAUINSRPLS                          **
     ***   Author  . . . . . :   Maurice Mead                        **
     ***   Date written  . . :   14/04/2009                          **
     ***   Request . . . . . :   RN-CHG-425505                       **
     ***                                                             **
     ***   See the SYNON/2 narrative text for full details and the   **
     ***     maintenance log.                                        **
     ***-------------------------------------------------------------**
           MOVE ZEROS   TO YL0105 OF WORK-CONTEXT
           INSPECT YL0104 OF WORK-CONTEXT
             TALLYING YL0105 OF WORK-CONTEXT
             FOR ALL ','
             REPLACING ALL ','
             BY ' '
      *.Rtn.Inspect.replacing.-.End.of.user.source.....................
      *                CASE: PAR.U:Vehicle All Options Dsc is *Not Blank
      *                *IF
                       IF (WN0050 NOT = ' ') THEN
                           MOVE ZEROS TO YRSW03
                           MOVE 'T' TO YRSW05
                           IF (WN0050 = SPACES AND
                               YRSW05 = 'T') THEN
                               ADD  1 TO ZEROS GIVING YRSW04
                           ELSE
                               ADD  1 TO 03000 GIVING YRSW04
                           END-IF
                           MOVE 03000 TO YRSW02
                           MOVE WN0050 TO YRSW06
                           PERFORM ZCATWK
                           STRING YRSW06 DELIMITED BY X'FF',
                                  ',' DELIMITED BY SIZE
                           INTO   YRSW06
                           MOVE YRSW06 TO WN0050
                       END-IF
                       MOVE ZEROS TO YRSW03
                       MOVE 'T' TO YRSW05
                       IF (WN0050 = SPACES AND
                           YRSW05 = 'T') THEN
                           ADD  1 TO ZEROS GIVING YRSW04
                       ELSE
                           ADD  1 TO 03000 GIVING YRSW04
                       END-IF
                       MOVE 03000 TO YRSW02
                       MOVE WN0050 TO YRSW06
                       PERFORM ZCATWK
                       STRING YRSW06 DELIMITED BY X'FF',
                              YL0104 OF WORK-CONTEXT DELIMITED BY SIZE
                       INTO   YRSW06
                       MOVE YRSW06 TO WN0050
                   END-IF
               END-IF
      *        Int Chk Option String Apn
      *        Append Description to Output string :
      *        CASE: PAR.Option Desc ATR 02 is Not Blank
      *        *IF
               IF (WN0073 NOT = ' ') THEN
      *            U:Number (2.0)
                   MOVE ZEROS TO YL0100 OF WORK-CONTEXT
      *            U:Number (2.0) b
                   MOVE ZEROS TO YL0101 OF WORK-CONTEXT
      *            U:Number (2.0) c
                   MOVE ZEROS TO YL0102 OF WORK-CONTEXT
      *            U:Number (2.0) d
                   MOVE ZEROS TO YL0103 OF WORK-CONTEXT
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0073
                TALLYING YL0100 OF WORK-CONTEXT
                FOR ALL 'Admin Code'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0073
                TALLYING YL0101 OF WORK-CONTEXT
                FOR ALL 'Admin only'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0073
                TALLYING YL0102 OF WORK-CONTEXT
                FOR ALL 'Admin code'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0073
                TALLYING YL0103 OF WORK-CONTEXT
                FOR ALL 'Battery Hire'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            CASE:
      *            - c1 AND c2 AND c3 AND c4
      *            |- c1    : LCL.U:Number (2.0) is Zero
      *            |- c2    : LCL.U:Number (2.0) b is Zero
      *            |- c3    : LCL.U:Number (2.0) c is Zero
      *            |- c4    : LCL.U:Number (2.0) d is Zero
      *            '-
      *            *IF
                   IF (YL0100 OF WORK-CONTEXT = 0 AND
                       YL0101 OF WORK-CONTEXT = 0 AND
                       YL0102 OF WORK-CONTEXT = 0 AND
                       YL0103 OF WORK-CONTEXT = 0) THEN
      *                Option Desc ATR 02
                       MOVE WN0073 TO YL0104 OF WORK-CONTEXT
      *                Rtn Inspect replacing - #String Functions  *
     ***-------------------------------------------------------------**
     ***   COBOL inspect replacing statement                         **
     ***                                                             **
     ***   System  . . . . . :   Renault UK utilties                 **
     ***   User source name  :   RAUINSRPLS                          **
     ***   Author  . . . . . :   Maurice Mead                        **
     ***   Date written  . . :   14/04/2009                          **
     ***   Request . . . . . :   RN-CHG-425505                       **
     ***                                                             **
     ***   See the SYNON/2 narrative text for full details and the   **
     ***     maintenance log.                                        **
     ***-------------------------------------------------------------**
           MOVE ZEROS   TO YL0105 OF WORK-CONTEXT
           INSPECT YL0104 OF WORK-CONTEXT
             TALLYING YL0105 OF WORK-CONTEXT
             FOR ALL ','
             REPLACING ALL ','
             BY ' '
      *.Rtn.Inspect.replacing.-.End.of.user.source.....................
      *                CASE: PAR.U:Vehicle All Options Dsc is *Not Blank
      *                *IF
                       IF (WN0050 NOT = ' ') THEN
                           MOVE ZEROS TO YRSW03
                           MOVE 'T' TO YRSW05
                           IF (WN0050 = SPACES AND
                               YRSW05 = 'T') THEN
                               ADD  1 TO ZEROS GIVING YRSW04
                           ELSE
                               ADD  1 TO 03000 GIVING YRSW04
                           END-IF
                           MOVE 03000 TO YRSW02
                           MOVE WN0050 TO YRSW06
                           PERFORM ZCATWK
                           STRING YRSW06 DELIMITED BY X'FF',
                                  ',' DELIMITED BY SIZE
                           INTO   YRSW06
                           MOVE YRSW06 TO WN0050
                       END-IF
                       MOVE ZEROS TO YRSW03
                       MOVE 'T' TO YRSW05
                       IF (WN0050 = SPACES AND
                           YRSW05 = 'T') THEN
                           ADD  1 TO ZEROS GIVING YRSW04
                       ELSE
                           ADD  1 TO 03000 GIVING YRSW04
                       END-IF
                       MOVE 03000 TO YRSW02
                       MOVE WN0050 TO YRSW06
                       PERFORM ZCATWK
                       STRING YRSW06 DELIMITED BY X'FF',
                              YL0104 OF WORK-CONTEXT DELIMITED BY SIZE
                       INTO   YRSW06
                       MOVE YRSW06 TO WN0050
                   END-IF
               END-IF
      *        Int Chk Option String Apn
      *        Append Description to Output string :
      *        CASE: PAR.Option Desc ATR 02 is Not Blank
      *        *IF
               IF (WN0075 NOT = ' ') THEN
      *            U:Number (2.0)
                   MOVE ZEROS TO YL0100 OF WORK-CONTEXT
      *            U:Number (2.0) b
                   MOVE ZEROS TO YL0101 OF WORK-CONTEXT
      *            U:Number (2.0) c
                   MOVE ZEROS TO YL0102 OF WORK-CONTEXT
      *            U:Number (2.0) d
                   MOVE ZEROS TO YL0103 OF WORK-CONTEXT
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0075
                TALLYING YL0100 OF WORK-CONTEXT
                FOR ALL 'Admin Code'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0075
                TALLYING YL0101 OF WORK-CONTEXT
                FOR ALL 'Admin only'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0075
                TALLYING YL0102 OF WORK-CONTEXT
                FOR ALL 'Admin code'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0075
                TALLYING YL0103 OF WORK-CONTEXT
                FOR ALL 'Battery Hire'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            CASE:
      *            - c1 AND c2 AND c3 AND c4
      *            |- c1    : LCL.U:Number (2.0) is Zero
      *            |- c2    : LCL.U:Number (2.0) b is Zero
      *            |- c3    : LCL.U:Number (2.0) c is Zero
      *            |- c4    : LCL.U:Number (2.0) d is Zero
      *            '-
      *            *IF
                   IF (YL0100 OF WORK-CONTEXT = 0 AND
                       YL0101 OF WORK-CONTEXT = 0 AND
                       YL0102 OF WORK-CONTEXT = 0 AND
                       YL0103 OF WORK-CONTEXT = 0) THEN
      *                Option Desc ATR 02
                       MOVE WN0075 TO YL0104 OF WORK-CONTEXT
      *                Rtn Inspect replacing - #String Functions  *
     ***-------------------------------------------------------------**
     ***   COBOL inspect replacing statement                         **
     ***                                                             **
     ***   System  . . . . . :   Renault UK utilties                 **
     ***   User source name  :   RAUINSRPLS                          **
     ***   Author  . . . . . :   Maurice Mead                        **
     ***   Date written  . . :   14/04/2009                          **
     ***   Request . . . . . :   RN-CHG-425505                       **
     ***                                                             **
     ***   See the SYNON/2 narrative text for full details and the   **
     ***     maintenance log.                                        **
     ***-------------------------------------------------------------**
           MOVE ZEROS   TO YL0105 OF WORK-CONTEXT
           INSPECT YL0104 OF WORK-CONTEXT
             TALLYING YL0105 OF WORK-CONTEXT
             FOR ALL ','
             REPLACING ALL ','
             BY ' '
      *.Rtn.Inspect.replacing.-.End.of.user.source.....................
      *                CASE: PAR.U:Vehicle All Options Dsc is *Not Blank
      *                *IF
                       IF (WN0050 NOT = ' ') THEN
                           MOVE ZEROS TO YRSW03
                           MOVE 'T' TO YRSW05
                           IF (WN0050 = SPACES AND
                               YRSW05 = 'T') THEN
                               ADD  1 TO ZEROS GIVING YRSW04
                           ELSE
                               ADD  1 TO 03000 GIVING YRSW04
                           END-IF
                           MOVE 03000 TO YRSW02
                           MOVE WN0050 TO YRSW06
                           PERFORM ZCATWK
                           STRING YRSW06 DELIMITED BY X'FF',
                                  ',' DELIMITED BY SIZE
                           INTO   YRSW06
                           MOVE YRSW06 TO WN0050
                       END-IF
                       MOVE ZEROS TO YRSW03
                       MOVE 'T' TO YRSW05
                       IF (WN0050 = SPACES AND
                           YRSW05 = 'T') THEN
                           ADD  1 TO ZEROS GIVING YRSW04
                       ELSE
                           ADD  1 TO 03000 GIVING YRSW04
                       END-IF
                       MOVE 03000 TO YRSW02
                       MOVE WN0050 TO YRSW06
                       PERFORM ZCATWK
                       STRING YRSW06 DELIMITED BY X'FF',
                              YL0104 OF WORK-CONTEXT DELIMITED BY SIZE
                       INTO   YRSW06
                       MOVE YRSW06 TO WN0050
                   END-IF
               END-IF
      *        Int Chk Option String Apn
      *        Append Description to Output string :
      *        CASE: PAR.Option Desc ATR 02 is Not Blank
      *        *IF
               IF (WN0077 NOT = ' ') THEN
      *            U:Number (2.0)
                   MOVE ZEROS TO YL0100 OF WORK-CONTEXT
      *            U:Number (2.0) b
                   MOVE ZEROS TO YL0101 OF WORK-CONTEXT
      *            U:Number (2.0) c
                   MOVE ZEROS TO YL0102 OF WORK-CONTEXT
      *            U:Number (2.0) d
                   MOVE ZEROS TO YL0103 OF WORK-CONTEXT
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0077
                TALLYING YL0100 OF WORK-CONTEXT
                FOR ALL 'Admin Code'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0077
                TALLYING YL0101 OF WORK-CONTEXT
                FOR ALL 'Admin only'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0077
                TALLYING YL0102 OF WORK-CONTEXT
                FOR ALL 'Admin code'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0077
                TALLYING YL0103 OF WORK-CONTEXT
                FOR ALL 'Battery Hire'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            CASE:
      *            - c1 AND c2 AND c3 AND c4
      *            |- c1    : LCL.U:Number (2.0) is Zero
      *            |- c2    : LCL.U:Number (2.0) b is Zero
      *            |- c3    : LCL.U:Number (2.0) c is Zero
      *            |- c4    : LCL.U:Number (2.0) d is Zero
      *            '-
      *            *IF
                   IF (YL0100 OF WORK-CONTEXT = 0 AND
                       YL0101 OF WORK-CONTEXT = 0 AND
                       YL0102 OF WORK-CONTEXT = 0 AND
                       YL0103 OF WORK-CONTEXT = 0) THEN
      *                Option Desc ATR 02
                       MOVE WN0077 TO YL0104 OF WORK-CONTEXT
      *                Rtn Inspect replacing - #String Functions  *
     ***-------------------------------------------------------------**
     ***   COBOL inspect replacing statement                         **
     ***                                                             **
     ***   System  . . . . . :   Renault UK utilties                 **
     ***   User source name  :   RAUINSRPLS                          **
     ***   Author  . . . . . :   Maurice Mead                        **
     ***   Date written  . . :   14/04/2009                          **
     ***   Request . . . . . :   RN-CHG-425505                       **
     ***                                                             **
     ***   See the SYNON/2 narrative text for full details and the   **
     ***     maintenance log.                                        **
     ***-------------------------------------------------------------**
           MOVE ZEROS   TO YL0105 OF WORK-CONTEXT
           INSPECT YL0104 OF WORK-CONTEXT
             TALLYING YL0105 OF WORK-CONTEXT
             FOR ALL ','
             REPLACING ALL ','
             BY ' '
      *.Rtn.Inspect.replacing.-.End.of.user.source.....................
      *                CASE: PAR.U:Vehicle All Options Dsc is *Not Blank
      *                *IF
                       IF (WN0050 NOT = ' ') THEN
                           MOVE ZEROS TO YRSW03
                           MOVE 'T' TO YRSW05
                           IF (WN0050 = SPACES AND
                               YRSW05 = 'T') THEN
                               ADD  1 TO ZEROS GIVING YRSW04
                           ELSE
                               ADD  1 TO 03000 GIVING YRSW04
                           END-IF
                           MOVE 03000 TO YRSW02
                           MOVE WN0050 TO YRSW06
                           PERFORM ZCATWK
                           STRING YRSW06 DELIMITED BY X'FF',
                                  ',' DELIMITED BY SIZE
                           INTO   YRSW06
                           MOVE YRSW06 TO WN0050
                       END-IF
                       MOVE ZEROS TO YRSW03
                       MOVE 'T' TO YRSW05
                       IF (WN0050 = SPACES AND
                           YRSW05 = 'T') THEN
                           ADD  1 TO ZEROS GIVING YRSW04
                       ELSE
                           ADD  1 TO 03000 GIVING YRSW04
                       END-IF
                       MOVE 03000 TO YRSW02
                       MOVE WN0050 TO YRSW06
                       PERFORM ZCATWK
                       STRING YRSW06 DELIMITED BY X'FF',
                              YL0104 OF WORK-CONTEXT DELIMITED BY SIZE
                       INTO   YRSW06
                       MOVE YRSW06 TO WN0050
                   END-IF
               END-IF
      *        Int Chk Option String Apn
      *        Append Description to Output string :
      *        CASE: PAR.Option Desc ATR 02 is Not Blank
      *        *IF
               IF (WN0079 NOT = ' ') THEN
      *            U:Number (2.0)
                   MOVE ZEROS TO YL0100 OF WORK-CONTEXT
      *            U:Number (2.0) b
                   MOVE ZEROS TO YL0101 OF WORK-CONTEXT
      *            U:Number (2.0) c
                   MOVE ZEROS TO YL0102 OF WORK-CONTEXT
      *            U:Number (2.0) d
                   MOVE ZEROS TO YL0103 OF WORK-CONTEXT
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0079
                TALLYING YL0100 OF WORK-CONTEXT
                FOR ALL 'Admin Code'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0079
                TALLYING YL0101 OF WORK-CONTEXT
                FOR ALL 'Admin only'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0079
                TALLYING YL0102 OF WORK-CONTEXT
                FOR ALL 'Admin code'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0079
                TALLYING YL0103 OF WORK-CONTEXT
                FOR ALL 'Battery Hire'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            CASE:
      *            - c1 AND c2 AND c3 AND c4
      *            |- c1    : LCL.U:Number (2.0) is Zero
      *            |- c2    : LCL.U:Number (2.0) b is Zero
      *            |- c3    : LCL.U:Number (2.0) c is Zero
      *            |- c4    : LCL.U:Number (2.0) d is Zero
      *            '-
      *            *IF
                   IF (YL0100 OF WORK-CONTEXT = 0 AND
                       YL0101 OF WORK-CONTEXT = 0 AND
                       YL0102 OF WORK-CONTEXT = 0 AND
                       YL0103 OF WORK-CONTEXT = 0) THEN
      *                Option Desc ATR 02
                       MOVE WN0079 TO YL0104 OF WORK-CONTEXT
      *                Rtn Inspect replacing - #String Functions  *
     ***-------------------------------------------------------------**
     ***   COBOL inspect replacing statement                         **
     ***                                                             **
     ***   System  . . . . . :   Renault UK utilties                 **
     ***   User source name  :   RAUINSRPLS                          **
     ***   Author  . . . . . :   Maurice Mead                        **
     ***   Date written  . . :   14/04/2009                          **
     ***   Request . . . . . :   RN-CHG-425505                       **
     ***                                                             **
     ***   See the SYNON/2 narrative text for full details and the   **
     ***     maintenance log.                                        **
     ***-------------------------------------------------------------**
           MOVE ZEROS   TO YL0105 OF WORK-CONTEXT
           INSPECT YL0104 OF WORK-CONTEXT
             TALLYING YL0105 OF WORK-CONTEXT
             FOR ALL ','
             REPLACING ALL ','
             BY ' '
      *.Rtn.Inspect.replacing.-.End.of.user.source.....................
      *                CASE: PAR.U:Vehicle All Options Dsc is *Not Blank
      *                *IF
                       IF (WN0050 NOT = ' ') THEN
                           MOVE ZEROS TO YRSW03
                           MOVE 'T' TO YRSW05
                           IF (WN0050 = SPACES AND
                               YRSW05 = 'T') THEN
                               ADD  1 TO ZEROS GIVING YRSW04
                           ELSE
                               ADD  1 TO 03000 GIVING YRSW04
                           END-IF
                           MOVE 03000 TO YRSW02
                           MOVE WN0050 TO YRSW06
                           PERFORM ZCATWK
                           STRING YRSW06 DELIMITED BY X'FF',
                                  ',' DELIMITED BY SIZE
                           INTO   YRSW06
                           MOVE YRSW06 TO WN0050
                       END-IF
                       MOVE ZEROS TO YRSW03
                       MOVE 'T' TO YRSW05
                       IF (WN0050 = SPACES AND
                           YRSW05 = 'T') THEN
                           ADD  1 TO ZEROS GIVING YRSW04
                       ELSE
                           ADD  1 TO 03000 GIVING YRSW04
                       END-IF
                       MOVE 03000 TO YRSW02
                       MOVE WN0050 TO YRSW06
                       PERFORM ZCATWK
                       STRING YRSW06 DELIMITED BY X'FF',
                              YL0104 OF WORK-CONTEXT DELIMITED BY SIZE
                       INTO   YRSW06
                       MOVE YRSW06 TO WN0050
                   END-IF
               END-IF
      *        Int Chk Option String Apn
      *        Append Description to Output string :
      *        CASE: PAR.Option Desc ATR 02 is Not Blank
      *        *IF
               IF (WN0081 NOT = ' ') THEN
      *            U:Number (2.0)
                   MOVE ZEROS TO YL0100 OF WORK-CONTEXT
      *            U:Number (2.0) b
                   MOVE ZEROS TO YL0101 OF WORK-CONTEXT
      *            U:Number (2.0) c
                   MOVE ZEROS TO YL0102 OF WORK-CONTEXT
      *            U:Number (2.0) d
                   MOVE ZEROS TO YL0103 OF WORK-CONTEXT
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0081
                TALLYING YL0100 OF WORK-CONTEXT
                FOR ALL 'Admin Code'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0081
                TALLYING YL0101 OF WORK-CONTEXT
                FOR ALL 'Admin only'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0081
                TALLYING YL0102 OF WORK-CONTEXT
                FOR ALL 'Admin code'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0081
                TALLYING YL0103 OF WORK-CONTEXT
                FOR ALL 'Battery Hire'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            CASE:
      *            - c1 AND c2 AND c3 AND c4
      *            |- c1    : LCL.U:Number (2.0) is Zero
      *            |- c2    : LCL.U:Number (2.0) b is Zero
      *            |- c3    : LCL.U:Number (2.0) c is Zero
      *            |- c4    : LCL.U:Number (2.0) d is Zero
      *            '-
      *            *IF
                   IF (YL0100 OF WORK-CONTEXT = 0 AND
                       YL0101 OF WORK-CONTEXT = 0 AND
                       YL0102 OF WORK-CONTEXT = 0 AND
                       YL0103 OF WORK-CONTEXT = 0) THEN
      *                Option Desc ATR 02
                       MOVE WN0081 TO YL0104 OF WORK-CONTEXT
      *                Rtn Inspect replacing - #String Functions  *
     ***-------------------------------------------------------------**
     ***   COBOL inspect replacing statement                         **
     ***                                                             **
     ***   System  . . . . . :   Renault UK utilties                 **
     ***   User source name  :   RAUINSRPLS                          **
     ***   Author  . . . . . :   Maurice Mead                        **
     ***   Date written  . . :   14/04/2009                          **
     ***   Request . . . . . :   RN-CHG-425505                       **
     ***                                                             **
     ***   See the SYNON/2 narrative text for full details and the   **
     ***     maintenance log.                                        **
     ***-------------------------------------------------------------**
           MOVE ZEROS   TO YL0105 OF WORK-CONTEXT
           INSPECT YL0104 OF WORK-CONTEXT
             TALLYING YL0105 OF WORK-CONTEXT
             FOR ALL ','
             REPLACING ALL ','
             BY ' '
      *.Rtn.Inspect.replacing.-.End.of.user.source.....................
      *                CASE: PAR.U:Vehicle All Options Dsc is *Not Blank
      *                *IF
                       IF (WN0050 NOT = ' ') THEN
                           MOVE ZEROS TO YRSW03
                           MOVE 'T' TO YRSW05
                           IF (WN0050 = SPACES AND
                               YRSW05 = 'T') THEN
                               ADD  1 TO ZEROS GIVING YRSW04
                           ELSE
                               ADD  1 TO 03000 GIVING YRSW04
                           END-IF
                           MOVE 03000 TO YRSW02
                           MOVE WN0050 TO YRSW06
                           PERFORM ZCATWK
                           STRING YRSW06 DELIMITED BY X'FF',
                                  ',' DELIMITED BY SIZE
                           INTO   YRSW06
                           MOVE YRSW06 TO WN0050
                       END-IF
                       MOVE ZEROS TO YRSW03
                       MOVE 'T' TO YRSW05
                       IF (WN0050 = SPACES AND
                           YRSW05 = 'T') THEN
                           ADD  1 TO ZEROS GIVING YRSW04
                       ELSE
                           ADD  1 TO 03000 GIVING YRSW04
                       END-IF
                       MOVE 03000 TO YRSW02
                       MOVE WN0050 TO YRSW06
                       PERFORM ZCATWK
                       STRING YRSW06 DELIMITED BY X'FF',
                              YL0104 OF WORK-CONTEXT DELIMITED BY SIZE
                       INTO   YRSW06
                       MOVE YRSW06 TO WN0050
                   END-IF
               END-IF
      *        Int Chk Option String Apn
      *        Append Description to Output string :
      *        CASE: PAR.Option Desc ATR 02 is Not Blank
      *        *IF
               IF (WN0083 NOT = ' ') THEN
      *            U:Number (2.0)
                   MOVE ZEROS TO YL0100 OF WORK-CONTEXT
      *            U:Number (2.0) b
                   MOVE ZEROS TO YL0101 OF WORK-CONTEXT
      *            U:Number (2.0) c
                   MOVE ZEROS TO YL0102 OF WORK-CONTEXT
      *            U:Number (2.0) d
                   MOVE ZEROS TO YL0103 OF WORK-CONTEXT
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0083
                TALLYING YL0100 OF WORK-CONTEXT
                FOR ALL 'Admin Code'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0083
                TALLYING YL0101 OF WORK-CONTEXT
                FOR ALL 'Admin only'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0083
                TALLYING YL0102 OF WORK-CONTEXT
                FOR ALL 'Admin code'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0083
                TALLYING YL0103 OF WORK-CONTEXT
                FOR ALL 'Battery Hire'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            CASE:
      *            - c1 AND c2 AND c3 AND c4
      *            |- c1    : LCL.U:Number (2.0) is Zero
      *            |- c2    : LCL.U:Number (2.0) b is Zero
      *            |- c3    : LCL.U:Number (2.0) c is Zero
      *            |- c4    : LCL.U:Number (2.0) d is Zero
      *            '-
      *            *IF
                   IF (YL0100 OF WORK-CONTEXT = 0 AND
                       YL0101 OF WORK-CONTEXT = 0 AND
                       YL0102 OF WORK-CONTEXT = 0 AND
                       YL0103 OF WORK-CONTEXT = 0) THEN
      *                Option Desc ATR 02
                       MOVE WN0083 TO YL0104 OF WORK-CONTEXT
      *                Rtn Inspect replacing - #String Functions  *
     ***-------------------------------------------------------------**
     ***   COBOL inspect replacing statement                         **
     ***                                                             **
     ***   System  . . . . . :   Renault UK utilties                 **
     ***   User source name  :   RAUINSRPLS                          **
     ***   Author  . . . . . :   Maurice Mead                        **
     ***   Date written  . . :   14/04/2009                          **
     ***   Request . . . . . :   RN-CHG-425505                       **
     ***                                                             **
     ***   See the SYNON/2 narrative text for full details and the   **
     ***     maintenance log.                                        **
     ***-------------------------------------------------------------**
           MOVE ZEROS   TO YL0105 OF WORK-CONTEXT
           INSPECT YL0104 OF WORK-CONTEXT
             TALLYING YL0105 OF WORK-CONTEXT
             FOR ALL ','
             REPLACING ALL ','
             BY ' '
      *.Rtn.Inspect.replacing.-.End.of.user.source.....................
      *                CASE: PAR.U:Vehicle All Options Dsc is *Not Blank
      *                *IF
                       IF (WN0050 NOT = ' ') THEN
                           MOVE ZEROS TO YRSW03
                           MOVE 'T' TO YRSW05
                           IF (WN0050 = SPACES AND
                               YRSW05 = 'T') THEN
                               ADD  1 TO ZEROS GIVING YRSW04
                           ELSE
                               ADD  1 TO 03000 GIVING YRSW04
                           END-IF
                           MOVE 03000 TO YRSW02
                           MOVE WN0050 TO YRSW06
                           PERFORM ZCATWK
                           STRING YRSW06 DELIMITED BY X'FF',
                                  ',' DELIMITED BY SIZE
                           INTO   YRSW06
                           MOVE YRSW06 TO WN0050
                       END-IF
                       MOVE ZEROS TO YRSW03
                       MOVE 'T' TO YRSW05
                       IF (WN0050 = SPACES AND
                           YRSW05 = 'T') THEN
                           ADD  1 TO ZEROS GIVING YRSW04
                       ELSE
                           ADD  1 TO 03000 GIVING YRSW04
                       END-IF
                       MOVE 03000 TO YRSW02
                       MOVE WN0050 TO YRSW06
                       PERFORM ZCATWK
                       STRING YRSW06 DELIMITED BY X'FF',
                              YL0104 OF WORK-CONTEXT DELIMITED BY SIZE
                       INTO   YRSW06
                       MOVE YRSW06 TO WN0050
                   END-IF
               END-IF
      *        Int Chk Option String Apn
      *        Append Description to Output string :
      *        CASE: PAR.Option Desc ATR 02 is Not Blank
      *        *IF
               IF (WN0085 NOT = ' ') THEN
      *            U:Number (2.0)
                   MOVE ZEROS TO YL0100 OF WORK-CONTEXT
      *            U:Number (2.0) b
                   MOVE ZEROS TO YL0101 OF WORK-CONTEXT
      *            U:Number (2.0) c
                   MOVE ZEROS TO YL0102 OF WORK-CONTEXT
      *            U:Number (2.0) d
                   MOVE ZEROS TO YL0103 OF WORK-CONTEXT
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0085
                TALLYING YL0100 OF WORK-CONTEXT
                FOR ALL 'Admin Code'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0085
                TALLYING YL0101 OF WORK-CONTEXT
                FOR ALL 'Admin only'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0085
                TALLYING YL0102 OF WORK-CONTEXT
                FOR ALL 'Admin code'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0085
                TALLYING YL0103 OF WORK-CONTEXT
                FOR ALL 'Battery Hire'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            CASE:
      *            - c1 AND c2 AND c3 AND c4
      *            |- c1    : LCL.U:Number (2.0) is Zero
      *            |- c2    : LCL.U:Number (2.0) b is Zero
      *            |- c3    : LCL.U:Number (2.0) c is Zero
      *            |- c4    : LCL.U:Number (2.0) d is Zero
      *            '-
      *            *IF
                   IF (YL0100 OF WORK-CONTEXT = 0 AND
                       YL0101 OF WORK-CONTEXT = 0 AND
                       YL0102 OF WORK-CONTEXT = 0 AND
                       YL0103 OF WORK-CONTEXT = 0) THEN
      *                Option Desc ATR 02
                       MOVE WN0085 TO YL0104 OF WORK-CONTEXT
      *                Rtn Inspect replacing - #String Functions  *
     ***-------------------------------------------------------------**
     ***   COBOL inspect replacing statement                         **
     ***                                                             **
     ***   System  . . . . . :   Renault UK utilties                 **
     ***   User source name  :   RAUINSRPLS                          **
     ***   Author  . . . . . :   Maurice Mead                        **
     ***   Date written  . . :   14/04/2009                          **
     ***   Request . . . . . :   RN-CHG-425505                       **
     ***                                                             **
     ***   See the SYNON/2 narrative text for full details and the   **
     ***     maintenance log.                                        **
     ***-------------------------------------------------------------**
           MOVE ZEROS   TO YL0105 OF WORK-CONTEXT
           INSPECT YL0104 OF WORK-CONTEXT
             TALLYING YL0105 OF WORK-CONTEXT
             FOR ALL ','
             REPLACING ALL ','
             BY ' '
      *.Rtn.Inspect.replacing.-.End.of.user.source.....................
      *                CASE: PAR.U:Vehicle All Options Dsc is *Not Blank
      *                *IF
                       IF (WN0050 NOT = ' ') THEN
                           MOVE ZEROS TO YRSW03
                           MOVE 'T' TO YRSW05
                           IF (WN0050 = SPACES AND
                               YRSW05 = 'T') THEN
                               ADD  1 TO ZEROS GIVING YRSW04
                           ELSE
                               ADD  1 TO 03000 GIVING YRSW04
                           END-IF
                           MOVE 03000 TO YRSW02
                           MOVE WN0050 TO YRSW06
                           PERFORM ZCATWK
                           STRING YRSW06 DELIMITED BY X'FF',
                                  ',' DELIMITED BY SIZE
                           INTO   YRSW06
                           MOVE YRSW06 TO WN0050
                       END-IF
                       MOVE ZEROS TO YRSW03
                       MOVE 'T' TO YRSW05
                       IF (WN0050 = SPACES AND
                           YRSW05 = 'T') THEN
                           ADD  1 TO ZEROS GIVING YRSW04
                       ELSE
                           ADD  1 TO 03000 GIVING YRSW04
                       END-IF
                       MOVE 03000 TO YRSW02
                       MOVE WN0050 TO YRSW06
                       PERFORM ZCATWK
                       STRING YRSW06 DELIMITED BY X'FF',
                              YL0104 OF WORK-CONTEXT DELIMITED BY SIZE
                       INTO   YRSW06
                       MOVE YRSW06 TO WN0050
                   END-IF
               END-IF
      *        Int Chk Option String Apn
      *        Append Description to Output string :
      *        CASE: PAR.Option Desc ATR 02 is Not Blank
      *        *IF
               IF (WN0087 NOT = ' ') THEN
      *            U:Number (2.0)
                   MOVE ZEROS TO YL0100 OF WORK-CONTEXT
      *            U:Number (2.0) b
                   MOVE ZEROS TO YL0101 OF WORK-CONTEXT
      *            U:Number (2.0) c
                   MOVE ZEROS TO YL0102 OF WORK-CONTEXT
      *            U:Number (2.0) d
                   MOVE ZEROS TO YL0103 OF WORK-CONTEXT
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0087
                TALLYING YL0100 OF WORK-CONTEXT
                FOR ALL 'Admin Code'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0087
                TALLYING YL0101 OF WORK-CONTEXT
                FOR ALL 'Admin only'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0087
                TALLYING YL0102 OF WORK-CONTEXT
                FOR ALL 'Admin code'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0087
                TALLYING YL0103 OF WORK-CONTEXT
                FOR ALL 'Battery Hire'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            CASE:
      *            - c1 AND c2 AND c3 AND c4
      *            |- c1    : LCL.U:Number (2.0) is Zero
      *            |- c2    : LCL.U:Number (2.0) b is Zero
      *            |- c3    : LCL.U:Number (2.0) c is Zero
      *            |- c4    : LCL.U:Number (2.0) d is Zero
      *            '-
      *            *IF
                   IF (YL0100 OF WORK-CONTEXT = 0 AND
                       YL0101 OF WORK-CONTEXT = 0 AND
                       YL0102 OF WORK-CONTEXT = 0 AND
                       YL0103 OF WORK-CONTEXT = 0) THEN
      *                Option Desc ATR 02
                       MOVE WN0087 TO YL0104 OF WORK-CONTEXT
      *                Rtn Inspect replacing - #String Functions  *
     ***-------------------------------------------------------------**
     ***   COBOL inspect replacing statement                         **
     ***                                                             **
     ***   System  . . . . . :   Renault UK utilties                 **
     ***   User source name  :   RAUINSRPLS                          **
     ***   Author  . . . . . :   Maurice Mead                        **
     ***   Date written  . . :   14/04/2009                          **
     ***   Request . . . . . :   RN-CHG-425505                       **
     ***                                                             **
     ***   See the SYNON/2 narrative text for full details and the   **
     ***     maintenance log.                                        **
     ***-------------------------------------------------------------**
           MOVE ZEROS   TO YL0105 OF WORK-CONTEXT
           INSPECT YL0104 OF WORK-CONTEXT
             TALLYING YL0105 OF WORK-CONTEXT
             FOR ALL ','
             REPLACING ALL ','
             BY ' '
      *.Rtn.Inspect.replacing.-.End.of.user.source.....................
      *                CASE: PAR.U:Vehicle All Options Dsc is *Not Blank
      *                *IF
                       IF (WN0050 NOT = ' ') THEN
                           MOVE ZEROS TO YRSW03
                           MOVE 'T' TO YRSW05
                           IF (WN0050 = SPACES AND
                               YRSW05 = 'T') THEN
                               ADD  1 TO ZEROS GIVING YRSW04
                           ELSE
                               ADD  1 TO 03000 GIVING YRSW04
                           END-IF
                           MOVE 03000 TO YRSW02
                           MOVE WN0050 TO YRSW06
                           PERFORM ZCATWK
                           STRING YRSW06 DELIMITED BY X'FF',
                                  ',' DELIMITED BY SIZE
                           INTO   YRSW06
                           MOVE YRSW06 TO WN0050
                       END-IF
                       MOVE ZEROS TO YRSW03
                       MOVE 'T' TO YRSW05
                       IF (WN0050 = SPACES AND
                           YRSW05 = 'T') THEN
                           ADD  1 TO ZEROS GIVING YRSW04
                       ELSE
                           ADD  1 TO 03000 GIVING YRSW04
                       END-IF
                       MOVE 03000 TO YRSW02
                       MOVE WN0050 TO YRSW06
                       PERFORM ZCATWK
                       STRING YRSW06 DELIMITED BY X'FF',
                              YL0104 OF WORK-CONTEXT DELIMITED BY SIZE
                       INTO   YRSW06
                       MOVE YRSW06 TO WN0050
                   END-IF
               END-IF
      *        Int Chk Option String Apn
      *        Append Description to Output string :
      *        CASE: PAR.Option Desc ATR 02 is Not Blank
      *        *IF
               IF (WN0089 NOT = ' ') THEN
      *            U:Number (2.0)
                   MOVE ZEROS TO YL0100 OF WORK-CONTEXT
      *            U:Number (2.0) b
                   MOVE ZEROS TO YL0101 OF WORK-CONTEXT
      *            U:Number (2.0) c
                   MOVE ZEROS TO YL0102 OF WORK-CONTEXT
      *            U:Number (2.0) d
                   MOVE ZEROS TO YL0103 OF WORK-CONTEXT
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0089
                TALLYING YL0100 OF WORK-CONTEXT
                FOR ALL 'Admin Code'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0089
                TALLYING YL0101 OF WORK-CONTEXT
                FOR ALL 'Admin only'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0089
                TALLYING YL0102 OF WORK-CONTEXT
                FOR ALL 'Admin code'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0089
                TALLYING YL0103 OF WORK-CONTEXT
                FOR ALL 'Battery Hire'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            CASE:
      *            - c1 AND c2 AND c3 AND c4
      *            |- c1    : LCL.U:Number (2.0) is Zero
      *            |- c2    : LCL.U:Number (2.0) b is Zero
      *            |- c3    : LCL.U:Number (2.0) c is Zero
      *            |- c4    : LCL.U:Number (2.0) d is Zero
      *            '-
      *            *IF
                   IF (YL0100 OF WORK-CONTEXT = 0 AND
                       YL0101 OF WORK-CONTEXT = 0 AND
                       YL0102 OF WORK-CONTEXT = 0 AND
                       YL0103 OF WORK-CONTEXT = 0) THEN
      *                Option Desc ATR 02
                       MOVE WN0089 TO YL0104 OF WORK-CONTEXT
      *                Rtn Inspect replacing - #String Functions  *
     ***-------------------------------------------------------------**
     ***   COBOL inspect replacing statement                         **
     ***                                                             **
     ***   System  . . . . . :   Renault UK utilties                 **
     ***   User source name  :   RAUINSRPLS                          **
     ***   Author  . . . . . :   Maurice Mead                        **
     ***   Date written  . . :   14/04/2009                          **
     ***   Request . . . . . :   RN-CHG-425505                       **
     ***                                                             **
     ***   See the SYNON/2 narrative text for full details and the   **
     ***     maintenance log.                                        **
     ***-------------------------------------------------------------**
           MOVE ZEROS   TO YL0105 OF WORK-CONTEXT
           INSPECT YL0104 OF WORK-CONTEXT
             TALLYING YL0105 OF WORK-CONTEXT
             FOR ALL ','
             REPLACING ALL ','
             BY ' '
      *.Rtn.Inspect.replacing.-.End.of.user.source.....................
      *                CASE: PAR.U:Vehicle All Options Dsc is *Not Blank
      *                *IF
                       IF (WN0050 NOT = ' ') THEN
                           MOVE ZEROS TO YRSW03
                           MOVE 'T' TO YRSW05
                           IF (WN0050 = SPACES AND
                               YRSW05 = 'T') THEN
                               ADD  1 TO ZEROS GIVING YRSW04
                           ELSE
                               ADD  1 TO 03000 GIVING YRSW04
                           END-IF
                           MOVE 03000 TO YRSW02
                           MOVE WN0050 TO YRSW06
                           PERFORM ZCATWK
                           STRING YRSW06 DELIMITED BY X'FF',
                                  ',' DELIMITED BY SIZE
                           INTO   YRSW06
                           MOVE YRSW06 TO WN0050
                       END-IF
                       MOVE ZEROS TO YRSW03
                       MOVE 'T' TO YRSW05
                       IF (WN0050 = SPACES AND
                           YRSW05 = 'T') THEN
                           ADD  1 TO ZEROS GIVING YRSW04
                       ELSE
                           ADD  1 TO 03000 GIVING YRSW04
                       END-IF
                       MOVE 03000 TO YRSW02
                       MOVE WN0050 TO YRSW06
                       PERFORM ZCATWK
                       STRING YRSW06 DELIMITED BY X'FF',
                              YL0104 OF WORK-CONTEXT DELIMITED BY SIZE
                       INTO   YRSW06
                       MOVE YRSW06 TO WN0050
                   END-IF
               END-IF
      *        Int Chk Option String Apn
      *        Append Description to Output string :
      *        CASE: PAR.Option Desc ATR 02 is Not Blank
      *        *IF
               IF (WN0091 NOT = ' ') THEN
      *            U:Number (2.0)
                   MOVE ZEROS TO YL0100 OF WORK-CONTEXT
      *            U:Number (2.0) b
                   MOVE ZEROS TO YL0101 OF WORK-CONTEXT
      *            U:Number (2.0) c
                   MOVE ZEROS TO YL0102 OF WORK-CONTEXT
      *            U:Number (2.0) d
                   MOVE ZEROS TO YL0103 OF WORK-CONTEXT
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0091
                TALLYING YL0100 OF WORK-CONTEXT
                FOR ALL 'Admin Code'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0091
                TALLYING YL0101 OF WORK-CONTEXT
                FOR ALL 'Admin only'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0091
                TALLYING YL0102 OF WORK-CONTEXT
                FOR ALL 'Admin code'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0091
                TALLYING YL0103 OF WORK-CONTEXT
                FOR ALL 'Battery Hire'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            CASE:
      *            - c1 AND c2 AND c3 AND c4
      *            |- c1    : LCL.U:Number (2.0) is Zero
      *            |- c2    : LCL.U:Number (2.0) b is Zero
      *            |- c3    : LCL.U:Number (2.0) c is Zero
      *            |- c4    : LCL.U:Number (2.0) d is Zero
      *            '-
      *            *IF
                   IF (YL0100 OF WORK-CONTEXT = 0 AND
                       YL0101 OF WORK-CONTEXT = 0 AND
                       YL0102 OF WORK-CONTEXT = 0 AND
                       YL0103 OF WORK-CONTEXT = 0) THEN
      *                Option Desc ATR 02
                       MOVE WN0091 TO YL0104 OF WORK-CONTEXT
      *                Rtn Inspect replacing - #String Functions  *
     ***-------------------------------------------------------------**
     ***   COBOL inspect replacing statement                         **
     ***                                                             **
     ***   System  . . . . . :   Renault UK utilties                 **
     ***   User source name  :   RAUINSRPLS                          **
     ***   Author  . . . . . :   Maurice Mead                        **
     ***   Date written  . . :   14/04/2009                          **
     ***   Request . . . . . :   RN-CHG-425505                       **
     ***                                                             **
     ***   See the SYNON/2 narrative text for full details and the   **
     ***     maintenance log.                                        **
     ***-------------------------------------------------------------**
           MOVE ZEROS   TO YL0105 OF WORK-CONTEXT
           INSPECT YL0104 OF WORK-CONTEXT
             TALLYING YL0105 OF WORK-CONTEXT
             FOR ALL ','
             REPLACING ALL ','
             BY ' '
      *.Rtn.Inspect.replacing.-.End.of.user.source.....................
      *                CASE: PAR.U:Vehicle All Options Dsc is *Not Blank
      *                *IF
                       IF (WN0050 NOT = ' ') THEN
                           MOVE ZEROS TO YRSW03
                           MOVE 'T' TO YRSW05
                           IF (WN0050 = SPACES AND
                               YRSW05 = 'T') THEN
                               ADD  1 TO ZEROS GIVING YRSW04
                           ELSE
                               ADD  1 TO 03000 GIVING YRSW04
                           END-IF
                           MOVE 03000 TO YRSW02
                           MOVE WN0050 TO YRSW06
                           PERFORM ZCATWK
                           STRING YRSW06 DELIMITED BY X'FF',
                                  ',' DELIMITED BY SIZE
                           INTO   YRSW06
                           MOVE YRSW06 TO WN0050
                       END-IF
                       MOVE ZEROS TO YRSW03
                       MOVE 'T' TO YRSW05
                       IF (WN0050 = SPACES AND
                           YRSW05 = 'T') THEN
                           ADD  1 TO ZEROS GIVING YRSW04
                       ELSE
                           ADD  1 TO 03000 GIVING YRSW04
                       END-IF
                       MOVE 03000 TO YRSW02
                       MOVE WN0050 TO YRSW06
                       PERFORM ZCATWK
                       STRING YRSW06 DELIMITED BY X'FF',
                              YL0104 OF WORK-CONTEXT DELIMITED BY SIZE
                       INTO   YRSW06
                       MOVE YRSW06 TO WN0050
                   END-IF
               END-IF
      *        Int Chk Option String Apn
      *        Append Description to Output string :
      *        CASE: PAR.Option Desc ATR 02 is Not Blank
      *        *IF
               IF (WN0093 NOT = ' ') THEN
      *            U:Number (2.0)
                   MOVE ZEROS TO YL0100 OF WORK-CONTEXT
      *            U:Number (2.0) b
                   MOVE ZEROS TO YL0101 OF WORK-CONTEXT
      *            U:Number (2.0) c
                   MOVE ZEROS TO YL0102 OF WORK-CONTEXT
      *            U:Number (2.0) d
                   MOVE ZEROS TO YL0103 OF WORK-CONTEXT
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0093
                TALLYING YL0100 OF WORK-CONTEXT
                FOR ALL 'Admin Code'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0093
                TALLYING YL0101 OF WORK-CONTEXT
                FOR ALL 'Admin only'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0093
                TALLYING YL0102 OF WORK-CONTEXT
                FOR ALL 'Admin code'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0093
                TALLYING YL0103 OF WORK-CONTEXT
                FOR ALL 'Battery Hire'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            CASE:
      *            - c1 AND c2 AND c3 AND c4
      *            |- c1    : LCL.U:Number (2.0) is Zero
      *            |- c2    : LCL.U:Number (2.0) b is Zero
      *            |- c3    : LCL.U:Number (2.0) c is Zero
      *            |- c4    : LCL.U:Number (2.0) d is Zero
      *            '-
      *            *IF
                   IF (YL0100 OF WORK-CONTEXT = 0 AND
                       YL0101 OF WORK-CONTEXT = 0 AND
                       YL0102 OF WORK-CONTEXT = 0 AND
                       YL0103 OF WORK-CONTEXT = 0) THEN
      *                Option Desc ATR 02
                       MOVE WN0093 TO YL0104 OF WORK-CONTEXT
      *                Rtn Inspect replacing - #String Functions  *
     ***-------------------------------------------------------------**
     ***   COBOL inspect replacing statement                         **
     ***                                                             **
     ***   System  . . . . . :   Renault UK utilties                 **
     ***   User source name  :   RAUINSRPLS                          **
     ***   Author  . . . . . :   Maurice Mead                        **
     ***   Date written  . . :   14/04/2009                          **
     ***   Request . . . . . :   RN-CHG-425505                       **
     ***                                                             **
     ***   See the SYNON/2 narrative text for full details and the   **
     ***     maintenance log.                                        **
     ***-------------------------------------------------------------**
           MOVE ZEROS   TO YL0105 OF WORK-CONTEXT
           INSPECT YL0104 OF WORK-CONTEXT
             TALLYING YL0105 OF WORK-CONTEXT
             FOR ALL ','
             REPLACING ALL ','
             BY ' '
      *.Rtn.Inspect.replacing.-.End.of.user.source.....................
      *                CASE: PAR.U:Vehicle All Options Dsc is *Not Blank
      *                *IF
                       IF (WN0050 NOT = ' ') THEN
                           MOVE ZEROS TO YRSW03
                           MOVE 'T' TO YRSW05
                           IF (WN0050 = SPACES AND
                               YRSW05 = 'T') THEN
                               ADD  1 TO ZEROS GIVING YRSW04
                           ELSE
                               ADD  1 TO 03000 GIVING YRSW04
                           END-IF
                           MOVE 03000 TO YRSW02
                           MOVE WN0050 TO YRSW06
                           PERFORM ZCATWK
                           STRING YRSW06 DELIMITED BY X'FF',
                                  ',' DELIMITED BY SIZE
                           INTO   YRSW06
                           MOVE YRSW06 TO WN0050
                       END-IF
                       MOVE ZEROS TO YRSW03
                       MOVE 'T' TO YRSW05
                       IF (WN0050 = SPACES AND
                           YRSW05 = 'T') THEN
                           ADD  1 TO ZEROS GIVING YRSW04
                       ELSE
                           ADD  1 TO 03000 GIVING YRSW04
                       END-IF
                       MOVE 03000 TO YRSW02
                       MOVE WN0050 TO YRSW06
                       PERFORM ZCATWK
                       STRING YRSW06 DELIMITED BY X'FF',
                              YL0104 OF WORK-CONTEXT DELIMITED BY SIZE
                       INTO   YRSW06
                       MOVE YRSW06 TO WN0050
                   END-IF
               END-IF
      *        Int Chk Option String Apn
      *        Append Description to Output string :
      *        CASE: PAR.Option Desc ATR 02 is Not Blank
      *        *IF
               IF (WN0095 NOT = ' ') THEN
      *            U:Number (2.0)
                   MOVE ZEROS TO YL0100 OF WORK-CONTEXT
      *            U:Number (2.0) b
                   MOVE ZEROS TO YL0101 OF WORK-CONTEXT
      *            U:Number (2.0) c
                   MOVE ZEROS TO YL0102 OF WORK-CONTEXT
      *            U:Number (2.0) d
                   MOVE ZEROS TO YL0103 OF WORK-CONTEXT
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0095
                TALLYING YL0100 OF WORK-CONTEXT
                FOR ALL 'Admin Code'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0095
                TALLYING YL0101 OF WORK-CONTEXT
                FOR ALL 'Admin only'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0095
                TALLYING YL0102 OF WORK-CONTEXT
                FOR ALL 'Admin code'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0095
                TALLYING YL0103 OF WORK-CONTEXT
                FOR ALL 'Battery Hire'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            CASE:
      *            - c1 AND c2 AND c3 AND c4
      *            |- c1    : LCL.U:Number (2.0) is Zero
      *            |- c2    : LCL.U:Number (2.0) b is Zero
      *            |- c3    : LCL.U:Number (2.0) c is Zero
      *            |- c4    : LCL.U:Number (2.0) d is Zero
      *            '-
      *            *IF
                   IF (YL0100 OF WORK-CONTEXT = 0 AND
                       YL0101 OF WORK-CONTEXT = 0 AND
                       YL0102 OF WORK-CONTEXT = 0 AND
                       YL0103 OF WORK-CONTEXT = 0) THEN
      *                Option Desc ATR 02
                       MOVE WN0095 TO YL0104 OF WORK-CONTEXT
      *                Rtn Inspect replacing - #String Functions  *
     ***-------------------------------------------------------------**
     ***   COBOL inspect replacing statement                         **
     ***                                                             **
     ***   System  . . . . . :   Renault UK utilties                 **
     ***   User source name  :   RAUINSRPLS                          **
     ***   Author  . . . . . :   Maurice Mead                        **
     ***   Date written  . . :   14/04/2009                          **
     ***   Request . . . . . :   RN-CHG-425505                       **
     ***                                                             **
     ***   See the SYNON/2 narrative text for full details and the   **
     ***     maintenance log.                                        **
     ***-------------------------------------------------------------**
           MOVE ZEROS   TO YL0105 OF WORK-CONTEXT
           INSPECT YL0104 OF WORK-CONTEXT
             TALLYING YL0105 OF WORK-CONTEXT
             FOR ALL ','
             REPLACING ALL ','
             BY ' '
      *.Rtn.Inspect.replacing.-.End.of.user.source.....................
      *                CASE: PAR.U:Vehicle All Options Dsc is *Not Blank
      *                *IF
                       IF (WN0050 NOT = ' ') THEN
                           MOVE ZEROS TO YRSW03
                           MOVE 'T' TO YRSW05
                           IF (WN0050 = SPACES AND
                               YRSW05 = 'T') THEN
                               ADD  1 TO ZEROS GIVING YRSW04
                           ELSE
                               ADD  1 TO 03000 GIVING YRSW04
                           END-IF
                           MOVE 03000 TO YRSW02
                           MOVE WN0050 TO YRSW06
                           PERFORM ZCATWK
                           STRING YRSW06 DELIMITED BY X'FF',
                                  ',' DELIMITED BY SIZE
                           INTO   YRSW06
                           MOVE YRSW06 TO WN0050
                       END-IF
                       MOVE ZEROS TO YRSW03
                       MOVE 'T' TO YRSW05
                       IF (WN0050 = SPACES AND
                           YRSW05 = 'T') THEN
                           ADD  1 TO ZEROS GIVING YRSW04
                       ELSE
                           ADD  1 TO 03000 GIVING YRSW04
                       END-IF
                       MOVE 03000 TO YRSW02
                       MOVE WN0050 TO YRSW06
                       PERFORM ZCATWK
                       STRING YRSW06 DELIMITED BY X'FF',
                              YL0104 OF WORK-CONTEXT DELIMITED BY SIZE
                       INTO   YRSW06
                       MOVE YRSW06 TO WN0050
                   END-IF
               END-IF
      *        Int Chk Option String Apn
      *        Append Description to Output string :
      *        CASE: PAR.Option Desc ATR 02 is Not Blank
      *        *IF
               IF (WN0097 NOT = ' ') THEN
      *            U:Number (2.0)
                   MOVE ZEROS TO YL0100 OF WORK-CONTEXT
      *            U:Number (2.0) b
                   MOVE ZEROS TO YL0101 OF WORK-CONTEXT
      *            U:Number (2.0) c
                   MOVE ZEROS TO YL0102 OF WORK-CONTEXT
      *            U:Number (2.0) d
                   MOVE ZEROS TO YL0103 OF WORK-CONTEXT
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0097
                TALLYING YL0100 OF WORK-CONTEXT
                FOR ALL 'Admin Code'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0097
                TALLYING YL0101 OF WORK-CONTEXT
                FOR ALL 'Admin only'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0097
                TALLYING YL0102 OF WORK-CONTEXT
                FOR ALL 'Admin code'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0097
                TALLYING YL0103 OF WORK-CONTEXT
                FOR ALL 'Battery Hire'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            CASE:
      *            - c1 AND c2 AND c3 AND c4
      *            |- c1    : LCL.U:Number (2.0) is Zero
      *            |- c2    : LCL.U:Number (2.0) b is Zero
      *            |- c3    : LCL.U:Number (2.0) c is Zero
      *            |- c4    : LCL.U:Number (2.0) d is Zero
      *            '-
      *            *IF
                   IF (YL0100 OF WORK-CONTEXT = 0 AND
                       YL0101 OF WORK-CONTEXT = 0 AND
                       YL0102 OF WORK-CONTEXT = 0 AND
                       YL0103 OF WORK-CONTEXT = 0) THEN
      *                Option Desc ATR 02
                       MOVE WN0097 TO YL0104 OF WORK-CONTEXT
      *                Rtn Inspect replacing - #String Functions  *
     ***-------------------------------------------------------------**
     ***   COBOL inspect replacing statement                         **
     ***                                                             **
     ***   System  . . . . . :   Renault UK utilties                 **
     ***   User source name  :   RAUINSRPLS                          **
     ***   Author  . . . . . :   Maurice Mead                        **
     ***   Date written  . . :   14/04/2009                          **
     ***   Request . . . . . :   RN-CHG-425505                       **
     ***                                                             **
     ***   See the SYNON/2 narrative text for full details and the   **
     ***     maintenance log.                                        **
     ***-------------------------------------------------------------**
           MOVE ZEROS   TO YL0105 OF WORK-CONTEXT
           INSPECT YL0104 OF WORK-CONTEXT
             TALLYING YL0105 OF WORK-CONTEXT
             FOR ALL ','
             REPLACING ALL ','
             BY ' '
      *.Rtn.Inspect.replacing.-.End.of.user.source.....................
      *                CASE: PAR.U:Vehicle All Options Dsc is *Not Blank
      *                *IF
                       IF (WN0050 NOT = ' ') THEN
                           MOVE ZEROS TO YRSW03
                           MOVE 'T' TO YRSW05
                           IF (WN0050 = SPACES AND
                               YRSW05 = 'T') THEN
                               ADD  1 TO ZEROS GIVING YRSW04
                           ELSE
                               ADD  1 TO 03000 GIVING YRSW04
                           END-IF
                           MOVE 03000 TO YRSW02
                           MOVE WN0050 TO YRSW06
                           PERFORM ZCATWK
                           STRING YRSW06 DELIMITED BY X'FF',
                                  ',' DELIMITED BY SIZE
                           INTO   YRSW06
                           MOVE YRSW06 TO WN0050
                       END-IF
                       MOVE ZEROS TO YRSW03
                       MOVE 'T' TO YRSW05
                       IF (WN0050 = SPACES AND
                           YRSW05 = 'T') THEN
                           ADD  1 TO ZEROS GIVING YRSW04
                       ELSE
                           ADD  1 TO 03000 GIVING YRSW04
                       END-IF
                       MOVE 03000 TO YRSW02
                       MOVE WN0050 TO YRSW06
                       PERFORM ZCATWK
                       STRING YRSW06 DELIMITED BY X'FF',
                              YL0104 OF WORK-CONTEXT DELIMITED BY SIZE
                       INTO   YRSW06
                       MOVE YRSW06 TO WN0050
                   END-IF
               END-IF
      *        Int Chk Option String Apn
      *        Append Description to Output string :
      *        CASE: PAR.Option Desc ATR 02 is Not Blank
      *        *IF
               IF (WN0099 NOT = ' ') THEN
      *            U:Number (2.0)
                   MOVE ZEROS TO YL0100 OF WORK-CONTEXT
      *            U:Number (2.0) b
                   MOVE ZEROS TO YL0101 OF WORK-CONTEXT
      *            U:Number (2.0) c
                   MOVE ZEROS TO YL0102 OF WORK-CONTEXT
      *            U:Number (2.0) d
                   MOVE ZEROS TO YL0103 OF WORK-CONTEXT
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0099
                TALLYING YL0100 OF WORK-CONTEXT
                FOR ALL 'Admin Code'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0099
                TALLYING YL0101 OF WORK-CONTEXT
                FOR ALL 'Admin only'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0099
                TALLYING YL0102 OF WORK-CONTEXT
                FOR ALL 'Admin code'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0099
                TALLYING YL0103 OF WORK-CONTEXT
                FOR ALL 'Battery Hire'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            CASE:
      *            - c1 AND c2 AND c3 AND c4
      *            |- c1    : LCL.U:Number (2.0) is Zero
      *            |- c2    : LCL.U:Number (2.0) b is Zero
      *            |- c3    : LCL.U:Number (2.0) c is Zero
      *            |- c4    : LCL.U:Number (2.0) d is Zero
      *            '-
      *            *IF
                   IF (YL0100 OF WORK-CONTEXT = 0 AND
                       YL0101 OF WORK-CONTEXT = 0 AND
                       YL0102 OF WORK-CONTEXT = 0 AND
                       YL0103 OF WORK-CONTEXT = 0) THEN
      *                Option Desc ATR 02
                       MOVE WN0099 TO YL0104 OF WORK-CONTEXT
      *                Rtn Inspect replacing - #String Functions  *
     ***-------------------------------------------------------------**
     ***   COBOL inspect replacing statement                         **
     ***                                                             **
     ***   System  . . . . . :   Renault UK utilties                 **
     ***   User source name  :   RAUINSRPLS                          **
     ***   Author  . . . . . :   Maurice Mead                        **
     ***   Date written  . . :   14/04/2009                          **
     ***   Request . . . . . :   RN-CHG-425505                       **
     ***                                                             **
     ***   See the SYNON/2 narrative text for full details and the   **
     ***     maintenance log.                                        **
     ***-------------------------------------------------------------**
           MOVE ZEROS   TO YL0105 OF WORK-CONTEXT
           INSPECT YL0104 OF WORK-CONTEXT
             TALLYING YL0105 OF WORK-CONTEXT
             FOR ALL ','
             REPLACING ALL ','
             BY ' '
      *.Rtn.Inspect.replacing.-.End.of.user.source.....................
      *                CASE: PAR.U:Vehicle All Options Dsc is *Not Blank
      *                *IF
                       IF (WN0050 NOT = ' ') THEN
                           MOVE ZEROS TO YRSW03
                           MOVE 'T' TO YRSW05
                           IF (WN0050 = SPACES AND
                               YRSW05 = 'T') THEN
                               ADD  1 TO ZEROS GIVING YRSW04
                           ELSE
                               ADD  1 TO 03000 GIVING YRSW04
                           END-IF
                           MOVE 03000 TO YRSW02
                           MOVE WN0050 TO YRSW06
                           PERFORM ZCATWK
                           STRING YRSW06 DELIMITED BY X'FF',
                                  ',' DELIMITED BY SIZE
                           INTO   YRSW06
                           MOVE YRSW06 TO WN0050
                       END-IF
                       MOVE ZEROS TO YRSW03
                       MOVE 'T' TO YRSW05
                       IF (WN0050 = SPACES AND
                           YRSW05 = 'T') THEN
                           ADD  1 TO ZEROS GIVING YRSW04
                       ELSE
                           ADD  1 TO 03000 GIVING YRSW04
                       END-IF
                       MOVE 03000 TO YRSW02
                       MOVE WN0050 TO YRSW06
                       PERFORM ZCATWK
                       STRING YRSW06 DELIMITED BY X'FF',
                              YL0104 OF WORK-CONTEXT DELIMITED BY SIZE
                       INTO   YRSW06
                       MOVE YRSW06 TO WN0050
                   END-IF
               END-IF
      *        Int Chk Option String Apn
      *        Append Description to Output string :
      *        CASE: PAR.Option Desc ATR 02 is Not Blank
      *        *IF
               IF (WN0101 NOT = ' ') THEN
      *            U:Number (2.0)
                   MOVE ZEROS TO YL0100 OF WORK-CONTEXT
      *            U:Number (2.0) b
                   MOVE ZEROS TO YL0101 OF WORK-CONTEXT
      *            U:Number (2.0) c
                   MOVE ZEROS TO YL0102 OF WORK-CONTEXT
      *            U:Number (2.0) d
                   MOVE ZEROS TO YL0103 OF WORK-CONTEXT
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0101
                TALLYING YL0100 OF WORK-CONTEXT
                FOR ALL 'Admin Code'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0101
                TALLYING YL0101 OF WORK-CONTEXT
                FOR ALL 'Admin only'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0101
                TALLYING YL0102 OF WORK-CONTEXT
                FOR ALL 'Admin code'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0101
                TALLYING YL0103 OF WORK-CONTEXT
                FOR ALL 'Battery Hire'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            CASE:
      *            - c1 AND c2 AND c3 AND c4
      *            |- c1    : LCL.U:Number (2.0) is Zero
      *            |- c2    : LCL.U:Number (2.0) b is Zero
      *            |- c3    : LCL.U:Number (2.0) c is Zero
      *            |- c4    : LCL.U:Number (2.0) d is Zero
      *            '-
      *            *IF
                   IF (YL0100 OF WORK-CONTEXT = 0 AND
                       YL0101 OF WORK-CONTEXT = 0 AND
                       YL0102 OF WORK-CONTEXT = 0 AND
                       YL0103 OF WORK-CONTEXT = 0) THEN
      *                Option Desc ATR 02
                       MOVE WN0101 TO YL0104 OF WORK-CONTEXT
      *                Rtn Inspect replacing - #String Functions  *
     ***-------------------------------------------------------------**
     ***   COBOL inspect replacing statement                         **
     ***                                                             **
     ***   System  . . . . . :   Renault UK utilties                 **
     ***   User source name  :   RAUINSRPLS                          **
     ***   Author  . . . . . :   Maurice Mead                        **
     ***   Date written  . . :   14/04/2009                          **
     ***   Request . . . . . :   RN-CHG-425505                       **
     ***                                                             **
     ***   See the SYNON/2 narrative text for full details and the   **
     ***     maintenance log.                                        **
     ***-------------------------------------------------------------**
           MOVE ZEROS   TO YL0105 OF WORK-CONTEXT
           INSPECT YL0104 OF WORK-CONTEXT
             TALLYING YL0105 OF WORK-CONTEXT
             FOR ALL ','
             REPLACING ALL ','
             BY ' '
      *.Rtn.Inspect.replacing.-.End.of.user.source.....................
      *                CASE: PAR.U:Vehicle All Options Dsc is *Not Blank
      *                *IF
                       IF (WN0050 NOT = ' ') THEN
                           MOVE ZEROS TO YRSW03
                           MOVE 'T' TO YRSW05
                           IF (WN0050 = SPACES AND
                               YRSW05 = 'T') THEN
                               ADD  1 TO ZEROS GIVING YRSW04
                           ELSE
                               ADD  1 TO 03000 GIVING YRSW04
                           END-IF
                           MOVE 03000 TO YRSW02
                           MOVE WN0050 TO YRSW06
                           PERFORM ZCATWK
                           STRING YRSW06 DELIMITED BY X'FF',
                                  ',' DELIMITED BY SIZE
                           INTO   YRSW06
                           MOVE YRSW06 TO WN0050
                       END-IF
                       MOVE ZEROS TO YRSW03
                       MOVE 'T' TO YRSW05
                       IF (WN0050 = SPACES AND
                           YRSW05 = 'T') THEN
                           ADD  1 TO ZEROS GIVING YRSW04
                       ELSE
                           ADD  1 TO 03000 GIVING YRSW04
                       END-IF
                       MOVE 03000 TO YRSW02
                       MOVE WN0050 TO YRSW06
                       PERFORM ZCATWK
                       STRING YRSW06 DELIMITED BY X'FF',
                              YL0104 OF WORK-CONTEXT DELIMITED BY SIZE
                       INTO   YRSW06
                       MOVE YRSW06 TO WN0050
                   END-IF
               END-IF
      *        Int Chk Option String Apn
      *        Append Description to Output string :
      *        CASE: PAR.Option Desc ATR 02 is Not Blank
      *        *IF
               IF (WN0103 NOT = ' ') THEN
      *            U:Number (2.0)
                   MOVE ZEROS TO YL0100 OF WORK-CONTEXT
      *            U:Number (2.0) b
                   MOVE ZEROS TO YL0101 OF WORK-CONTEXT
      *            U:Number (2.0) c
                   MOVE ZEROS TO YL0102 OF WORK-CONTEXT
      *            U:Number (2.0) d
                   MOVE ZEROS TO YL0103 OF WORK-CONTEXT
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0103
                TALLYING YL0100 OF WORK-CONTEXT
                FOR ALL 'Admin Code'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0103
                TALLYING YL0101 OF WORK-CONTEXT
                FOR ALL 'Admin only'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0103
                TALLYING YL0102 OF WORK-CONTEXT
                FOR ALL 'Admin code'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0103
                TALLYING YL0103 OF WORK-CONTEXT
                FOR ALL 'Battery Hire'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            CASE:
      *            - c1 AND c2 AND c3 AND c4
      *            |- c1    : LCL.U:Number (2.0) is Zero
      *            |- c2    : LCL.U:Number (2.0) b is Zero
      *            |- c3    : LCL.U:Number (2.0) c is Zero
      *            |- c4    : LCL.U:Number (2.0) d is Zero
      *            '-
      *            *IF
                   IF (YL0100 OF WORK-CONTEXT = 0 AND
                       YL0101 OF WORK-CONTEXT = 0 AND
                       YL0102 OF WORK-CONTEXT = 0 AND
                       YL0103 OF WORK-CONTEXT = 0) THEN
      *                Option Desc ATR 02
                       MOVE WN0103 TO YL0104 OF WORK-CONTEXT
      *                Rtn Inspect replacing - #String Functions  *
     ***-------------------------------------------------------------**
     ***   COBOL inspect replacing statement                         **
     ***                                                             **
     ***   System  . . . . . :   Renault UK utilties                 **
     ***   User source name  :   RAUINSRPLS                          **
     ***   Author  . . . . . :   Maurice Mead                        **
     ***   Date written  . . :   14/04/2009                          **
     ***   Request . . . . . :   RN-CHG-425505                       **
     ***                                                             **
     ***   See the SYNON/2 narrative text for full details and the   **
     ***     maintenance log.                                        **
     ***-------------------------------------------------------------**
           MOVE ZEROS   TO YL0105 OF WORK-CONTEXT
           INSPECT YL0104 OF WORK-CONTEXT
             TALLYING YL0105 OF WORK-CONTEXT
             FOR ALL ','
             REPLACING ALL ','
             BY ' '
      *.Rtn.Inspect.replacing.-.End.of.user.source.....................
      *                CASE: PAR.U:Vehicle All Options Dsc is *Not Blank
      *                *IF
                       IF (WN0050 NOT = ' ') THEN
                           MOVE ZEROS TO YRSW03
                           MOVE 'T' TO YRSW05
                           IF (WN0050 = SPACES AND
                               YRSW05 = 'T') THEN
                               ADD  1 TO ZEROS GIVING YRSW04
                           ELSE
                               ADD  1 TO 03000 GIVING YRSW04
                           END-IF
                           MOVE 03000 TO YRSW02
                           MOVE WN0050 TO YRSW06
                           PERFORM ZCATWK
                           STRING YRSW06 DELIMITED BY X'FF',
                                  ',' DELIMITED BY SIZE
                           INTO   YRSW06
                           MOVE YRSW06 TO WN0050
                       END-IF
                       MOVE ZEROS TO YRSW03
                       MOVE 'T' TO YRSW05
                       IF (WN0050 = SPACES AND
                           YRSW05 = 'T') THEN
                           ADD  1 TO ZEROS GIVING YRSW04
                       ELSE
                           ADD  1 TO 03000 GIVING YRSW04
                       END-IF
                       MOVE 03000 TO YRSW02
                       MOVE WN0050 TO YRSW06
                       PERFORM ZCATWK
                       STRING YRSW06 DELIMITED BY X'FF',
                              YL0104 OF WORK-CONTEXT DELIMITED BY SIZE
                       INTO   YRSW06
                       MOVE YRSW06 TO WN0050
                   END-IF
               END-IF
      *        Int Chk Option String Apn
      *        Append Description to Output string :
      *        CASE: PAR.Option Desc ATR 02 is Not Blank
      *        *IF
               IF (WN0105 NOT = ' ') THEN
      *            U:Number (2.0)
                   MOVE ZEROS TO YL0100 OF WORK-CONTEXT
      *            U:Number (2.0) b
                   MOVE ZEROS TO YL0101 OF WORK-CONTEXT
      *            U:Number (2.0) c
                   MOVE ZEROS TO YL0102 OF WORK-CONTEXT
      *            U:Number (2.0) d
                   MOVE ZEROS TO YL0103 OF WORK-CONTEXT
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0105
                TALLYING YL0100 OF WORK-CONTEXT
                FOR ALL 'Admin Code'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0105
                TALLYING YL0101 OF WORK-CONTEXT
                FOR ALL 'Admin only'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0105
                TALLYING YL0102 OF WORK-CONTEXT
                FOR ALL 'Admin code'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0105
                TALLYING YL0103 OF WORK-CONTEXT
                FOR ALL 'Battery Hire'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            CASE:
      *            - c1 AND c2 AND c3 AND c4
      *            |- c1    : LCL.U:Number (2.0) is Zero
      *            |- c2    : LCL.U:Number (2.0) b is Zero
      *            |- c3    : LCL.U:Number (2.0) c is Zero
      *            |- c4    : LCL.U:Number (2.0) d is Zero
      *            '-
      *            *IF
                   IF (YL0100 OF WORK-CONTEXT = 0 AND
                       YL0101 OF WORK-CONTEXT = 0 AND
                       YL0102 OF WORK-CONTEXT = 0 AND
                       YL0103 OF WORK-CONTEXT = 0) THEN
      *                Option Desc ATR 02
                       MOVE WN0105 TO YL0104 OF WORK-CONTEXT
      *                Rtn Inspect replacing - #String Functions  *
     ***-------------------------------------------------------------**
     ***   COBOL inspect replacing statement                         **
     ***                                                             **
     ***   System  . . . . . :   Renault UK utilties                 **
     ***   User source name  :   RAUINSRPLS                          **
     ***   Author  . . . . . :   Maurice Mead                        **
     ***   Date written  . . :   14/04/2009                          **
     ***   Request . . . . . :   RN-CHG-425505                       **
     ***                                                             **
     ***   See the SYNON/2 narrative text for full details and the   **
     ***     maintenance log.                                        **
     ***-------------------------------------------------------------**
           MOVE ZEROS   TO YL0105 OF WORK-CONTEXT
           INSPECT YL0104 OF WORK-CONTEXT
             TALLYING YL0105 OF WORK-CONTEXT
             FOR ALL ','
             REPLACING ALL ','
             BY ' '
      *.Rtn.Inspect.replacing.-.End.of.user.source.....................
      *                CASE: PAR.U:Vehicle All Options Dsc is *Not Blank
      *                *IF
                       IF (WN0050 NOT = ' ') THEN
                           MOVE ZEROS TO YRSW03
                           MOVE 'T' TO YRSW05
                           IF (WN0050 = SPACES AND
                               YRSW05 = 'T') THEN
                               ADD  1 TO ZEROS GIVING YRSW04
                           ELSE
                               ADD  1 TO 03000 GIVING YRSW04
                           END-IF
                           MOVE 03000 TO YRSW02
                           MOVE WN0050 TO YRSW06
                           PERFORM ZCATWK
                           STRING YRSW06 DELIMITED BY X'FF',
                                  ',' DELIMITED BY SIZE
                           INTO   YRSW06
                           MOVE YRSW06 TO WN0050
                       END-IF
                       MOVE ZEROS TO YRSW03
                       MOVE 'T' TO YRSW05
                       IF (WN0050 = SPACES AND
                           YRSW05 = 'T') THEN
                           ADD  1 TO ZEROS GIVING YRSW04
                       ELSE
                           ADD  1 TO 03000 GIVING YRSW04
                       END-IF
                       MOVE 03000 TO YRSW02
                       MOVE WN0050 TO YRSW06
                       PERFORM ZCATWK
                       STRING YRSW06 DELIMITED BY X'FF',
                              YL0104 OF WORK-CONTEXT DELIMITED BY SIZE
                       INTO   YRSW06
                       MOVE YRSW06 TO WN0050
                   END-IF
               END-IF
      *        Int Chk Option String Apn
      *        Append Description to Output string :
      *        CASE: PAR.Option Desc ATR 02 is Not Blank
      *        *IF
               IF (WN0107 NOT = ' ') THEN
      *            U:Number (2.0)
                   MOVE ZEROS TO YL0100 OF WORK-CONTEXT
      *            U:Number (2.0) b
                   MOVE ZEROS TO YL0101 OF WORK-CONTEXT
      *            U:Number (2.0) c
                   MOVE ZEROS TO YL0102 OF WORK-CONTEXT
      *            U:Number (2.0) d
                   MOVE ZEROS TO YL0103 OF WORK-CONTEXT
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0107
                TALLYING YL0100 OF WORK-CONTEXT
                FOR ALL 'Admin Code'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0107
                TALLYING YL0101 OF WORK-CONTEXT
                FOR ALL 'Admin only'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0107
                TALLYING YL0102 OF WORK-CONTEXT
                FOR ALL 'Admin code'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0107
                TALLYING YL0103 OF WORK-CONTEXT
                FOR ALL 'Battery Hire'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            CASE:
      *            - c1 AND c2 AND c3 AND c4
      *            |- c1    : LCL.U:Number (2.0) is Zero
      *            |- c2    : LCL.U:Number (2.0) b is Zero
      *            |- c3    : LCL.U:Number (2.0) c is Zero
      *            |- c4    : LCL.U:Number (2.0) d is Zero
      *            '-
      *            *IF
                   IF (YL0100 OF WORK-CONTEXT = 0 AND
                       YL0101 OF WORK-CONTEXT = 0 AND
                       YL0102 OF WORK-CONTEXT = 0 AND
                       YL0103 OF WORK-CONTEXT = 0) THEN
      *                Option Desc ATR 02
                       MOVE WN0107 TO YL0104 OF WORK-CONTEXT
      *                Rtn Inspect replacing - #String Functions  *
     ***-------------------------------------------------------------**
     ***   COBOL inspect replacing statement                         **
     ***                                                             **
     ***   System  . . . . . :   Renault UK utilties                 **
     ***   User source name  :   RAUINSRPLS                          **
     ***   Author  . . . . . :   Maurice Mead                        **
     ***   Date written  . . :   14/04/2009                          **
     ***   Request . . . . . :   RN-CHG-425505                       **
     ***                                                             **
     ***   See the SYNON/2 narrative text for full details and the   **
     ***     maintenance log.                                        **
     ***-------------------------------------------------------------**
           MOVE ZEROS   TO YL0105 OF WORK-CONTEXT
           INSPECT YL0104 OF WORK-CONTEXT
             TALLYING YL0105 OF WORK-CONTEXT
             FOR ALL ','
             REPLACING ALL ','
             BY ' '
      *.Rtn.Inspect.replacing.-.End.of.user.source.....................
      *                CASE: PAR.U:Vehicle All Options Dsc is *Not Blank
      *                *IF
                       IF (WN0050 NOT = ' ') THEN
                           MOVE ZEROS TO YRSW03
                           MOVE 'T' TO YRSW05
                           IF (WN0050 = SPACES AND
                               YRSW05 = 'T') THEN
                               ADD  1 TO ZEROS GIVING YRSW04
                           ELSE
                               ADD  1 TO 03000 GIVING YRSW04
                           END-IF
                           MOVE 03000 TO YRSW02
                           MOVE WN0050 TO YRSW06
                           PERFORM ZCATWK
                           STRING YRSW06 DELIMITED BY X'FF',
                                  ',' DELIMITED BY SIZE
                           INTO   YRSW06
                           MOVE YRSW06 TO WN0050
                       END-IF
                       MOVE ZEROS TO YRSW03
                       MOVE 'T' TO YRSW05
                       IF (WN0050 = SPACES AND
                           YRSW05 = 'T') THEN
                           ADD  1 TO ZEROS GIVING YRSW04
                       ELSE
                           ADD  1 TO 03000 GIVING YRSW04
                       END-IF
                       MOVE 03000 TO YRSW02
                       MOVE WN0050 TO YRSW06
                       PERFORM ZCATWK
                       STRING YRSW06 DELIMITED BY X'FF',
                              YL0104 OF WORK-CONTEXT DELIMITED BY SIZE
                       INTO   YRSW06
                       MOVE YRSW06 TO WN0050
                   END-IF
               END-IF
      *        Int Chk Option String Apn
      *        Append Description to Output string :
      *        CASE: PAR.Option Desc ATR 02 is Not Blank
      *        *IF
               IF (WN0109 NOT = ' ') THEN
      *            U:Number (2.0)
                   MOVE ZEROS TO YL0100 OF WORK-CONTEXT
      *            U:Number (2.0) b
                   MOVE ZEROS TO YL0101 OF WORK-CONTEXT
      *            U:Number (2.0) c
                   MOVE ZEROS TO YL0102 OF WORK-CONTEXT
      *            U:Number (2.0) d
                   MOVE ZEROS TO YL0103 OF WORK-CONTEXT
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0109
                TALLYING YL0100 OF WORK-CONTEXT
                FOR ALL 'Admin Code'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0109
                TALLYING YL0101 OF WORK-CONTEXT
                FOR ALL 'Admin only'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0109
                TALLYING YL0102 OF WORK-CONTEXT
                FOR ALL 'Admin code'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0109
                TALLYING YL0103 OF WORK-CONTEXT
                FOR ALL 'Battery Hire'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            CASE:
      *            - c1 AND c2 AND c3 AND c4
      *            |- c1    : LCL.U:Number (2.0) is Zero
      *            |- c2    : LCL.U:Number (2.0) b is Zero
      *            |- c3    : LCL.U:Number (2.0) c is Zero
      *            |- c4    : LCL.U:Number (2.0) d is Zero
      *            '-
      *            *IF
                   IF (YL0100 OF WORK-CONTEXT = 0 AND
                       YL0101 OF WORK-CONTEXT = 0 AND
                       YL0102 OF WORK-CONTEXT = 0 AND
                       YL0103 OF WORK-CONTEXT = 0) THEN
      *                Option Desc ATR 02
                       MOVE WN0109 TO YL0104 OF WORK-CONTEXT
      *                Rtn Inspect replacing - #String Functions  *
     ***-------------------------------------------------------------**
     ***   COBOL inspect replacing statement                         **
     ***                                                             **
     ***   System  . . . . . :   Renault UK utilties                 **
     ***   User source name  :   RAUINSRPLS                          **
     ***   Author  . . . . . :   Maurice Mead                        **
     ***   Date written  . . :   14/04/2009                          **
     ***   Request . . . . . :   RN-CHG-425505                       **
     ***                                                             **
     ***   See the SYNON/2 narrative text for full details and the   **
     ***     maintenance log.                                        **
     ***-------------------------------------------------------------**
           MOVE ZEROS   TO YL0105 OF WORK-CONTEXT
           INSPECT YL0104 OF WORK-CONTEXT
             TALLYING YL0105 OF WORK-CONTEXT
             FOR ALL ','
             REPLACING ALL ','
             BY ' '
      *.Rtn.Inspect.replacing.-.End.of.user.source.....................
      *                CASE: PAR.U:Vehicle All Options Dsc is *Not Blank
      *                *IF
                       IF (WN0050 NOT = ' ') THEN
                           MOVE ZEROS TO YRSW03
                           MOVE 'T' TO YRSW05
                           IF (WN0050 = SPACES AND
                               YRSW05 = 'T') THEN
                               ADD  1 TO ZEROS GIVING YRSW04
                           ELSE
                               ADD  1 TO 03000 GIVING YRSW04
                           END-IF
                           MOVE 03000 TO YRSW02
                           MOVE WN0050 TO YRSW06
                           PERFORM ZCATWK
                           STRING YRSW06 DELIMITED BY X'FF',
                                  ',' DELIMITED BY SIZE
                           INTO   YRSW06
                           MOVE YRSW06 TO WN0050
                       END-IF
                       MOVE ZEROS TO YRSW03
                       MOVE 'T' TO YRSW05
                       IF (WN0050 = SPACES AND
                           YRSW05 = 'T') THEN
                           ADD  1 TO ZEROS GIVING YRSW04
                       ELSE
                           ADD  1 TO 03000 GIVING YRSW04
                       END-IF
                       MOVE 03000 TO YRSW02
                       MOVE WN0050 TO YRSW06
                       PERFORM ZCATWK
                       STRING YRSW06 DELIMITED BY X'FF',
                              YL0104 OF WORK-CONTEXT DELIMITED BY SIZE
                       INTO   YRSW06
                       MOVE YRSW06 TO WN0050
                   END-IF
               END-IF
      *        Int Chk Option String Apn
      *        Append Description to Output string :
      *        CASE: PAR.Option Desc ATR 02 is Not Blank
      *        *IF
               IF (WN0111 NOT = ' ') THEN
      *            U:Number (2.0)
                   MOVE ZEROS TO YL0100 OF WORK-CONTEXT
      *            U:Number (2.0) b
                   MOVE ZEROS TO YL0101 OF WORK-CONTEXT
      *            U:Number (2.0) c
                   MOVE ZEROS TO YL0102 OF WORK-CONTEXT
      *            U:Number (2.0) d
                   MOVE ZEROS TO YL0103 OF WORK-CONTEXT
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0111
                TALLYING YL0100 OF WORK-CONTEXT
                FOR ALL 'Admin Code'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0111
                TALLYING YL0101 OF WORK-CONTEXT
                FOR ALL 'Admin only'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0111
                TALLYING YL0102 OF WORK-CONTEXT
                FOR ALL 'Admin code'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0111
                TALLYING YL0103 OF WORK-CONTEXT
                FOR ALL 'Battery Hire'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            CASE:
      *            - c1 AND c2 AND c3 AND c4
      *            |- c1    : LCL.U:Number (2.0) is Zero
      *            |- c2    : LCL.U:Number (2.0) b is Zero
      *            |- c3    : LCL.U:Number (2.0) c is Zero
      *            |- c4    : LCL.U:Number (2.0) d is Zero
      *            '-
      *            *IF
                   IF (YL0100 OF WORK-CONTEXT = 0 AND
                       YL0101 OF WORK-CONTEXT = 0 AND
                       YL0102 OF WORK-CONTEXT = 0 AND
                       YL0103 OF WORK-CONTEXT = 0) THEN
      *                Option Desc ATR 02
                       MOVE WN0111 TO YL0104 OF WORK-CONTEXT
      *                Rtn Inspect replacing - #String Functions  *
     ***-------------------------------------------------------------**
     ***   COBOL inspect replacing statement                         **
     ***                                                             **
     ***   System  . . . . . :   Renault UK utilties                 **
     ***   User source name  :   RAUINSRPLS                          **
     ***   Author  . . . . . :   Maurice Mead                        **
     ***   Date written  . . :   14/04/2009                          **
     ***   Request . . . . . :   RN-CHG-425505                       **
     ***                                                             **
     ***   See the SYNON/2 narrative text for full details and the   **
     ***     maintenance log.                                        **
     ***-------------------------------------------------------------**
           MOVE ZEROS   TO YL0105 OF WORK-CONTEXT
           INSPECT YL0104 OF WORK-CONTEXT
             TALLYING YL0105 OF WORK-CONTEXT
             FOR ALL ','
             REPLACING ALL ','
             BY ' '
      *.Rtn.Inspect.replacing.-.End.of.user.source.....................
      *                CASE: PAR.U:Vehicle All Options Dsc is *Not Blank
      *                *IF
                       IF (WN0050 NOT = ' ') THEN
                           MOVE ZEROS TO YRSW03
                           MOVE 'T' TO YRSW05
                           IF (WN0050 = SPACES AND
                               YRSW05 = 'T') THEN
                               ADD  1 TO ZEROS GIVING YRSW04
                           ELSE
                               ADD  1 TO 03000 GIVING YRSW04
                           END-IF
                           MOVE 03000 TO YRSW02
                           MOVE WN0050 TO YRSW06
                           PERFORM ZCATWK
                           STRING YRSW06 DELIMITED BY X'FF',
                                  ',' DELIMITED BY SIZE
                           INTO   YRSW06
                           MOVE YRSW06 TO WN0050
                       END-IF
                       MOVE ZEROS TO YRSW03
                       MOVE 'T' TO YRSW05
                       IF (WN0050 = SPACES AND
                           YRSW05 = 'T') THEN
                           ADD  1 TO ZEROS GIVING YRSW04
                       ELSE
                           ADD  1 TO 03000 GIVING YRSW04
                       END-IF
                       MOVE 03000 TO YRSW02
                       MOVE WN0050 TO YRSW06
                       PERFORM ZCATWK
                       STRING YRSW06 DELIMITED BY X'FF',
                              YL0104 OF WORK-CONTEXT DELIMITED BY SIZE
                       INTO   YRSW06
                       MOVE YRSW06 TO WN0050
                   END-IF
               END-IF
      *        Int Chk Option String Apn
      *        Append Description to Output string :
      *        CASE: PAR.Option Desc ATR 02 is Not Blank
      *        *IF
               IF (WN0113 NOT = ' ') THEN
      *            U:Number (2.0)
                   MOVE ZEROS TO YL0100 OF WORK-CONTEXT
      *            U:Number (2.0) b
                   MOVE ZEROS TO YL0101 OF WORK-CONTEXT
      *            U:Number (2.0) c
                   MOVE ZEROS TO YL0102 OF WORK-CONTEXT
      *            U:Number (2.0) d
                   MOVE ZEROS TO YL0103 OF WORK-CONTEXT
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0113
                TALLYING YL0100 OF WORK-CONTEXT
                FOR ALL 'Admin Code'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0113
                TALLYING YL0101 OF WORK-CONTEXT
                FOR ALL 'Admin only'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0113
                TALLYING YL0102 OF WORK-CONTEXT
                FOR ALL 'Admin code'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0113
                TALLYING YL0103 OF WORK-CONTEXT
                FOR ALL 'Battery Hire'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            CASE:
      *            - c1 AND c2 AND c3 AND c4
      *            |- c1    : LCL.U:Number (2.0) is Zero
      *            |- c2    : LCL.U:Number (2.0) b is Zero
      *            |- c3    : LCL.U:Number (2.0) c is Zero
      *            |- c4    : LCL.U:Number (2.0) d is Zero
      *            '-
      *            *IF
                   IF (YL0100 OF WORK-CONTEXT = 0 AND
                       YL0101 OF WORK-CONTEXT = 0 AND
                       YL0102 OF WORK-CONTEXT = 0 AND
                       YL0103 OF WORK-CONTEXT = 0) THEN
      *                Option Desc ATR 02
                       MOVE WN0113 TO YL0104 OF WORK-CONTEXT
      *                Rtn Inspect replacing - #String Functions  *
     ***-------------------------------------------------------------**
     ***   COBOL inspect replacing statement                         **
     ***                                                             **
     ***   System  . . . . . :   Renault UK utilties                 **
     ***   User source name  :   RAUINSRPLS                          **
     ***   Author  . . . . . :   Maurice Mead                        **
     ***   Date written  . . :   14/04/2009                          **
     ***   Request . . . . . :   RN-CHG-425505                       **
     ***                                                             **
     ***   See the SYNON/2 narrative text for full details and the   **
     ***     maintenance log.                                        **
     ***-------------------------------------------------------------**
           MOVE ZEROS   TO YL0105 OF WORK-CONTEXT
           INSPECT YL0104 OF WORK-CONTEXT
             TALLYING YL0105 OF WORK-CONTEXT
             FOR ALL ','
             REPLACING ALL ','
             BY ' '
      *.Rtn.Inspect.replacing.-.End.of.user.source.....................
      *                CASE: PAR.U:Vehicle All Options Dsc is *Not Blank
      *                *IF
                       IF (WN0050 NOT = ' ') THEN
                           MOVE ZEROS TO YRSW03
                           MOVE 'T' TO YRSW05
                           IF (WN0050 = SPACES AND
                               YRSW05 = 'T') THEN
                               ADD  1 TO ZEROS GIVING YRSW04
                           ELSE
                               ADD  1 TO 03000 GIVING YRSW04
                           END-IF
                           MOVE 03000 TO YRSW02
                           MOVE WN0050 TO YRSW06
                           PERFORM ZCATWK
                           STRING YRSW06 DELIMITED BY X'FF',
                                  ',' DELIMITED BY SIZE
                           INTO   YRSW06
                           MOVE YRSW06 TO WN0050
                       END-IF
                       MOVE ZEROS TO YRSW03
                       MOVE 'T' TO YRSW05
                       IF (WN0050 = SPACES AND
                           YRSW05 = 'T') THEN
                           ADD  1 TO ZEROS GIVING YRSW04
                       ELSE
                           ADD  1 TO 03000 GIVING YRSW04
                       END-IF
                       MOVE 03000 TO YRSW02
                       MOVE WN0050 TO YRSW06
                       PERFORM ZCATWK
                       STRING YRSW06 DELIMITED BY X'FF',
                              YL0104 OF WORK-CONTEXT DELIMITED BY SIZE
                       INTO   YRSW06
                       MOVE YRSW06 TO WN0050
                   END-IF
               END-IF
      *        Int Chk Option String Apn
      *        Append Description to Output string :
      *        CASE: PAR.Option Desc ATR 02 is Not Blank
      *        *IF
               IF (WN0115 NOT = ' ') THEN
      *            U:Number (2.0)
                   MOVE ZEROS TO YL0100 OF WORK-CONTEXT
      *            U:Number (2.0) b
                   MOVE ZEROS TO YL0101 OF WORK-CONTEXT
      *            U:Number (2.0) c
                   MOVE ZEROS TO YL0102 OF WORK-CONTEXT
      *            U:Number (2.0) d
                   MOVE ZEROS TO YL0103 OF WORK-CONTEXT
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0115
                TALLYING YL0100 OF WORK-CONTEXT
                FOR ALL 'Admin Code'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0115
                TALLYING YL0101 OF WORK-CONTEXT
                FOR ALL 'Admin only'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0115
                TALLYING YL0102 OF WORK-CONTEXT
                FOR ALL 'Admin code'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            Find string in a string - #String Functions  *
      ************* START OF USER SOURCE UTLINSTRGS ********************
      ** Function   : Return length of a string.
      ** System     : Renault Applications
      ** Programmer : Hamid Ghaffari
      ** Date       : 18/02/04
      *::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      *.Start.of.User.source.interface..................................
           INSPECT WN0115
                TALLYING YL0103 OF WORK-CONTEXT
                FOR ALL 'Battery Hire'
      *************   END OF USER SOURCE UTLINSTRGS ********************
      *            CASE:
      *            - c1 AND c2 AND c3 AND c4
      *            |- c1    : LCL.U:Number (2.0) is Zero
      *            |- c2    : LCL.U:Number (2.0) b is Zero
      *            |- c3    : LCL.U:Number (2.0) c is Zero
      *            |- c4    : LCL.U:Number (2.0) d is Zero
      *            '-
      *            *IF
                   IF (YL0100 OF WORK-CONTEXT = 0 AND
                       YL0101 OF WORK-CONTEXT = 0 AND
                       YL0102 OF WORK-CONTEXT = 0 AND
                       YL0103 OF WORK-CONTEXT = 0) THEN
      *                Option Desc ATR 02
                       MOVE WN0115 TO YL0104 OF WORK-CONTEXT
      *                Rtn Inspect replacing - #String Functions  *
     ***-------------------------------------------------------------**
     ***   COBOL inspect replacing statement                         **
     ***                                                             **
     ***   System  . . . . . :   Renault UK utilties                 **
     ***   User source name  :   RAUINSRPLS                          **
     ***   Author  . . . . . :   Maurice Mead                        **
     ***   Date written  . . :   14/04/2009                          **
     ***   Request . . . . . :   RN-CHG-425505                       **
     ***                                                             **
     ***   See the SYNON/2 narrative text for full details and the   **
     ***     maintenance log.                                        **
     ***-------------------------------------------------------------**
           MOVE ZEROS   TO YL0105 OF WORK-CONTEXT
           INSPECT YL0104 OF WORK-CONTEXT
             TALLYING YL0105 OF WORK-CONTEXT
             FOR ALL ','
             REPLACING ALL ','
             BY ' '
      *.Rtn.Inspect.replacing.-.End.of.user.source.....................
      *                CASE: PAR.U:Vehicle All Options Dsc is *Not Blank
      *                *IF
                       IF (WN0050 NOT = ' ') THEN
                           MOVE ZEROS TO YRSW03
                           MOVE 'T' TO YRSW05
                           IF (WN0050 = SPACES AND
                               YRSW05 = 'T') THEN
                               ADD  1 TO ZEROS GIVING YRSW04
                           ELSE
                               ADD  1 TO 03000 GIVING YRSW04
                           END-IF
                           MOVE 03000 TO YRSW02
                           MOVE WN0050 TO YRSW06
                           PERFORM ZCATWK
                           STRING YRSW06 DELIMITED BY X'FF',
                                  ',' DELIMITED BY SIZE
                           INTO   YRSW06
                           MOVE YRSW06 TO WN0050
                       END-IF
                       MOVE ZEROS TO YRSW03
                       MOVE 'T' TO YRSW05
                       IF (WN0050 = SPACES AND
                           YRSW05 = 'T') THEN
                           ADD  1 TO ZEROS GIVING YRSW04
                       ELSE
                           ADD  1 TO 03000 GIVING YRSW04
                       END-IF
                       MOVE 03000 TO YRSW02
                       MOVE WN0050 TO YRSW06
                       PERFORM ZCATWK
                       STRING YRSW06 DELIMITED BY X'FF',
                              YL0104 OF WORK-CONTEXT DELIMITED BY SIZE
                       INTO   YRSW06
                       MOVE YRSW06 TO WN0050
                   END-IF
               END-IF
           END-IF
      *    Set Sedre Status
      *    CASE:
      *    - c1 AND c2 AND c3
      *    |- c1    : DB1.TCM Date 07 is GT *Zero
      *    |- c2    : DB1.PEC/MADC Date 10 is GT Zero
      *    |- c3    : DB1.Arrival at Dock Date 28 is EQ Zero
      *    '-
      *    *IF
           IF (J6TCMDT07 OF FVEHDF2 OF VAVEHDTALE-R > 0 AND
               J6PECDT10 OF FVEHDF2 OF VAVEHDTALE-R > 0 AND
               J6DOCDT28 OF FVEHDF2 OF VAVEHDTALE-R = 0) THEN
      *        Sedre Vehicle Status
               MOVE '3' TO WN0033
           ELSE
      *        CASE:
      *        - c1 AND c2 AND c3 AND c4
      *        |- c1    : DB1.TCM Date 07 is GT *Zero
      *        |- c2    : DB1.PEC/MADC Date 10 is GT Zero
      *        |- c3    : DB1.Arrival at Dock Date 28 is GT Zero
      *        |- c4    : DB1.Exit Import Centre Dte 45 is Zero
      *        '-
      *        *IF
               IF (J6TCMDT07 OF FVEHDF2 OF VAVEHDTALE-R > 0 AND
                   J6PECDT10 OF FVEHDF2 OF VAVEHDTALE-R > 0 AND
                   J6DOCDT28 OF FVEHDF2 OF VAVEHDTALE-R > 0 AND
                   J6EXICDT45 OF FVEHDF2 OF VAVEHDTALE-R = 0) THEN
      *            Sedre Vehicle Status
                   MOVE '4' TO WN0033
               ELSE
      *            CASE:
      *            - c1 AND c2 AND c3 AND c4 AND c5
      *            |- c1    : DB1.TCM Date 07 is GT *Zero
      *            |- c2    : DB1.PEC/MADC Date 10 is GT Zero
      *            |- c3    : DB1.Arrival at Dock Date 28 is GT Zero
      *            |- c4    : DB1.Exit Import Centre Dte 45 is GT Zero
      *            |- c5    : DB1.Registration Date 58 is Zero
      *            '-
      *            *IF
                   IF (J6TCMDT07 OF FVEHDF2 OF VAVEHDTALE-R > 0 AND
                       J6PECDT10 OF FVEHDF2 OF VAVEHDTALE-R > 0 AND
                       J6DOCDT28 OF FVEHDF2 OF VAVEHDTALE-R > 0 AND
                       J6EXICDT45 OF FVEHDF2 OF VAVEHDTALE-R > 0 AND
                       J6REGDT58 OF FVEHDF2 OF VAVEHDTALE-R = 0) THEN
      *                Sedre Vehicle Status
                       MOVE '5' TO WN0033
                   ELSE
      *                CASE: *OTHERWISE
      *                Sedre Vehicle Status
                       MOVE ' ' TO WN0033
                   END-IF
               END-IF
           END-IF
      *    PAR.Sedre Vehicle Status Dsc = Condition name of PAR.Sedre
      *      Vehicle Status
           MOVE 1305432 TO Y2LSTN
           MOVE WN0033 TO W0INVL
           MOVE ' ' TO W0VLMP
           CALL 'JSRVC2R' USING
      *    Return code
             W0RTN
      *    List number
             Y2LSTN
      *    Sedre Vehicle Status
             W0INVL
      *    Value mapped
             W0VLMP
      *    Sedre Vehicle Status Dsc
             W0CNNM
           END-CALL
           MOVE W0CNNM TO WN0034
      *
      *    Error on program call will terminate run unit
      *
      *    Set Extract Status
      *    CASE:
      *    - c1 OR c2
      *    |- c1    : PAR.Sedre Vehicle Status is ATIC
      *    |- c2    : PAR.Sedre Vehicle Status is DELIVERED
      *    '-
      *    *IF
           IF (WN0033 = '4' OR
               WN0033 = '5') THEN
      *        Record Processed Status
               MOVE '5' TO WN0054
           ELSE
      *        CASE: *OTHERWISE
      *        Record Processed Status
               MOVE 'X' TO WN0054
           END-IF
      *    Ext Rtv C.Ord and C.Alloc - #Foreign model access  *
      *    Clear array PDRC
           INITIALIZE PDRC
      *    CA Owning Account
           MOVE YL0106 OF WORK-CONTEXT TO PDCAOWNACC
      *    CA Customer Ord Number
           MOVE YL0107 OF WORK-CONTEXT TO PDCACUSORN
      *    CA Invariant BCV
           MOVE YL0108 OF WORK-CONTEXT TO PDCAINVBCV
      *    CA VIN
           MOVE YL0110 OF WORK-CONTEXT TO PDCAVIN
      *    Clear array PERC
           INITIALIZE PERC
      *
           SET C-INDICATOR-OFF(90) TO TRUE
           MOVE SPACES TO WQ0082
           MOVE '4' TO WQ0083
           MOVE YL0084 OF WORK-CONTEXT TO WQ0084
           MOVE SPACES TO WQ0085
      *
           CALL 'COG000600S' USING
      *    *Return code
             WQ0082
      *    Retrieve by
             WQ0083
      *    Vehicle Chassis No
             WQ0084
      *    RCD : STR Customer Order Alloc
             PDRC
      *    RCD : STR Customer Order
             PERC
      *    Cust Ord Alloc Exists
             WQ0085
                    ON OVERFLOW
                    SET C-INDICATOR-ON(90) TO TRUE
           END-CALL
      *
           MOVE WQ0082 TO W0RTN
           MOVE WQ0085 TO YL0124 OF WORK-CONTEXT
      *
      *    CA Owning Account
           MOVE PDCAOWNACC TO YL0106 OF WORK-CONTEXT
      *    CA Customer Ord Number
           MOVE PDCACUSORN TO YL0107 OF WORK-CONTEXT
      *    CA Invariant BCV
           MOVE PDCAINVBCV TO YL0108 OF WORK-CONTEXT
      *    CA Order Allocation SeqNb
           MOVE PDCAORALSQ TO YL0109 OF WORK-CONTEXT
      *    CA VIN
           MOVE PDCAVIN TO YL0110 OF WORK-CONTEXT
      *    CA Order Type code
           MOVE PDCAORTPCD TO YL0111 OF WORK-CONTEXT
      *    CA Order Type(Central)
           MOVE PDCAORTPCN TO YL0112 OF WORK-CONTEXT
      *    CA Order Type(Local)
           MOVE PDCAORTPLO TO YL0113 OF WORK-CONTEXT
      *    CA SEDRE Customer Type
           MOVE PDCACSTTYP TO YL0114 OF WORK-CONTEXT
      *    CA Cus Ord Allocation Dte
           MOVE PDCAORALDT TO YL0115 OF WORK-CONTEXT
      *    CA Cus Ord Dealloc Dte
           MOVE PDCAORDLDT TO YL0116 OF WORK-CONTEXT
      *    CA Dealer Order Cancel Da
           MOVE PDCADLORCD TO YL0117 OF WORK-CONTEXT
      *    CA Cust Order Alloc Sts
           MOVE PDCACOALST TO YL0118 OF WORK-CONTEXT
      *    CO Customer Order Date #
           MOVE PECOCORDD8 TO YL0119 OF WORK-CONTEXT
      *    CO Sales Channel
           MOVE PECOSLSCNL TO YL0120 OF WORK-CONTEXT
      *    CO Cust Desired Deliv Dte
           MOVE PECOCUDDDT TO YL0121 OF WORK-CONTEXT
      *    CO Order Cancelled Date
           MOVE PECOORCNDT TO YL0122 OF WORK-CONTEXT
      *    CO Order Cancellation Rsn
           MOVE PECOORCNRS TO YL0123 OF WORK-CONTEXT
      *
      *    Error on program call will terminate run unit
           IF (C-INDICATOR-ON(90)) THEN
               MOVE 'Y2U0032' TO W0RTN
               MOVE 'COG000600S' TO W0CLPG
      *        Send message '*Error occured on CALL...'
      *        Message ID
               MOVE 'Y2U0032' TO ZAMSID
      *        Message file
               MOVE 'Y2USRMSG' TO ZAMSGF
      *        Message data
               MOVE W0CLPG TO ZAMSDA
               PERFORM ZASNMS
               SET C-INDICATOR-ON(99) TO TRUE
           END-IF
      *    Customer Order Number
           MOVE YL0107 OF WORK-CONTEXT TO WN0035
      *    Customer Order Date #
           MOVE YL0119 OF WORK-CONTEXT TO WN0036
      *    Cust Allocation Date
           MOVE YL0115 OF WORK-CONTEXT TO WN0037
      *    SEDRE customer type
           MOVE YL0114 OF WORK-CONTEXT TO WN0038
      *    Order Type Central
           MOVE YL0112 OF WORK-CONTEXT TO WN0039
      *    SD Sales Channel Code ATR
           MOVE YL0120 OF WORK-CONTEXT TO WN0040
      *    For Records Pass Test for Sending - Check Allocated
      *      Customer Order ?
      *    CASE: PAR.Record Processed Status is Processed Ready To Send
      *    *IF
           IF (WN0054 = '5') THEN
      *        Block from Extract if Vehicle Allocated to Customer Order
      *        CASE:
      *        - c1 OR c2
      *        |- c1    : PAR.SD Sales Channel Code ATR is *Blank
      *        |- c2    : PAR.SD Sales Channel Code ATR is Dealer Own
      *          Sale Channels
      *        '-
      *        *IF
               IF (WN0040 = ' ' OR
                   WN0040 NOT < '3A' AND
                   WN0040 NOT > '3G') THEN
                   CONTINUE
               ELSE
      *            CASE: *OTHERWISE
      *            Record Processed Status
                   MOVE 'X' TO WN0054
               END-IF
           END-IF
      *    For Records Pass Test for Sending - Check Dealer Type
      *    CASE: PAR.Record Processed Status is Processed Ready To Send
      *    *IF
           IF (WN0054 = '5') THEN
      *        Block from Extract if Vehicle Belong to to Internal
      *          Account
      *        CASE: LCL.Dealer Network Type is Internal
      *        *IF
               IF (YL0088 OF WORK-CONTEXT = 'N') THEN
      *            Record Processed Status
                   MOVE 'X' TO WN0054
               ELSE
      *            CASE: *OTHERWISE
                   CONTINUE
               END-IF
           END-IF
      *    Run Mode 1 - All Vehicle Override - Send All - All Means All
      *    CASE: PAR.U:Run Mode is 1 - All Vehicles
      *    *IF
           IF (P3URUNMODE = '1') THEN
      *        Record Processed Status
               MOVE '5' TO WN0054
           END-IF
      *    CASE: PAR.U:Display yes/no 1 is Y
      *    *IF
           IF (P2UDSPYN1 = 'Y') THEN
      *        Rtn Price Retail
      *        PAR = CON By name
      *        List price
               MOVE ZEROS TO YL0125 OF WORK-CONTEXT
      *        Version price
               MOVE ZEROS TO YL0126 OF WORK-CONTEXT
      *        Delivery price
               MOVE ZEROS TO YL0127 OF WORK-CONTEXT
      *        Color price
               MOVE ZEROS TO YL0128 OF WORK-CONTEXT
      *        Accessories
               MOVE ZEROS TO YL0129 OF WORK-CONTEXT
      *        Options price     0060545
               MOVE ZEROS TO YL0130 OF WORK-CONTEXT
      *        Rtv Vehicle by VIN - Vehicle  *
               PERFORM SB2RVGN
      *        Ext Rtv Veh Model Version - #Foreign model access  *
      *        Clear array PBRC
               INITIALIZE PBRC
      *        SCP Model code
               MOVE YL0131 OF WORK-CONTEXT TO PBSCMDLCDE
      *        Phase
               MOVE YL0139 OF WORK-CONTEXT TO PBO2ST
      *        SCP Model Version Code
               MOVE YL0132 OF WORK-CONTEXT TO PBSCVERCDE
      *
               SET C-INDICATOR-OFF(90) TO TRUE
               MOVE SPACES TO WQ0086
      *
               CALL 'VAG005000S' USING
      *        *Return code
                 WQ0086
      *        RCD : *Arrays
                 PBRC
                        ON OVERFLOW
                        SET C-INDICATOR-ON(90) TO TRUE
               END-CALL
      *
               MOVE WQ0086 TO W0RTN
      *
      *        V55 Model Version Desc
               MOVE PBVERV55DS TO YL0143 OF WORK-CONTEXT
      *
      *        Error on program call will terminate run unit
               IF (C-INDICATOR-ON(90)) THEN
                   MOVE 'Y2U0032' TO W0RTN
                   MOVE 'VAG005000S' TO W0CLPG
      *            Send message '*Error occured on CALL...'
      *            Message ID
                   MOVE 'Y2U0032' TO ZAMSID
      *            Message file
                   MOVE 'Y2USRMSG' TO ZAMSGF
      *            Message data
                   MOVE W0CLPG TO ZAMSDA
                   PERFORM ZASNMS
                   SET C-INDICATOR-ON(99) TO TRUE
               END-IF
      *        Exc Rtv Vehicle Colour - #Foreign model access  *
               SET C-INDICATOR-OFF(90) TO TRUE
               MOVE SPACES TO WQ0087
               MOVE YL0133 OF WORK-CONTEXT TO WQ0088
               MOVE SPACES TO WQ0089
               MOVE SPACES TO WQ0090
               MOVE SPACES TO WQ0091
               MOVE SPACES TO WQ0092
               MOVE SPACES TO WQ0093
               MOVE SPACES TO WQ0094
               MOVE SPACES TO WQ0095
      *
               CALL 'VAG004000S' USING
      *        *Return code
                 WQ0087
      *        Colour Code
                 WQ0088
      *        Colour Marketing Desc
                 WQ0089
      *        Colour Type Code
                 WQ0090
      *        Vehicle MVRIS Colour Code
                 WQ0091
      *        Vehicle MVRIS Colour Cde2
                 WQ0092
      *        Vehicle MVRIS Colour Cde3
                 WQ0093
      *        Colour Type Category Code
                 WQ0094
      *        Vehicle Database Rec Sts
                 WQ0095
                        ON OVERFLOW
                        SET C-INDICATOR-ON(90) TO TRUE
               END-CALL
      *
               MOVE WQ0087 TO W0RTN
               MOVE WQ0089 TO YL0144 OF WORK-CONTEXT
      *
      *        Error on program call will terminate run unit
               IF (C-INDICATOR-ON(90)) THEN
                   MOVE 'Y2U0032' TO W0RTN
                   MOVE 'VAG004000S' TO W0CLPG
      *            Send message '*Error occured on CALL...'
      *            Message ID
                   MOVE 'Y2U0032' TO ZAMSID
      *            Message file
                   MOVE 'Y2USRMSG' TO ZAMSGF
      *            Message data
                   MOVE W0CLPG TO ZAMSDA
                   PERFORM ZASNMS
                   SET C-INDICATOR-ON(99) TO TRUE
               END-IF
      *        Ext Price Routine - Retl - AOC Price list  *
      *        Clear array PFRC
               INITIALIZE PFRC
      *
               SET C-INDICATOR-OFF(90) TO TRUE
               MOVE YL0002 OF WORK-CONTEXT TO WQ0096
               MOVE J6VIN OF FVEHDF2 OF VAVEHDTALE-R TO WQ0097
               MOVE ZEROS TO WQ0098
               MOVE ZEROS TO WQ0099
               MOVE ZEROS TO WQ0100
               MOVE ZEROS TO WQ0101
               MOVE ZEROS TO WQ0102
               MOVE ZEROS TO WQ0103
               MOVE ZEROS TO WQ0104
               MOVE ZEROS TO WQ0105
               MOVE ZEROS TO WQ0106
               MOVE ZEROS TO WQ0107
               MOVE ZEROS TO WQ0108
               MOVE ZEROS TO WQ0109
               MOVE ZEROS TO WQ0110
               MOVE ZEROS TO WQ0111
               MOVE ZEROS TO WQ0112
               MOVE ZEROS TO WQ0113
               MOVE ZEROS TO WQ0114
               MOVE ZEROS TO WQ0115
               MOVE ZEROS TO WQ0116
               MOVE ZEROS TO WQ0117
      *
               CALL 'RAA001000S' USING
      *        Return code
                 W0RTN
      *        Price Effective Date
                 WQ0096
      *        VIN
                 WQ0097
      *        NV Basic Selling Price
                 WQ0098
      *        NV Colour Price
                 WQ0099
      *        NV Upholstery Price
                 WQ0100
      *        NV Options Total Price
                 WQ0101
      *        NV Sub-total 1
                 WQ0102
      *        NV Dealer Margin
                 WQ0103
      *        NV Sub-total 2
                 WQ0104
      *        NV Other Vatable Charges
                 WQ0105
      *        NV Sub-total 3
                 WQ0106
      *        NV Accessory Retail Tot
                 WQ0107
      *        NV Accessory Discount Tot
                 WQ0108
      *        NV Accessory Net Total
                 WQ0109
      *        NV Sub-Total 4
                 WQ0110
      *        NV Other Vatable Discount
                 WQ0111
      *        NV Sub-Total 5
                 WQ0112
      *        NV VAT Amount
                 WQ0113
      *        NV Non-vatable Charges
                 WQ0114
      *        NV Non-vatable Discount
                 WQ0115
      *        NV Total Amount
                 WQ0116
      *        RCD : *Arrays
                 PFRC
      *        Options Total Margin
                 WQ0117
                        ON OVERFLOW
                        SET C-INDICATOR-ON(90) TO TRUE
               END-CALL
      *
               MOVE WQ0098 TO YL0145 OF WORK-CONTEXT
               MOVE WQ0099 TO YL0146 OF WORK-CONTEXT
               MOVE WQ0100 TO YL0147 OF WORK-CONTEXT
               MOVE WQ0101 TO YL0148 OF WORK-CONTEXT
               MOVE WQ0102 TO YL0149 OF WORK-CONTEXT
               MOVE WQ0103 TO YL0150 OF WORK-CONTEXT
               MOVE WQ0104 TO YL0151 OF WORK-CONTEXT
               MOVE WQ0105 TO YL0152 OF WORK-CONTEXT
               MOVE WQ0106 TO YL0153 OF WORK-CONTEXT
               MOVE WQ0107 TO YL0154 OF WORK-CONTEXT
               MOVE WQ0109 TO YL0155 OF WORK-CONTEXT
               MOVE WQ0110 TO YL0156 OF WORK-CONTEXT
               MOVE WQ0111 TO YL0157 OF WORK-CONTEXT
               MOVE WQ0112 TO YL0158 OF WORK-CONTEXT
               MOVE WQ0113 TO YL0159 OF WORK-CONTEXT
               MOVE WQ0116 TO YL0160 OF WORK-CONTEXT
               MOVE WQ0117 TO YL0258 OF WORK-CONTEXT
      *
      *        VP Option Price 1
               MOVE PFVPOPTP1 TO YL0161 OF WORK-CONTEXT
      *        VP Option Price 2
               MOVE PFVPOPTP2 TO YL0162 OF WORK-CONTEXT
      *        VP Option Price 3
               MOVE PFVPOPTP3 TO YL0163 OF WORK-CONTEXT
      *        VP Option Price 4
               MOVE PFVPOPTP4 TO YL0164 OF WORK-CONTEXT
      *        VP Option Price 5
               MOVE PFVPOPTP5 TO YL0165 OF WORK-CONTEXT
      *        VP Option Price 6
               MOVE PFVPOPTP6 TO YL0166 OF WORK-CONTEXT
      *        VP Option Price 7
               MOVE PFVPOPTP7 TO YL0167 OF WORK-CONTEXT
      *        VP Option Price 8
               MOVE PFVPOPTP8 TO YL0168 OF WORK-CONTEXT
      *        VP Option Price 9
               MOVE PFVPOPTP9 TO YL0169 OF WORK-CONTEXT
      *        VP Option Price 10
               MOVE PFVPOPTP10 TO YL0170 OF WORK-CONTEXT
      *        VP Option Price 11
               MOVE PFVPOPTP11 TO YL0171 OF WORK-CONTEXT
      *        VP Option Price 12
               MOVE PFVPOPTP12 TO YL0172 OF WORK-CONTEXT
      *        VP Option Price 13
               MOVE PFVPOPTP13 TO YL0173 OF WORK-CONTEXT
      *        VP Option Price 14
               MOVE PFVPOPTP14 TO YL0174 OF WORK-CONTEXT
      *        VP Option Price 15
               MOVE PFVPOPTP15 TO YL0175 OF WORK-CONTEXT
      *        VP Option Price 16
               MOVE PFVPOPTP16 TO YL0176 OF WORK-CONTEXT
      *        VP Option Price 17
               MOVE PFVPOPTP17 TO YL0177 OF WORK-CONTEXT
      *        VP Option Price 18
               MOVE PFVPOPTP18 TO YL0178 OF WORK-CONTEXT
      *        VP Option Price 19
               MOVE PFVPOPTP19 TO YL0179 OF WORK-CONTEXT
      *        VP Option Price 20
               MOVE PFVPOPTP20 TO YL0180 OF WORK-CONTEXT
      *        VP Option Price 21
               MOVE PFVPOPTP21 TO YL0181 OF WORK-CONTEXT
      *        VP Option Price 22
               MOVE PFVPOPTP22 TO YL0182 OF WORK-CONTEXT
      *        VP Option Price 23
               MOVE PFVPOPTP23 TO YL0183 OF WORK-CONTEXT
      *        VP Option Price 24
               MOVE PFVPOPTP24 TO YL0184 OF WORK-CONTEXT
      *        VP Option Price 25
               MOVE PFVPOPTP25 TO YL0185 OF WORK-CONTEXT
      *        VP Option Price 26
               MOVE PFVPOPTP26 TO YL0186 OF WORK-CONTEXT
      *        VP Option Price 27
               MOVE PFVPOPTP27 TO YL0187 OF WORK-CONTEXT
      *        VP Option Price 28
               MOVE PFVPOPTP28 TO YL0188 OF WORK-CONTEXT
      *        VP Option Price 29
               MOVE PFVPOPTP29 TO YL0189 OF WORK-CONTEXT
      *        VP Option Price 30
               MOVE PFVPOPTP30 TO YL0190 OF WORK-CONTEXT
      *        Vehicle Margin Value
               MOVE PFVEHMARGN TO YL0191 OF WORK-CONTEXT
      *        VP Option Margin 1
               MOVE PFVPOPM1 TO YL0192 OF WORK-CONTEXT
      *        VP Option Margin 2
               MOVE PFVPOPM2 TO YL0193 OF WORK-CONTEXT
      *        VP Option Margin 3
               MOVE PFVPOPM3 TO YL0194 OF WORK-CONTEXT
      *        VP Option Margin 4
               MOVE PFVPOPTMG TO YL0195 OF WORK-CONTEXT
      *        VP Option Margin 5
               MOVE PFVPOPTM5 TO YL0196 OF WORK-CONTEXT
      *        VP Option Margin 6
               MOVE PFVPOPTM6 TO YL0197 OF WORK-CONTEXT
      *        VP Option Margin 7
               MOVE PFVPOPTM7 TO YL0198 OF WORK-CONTEXT
      *        VP Option Margin 8
               MOVE PFVPOPTM8 TO YL0199 OF WORK-CONTEXT
      *        VP Option Margin 9
               MOVE PFVPOPTM9 TO YL0200 OF WORK-CONTEXT
      *        VP Option Margin 10
               MOVE PFVPOPTM10 TO YL0201 OF WORK-CONTEXT
      *        VP Option Margin 11
               MOVE PFVPOPTM11 TO YL0202 OF WORK-CONTEXT
      *        VP Option Margin 12
               MOVE PFVPOPTM12 TO YL0203 OF WORK-CONTEXT
      *        VP Option Margin 13
               MOVE PFVPOPTM13 TO YL0204 OF WORK-CONTEXT
      *        VP Option Margin 14
               MOVE PFVPOPTM14 TO YL0205 OF WORK-CONTEXT
      *        VP Option Margin 15
               MOVE PFVPOPTM15 TO YL0206 OF WORK-CONTEXT
      *        VP Option Margin 16
               MOVE PFVPOPTM16 TO YL0207 OF WORK-CONTEXT
      *        VP Option Margin 17
               MOVE PFVPOPTM17 TO YL0208 OF WORK-CONTEXT
      *        VP Option Margin 18
               MOVE PFVPOPTM18 TO YL0209 OF WORK-CONTEXT
      *        VP Option Margin 19
               MOVE PFVPOPTM19 TO YL0210 OF WORK-CONTEXT
      *        VP Option Margin 20
               MOVE PFVPOPTM20 TO YL0211 OF WORK-CONTEXT
      *        VP Option Margin 21
               MOVE PFVPOPTM21 TO YL0212 OF WORK-CONTEXT
      *        VP Option Margin 22
               MOVE PFVPOPTM22 TO YL0213 OF WORK-CONTEXT
      *        VP Option Margin 23
               MOVE PFVPOPTM23 TO YL0214 OF WORK-CONTEXT
      *        VP Option Margin 24
               MOVE PFVPOPTM24 TO YL0215 OF WORK-CONTEXT
      *        VP Option Margin 25
               MOVE PFVPOPTM25 TO YL0216 OF WORK-CONTEXT
      *        VP Option Margin 26
               MOVE PFVPOPTM26 TO YL0217 OF WORK-CONTEXT
      *        VP Option Margin 27
               MOVE PFVPOPTM27 TO YL0218 OF WORK-CONTEXT
      *        Option Margin 28
               MOVE PFVPOPTM28 TO YL0219 OF WORK-CONTEXT
      *        VP Option Margin 29
               MOVE PFVPOPTM29 TO YL0220 OF WORK-CONTEXT
      *        VP Option Margin 30
               MOVE PFVPOPTM30 TO YL0221 OF WORK-CONTEXT
      *        Colour Margin
               MOVE PFVPCOLMGN TO YL0222 OF WORK-CONTEXT
      *        Trim Margin
               MOVE PFVPTRMMGN TO YL0223 OF WORK-CONTEXT
      *        V.A.T rate
               MOVE PFVATRATE TO YL0224 OF WORK-CONTEXT
      *        SC Option Code 1
               MOVE PFSCOPT1 TO YL0225 OF WORK-CONTEXT
      *        SC Option Code 2
               MOVE PFSCOPT2 TO YL0226 OF WORK-CONTEXT
      *        SC Option Code 3
               MOVE PFSCOPT3 TO YL0227 OF WORK-CONTEXT
      *        SC Option Code 4
               MOVE PFSCOPT4 TO YL0228 OF WORK-CONTEXT
      *        SC Option Code 5
               MOVE PFSCOPT5 TO YL0229 OF WORK-CONTEXT
      *        SC Option Code 6
               MOVE PFSCOPT6 TO YL0230 OF WORK-CONTEXT
      *        SC Option Code 7
               MOVE PFSCOPT7 TO YL0231 OF WORK-CONTEXT
      *        SC Option Code 8
               MOVE PFSCOPT8 TO YL0232 OF WORK-CONTEXT
      *        SC Option Code 9
               MOVE PFSCOPT9 TO YL0233 OF WORK-CONTEXT
      *        SC Option Code 10
               MOVE PFSCOPT10 TO YL0234 OF WORK-CONTEXT
      *        SC Option Code 11
               MOVE PFSCOPT11 TO YL0235 OF WORK-CONTEXT
      *        SC Option Code 12
               MOVE PFSCOPT12 TO YL0236 OF WORK-CONTEXT
      *        SC Option Code 13
               MOVE PFSCOPT13 TO YL0237 OF WORK-CONTEXT
      *        SC Option Code 14
               MOVE PFSCOPT14 TO YL0238 OF WORK-CONTEXT
      *        SC Option Code 15
               MOVE PFSCOPT15 TO YL0239 OF WORK-CONTEXT
      *        SC Option Code 16
               MOVE PFSCOPT16 TO YL0240 OF WORK-CONTEXT
      *        SC Option Code 17
               MOVE PFSCOPT17 TO YL0241 OF WORK-CONTEXT
      *        SC Option Code 18
               MOVE PFSCOPT18 TO YL0242 OF WORK-CONTEXT
      *        SC Option Code 19
               MOVE PFSCOPT19 TO YL0243 OF WORK-CONTEXT
      *        SC Option Code 20
               MOVE PFSCOPT20 TO YL0244 OF WORK-CONTEXT
      *        SC Option Code 21
               MOVE PFSCOPT21 TO YL0245 OF WORK-CONTEXT
      *        SC Option Code 22
               MOVE PFSCOPT22 TO YL0246 OF WORK-CONTEXT
      *        SC Option Code 23
               MOVE PFSCOPT23 TO YL0247 OF WORK-CONTEXT
      *        SC Option Code 24
               MOVE PFSCOPT24 TO YL0248 OF WORK-CONTEXT
      *        SC Option Code 25
               MOVE PFSCOPT25 TO YL0249 OF WORK-CONTEXT
      *        SC Option Code 26
               MOVE PFSCOPT26 TO YL0250 OF WORK-CONTEXT
      *        SC Option Code 27
               MOVE PFSCOPT27 TO YL0251 OF WORK-CONTEXT
      *        SC Option Code 28
               MOVE PFSCOPT28 TO YL0252 OF WORK-CONTEXT
      *        SC Option Code 29
               MOVE PFSCOPT29 TO YL0253 OF WORK-CONTEXT
      *        SC Option Code 30
               MOVE PFSCOPT30 TO YL0254 OF WORK-CONTEXT
      *        Error/Info Text
               MOVE PFERRTXT TO YL0255 OF WORK-CONTEXT
      *        U:Vehicle Pricing Status
               MOVE PFVPSTS TO YL0256 OF WORK-CONTEXT
      *        U:Option Pricing Status
               MOVE PFOPTPRCST TO YL0257 OF WORK-CONTEXT
      *
      *        Error on program call will terminate run unit
               IF (C-INDICATOR-ON(90)) THEN
                   MOVE 'Y2U0032' TO W0RTN
                   MOVE 'RAA001000S' TO W0CLPG
      *            Send message '*Error occured on CALL...'
      *            Message ID
                   MOVE 'Y2U0032' TO ZAMSID
      *            Message file
                   MOVE 'Y2USRMSG' TO ZAMSGF
      *            Message data
                   MOVE W0CLPG TO ZAMSDA
                   PERFORM ZASNMS
               END-IF
      *        Error detected?
               IF (W0RTN        NOT = SPACES) THEN
                   SET C-INDICATOR-ON(99) TO TRUE
               END-IF
      *        Calc VAT to Apply
      *        LCL.VAT Rate 1 =
      *        *COMPUTE ((x1 + x2) * x3)
      *        x1    : CON.100
      *        +     : PGM.*Synon (17,7) work field
      *        x2    : LCL.NV Basic VAT Rate
      *        *     : PGM.*Synon (17,7) work field *Rounded
      *        x3    : CON.0.01
      *        *Synon (17,7) work field
               ADD 100, YL0224 OF WORK-CONTEXT GIVING W0WD01
      *        *Synon (17,7) work field
               MULTIPLY W0WD01 BY 0.01 GIVING W0WD00
      *        VAT Rate 1
               MOVE W0WD00 TO YL0259 OF WORK-CONTEXT
      *        Version price
               MULTIPLY YL0145 OF WORK-CONTEXT BY YL0259 OF
                 WORK-CONTEXT GIVING YL0126 OF WORK-CONTEXT ROUNDED
      *        Color price
               MULTIPLY YL0146 OF WORK-CONTEXT BY YL0259 OF
                 WORK-CONTEXT GIVING YL0128 OF WORK-CONTEXT ROUNDED
      *        Exclude Any Battery Options Amounts
               PERFORM UA5SUBR
      *        Options
      *        PAR.Options price     0060545 =
      *        *COMPUTE ((x1 + x2 - x4) * x3)
      *        x1    : LCL.NV Options Total Price
      *        +     : PGM.*Synon (17,7) work field
      *        x2    : LCL.NV Upholstery Price
      *        -     : PGM.*Synon (17,7) work field
      *        x4    : LCL.U:Option Price
      *        *     : PGM.*Synon (17,7) work field *Rounded
      *        x3    : LCL.VAT Rate 1
      *        *Synon (17,7) work field
               ADD YL0148 OF WORK-CONTEXT, YL0147 OF WORK-CONTEXT
                 GIVING W0WD02
      *        *Synon (17,7) work field
               SUBTRACT YL0260 OF WORK-CONTEXT FROM W0WD02 GIVING W0WD01
      *        *Synon (17,7) work field
               MULTIPLY W0WD01 BY YL0259 OF WORK-CONTEXT GIVING W0WD00
                 ROUNDED
      *        Options price     0060545
               MOVE W0WD00 TO YL0130 OF WORK-CONTEXT
      *        Accessories
               MULTIPLY YL0154 OF WORK-CONTEXT BY YL0259 OF
                 WORK-CONTEXT GIVING YL0129 OF WORK-CONTEXT
      *        Rtv by Mdl/Phs/Ver/Dte - AOC Version Price  *
               PERFORM SB3RVGN
      *        Delivery price
               MULTIPLY YL0262 OF WORK-CONTEXT BY 1 GIVING YL0127 OF
                 WORK-CONTEXT
      *        List Price
      *        PAR.List price =
      *        *COMPUTE (x1 + x2 + x3 + x4 + x5)
      *        x1    : PAR.Version price
      *        +     : PGM.*Synon (17,7) work field
      *        x2    : PAR.Delivery price
      *        +     : PGM.*Synon (17,7) work field
      *        x3    : PAR.Color price
      *        +     : PGM.*Synon (17,7) work field
      *        x4    : PAR.Accessories
      *        +     : PGM.*Synon (17,7) work field
      *        x5    : PAR.Options price     0060545
      *        *Synon (17,7) work field
               ADD YL0126 OF WORK-CONTEXT, YL0127 OF WORK-CONTEXT
                 GIVING W0WD03
      *        *Synon (17,7) work field
               ADD W0WD03, YL0128 OF WORK-CONTEXT GIVING W0WD02
      *        *Synon (17,7) work field
               ADD W0WD02, YL0129 OF WORK-CONTEXT GIVING W0WD01
      *        *Synon (17,7) work field
               ADD W0WD01, YL0130 OF WORK-CONTEXT GIVING W0WD00
      *        List price
               MOVE W0WD00 TO YL0125 OF WORK-CONTEXT
      *        Vehicle List Price
               MULTIPLY YL0125 OF WORK-CONTEXT BY 1 GIVING WN0041
      *        Vehicle Version Price
               MULTIPLY YL0126 OF WORK-CONTEXT BY 1 GIVING WN0042
      *        Vehicle Delivery Price
               MULTIPLY YL0127 OF WORK-CONTEXT BY 1 GIVING WN0043
      *        Vehicle Colour Price
               MULTIPLY YL0128 OF WORK-CONTEXT BY 1 GIVING WN0044
      *        Vehicle Accessories Price
               MULTIPLY YL0129 OF WORK-CONTEXT BY 1 GIVING WN0045
      *        Vehicle Options Price
               MULTIPLY YL0130 OF WORK-CONTEXT BY 1 GIVING WN0046
      *        Vehicle First Reg Fee
               MULTIPLY YL0046 OF WORK-CONTEXT BY 1 GIVING WN0047
      *        Vehicle Road Fun License
               MULTIPLY YL0048 OF WORK-CONTEXT BY 1 GIVING WN0048
      *        Vehicle On The Road Price
      *        CASE: PAR.Vehicle List Price is GT Zero
      *        *IF
               IF (WN0041 > 0) THEN
      *            PAR.Vehicle On The Road Price =
      *            *COMPUTE (x1 + x2 + x3)
      *            x1    : PAR.Vehicle List Price
      *            +     : PGM.*Synon (17,7) work field
      *            x2    : PAR.Vehicle First Reg Fee
      *            +     : PGM.*Synon (17,7) work field
      *            x3    : PAR.Vehicle Road Fun License
      *            *Synon (17,7) work field
                   ADD WN0041, WN0047 GIVING W0WD01
      *            *Synon (17,7) work field
                   ADD W0WD01, WN0048 GIVING W0WD00
      *            Vehicle On The Road Price
                   MOVE W0WD00 TO WN0049
               END-IF
      *        rtv Autotrader PICG Price - Autotrader PICG Price  *
               PERFORM SB4RVGN
      *        - PICG amount to deducted
      *        CASE:
      *        - c1AND c2
      *        |- c1    : LCL.PICG amount to deduc val is not zero
      *        |- c2    : PGM.*Return code is *Normal
      *        '-
      *        *IF
               IF (YL0263 OF WORK-CONTEXT NOT = 0 AND
                   W0RTN = ' ') THEN
      *            Vehicle On The Road Price
                   SUBTRACT YL0263 OF WORK-CONTEXT FROM WN0049 GIVING
                     WN0049
      *            not negative
      *            CASE: PAR.Vehicle On The Road Price is Negative
      *            *IF
                   IF (WN0049 < 0) THEN
      *                Vehicle On The Road Price
                       MOVE ZEROS TO WN0049
                   END-IF
               END-IF
           END-IF
      *    Clear all neither parameters
      *    Category
           MOVE SPACES TO WN0116
      *    SCR Trim Colour (12)
           MOVE SPACES TO WN0117
      *    SCR Trim Type (12)
           MOVE SPACES TO WN0118
      *
      *    Int Rtn Model Trim Desc
      *    CASE:
      *    - c1 AND c2
      *    |- c1    : PAR.SCR Trim Type is *Not Blank
      *    |- c2    : PAR.SCR Trim Colour is *Not Blank
      *    '-
      *    *IF
           IF (J6TRMTYSCR OF FVEHDF2 OF VAVEHDTALE-R NOT = ' ' AND
               J6TRMCLSCR OF FVEHDF2 OF VAVEHDTALE-R NOT = ' ') THEN
      *        Rtv Trim Description - Model Version Colour Trim  *
               PERFORM SB5RVGN
      *        CASE: LCL.U:Record found is N
      *        *IF
               IF (YL0267 OF WORK-CONTEXT = 'N') THEN
      *            Rtv trim - Model Version Colour Trim  *
                   PERFORM SB6RVGN
               END-IF
           ELSE
      *        CASE: *OTHERWISE
      *        Rtv trim - Model Version Colour Trim  *
               PERFORM SB7RVGN
           END-IF
      *    Ext I.C. Ord Pack for Veh - #Foreign model access  *
           SET C-INDICATOR-OFF(90) TO TRUE
           MOVE SPACES TO WQ0118
           MOVE J6INVBCV OF FVEHDF2 OF VAVEHDTALE-R TO WQ0119
           MOVE WN0051 TO WQ0120
           MOVE YL0270 OF WORK-CONTEXT TO WQ0121
           MOVE ',' TO WQ0122
      *
           CALL 'PFA003210S' USING
      *    U:Return Code Id
             WQ0118
      *    Invariant BCV
             WQ0119
      *    U:I.C. Pack Desc All
             WQ0120
      *    U:I.C. Total Retail Price
             WQ0121
      *    U:Delimiter
             WQ0122
                    ON OVERFLOW
                    SET C-INDICATOR-ON(90) TO TRUE
           END-CALL
      *
           MOVE WQ0118 TO YL0041 OF WORK-CONTEXT
           MOVE WQ0120 TO WN0051
           MOVE WQ0121 TO YL0270 OF WORK-CONTEXT
      *
      *    Error on program call will terminate run unit
           IF (C-INDICATOR-ON(90)) THEN
               MOVE 'Y2U0032' TO W0RTN
               MOVE 'PFA003210S' TO W0CLPG
      *        Send message '*Error occured on CALL...'
      *        Message ID
               MOVE 'Y2U0032' TO ZAMSID
      *        Message file
               MOVE 'Y2USRMSG' TO ZAMSGF
      *        Message data
               MOVE W0CLPG TO ZAMSDA
               PERFORM ZASNMS
               SET C-INDICATOR-ON(99) TO TRUE
           END-IF
      *    Set KSP Field
      *    Vehicle Version KSP All
           MOVE YL0043 OF WORK-CONTEXT TO WN0052
      *    Merge the Options and Accessories Fields
      *    Vehicle Options AXS Merge
           MOVE SPACES TO WN0053
           MOVE WN0050 TO WN0053
      *    CASE: PAR.Vehicle All Accessory Dsc is *Not Blank
      *    *IF
           IF (WN0051 NOT = ' ') THEN
      *        CASE: PAR.Vehicle Options AXS Merge is *Blank
      *        *IF
               IF (WN0053 = ' ') THEN
      *            Vehicle Options AXS Merge
                   MOVE SPACES TO WN0053
                   MOVE WN0051 TO WN0053
               ELSE
      *            CASE: *OTHERWISE
                   MOVE ',' TO YRSW0A
                   MOVE ZEROS TO YRSW03
                   MOVE 'T' TO YRSW05
                   IF (WN0053 = SPACES AND
                       YRSW05 = 'T') THEN
                       ADD  1 TO ZEROS GIVING YRSW04
                   ELSE
                       ADD  1 TO 03400 GIVING YRSW04
                   END-IF
                   MOVE 03400 TO YRSW02
                   MOVE WN0053 TO YRSW06
                   PERFORM ZCATWK
                   STRING YRSW06 DELIMITED BY X'FF',
                          YRSW0A DELIMITED BY SIZE
                   INTO   YRSW06
                   MOVE YRSW06 TO WN0053
                   MOVE ZEROS TO YRSW03
                   MOVE 'T' TO YRSW05
                   IF (WN0053 = SPACES AND
                       YRSW05 = 'T') THEN
                       ADD  1 TO ZEROS GIVING YRSW04
                   ELSE
                       ADD  1 TO 03400 GIVING YRSW04
                   END-IF
                   MOVE 03400 TO YRSW02
                   MOVE WN0053 TO YRSW06
                   PERFORM ZCATWK
                   STRING YRSW06 DELIMITED BY X'FF',
                          WN0051 DELIMITED BY SIZE
                   INTO   YRSW06
                   MOVE YRSW06 TO WN0053
               END-IF
           END-IF
      *    Veh Co2
           MOVE SPACES TO YL0271 OF WORK-CONTEXT
           MOVE ' ' TO YL0271 OF WORK-CONTEXT
      *    Chk Numeric - #Standard Functions  *
     ** Function   : Check field for all numeric characters.
     ** System     : Renault Applications
     ** Programmer : Brian Etheridge
     ** Date       : 29/03/93
     **.................................................................
      *.Start.of.User.source.interface..................................
      *    Initialise work field
           MOVE SPACES TO WK-INP-FIELD
           MOVE J6VCODE3 OF FVEHDF2 OF VAVEHDTALE-R TO WK-INP-FIELD
      *    Do the check.
           PERFORM CHK-NUMERIC
      *.End.of.User.source.interace.....................................
      *    CASE: PGM.*Return code is *Normal
      *    *IF
           IF (W0RTN = ' ') THEN
      *        Veh Co2
               MOVE J6VCODE3 OF FVEHDF2 OF VAVEHDTALE-R TO YL0271 OF
                 WORK-CONTEXT
           END-IF
      *    KSP Attn text
           MOVE SPACES TO YL0272 OF WORK-CONTEXT
           MOVE ' ' TO YL0272 OF WORK-CONTEXT
      *    Rtv KSP text by vin - KSP VIN Attn text  *
           PERFORM SB8RVGN
      *    by model and phase
      *    CASE:
      *    - NOTc1 OR c2
      *    |- c1    : PGM.*Return code is *Normal
      *    |- c2    : LCL.KSP Attn text is *blank
      *    '-
      *    *IF
           IF (NOT (W0RTN = ' ') OR
               YL0272 OF WORK-CONTEXT = ' ') THEN
      *        Rtv KSP text by mod ,pha - KSP VIN Attn text  *
               PERFORM SB9RVGN
      *        by model
      *        CASE:
      *        - NOTc1 OR c2
      *        |- c1    : PGM.*Return code is *Normal
      *        |- c2    : LCL.KSP Attn text is *blank
      *        '-
      *        *IF
               IF (NOT (W0RTN = ' ') OR
                   YL0272 OF WORK-CONTEXT = ' ') THEN
      *            Rtv KSP text by mod - KSP VIN Attn text  *
                   PERFORM SC1RVGN
               END-IF
           END-IF
      *    not exist
      *    CASE:
      *    - NOTc1
      *    |- c1    : PGM.*Return code is *Normal
      *    '-
      *    *IF
           IF (NOT (W0RTN = ' ')) THEN
      *        KSP Attn text
               MOVE SPACES TO YL0272 OF WORK-CONTEXT
               MOVE ' ' TO YL0272 OF WORK-CONTEXT
           ELSE
      *        CASE: *OTHERWISE
      *        Cvt DD/MM/YYYY to D8# - #Date Functions  *
     ** Function   : Cvt dd/mm/yyyy to D8#
     ** System     : All models
     ** Programmer : Maurice Mead
     ** Date       : 29/06/2006
     **................................................................
           MOVE YL0273 OF WORK-CONTEXT
             TO U-DATE-IN   OF U-UDTCMDDT8S-WS
           IF  U-DD  OF U-DATE-IN  NOT NUMERIC
               MOVE ZERO  TO U-DD  OF U-DATE-IN (1:1)
           END-IF
           MOVE CORR  U-DATE-IN  OF U-UDTCMDDT8S-WS
             TO U-DATE-OUT-X     OF U-UDTCMDDT8S-WS
           IF  U-DATE-OUT  OF U-UDTCMDDT8S-WS  NUMERIC
               MOVE U-DATE-OUT  OF U-UDTCMDDT8S-WS
                 TO YL0274 OF WORK-CONTEXT
           ELSE
               MOVE ZEROS
                 TO YL0274 OF WORK-CONTEXT
               MOVE 'Y2U0006'  TO W0RTN
           END-IF
      *.Cvt.dd/mm/yyyy.to.DTX.-.End.of.user.source.....................
      *
      *        Assume that Attn Expiry date is always populated if rcd
      *          found
      *        CASE:
      *        - c1 ORc3
      *        |- c1    : LCL.U:Job date long (D8#) GT LCL.KSP Attn
      *          expiry date
      *        |- c3    : LCL.KSP Attn expiry date is Zero
      *        '-
      *        *IF
               IF (YL0003 OF WORK-CONTEXT > YL0274 OF WORK-CONTEXT OR
                   YL0274 OF WORK-CONTEXT = 0) THEN
      *            KSP Attn text
                   MOVE SPACES TO YL0272 OF WORK-CONTEXT
                   MOVE ' ' TO YL0272 OF WORK-CONTEXT
               END-IF
           END-IF
      *    Rtv dealer - Autotrader Dealer  *
           PERFORM SC2RVGN
      *    dealer exlude
      *    CASE: PGM.*Return code is *Normal
      *    *IF
           IF (W0RTN = ' ') THEN
      *        CASE: DB1.Exit Import Centre Dte 45 is Zero
      *        *IF
               IF (J6EXICDT45 OF FVEHDF2 OF VAVEHDTALE-R = 0) THEN
      *            Record Processed Status
                   MOVE 'X' TO WN0054
               END-IF
           END-IF
      *    RRG in import centre is skip
      *    CASE: WRK.Dealer Network Type is RRG Dealer
      *    *IF
           IF (WUDLRNET OF WORK-CONTEXT = 'B') THEN
      *        CASE: DB1.Exit Import Centre Dte 45 is = 0
      *        *IF
               IF (J6EXICDT45 OF FVEHDF2 OF VAVEHDTALE-R = 0) THEN
      *            Record Processed Status
                   MOVE 'X' TO WN0054
               END-IF
           END-IF
      *==============================================================
           CONTINUE.
       UA3EXIT.
           EXIT.
      /EJECT
       UA4SUBR SECTION.
      *==============================================================
      *    dealer
      *==============================================================
      *    Rtv Retail/Second Dealer - Autotrader Ret/Sec Dealer  *
           PERFORM SB1RVGN
      *    CASE:
      *    - c1AND c2
      *    |- c1    : PGM.*Return code is *Normal
      *    |- c2    : DB1.Delivery Account is Not zeros
      *    '-
      *    *IF
           IF (W0RTN = ' ' AND
               J6DLVACC OF FVEHDF2 OF VAVEHDTALE-R NOT = '000000') THEN
               MOVE 4 TO YRSW03
               MOVE 1 TO YRSW02
               IF (YRSW02 NOT > 0 OR
                   YRSW03 NOT > 0 OR
                   YRSW02 > 00006 OR
                   YRSW03 > 00006) THEN
                   MOVE 'Y2U0510' TO W0RTN
               ELSE
                   MOVE J6DLVACC OF FVEHDF2 OF VAVEHDTALE-R TO W0STRNG
                   MOVE W0STRNG(YRSW02:YRSW03) TO YL0085 OF WORK-CONTEXT
               END-IF
               MOVE 2 TO YRSW03
               MOVE 5 TO YRSW02
               IF (YRSW02 NOT > 0 OR
                   YRSW03 NOT > 0 OR
                   YRSW02 > 00006 OR
                   YRSW03 > 00006) THEN
                   MOVE 'Y2U0510' TO W0RTN
               ELSE
                   MOVE J6DLVACC OF FVEHDF2 OF VAVEHDTALE-R TO W0STRNG
                   MOVE W0STRNG(YRSW02:YRSW03) TO YL0086 OF WORK-CONTEXT
               END-IF
      *        Dealer number (fin)
               MOVE J6DLVACC OF FVEHDF2 OF VAVEHDTALE-R TO YL0087 OF
                 WORK-CONTEXT
           ELSE
      *        CASE: *OTHERWISE
               MOVE 4 TO YRSW03
               MOVE 1 TO YRSW02
               IF (YRSW02 NOT > 0 OR
                   YRSW03 NOT > 0 OR
                   YRSW02 > 00006 OR
                   YRSW03 > 00006) THEN
                   MOVE 'Y2U0510' TO W0RTN
               ELSE
                   MOVE J6OWNACC OF FVEHDF2 OF VAVEHDTALE-R TO W0STRNG
                   MOVE W0STRNG(YRSW02:YRSW03) TO YL0085 OF WORK-CONTEXT
               END-IF
               MOVE 2 TO YRSW03
               MOVE 5 TO YRSW02
               IF (YRSW02 NOT > 0 OR
                   YRSW03 NOT > 0 OR
                   YRSW02 > 00006 OR
                   YRSW03 > 00006) THEN
                   MOVE 'Y2U0510' TO W0RTN
               ELSE
                   MOVE J6OWNACC OF FVEHDF2 OF VAVEHDTALE-R TO W0STRNG
                   MOVE W0STRNG(YRSW02:YRSW03) TO YL0086 OF WORK-CONTEXT
               END-IF
      *        Dealer number (fin)
               MOVE J6OWNACC OF FVEHDF2 OF VAVEHDTALE-R TO YL0087 OF
                 WORK-CONTEXT
           END-IF
      *    Ext Rtv all dealer det - #Foreign model access  *
      *    Clear array PCRC
           INITIALIZE PCRC
      *    Dealer number
           MOVE YL0085 OF WORK-CONTEXT TO PCDLRNBR
      *    Dealer number suffix
           MOVE YL0086 OF WORK-CONTEXT TO PCDLRSFX
      *
           SET C-INDICATOR-OFF(90) TO TRUE
           MOVE SPACES TO WQ0060
      *
           CALL 'DITPRCRTVS' USING
      *    *Return code
             WQ0060
      *    RCD : *Arrays
             PCRC
                    ON OVERFLOW
                    SET C-INDICATOR-ON(90) TO TRUE
           END-CALL
      *
           MOVE WQ0060 TO W0RTN
      *
      *    Dealer Network Type
           MOVE PCDLRNET TO YL0088 OF WORK-CONTEXT
      *    Dealer Known By Name
           MOVE PCDLKNNM TO WN0001
      *    Lead Dealer Number
           MOVE PCLEADNUM TO YL0089 OF WORK-CONTEXT
      *    Lead Dealer Number Suffix
           MOVE PCLEADSFX TO YL0090 OF WORK-CONTEXT
      *
      *    Error on program call will terminate run unit
           IF (C-INDICATOR-ON(90)) THEN
               MOVE 'Y2U0032' TO W0RTN
               MOVE 'DITPRCRTVS' TO W0CLPG
      *        Send message '*Error occured on CALL...'
      *        Message ID
               MOVE 'Y2U0032' TO ZAMSID
      *        Message file
               MOVE 'Y2USRMSG' TO ZAMSGF
      *        Message data
               MOVE W0CLPG TO ZAMSDA
               PERFORM ZASNMS
               SET C-INDICATOR-ON(99) TO TRUE
           END-IF
      *    internal
      *    CASE:
      *    - c1 OR NOTc2
      *    |- c1    : PAR.Dealer Name is Blank
      *    |- c2    : PGM.*Return code is *Normal
      *    '-
      *    *IF
           IF (WN0001 = ' ' OR
               NOT (W0RTN = ' ')) THEN
      *        Dealer Network Type
               MOVE 'N' TO YL0088 OF WORK-CONTEXT
           END-IF
      *    Ext Rtv all dealer det - #Foreign model access  * lead get
      *      for RRG
      *    Clear array PCRC
           INITIALIZE PCRC
      *    Dealer number
           MOVE YL0089 OF WORK-CONTEXT TO PCDLRNBR
      *    Dealer number suffix
           MOVE YL0090 OF WORK-CONTEXT TO PCDLRSFX
      *
           SET C-INDICATOR-OFF(90) TO TRUE
           MOVE SPACES TO WQ0061
      *
           CALL 'DITPRCRTVS' USING
      *    *Return code
             WQ0061
      *    RCD : *Arrays
             PCRC
                    ON OVERFLOW
                    SET C-INDICATOR-ON(90) TO TRUE
           END-CALL
      *
           MOVE WQ0061 TO W0RTN
      *
      *    Dealer Network Type
           MOVE PCDLRNET TO WUDLRNET OF WORK-CONTEXT
      *
      *    Error on program call will terminate run unit
           IF (C-INDICATOR-ON(90)) THEN
               MOVE 'Y2U0032' TO W0RTN
               MOVE 'DITPRCRTVS' TO W0CLPG
      *        Send message '*Error occured on CALL...'
      *        Message ID
               MOVE 'Y2U0032' TO ZAMSID
      *        Message file
               MOVE 'Y2USRMSG' TO ZAMSGF
      *        Message data
               MOVE W0CLPG TO ZAMSDA
               PERFORM ZASNMS
               SET C-INDICATOR-ON(99) TO TRUE
           END-IF
      *==============================================================
           CONTINUE.
       UA4EXIT.
           EXIT.
      /EJECT
       UA5SUBR SECTION.
      *==============================================================
      *    Exclude Any Battery Options Amounts
      *==============================================================
      *    U:Option Price
           MOVE ZEROS TO YL0260 OF WORK-CONTEXT
      *    Check if Battery Option - Option 01
      *    CASE: LCL.VP Option Price 1 is Not Zero
      *    *IF
           IF (YL0161 OF WORK-CONTEXT NOT = 0) THEN
               MOVE 5 TO YRSW03
               MOVE 1 TO YRSW02
               IF (YRSW02 NOT > 0 OR
                   YRSW03 NOT > 0 OR
                   YRSW02 > 00006 OR
                   YRSW03 > 00006) THEN
                   MOVE 'Y2U0510' TO W0RTN
               ELSE
                   MOVE YL0225 OF WORK-CONTEXT TO W0STRNG
                   MOVE W0STRNG(YRSW02:YRSW03) TO YL0261 OF WORK-CONTEXT
               END-IF
      *        CASE: LCL.U:Option Code 5 is Battery Hire
      *        *IF
               IF (YL0261 OF WORK-CONTEXT = 'FACBA') THEN
      *            U:Option Price
                   ADD YL0260 OF WORK-CONTEXT, YL0161 OF WORK-CONTEXT
                     GIVING YL0260 OF WORK-CONTEXT
      *            U:Option Price
                   ADD YL0260 OF WORK-CONTEXT, YL0192 OF WORK-CONTEXT
                     GIVING YL0260 OF WORK-CONTEXT
               END-IF
           END-IF
      *    Check if Battery Option - Option 02
      *    CASE: LCL.VP Option Price 2 is Not Zero
      *    *IF
           IF (YL0162 OF WORK-CONTEXT NOT = 0) THEN
               MOVE 5 TO YRSW03
               MOVE 1 TO YRSW02
               IF (YRSW02 NOT > 0 OR
                   YRSW03 NOT > 0 OR
                   YRSW02 > 00006 OR
                   YRSW03 > 00006) THEN
                   MOVE 'Y2U0510' TO W0RTN
               ELSE
                   MOVE YL0226 OF WORK-CONTEXT TO W0STRNG
                   MOVE W0STRNG(YRSW02:YRSW03) TO YL0261 OF WORK-CONTEXT
               END-IF
      *        CASE: LCL.U:Option Code 5 is Battery Hire
      *        *IF
               IF (YL0261 OF WORK-CONTEXT = 'FACBA') THEN
      *            U:Option Price
                   ADD YL0260 OF WORK-CONTEXT, YL0162 OF WORK-CONTEXT
                     GIVING YL0260 OF WORK-CONTEXT
      *            U:Option Price
                   ADD YL0260 OF WORK-CONTEXT, YL0193 OF WORK-CONTEXT
                     GIVING YL0260 OF WORK-CONTEXT
               END-IF
           END-IF
      *    Check if Battery Option - Option 03
      *    CASE: LCL.VP Option Price 3 is Not Zero
      *    *IF
           IF (YL0163 OF WORK-CONTEXT NOT = 0) THEN
               MOVE 5 TO YRSW03
               MOVE 1 TO YRSW02
               IF (YRSW02 NOT > 0 OR
                   YRSW03 NOT > 0 OR
                   YRSW02 > 00006 OR
                   YRSW03 > 00006) THEN
                   MOVE 'Y2U0510' TO W0RTN
               ELSE
                   MOVE YL0227 OF WORK-CONTEXT TO W0STRNG
                   MOVE W0STRNG(YRSW02:YRSW03) TO YL0261 OF WORK-CONTEXT
               END-IF
      *        CASE: LCL.U:Option Code 5 is Battery Hire
      *        *IF
               IF (YL0261 OF WORK-CONTEXT = 'FACBA') THEN
      *            U:Option Price
                   ADD YL0260 OF WORK-CONTEXT, YL0163 OF WORK-CONTEXT
                     GIVING YL0260 OF WORK-CONTEXT
      *            U:Option Price
                   ADD YL0260 OF WORK-CONTEXT, YL0194 OF WORK-CONTEXT
                     GIVING YL0260 OF WORK-CONTEXT
               END-IF
           END-IF
      *    Check if Battery Option - Option 04
      *    CASE: LCL.VP Option Price 4 is Not Zero
      *    *IF
           IF (YL0164 OF WORK-CONTEXT NOT = 0) THEN
               MOVE 5 TO YRSW03
               MOVE 1 TO YRSW02
               IF (YRSW02 NOT > 0 OR
                   YRSW03 NOT > 0 OR
                   YRSW02 > 00006 OR
                   YRSW03 > 00006) THEN
                   MOVE 'Y2U0510' TO W0RTN
               ELSE
                   MOVE YL0228 OF WORK-CONTEXT TO W0STRNG
                   MOVE W0STRNG(YRSW02:YRSW03) TO YL0261 OF WORK-CONTEXT
               END-IF
      *        CASE: LCL.U:Option Code 5 is Battery Hire
      *        *IF
               IF (YL0261 OF WORK-CONTEXT = 'FACBA') THEN
      *            U:Option Price
                   ADD YL0260 OF WORK-CONTEXT, YL0164 OF WORK-CONTEXT
                     GIVING YL0260 OF WORK-CONTEXT
      *            U:Option Price
                   ADD YL0260 OF WORK-CONTEXT, YL0195 OF WORK-CONTEXT
                     GIVING YL0260 OF WORK-CONTEXT
               END-IF
           END-IF
      *    Check if Battery Option - Option 05
      *    CASE: LCL.VP Option Price 5 is Not Zero
      *    *IF
           IF (YL0165 OF WORK-CONTEXT NOT = 0) THEN
               MOVE 5 TO YRSW03
               MOVE 1 TO YRSW02
               IF (YRSW02 NOT > 0 OR
                   YRSW03 NOT > 0 OR
                   YRSW02 > 00006 OR
                   YRSW03 > 00006) THEN
                   MOVE 'Y2U0510' TO W0RTN
               ELSE
                   MOVE YL0229 OF WORK-CONTEXT TO W0STRNG
                   MOVE W0STRNG(YRSW02:YRSW03) TO YL0261 OF WORK-CONTEXT
               END-IF
      *        CASE: LCL.U:Option Code 5 is Battery Hire
      *        *IF
               IF (YL0261 OF WORK-CONTEXT = 'FACBA') THEN
      *            U:Option Price
                   ADD YL0260 OF WORK-CONTEXT, YL0165 OF WORK-CONTEXT
                     GIVING YL0260 OF WORK-CONTEXT
      *            U:Option Price
                   ADD YL0260 OF WORK-CONTEXT, YL0196 OF WORK-CONTEXT
                     GIVING YL0260 OF WORK-CONTEXT
               END-IF
           END-IF
      *    Check if Battery Option - Option 06
      *    CASE: LCL.VP Option Price 6 is Not Zero
      *    *IF
           IF (YL0166 OF WORK-CONTEXT NOT = 0) THEN
               MOVE 5 TO YRSW03
               MOVE 1 TO YRSW02
               IF (YRSW02 NOT > 0 OR
                   YRSW03 NOT > 0 OR
                   YRSW02 > 00006 OR
                   YRSW03 > 00006) THEN
                   MOVE 'Y2U0510' TO W0RTN
               ELSE
                   MOVE YL0230 OF WORK-CONTEXT TO W0STRNG
                   MOVE W0STRNG(YRSW02:YRSW03) TO YL0261 OF WORK-CONTEXT
               END-IF
      *        CASE: LCL.U:Option Code 5 is Battery Hire
      *        *IF
               IF (YL0261 OF WORK-CONTEXT = 'FACBA') THEN
      *            U:Option Price
                   ADD YL0260 OF WORK-CONTEXT, YL0166 OF WORK-CONTEXT
                     GIVING YL0260 OF WORK-CONTEXT
      *            U:Option Price
                   ADD YL0260 OF WORK-CONTEXT, YL0197 OF WORK-CONTEXT
                     GIVING YL0260 OF WORK-CONTEXT
               END-IF
           END-IF
      *    Check if Battery Option - Option 07
      *    CASE: LCL.VP Option Price 7 is Not Zero
      *    *IF
           IF (YL0167 OF WORK-CONTEXT NOT = 0) THEN
               MOVE 5 TO YRSW03
               MOVE 1 TO YRSW02
               IF (YRSW02 NOT > 0 OR
                   YRSW03 NOT > 0 OR
                   YRSW02 > 00006 OR
                   YRSW03 > 00006) THEN
                   MOVE 'Y2U0510' TO W0RTN
               ELSE
                   MOVE YL0231 OF WORK-CONTEXT TO W0STRNG
                   MOVE W0STRNG(YRSW02:YRSW03) TO YL0261 OF WORK-CONTEXT
               END-IF
      *        CASE: LCL.U:Option Code 5 is Battery Hire
      *        *IF
               IF (YL0261 OF WORK-CONTEXT = 'FACBA') THEN
      *            U:Option Price
                   ADD YL0260 OF WORK-CONTEXT, YL0167 OF WORK-CONTEXT
                     GIVING YL0260 OF WORK-CONTEXT
      *            U:Option Price
                   ADD YL0260 OF WORK-CONTEXT, YL0198 OF WORK-CONTEXT
                     GIVING YL0260 OF WORK-CONTEXT
               END-IF
           END-IF
      *    Check if Battery Option - Option 08
      *    CASE: LCL.VP Option Price 8 is Not Zero
      *    *IF
           IF (YL0168 OF WORK-CONTEXT NOT = 0) THEN
               MOVE 5 TO YRSW03
               MOVE 1 TO YRSW02
               IF (YRSW02 NOT > 0 OR
                   YRSW03 NOT > 0 OR
                   YRSW02 > 00006 OR
                   YRSW03 > 00006) THEN
                   MOVE 'Y2U0510' TO W0RTN
               ELSE
                   MOVE YL0232 OF WORK-CONTEXT TO W0STRNG
                   MOVE W0STRNG(YRSW02:YRSW03) TO YL0261 OF WORK-CONTEXT
               END-IF
      *        CASE: LCL.U:Option Code 5 is Battery Hire
      *        *IF
               IF (YL0261 OF WORK-CONTEXT = 'FACBA') THEN
      *            U:Option Price
                   ADD YL0260 OF WORK-CONTEXT, YL0168 OF WORK-CONTEXT
                     GIVING YL0260 OF WORK-CONTEXT
      *            U:Option Price
                   ADD YL0260 OF WORK-CONTEXT, YL0199 OF WORK-CONTEXT
                     GIVING YL0260 OF WORK-CONTEXT
               END-IF
           END-IF
      *    Check if Battery Option - Option 09
      *    CASE: LCL.VP Option Price 9 is Not Zero
      *    *IF
           IF (YL0169 OF WORK-CONTEXT NOT = 0) THEN
               MOVE 5 TO YRSW03
               MOVE 1 TO YRSW02
               IF (YRSW02 NOT > 0 OR
                   YRSW03 NOT > 0 OR
                   YRSW02 > 00006 OR
                   YRSW03 > 00006) THEN
                   MOVE 'Y2U0510' TO W0RTN
               ELSE
                   MOVE YL0233 OF WORK-CONTEXT TO W0STRNG
                   MOVE W0STRNG(YRSW02:YRSW03) TO YL0261 OF WORK-CONTEXT
               END-IF
      *        CASE: LCL.U:Option Code 5 is Battery Hire
      *        *IF
               IF (YL0261 OF WORK-CONTEXT = 'FACBA') THEN
      *            U:Option Price
                   ADD YL0260 OF WORK-CONTEXT, YL0169 OF WORK-CONTEXT
                     GIVING YL0260 OF WORK-CONTEXT
      *            U:Option Price
                   ADD YL0260 OF WORK-CONTEXT, YL0200 OF WORK-CONTEXT
                     GIVING YL0260 OF WORK-CONTEXT
               END-IF
           END-IF
      *    Check if Battery Option - Option 10
      *    CASE: LCL.VP Option Price 10 is Not Zero
      *    *IF
           IF (YL0170 OF WORK-CONTEXT NOT = 0) THEN
               MOVE 5 TO YRSW03
               MOVE 1 TO YRSW02
               IF (YRSW02 NOT > 0 OR
                   YRSW03 NOT > 0 OR
                   YRSW02 > 00006 OR
                   YRSW03 > 00006) THEN
                   MOVE 'Y2U0510' TO W0RTN
               ELSE
                   MOVE YL0234 OF WORK-CONTEXT TO W0STRNG
                   MOVE W0STRNG(YRSW02:YRSW03) TO YL0261 OF WORK-CONTEXT
               END-IF
      *        CASE: LCL.U:Option Code 5 is Battery Hire
      *        *IF
               IF (YL0261 OF WORK-CONTEXT = 'FACBA') THEN
      *            U:Option Price
                   ADD YL0260 OF WORK-CONTEXT, YL0170 OF WORK-CONTEXT
                     GIVING YL0260 OF WORK-CONTEXT
      *            U:Option Price
                   ADD YL0260 OF WORK-CONTEXT, YL0201 OF WORK-CONTEXT
                     GIVING YL0260 OF WORK-CONTEXT
               END-IF
           END-IF
      *    Check if Battery Option - Option 11
      *    CASE: LCL.VP Option Price 11 is Not Zero
      *    *IF
           IF (YL0171 OF WORK-CONTEXT NOT = 0) THEN
               MOVE 5 TO YRSW03
               MOVE 1 TO YRSW02
               IF (YRSW02 NOT > 0 OR
                   YRSW03 NOT > 0 OR
                   YRSW02 > 00006 OR
                   YRSW03 > 00006) THEN
                   MOVE 'Y2U0510' TO W0RTN
               ELSE
                   MOVE YL0235 OF WORK-CONTEXT TO W0STRNG
                   MOVE W0STRNG(YRSW02:YRSW03) TO YL0261 OF WORK-CONTEXT
               END-IF
      *        CASE: LCL.U:Option Code 5 is Battery Hire
      *        *IF
               IF (YL0261 OF WORK-CONTEXT = 'FACBA') THEN
      *            U:Option Price
                   ADD YL0260 OF WORK-CONTEXT, YL0171 OF WORK-CONTEXT
                     GIVING YL0260 OF WORK-CONTEXT
      *            U:Option Price
                   ADD YL0260 OF WORK-CONTEXT, YL0202 OF WORK-CONTEXT
                     GIVING YL0260 OF WORK-CONTEXT
               END-IF
           END-IF
      *    Check if Battery Option - Option 12
      *    CASE: LCL.VP Option Price 12 is Not Zero
      *    *IF
           IF (YL0172 OF WORK-CONTEXT NOT = 0) THEN
               MOVE 5 TO YRSW03
               MOVE 1 TO YRSW02
               IF (YRSW02 NOT > 0 OR
                   YRSW03 NOT > 0 OR
                   YRSW02 > 00006 OR
                   YRSW03 > 00006) THEN
                   MOVE 'Y2U0510' TO W0RTN
               ELSE
                   MOVE YL0236 OF WORK-CONTEXT TO W0STRNG
                   MOVE W0STRNG(YRSW02:YRSW03) TO YL0261 OF WORK-CONTEXT
               END-IF
      *        CASE: LCL.U:Option Code 5 is Battery Hire
      *        *IF
               IF (YL0261 OF WORK-CONTEXT = 'FACBA') THEN
      *            U:Option Price
                   ADD YL0260 OF WORK-CONTEXT, YL0172 OF WORK-CONTEXT
                     GIVING YL0260 OF WORK-CONTEXT
      *            U:Option Price
                   ADD YL0260 OF WORK-CONTEXT, YL0203 OF WORK-CONTEXT
                     GIVING YL0260 OF WORK-CONTEXT
               END-IF
           END-IF
      *    Check if Battery Option - Option 13
      *    CASE: LCL.VP Option Price 13 is Not Zero
      *    *IF
           IF (YL0173 OF WORK-CONTEXT NOT = 0) THEN
               MOVE 5 TO YRSW03
               MOVE 1 TO YRSW02
               IF (YRSW02 NOT > 0 OR
                   YRSW03 NOT > 0 OR
                   YRSW02 > 00006 OR
                   YRSW03 > 00006) THEN
                   MOVE 'Y2U0510' TO W0RTN
               ELSE
                   MOVE YL0237 OF WORK-CONTEXT TO W0STRNG
                   MOVE W0STRNG(YRSW02:YRSW03) TO YL0261 OF WORK-CONTEXT
               END-IF
      *        CASE: LCL.U:Option Code 5 is Battery Hire
      *        *IF
               IF (YL0261 OF WORK-CONTEXT = 'FACBA') THEN
      *            U:Option Price
                   ADD YL0260 OF WORK-CONTEXT, YL0173 OF WORK-CONTEXT
                     GIVING YL0260 OF WORK-CONTEXT
      *            U:Option Price
                   ADD YL0260 OF WORK-CONTEXT, YL0204 OF WORK-CONTEXT
                     GIVING YL0260 OF WORK-CONTEXT
               END-IF
           END-IF
      *    Check if Battery Option - Option 14
      *    CASE: LCL.VP Option Price 14 is Not Zero
      *    *IF
           IF (YL0174 OF WORK-CONTEXT NOT = 0) THEN
               MOVE 5 TO YRSW03
               MOVE 1 TO YRSW02
               IF (YRSW02 NOT > 0 OR
                   YRSW03 NOT > 0 OR
                   YRSW02 > 00006 OR
                   YRSW03 > 00006) THEN
                   MOVE 'Y2U0510' TO W0RTN
               ELSE
                   MOVE YL0238 OF WORK-CONTEXT TO W0STRNG
                   MOVE W0STRNG(YRSW02:YRSW03) TO YL0261 OF WORK-CONTEXT
               END-IF
      *        CASE: LCL.U:Option Code 5 is Battery Hire
      *        *IF
               IF (YL0261 OF WORK-CONTEXT = 'FACBA') THEN
      *            U:Option Price
                   ADD YL0260 OF WORK-CONTEXT, YL0174 OF WORK-CONTEXT
                     GIVING YL0260 OF WORK-CONTEXT
      *            U:Option Price
                   ADD YL0260 OF WORK-CONTEXT, YL0205 OF WORK-CONTEXT
                     GIVING YL0260 OF WORK-CONTEXT
               END-IF
           END-IF
      *    Check if Battery Option - Option 15
      *    CASE: LCL.VP Option Price 15 is Not Zero
      *    *IF
           IF (YL0175 OF WORK-CONTEXT NOT = 0) THEN
               MOVE 5 TO YRSW03
               MOVE 1 TO YRSW02
               IF (YRSW02 NOT > 0 OR
                   YRSW03 NOT > 0 OR
                   YRSW02 > 00006 OR
                   YRSW03 > 00006) THEN
                   MOVE 'Y2U0510' TO W0RTN
               ELSE
                   MOVE YL0239 OF WORK-CONTEXT TO W0STRNG
                   MOVE W0STRNG(YRSW02:YRSW03) TO YL0261 OF WORK-CONTEXT
               END-IF
      *        CASE: LCL.U:Option Code 5 is Battery Hire
      *        *IF
               IF (YL0261 OF WORK-CONTEXT = 'FACBA') THEN
      *            U:Option Price
                   ADD YL0260 OF WORK-CONTEXT, YL0175 OF WORK-CONTEXT
                     GIVING YL0260 OF WORK-CONTEXT
      *            U:Option Price
                   ADD YL0260 OF WORK-CONTEXT, YL0206 OF WORK-CONTEXT
                     GIVING YL0260 OF WORK-CONTEXT
               END-IF
           END-IF
      *    Check if Battery Option - Option 16
      *    CASE: LCL.VP Option Price 16 is Not Zero
      *    *IF
           IF (YL0176 OF WORK-CONTEXT NOT = 0) THEN
               MOVE 5 TO YRSW03
               MOVE 1 TO YRSW02
               IF (YRSW02 NOT > 0 OR
                   YRSW03 NOT > 0 OR
                   YRSW02 > 00006 OR
                   YRSW03 > 00006) THEN
                   MOVE 'Y2U0510' TO W0RTN
               ELSE
                   MOVE YL0240 OF WORK-CONTEXT TO W0STRNG
                   MOVE W0STRNG(YRSW02:YRSW03) TO YL0261 OF WORK-CONTEXT
               END-IF
      *        CASE: LCL.U:Option Code 5 is Battery Hire
      *        *IF
               IF (YL0261 OF WORK-CONTEXT = 'FACBA') THEN
      *            U:Option Price
                   ADD YL0260 OF WORK-CONTEXT, YL0176 OF WORK-CONTEXT
                     GIVING YL0260 OF WORK-CONTEXT
      *            U:Option Price
                   ADD YL0260 OF WORK-CONTEXT, YL0207 OF WORK-CONTEXT
                     GIVING YL0260 OF WORK-CONTEXT
               END-IF
           END-IF
      *    Check if Battery Option - Option 17
      *    CASE: LCL.VP Option Price 17 is Not Zero
      *    *IF
           IF (YL0177 OF WORK-CONTEXT NOT = 0) THEN
               MOVE 5 TO YRSW03
               MOVE 1 TO YRSW02
               IF (YRSW02 NOT > 0 OR
                   YRSW03 NOT > 0 OR
                   YRSW02 > 00006 OR
                   YRSW03 > 00006) THEN
                   MOVE 'Y2U0510' TO W0RTN
               ELSE
                   MOVE YL0241 OF WORK-CONTEXT TO W0STRNG
                   MOVE W0STRNG(YRSW02:YRSW03) TO YL0261 OF WORK-CONTEXT
               END-IF
      *        CASE: LCL.U:Option Code 5 is Battery Hire
      *        *IF
               IF (YL0261 OF WORK-CONTEXT = 'FACBA') THEN
      *            U:Option Price
                   ADD YL0260 OF WORK-CONTEXT, YL0177 OF WORK-CONTEXT
                     GIVING YL0260 OF WORK-CONTEXT
      *            U:Option Price
                   ADD YL0260 OF WORK-CONTEXT, YL0208 OF WORK-CONTEXT
                     GIVING YL0260 OF WORK-CONTEXT
               END-IF
           END-IF
      *    Check if Battery Option - Option 18
      *    CASE: LCL.VP Option Price 18 is Not Zero
      *    *IF
           IF (YL0178 OF WORK-CONTEXT NOT = 0) THEN
               MOVE 5 TO YRSW03
               MOVE 1 TO YRSW02
               IF (YRSW02 NOT > 0 OR
                   YRSW03 NOT > 0 OR
                   YRSW02 > 00006 OR
                   YRSW03 > 00006) THEN
                   MOVE 'Y2U0510' TO W0RTN
               ELSE
                   MOVE YL0242 OF WORK-CONTEXT TO W0STRNG
                   MOVE W0STRNG(YRSW02:YRSW03) TO YL0261 OF WORK-CONTEXT
               END-IF
      *        CASE: LCL.U:Option Code 5 is Battery Hire
      *        *IF
               IF (YL0261 OF WORK-CONTEXT = 'FACBA') THEN
      *            U:Option Price
                   ADD YL0260 OF WORK-CONTEXT, YL0178 OF WORK-CONTEXT
                     GIVING YL0260 OF WORK-CONTEXT
      *            U:Option Price
                   ADD YL0260 OF WORK-CONTEXT, YL0209 OF WORK-CONTEXT
                     GIVING YL0260 OF WORK-CONTEXT
               END-IF
           END-IF
      *    Check if Battery Option - Option 19
      *    CASE: LCL.VP Option Price 19 is Not Zero
      *    *IF
           IF (YL0179 OF WORK-CONTEXT NOT = 0) THEN
               MOVE 5 TO YRSW03
               MOVE 1 TO YRSW02
               IF (YRSW02 NOT > 0 OR
                   YRSW03 NOT > 0 OR
                   YRSW02 > 00006 OR
                   YRSW03 > 00006) THEN
                   MOVE 'Y2U0510' TO W0RTN
               ELSE
                   MOVE YL0243 OF WORK-CONTEXT TO W0STRNG
                   MOVE W0STRNG(YRSW02:YRSW03) TO YL0261 OF WORK-CONTEXT
               END-IF
      *        CASE: LCL.U:Option Code 5 is Battery Hire
      *        *IF
               IF (YL0261 OF WORK-CONTEXT = 'FACBA') THEN
      *            U:Option Price
                   ADD YL0260 OF WORK-CONTEXT, YL0179 OF WORK-CONTEXT
                     GIVING YL0260 OF WORK-CONTEXT
      *            U:Option Price
                   ADD YL0260 OF WORK-CONTEXT, YL0210 OF WORK-CONTEXT
                     GIVING YL0260 OF WORK-CONTEXT
               END-IF
           END-IF
      *    Check if Battery Option - Option 20
      *    CASE: LCL.VP Option Price 20 is Not Zero
      *    *IF
           IF (YL0180 OF WORK-CONTEXT NOT = 0) THEN
               MOVE 5 TO YRSW03
               MOVE 1 TO YRSW02
               IF (YRSW02 NOT > 0 OR
                   YRSW03 NOT > 0 OR
                   YRSW02 > 00006 OR
                   YRSW03 > 00006) THEN
                   MOVE 'Y2U0510' TO W0RTN
               ELSE
                   MOVE YL0244 OF WORK-CONTEXT TO W0STRNG
                   MOVE W0STRNG(YRSW02:YRSW03) TO YL0261 OF WORK-CONTEXT
               END-IF
      *        CASE: LCL.U:Option Code 5 is Battery Hire
      *        *IF
               IF (YL0261 OF WORK-CONTEXT = 'FACBA') THEN
      *            U:Option Price
                   ADD YL0260 OF WORK-CONTEXT, YL0180 OF WORK-CONTEXT
                     GIVING YL0260 OF WORK-CONTEXT
      *            U:Option Price
                   ADD YL0260 OF WORK-CONTEXT, YL0211 OF WORK-CONTEXT
                     GIVING YL0260 OF WORK-CONTEXT
               END-IF
           END-IF
      *    Check if Battery Option - Option 21
      *    CASE: LCL.VP Option Price 21 is Not Zero
      *    *IF
           IF (YL0181 OF WORK-CONTEXT NOT = 0) THEN
               MOVE 5 TO YRSW03
               MOVE 1 TO YRSW02
               IF (YRSW02 NOT > 0 OR
                   YRSW03 NOT > 0 OR
                   YRSW02 > 00006 OR
                   YRSW03 > 00006) THEN
                   MOVE 'Y2U0510' TO W0RTN
               ELSE
                   MOVE YL0245 OF WORK-CONTEXT TO W0STRNG
                   MOVE W0STRNG(YRSW02:YRSW03) TO YL0261 OF WORK-CONTEXT
               END-IF
      *        CASE: LCL.U:Option Code 5 is Battery Hire
      *        *IF
               IF (YL0261 OF WORK-CONTEXT = 'FACBA') THEN
      *            U:Option Price
                   ADD YL0260 OF WORK-CONTEXT, YL0181 OF WORK-CONTEXT
                     GIVING YL0260 OF WORK-CONTEXT
      *            U:Option Price
                   ADD YL0260 OF WORK-CONTEXT, YL0212 OF WORK-CONTEXT
                     GIVING YL0260 OF WORK-CONTEXT
               END-IF
           END-IF
      *    Check if Battery Option - Option 22
      *    CASE: LCL.VP Option Price 22 is Not Zero
      *    *IF
           IF (YL0182 OF WORK-CONTEXT NOT = 0) THEN
               MOVE 5 TO YRSW03
               MOVE 1 TO YRSW02
               IF (YRSW02 NOT > 0 OR
                   YRSW03 NOT > 0 OR
                   YRSW02 > 00006 OR
                   YRSW03 > 00006) THEN
                   MOVE 'Y2U0510' TO W0RTN
               ELSE
                   MOVE YL0246 OF WORK-CONTEXT TO W0STRNG
                   MOVE W0STRNG(YRSW02:YRSW03) TO YL0261 OF WORK-CONTEXT
               END-IF
      *        CASE: LCL.U:Option Code 5 is Battery Hire
      *        *IF
               IF (YL0261 OF WORK-CONTEXT = 'FACBA') THEN
      *            U:Option Price
                   ADD YL0260 OF WORK-CONTEXT, YL0182 OF WORK-CONTEXT
                     GIVING YL0260 OF WORK-CONTEXT
      *            U:Option Price
                   ADD YL0260 OF WORK-CONTEXT, YL0213 OF WORK-CONTEXT
                     GIVING YL0260 OF WORK-CONTEXT
               END-IF
           END-IF
      *    Check if Battery Option - Option 23
      *    CASE: LCL.VP Option Price 23 is Not Zero
      *    *IF
           IF (YL0183 OF WORK-CONTEXT NOT = 0) THEN
               MOVE 5 TO YRSW03
               MOVE 1 TO YRSW02
               IF (YRSW02 NOT > 0 OR
                   YRSW03 NOT > 0 OR
                   YRSW02 > 00006 OR
                   YRSW03 > 00006) THEN
                   MOVE 'Y2U0510' TO W0RTN
               ELSE
                   MOVE YL0247 OF WORK-CONTEXT TO W0STRNG
                   MOVE W0STRNG(YRSW02:YRSW03) TO YL0261 OF WORK-CONTEXT
               END-IF
      *        CASE: LCL.U:Option Code 5 is Battery Hire
      *        *IF
               IF (YL0261 OF WORK-CONTEXT = 'FACBA') THEN
      *            U:Option Price
                   ADD YL0260 OF WORK-CONTEXT, YL0183 OF WORK-CONTEXT
                     GIVING YL0260 OF WORK-CONTEXT
      *            U:Option Price
                   ADD YL0260 OF WORK-CONTEXT, YL0214 OF WORK-CONTEXT
                     GIVING YL0260 OF WORK-CONTEXT
               END-IF
           END-IF
      *    Check if Battery Option - Option 24
      *    CASE: LCL.VP Option Price 24 is Not Zero
      *    *IF
           IF (YL0184 OF WORK-CONTEXT NOT = 0) THEN
               MOVE 5 TO YRSW03
               MOVE 1 TO YRSW02
               IF (YRSW02 NOT > 0 OR
                   YRSW03 NOT > 0 OR
                   YRSW02 > 00006 OR
                   YRSW03 > 00006) THEN
                   MOVE 'Y2U0510' TO W0RTN
               ELSE
                   MOVE YL0248 OF WORK-CONTEXT TO W0STRNG
                   MOVE W0STRNG(YRSW02:YRSW03) TO YL0261 OF WORK-CONTEXT
               END-IF
      *        CASE: LCL.U:Option Code 5 is Battery Hire
      *        *IF
               IF (YL0261 OF WORK-CONTEXT = 'FACBA') THEN
      *            U:Option Price
                   ADD YL0260 OF WORK-CONTEXT, YL0184 OF WORK-CONTEXT
                     GIVING YL0260 OF WORK-CONTEXT
      *            U:Option Price
                   ADD YL0260 OF WORK-CONTEXT, YL0215 OF WORK-CONTEXT
                     GIVING YL0260 OF WORK-CONTEXT
               END-IF
           END-IF
      *    Check if Battery Option - Option 25
      *    CASE: LCL.VP Option Price 25 is Not Zero
      *    *IF
           IF (YL0185 OF WORK-CONTEXT NOT = 0) THEN
               MOVE 5 TO YRSW03
               MOVE 1 TO YRSW02
               IF (YRSW02 NOT > 0 OR
                   YRSW03 NOT > 0 OR
                   YRSW02 > 00006 OR
                   YRSW03 > 00006) THEN
                   MOVE 'Y2U0510' TO W0RTN
               ELSE
                   MOVE YL0249 OF WORK-CONTEXT TO W0STRNG
                   MOVE W0STRNG(YRSW02:YRSW03) TO YL0261 OF WORK-CONTEXT
               END-IF
      *        CASE: LCL.U:Option Code 5 is Battery Hire
      *        *IF
               IF (YL0261 OF WORK-CONTEXT = 'FACBA') THEN
      *            U:Option Price
                   ADD YL0260 OF WORK-CONTEXT, YL0185 OF WORK-CONTEXT
                     GIVING YL0260 OF WORK-CONTEXT
      *            U:Option Price
                   ADD YL0260 OF WORK-CONTEXT, YL0216 OF WORK-CONTEXT
                     GIVING YL0260 OF WORK-CONTEXT
               END-IF
           END-IF
      *    Check if Battery Option - Option 26
      *    CASE: LCL.VP Option Price 26 is Not Zero
      *    *IF
           IF (YL0186 OF WORK-CONTEXT NOT = 0) THEN
               MOVE 5 TO YRSW03
               MOVE 1 TO YRSW02
               IF (YRSW02 NOT > 0 OR
                   YRSW03 NOT > 0 OR
                   YRSW02 > 00006 OR
                   YRSW03 > 00006) THEN
                   MOVE 'Y2U0510' TO W0RTN
               ELSE
                   MOVE YL0250 OF WORK-CONTEXT TO W0STRNG
                   MOVE W0STRNG(YRSW02:YRSW03) TO YL0261 OF WORK-CONTEXT
               END-IF
      *        CASE: LCL.U:Option Code 5 is Battery Hire
      *        *IF
               IF (YL0261 OF WORK-CONTEXT = 'FACBA') THEN
      *            U:Option Price
                   ADD YL0260 OF WORK-CONTEXT, YL0186 OF WORK-CONTEXT
                     GIVING YL0260 OF WORK-CONTEXT
      *            U:Option Price
                   ADD YL0260 OF WORK-CONTEXT, YL0217 OF WORK-CONTEXT
                     GIVING YL0260 OF WORK-CONTEXT
               END-IF
           END-IF
      *    Check if Battery Option - Option 27
      *    CASE: LCL.VP Option Price 27 is Not Zero
      *    *IF
           IF (YL0187 OF WORK-CONTEXT NOT = 0) THEN
               MOVE 5 TO YRSW03
               MOVE 1 TO YRSW02
               IF (YRSW02 NOT > 0 OR
                   YRSW03 NOT > 0 OR
                   YRSW02 > 00006 OR
                   YRSW03 > 00006) THEN
                   MOVE 'Y2U0510' TO W0RTN
               ELSE
                   MOVE YL0251 OF WORK-CONTEXT TO W0STRNG
                   MOVE W0STRNG(YRSW02:YRSW03) TO YL0261 OF WORK-CONTEXT
               END-IF
      *        CASE: LCL.U:Option Code 5 is Battery Hire
      *        *IF
               IF (YL0261 OF WORK-CONTEXT = 'FACBA') THEN
      *            U:Option Price
                   ADD YL0260 OF WORK-CONTEXT, YL0187 OF WORK-CONTEXT
                     GIVING YL0260 OF WORK-CONTEXT
      *            U:Option Price
                   ADD YL0260 OF WORK-CONTEXT, YL0218 OF WORK-CONTEXT
                     GIVING YL0260 OF WORK-CONTEXT
               END-IF
           END-IF
      *    Check if Battery Option - Option 28
      *    CASE: LCL.VP Option Price 28 is Not Zero
      *    *IF
           IF (YL0188 OF WORK-CONTEXT NOT = 0) THEN
               MOVE 5 TO YRSW03
               MOVE 1 TO YRSW02
               IF (YRSW02 NOT > 0 OR
                   YRSW03 NOT > 0 OR
                   YRSW02 > 00006 OR
                   YRSW03 > 00006) THEN
                   MOVE 'Y2U0510' TO W0RTN
               ELSE
                   MOVE YL0252 OF WORK-CONTEXT TO W0STRNG
                   MOVE W0STRNG(YRSW02:YRSW03) TO YL0261 OF WORK-CONTEXT
               END-IF
      *        CASE: LCL.U:Option Code 5 is Battery Hire
      *        *IF
               IF (YL0261 OF WORK-CONTEXT = 'FACBA') THEN
      *            U:Option Price
                   ADD YL0260 OF WORK-CONTEXT, YL0188 OF WORK-CONTEXT
                     GIVING YL0260 OF WORK-CONTEXT
      *            U:Option Price
                   ADD YL0260 OF WORK-CONTEXT, YL0219 OF WORK-CONTEXT
                     GIVING YL0260 OF WORK-CONTEXT
               END-IF
           END-IF
      *    Check if Battery Option - Option 29
      *    CASE: LCL.VP Option Price 29 is Not Zero
      *    *IF
           IF (YL0189 OF WORK-CONTEXT NOT = 0) THEN
               MOVE 5 TO YRSW03
               MOVE 1 TO YRSW02
               IF (YRSW02 NOT > 0 OR
                   YRSW03 NOT > 0 OR
                   YRSW02 > 00006 OR
                   YRSW03 > 00006) THEN
                   MOVE 'Y2U0510' TO W0RTN
               ELSE
                   MOVE YL0253 OF WORK-CONTEXT TO W0STRNG
                   MOVE W0STRNG(YRSW02:YRSW03) TO YL0261 OF WORK-CONTEXT
               END-IF
      *        CASE: LCL.U:Option Code 5 is Battery Hire
      *        *IF
               IF (YL0261 OF WORK-CONTEXT = 'FACBA') THEN
      *            U:Option Price
                   ADD YL0260 OF WORK-CONTEXT, YL0189 OF WORK-CONTEXT
                     GIVING YL0260 OF WORK-CONTEXT
      *            U:Option Price
                   ADD YL0260 OF WORK-CONTEXT, YL0220 OF WORK-CONTEXT
                     GIVING YL0260 OF WORK-CONTEXT
               END-IF
           END-IF
      *    Check if Battery Option - Option 30
      *    CASE: LCL.VP Option Price 30 is Not Zero
      *    *IF
           IF (YL0190 OF WORK-CONTEXT NOT = 0) THEN
               MOVE 5 TO YRSW03
               MOVE 1 TO YRSW02
               IF (YRSW02 NOT > 0 OR
                   YRSW03 NOT > 0 OR
                   YRSW02 > 00006 OR
                   YRSW03 > 00006) THEN
                   MOVE 'Y2U0510' TO W0RTN
               ELSE
                   MOVE YL0254 OF WORK-CONTEXT TO W0STRNG
                   MOVE W0STRNG(YRSW02:YRSW03) TO YL0261 OF WORK-CONTEXT
               END-IF
      *        CASE: LCL.U:Option Code 5 is Battery Hire
      *        *IF
               IF (YL0261 OF WORK-CONTEXT = 'FACBA') THEN
      *            U:Option Price
                   ADD YL0260 OF WORK-CONTEXT, YL0190 OF WORK-CONTEXT
                     GIVING YL0260 OF WORK-CONTEXT
      *            U:Option Price
                   ADD YL0260 OF WORK-CONTEXT, YL0221 OF WORK-CONTEXT
                     GIVING YL0260 OF WORK-CONTEXT
               END-IF
           END-IF
      *==============================================================
           CONTINUE.
       UA5EXIT.
           EXIT.
      /EJECT
       ZASNMS SECTION.
      *==============================================================
      *    Send message to program's message queue
      *==============================================================
      *    Send if first error message or not an error message
           IF (ZAMSTP NOT = SPACES OR
               ZAFSMS NOT = 'N') THEN
               IF (ZAMSTP = SPACES) THEN
      *            Signal first error message sent
                   MOVE 'N' TO ZAFSMS
               END-IF
               IF (ZAPGMQ = SPACES) THEN
                   MOVE ZZPGM OF JOB-CONTEXT TO ZAPGMQ
               END-IF
               CALL 'Y2SNMGC' USING
      *        Program queue
                 ZAPGMQ
      *        Relative queue
                 ZAPGRL
      *        Message ID
                 ZAMSID
      *        Message file
                 ZAMSGF
      *        Message data
                 ZAMSDA
      *        Message type
                 ZAMSTP
               END-CALL
           END-IF
      *    Clear all fields for default mechanism next time
      *    Program queue
           MOVE SPACES TO ZAPGMQ
      *    Relative queue
           MOVE SPACES TO ZAPGRL
      *    Message ID
           MOVE SPACES TO ZAMSID
      *    Message file
           MOVE SPACES TO ZAMSGF
      *    Message data
           MOVE SPACES TO ZAMSDA
      *    Message type
           MOVE SPACES TO ZAMSTP
      *==============================================================
           CONTINUE.
       ZAEXIT.
           EXIT.
      /EJECT
       ZCATWK SECTION.
      *==============================================================
      *    Process *CONCAT request
      *==============================================================
           MOVE YRSW04 TO YRSW00
           MOVE ZEROS TO YRSW01
           IF (YRSW05 = SPACES) THEN
               ADD YRSW02 TO YRSW01
               ADD YRSW03 TO YRSW01
               ADD  1 TO YRSW01
               IF (YRSW01 < YRSW04) THEN
                   MOVE X'FF' TO YRSW06X(YRSW01)
               ELSE
                   MOVE X'FF' TO YRSW06X(YRSW04)
               END-IF
           END-IF
           IF (YRSW05 = 'T') THEN
               PERFORM UNTIL NOT (YRSW01 = 0)
                   SUBTRACT 1 FROM YRSW00
                   IF (YRSW00 = 0) THEN
                       MOVE X'FF' TO YRSW06X(YRSW04)
                       ADD  1  TO YRSW01
                   ELSE
                       IF (YRSW06X(YRSW00) NOT = SPACES) THEN
                           MOVE YRSW00 TO YRSW01
                           ADD   1 TO YRSW01
                           ADD  YRSW03 TO YRSW01
                           MOVE X'FF' TO YRSW06X(YRSW01)
                       END-IF
                   END-IF
               END-PERFORM
           END-IF
      *==============================================================
           CONTINUE.
       ZCEXIT.
           EXIT.
      /EJECT
       ZXEXPG SECTION.
      *==============================================================
      *    Exit program: Normal
      *==============================================================
           PERFORM ZYEXPG
      *==============================================================
           CONTINUE.
       ZXEXIT.
           EXIT.
      /EJECT
       ZYEXPG SECTION.
      *==============================================================
      *    Exit program: Direct
      *==============================================================
           CLOSE VAMDLREFL4
           CLOSE VAVEHDTALE
           CLOSE RAVERSETL6
           CLOSE SFACAPXRL1
           CLOSE VAMVVSCPL2
           CLOSE VAMVFLSTL1
           CLOSE RAAOCVPRL2
           CLOSE AGRDLR10L1
           CLOSE VAVEHDTAL2
           CLOSE AGPICG00L1
           CLOSE VAMVRTRML1
           CLOSE VAVINATNL1
           CLOSE AGRDLR00L1
           CLOSE AGAUTOBUL2
           CLOSE AGAUTOBUL0
      *    Reset entry parameters as appropriate
           PERFORM ZZEXPM.
      *    Exit program
           CONTINUE.
       ZYEXPG-EXIT.
           GOBACK.
      *==============================================================
           CONTINUE.
       ZYEXIT.
           EXIT.
      /EJECT
       ZZEXPM SECTION.
      *==============================================================
      *    Return parameters from work fields
      *==============================================================
      *==============================================================
           CONTINUE.
       ZZPEXT.
           EXIT.
      /EJECT
       ZZINIT SECTION.
      *==============================================================
      *    Initialisation
      *==============================================================
           IF (W0ICL = SPACES) THEN
      *        *Initial call
               MOVE 'Y' TO W0ICL
           ELSE
               MOVE 'N' TO W0ICL
           END-IF
           MOVE SPACES TO P0RTN
           MOVE SPACES TO W0RTN
           MOVE ZEROS  TO W0RTW
           MOVE SPACES TO W0RSF
           MOVE '400' TO W0ENV
           MOVE ALL B'0' TO INDICS
      *    Clear all neither parameters
           INITIALIZE P6PARM
           INITIALIZE P7PARM
           MOVE SPACES TO ZZPGM OF JOB-CONTEXT
      *    Retrieve job attributes
           CALL 'Y2RTJCR' USING
             JOB-CONTEXT
           END-CALL
      *    Setup job date/time
           MOVE ZZSD7 OF JOB-CONTEXT TO ZZJDT
           ACCEPT ZZTIME FROM TIME
           MOVE ZZHNS TO ZZJTM OF JOB-CONTEXT
           MOVE 'AGR000210S' TO ZZPGM OF JOB-CONTEXT
      *    Define work field Model Marketing Desc.
           MOVE SPACES TO WUMDLMRKD OF WORK-CONTEXT
      *    Define work field Vehicle Model Trim Level
           MOVE SPACES TO WUVEHTRIML OF WORK-CONTEXT
      *    Define work field Vehicle Body Name ATR
           MOVE SPACES TO WUVEHBDYNM OF WORK-CONTEXT
      *    Define work field Dealer Network Type
           MOVE SPACES TO WUDLRNET OF WORK-CONTEXT
      *    Signal first error message outstanding
           MOVE 'Y' TO ZAFSMS
      *    Open files
           OPEN INPUT VAMDLREFL4
           ACCEPT VAMDLREFL4-OPEN FROM OPEN-FEEDBACK-AREA FOR VAMDLREFL4
      *    Move main file information to JOB context
           MOVE CORRESPONDING OPENFA OF VAMDLREFL4-OPEN TO JOB-CONTEXT
           CALL 'Y2QLVNR' USING
             ZZFFL OF JOB-CONTEXT
             ZZFLB OF JOB-CONTEXT
             ZZFQL OF JOB-CONTEXT
           END-CALL
           OPEN INPUT VAVEHDTALE
           ACCEPT VAVEHDTALE-OPEN FROM OPEN-FEEDBACK-AREA FOR VAVEHDTALE
           OPEN INPUT RAVERSETL6
           ACCEPT RAVERSETL6-OPEN FROM OPEN-FEEDBACK-AREA FOR RAVERSETL6
           OPEN INPUT SFACAPXRL1
           ACCEPT SFACAPXRL1-OPEN FROM OPEN-FEEDBACK-AREA FOR SFACAPXRL1
           OPEN INPUT VAMVVSCPL2
           ACCEPT VAMVVSCPL2-OPEN FROM OPEN-FEEDBACK-AREA FOR VAMVVSCPL2
           OPEN INPUT VAMVFLSTL1
           ACCEPT VAMVFLSTL1-OPEN FROM OPEN-FEEDBACK-AREA FOR VAMVFLSTL1
           OPEN INPUT RAAOCVPRL2
           ACCEPT RAAOCVPRL2-OPEN FROM OPEN-FEEDBACK-AREA FOR RAAOCVPRL2
           OPEN INPUT AGRDLR10L1
           ACCEPT AGRDLR10L1-OPEN FROM OPEN-FEEDBACK-AREA FOR AGRDLR10L1
           OPEN INPUT VAVEHDTAL2
           ACCEPT VAVEHDTAL2-OPEN FROM OPEN-FEEDBACK-AREA FOR VAVEHDTAL2
           OPEN INPUT AGPICG00L1
           ACCEPT AGPICG00L1-OPEN FROM OPEN-FEEDBACK-AREA FOR AGPICG00L1
           OPEN INPUT VAMVRTRML1
           ACCEPT VAMVRTRML1-OPEN FROM OPEN-FEEDBACK-AREA FOR VAMVRTRML1
           OPEN INPUT VAVINATNL1
           ACCEPT VAVINATNL1-OPEN FROM OPEN-FEEDBACK-AREA FOR VAVINATNL1
           OPEN INPUT AGRDLR00L1
           ACCEPT AGRDLR00L1-OPEN FROM OPEN-FEEDBACK-AREA FOR AGRDLR00L1
           OPEN INPUT AGAUTOBUL2
           ACCEPT AGAUTOBUL2-OPEN FROM OPEN-FEEDBACK-AREA FOR AGAUTOBUL2
           OPEN I-O AGAUTOBUL0
           ACCEPT AGAUTOBUL0-OPEN FROM OPEN-FEEDBACK-AREA FOR AGAUTOBUL0
           MOVE 'Y' TO W0OPN
           MOVE 'N' TO W0PMT
      *    Define local work field SCP Model code
           MOVE SPACES TO YL0001 OF WORK-CONTEXT
      *    Define local work field Price Start Date - Dealer
           MOVE ZERO TO YL0002 OF WORK-CONTEXT
      *    Define local work field U:Job date long (D8#)
           MOVE ZERO TO YL0003 OF WORK-CONTEXT
      *    Define local work field Brand Code
           MOVE SPACES TO YL0004 OF WORK-CONTEXT
      *    Define local work field VEH-RETCODE
           MOVE SPACES TO YL0005 OF WORK-CONTEXT
      *    Define local work field VEH-RECORD-AVEHBR2CB
           MOVE SPACES TO YL0006 OF WORK-CONTEXT
      *    Define local work field U:Text (7) b
           MOVE SPACES TO YL0007 OF WORK-CONTEXT
      *    Define local work field VEH-APLCDE
           MOVE SPACES TO YL0008 OF WORK-CONTEXT
      *    Define local work field Brand 15
           MOVE SPACES TO YL0009 OF WORK-CONTEXT
      *    Define local work field Phase
           MOVE SPACES TO YL0010 OF WORK-CONTEXT
      *    Define local work field SCP Model Version Code
           MOVE SPACES TO YL0011 OF WORK-CONTEXT
      *    Define local work field Model Marketing Desc.
           MOVE SPACES TO YL0012 OF WORK-CONTEXT
      *    Define local work field U:Text (5)
           MOVE SPACES TO YL0013 OF WORK-CONTEXT
      *    Define local work field U:Model Year(millesme)
           MOVE SPACES TO YN0001 OF WORK-CONTEXT
      *    Define local work field U:Vehicle Database Rec
           MOVE SPACES TO YN0002 OF WORK-CONTEXT
      *    Define local work field Version Marketing Desc.
           MOVE SPACES TO YL0014 OF WORK-CONTEXT
      *    Define local work field Vehicle Model Trim Level
           MOVE SPACES TO YL0015 OF WORK-CONTEXT
      *    Define local work field U:Text (7)
           MOVE SPACES TO YL0016 OF WORK-CONTEXT
      *    Define local work field Vehicle Body Name ATR
           MOVE SPACES TO YL0017 OF WORK-CONTEXT
      *    Define local work field Vehicle Body Class Code
           MOVE SPACES TO YL0018 OF WORK-CONTEXT
      *    Define local work field Autotrader Vehicle Type
           MOVE SPACES TO YL0019 OF WORK-CONTEXT
      *    Define local work field U:Text (4)
           MOVE SPACES TO YL0020 OF WORK-CONTEXT
      *    Define local work field U:Position Found (NBR)
           MOVE ZERO TO YL0021 OF WORK-CONTEXT
      *    Define local work field V55 Model Version Desc
           MOVE SPACES TO YN0003 OF WORK-CONTEXT
      *    Define local work field Manufacturer Code
           MOVE SPACES TO YN0004 OF WORK-CONTEXT
      *    Define local work field SMMT MVRIS Make Code
           MOVE SPACES TO YN0005 OF WORK-CONTEXT
      *    Define local work field SMMT Model MVRIS Code
           MOVE SPACES TO YN0006 OF WORK-CONTEXT
      *    Define local work field DVLA Make Code
           MOVE SPACES TO YN0007 OF WORK-CONTEXT
      *    Define local work field SMMT Model Code
           MOVE SPACES TO YN0008 OF WORK-CONTEXT
      *    Define local work field Vehicle Body Code
           MOVE SPACES TO YN0009 OF WORK-CONTEXT
      *    Define local work field DVLA Type Approval Categ
           MOVE SPACES TO YN0010 OF WORK-CONTEXT
      *    Define local work field Vehicle Fuel Code
           MOVE SPACES TO YL0022 OF WORK-CONTEXT
      *    Define local work field Model Engine Capacity
           MOVE ZERO TO YL0023 OF WORK-CONTEXT
      *    Define local work field Gross Weight
           MOVE ZERO TO YL0024 OF WORK-CONTEXT
      *    Define local work field Net Weight
           MOVE ZERO TO YN0011 OF WORK-CONTEXT
      *    Define local work field Typemines
           MOVE SPACES TO YN0012 OF WORK-CONTEXT
      *    Define local work field High Performance (Y/N)
           MOVE SPACES TO YN0013 OF WORK-CONTEXT
      *    Define local work field Special Edition (Y/N)
           MOVE SPACES TO YN0014 OF WORK-CONTEXT
      *    Define local work field Gearbox Type Sts
           MOVE SPACES TO YL0025 OF WORK-CONTEXT
      *    Define local work field Number of doors
           MOVE ZERO TO YL0026 OF WORK-CONTEXT
      *    Define local work field Seating Capacity V55
           MOVE ZERO TO YL0027 OF WORK-CONTEXT
      *    Define local work field Tax Class Code
           MOVE ZERO TO YN0015 OF WORK-CONTEXT
      *    Define local work field Vehicle Database Rec Sts
           MOVE SPACES TO YN0016 OF WORK-CONTEXT
      *    Define local work field AOC Parent Set Descript
           MOVE SPACES TO YL0028 OF WORK-CONTEXT
      *    Define local work field AOC Set Description
           MOVE SPACES TO YL0029 OF WORK-CONTEXT
      *    Define local work field U:Found
           MOVE SPACES TO YL0030 OF WORK-CONTEXT
      *    Define local work field U:Continue (Y/N)
           MOVE SPACES TO YL0031 OF WORK-CONTEXT
      *    Define local work field U:Text (1)
           MOVE SPACES TO YL0032 OF WORK-CONTEXT
      *    Define local work field U:Position Start (NBR)
           MOVE ZERO TO YL0033 OF WORK-CONTEXT
      *    Define local work field U:Length
           MOVE ZERO TO YL0034 OF WORK-CONTEXT
      *    Define local work field CAP Vehicle Code
           MOVE SPACES TO YL0035 OF WORK-CONTEXT
      *    Define local work field CAP Vehicle ID Number
           MOVE ZERO TO YL0036 OF WORK-CONTEXT
      *    Define local work field CAP Model Dsc Cleansed
           MOVE SPACES TO YL0037 OF WORK-CONTEXT
      *    Define local work field CAP Version Dsc Cleansed
           MOVE SPACES TO YL0038 OF WORK-CONTEXT
      *    Define local work field SCR Model Code
           MOVE SPACES TO YN0017 OF WORK-CONTEXT
      *    Define local work field SCR Model Version Code
           MOVE SPACES TO YN0018 OF WORK-CONTEXT
      *    Define local work field U:Text (100) From
           MOVE SPACES TO YL0039 OF WORK-CONTEXT
      *    Define local work field U:Text (100) To
           MOVE SPACES TO YL0040 OF WORK-CONTEXT
      *    Define local work field U:Return Code Id
           MOVE SPACES TO YL0041 OF WORK-CONTEXT
      *    Define local work field U:update (Y/N)
           MOVE SPACES TO YL0042 OF WORK-CONTEXT
      *    Define local work field Vehicle Version KSP All
           MOVE SPACES TO YL0043 OF WORK-CONTEXT
      *    Define local work field Model Version KSP Spec
           MOVE SPACES TO YL0044 OF WORK-CONTEXT
      *    Define local work field U:Inspect tally
           MOVE ZERO TO YL0045 OF WORK-CONTEXT
      *    Define local work field Vehicle First Reg Fee
           MOVE ZERO TO YL0046 OF WORK-CONTEXT
      *    Define local work field AOC Price/Pct Value
           MOVE ZERO TO YL0047 OF WORK-CONTEXT
      *    Define local work field Vehicle Road Fun License
           MOVE ZERO TO YL0048 OF WORK-CONTEXT
      *    Define local work field Technical Equipment Value
           MOVE SPACES TO YL0049 OF WORK-CONTEXT
      *    Define local work field Vehicle Horse Power
           MOVE SPACES TO YL0050 OF WORK-CONTEXT
      *    Define local work field Vehicle Drive System
           MOVE SPACES TO YL0051 OF WORK-CONTEXT
      *    Define local work field Vehicle Fuel Tank Cap
           MOVE SPACES TO YL0052 OF WORK-CONTEXT
      *    Define local work field Vehicle External Length
           MOVE SPACES TO YL0053 OF WORK-CONTEXT
      *    Define local work field Vehicle Ext Length Units
           MOVE SPACES TO YL0054 OF WORK-CONTEXT
      *    Define local work field Vehicle Ext Length AddTxt
           MOVE SPACES TO YL0055 OF WORK-CONTEXT
      *    Define local work field U:Length
           MOVE ZERO TO YL0056 OF WORK-CONTEXT
      *    Define local work field U:Text (1)
           MOVE SPACES TO YL0057 OF WORK-CONTEXT
      *    Define local work field Vehicle External Length
           MOVE SPACES TO YL0058 OF WORK-CONTEXT
      *    Define local work field Vehicle Ext Length Units
           MOVE SPACES TO YL0059 OF WORK-CONTEXT
      *    Define local work field U:Length 3
           MOVE ZERO TO YL0060 OF WORK-CONTEXT
      *    Define local work field U:Text (4)
           MOVE SPACES TO YL0061 OF WORK-CONTEXT
      *    Define local work field U:Position Found (NBR)
           MOVE ZERO TO YL0062 OF WORK-CONTEXT
      *    Define local work field U:Found
           MOVE SPACES TO YL0063 OF WORK-CONTEXT
      *    Define local work field U:Continue (Y/N)
           MOVE SPACES TO YL0064 OF WORK-CONTEXT
      *    Define local work field U:Text (4)
           MOVE SPACES TO YL0065 OF WORK-CONTEXT
      *    Define local work field U:Position Start (NBR)
           MOVE ZERO TO YL0066 OF WORK-CONTEXT
      *    Define local work field U:Length 2
           MOVE ZERO TO YL0067 OF WORK-CONTEXT
      *    Define local work field Vehicle External Width
           MOVE SPACES TO YL0068 OF WORK-CONTEXT
      *    Define local work field Vehicle External Height
           MOVE SPACES TO YL0069 OF WORK-CONTEXT
      *    Define local work field Vehicle Ext Height Units
           MOVE SPACES TO YL0070 OF WORK-CONTEXT
      *    Define local work field Vehicle Ext Height AddTxt
           MOVE SPACES TO YL0071 OF WORK-CONTEXT
      *    Define local work field U:Length
           MOVE ZERO TO YL0072 OF WORK-CONTEXT
      *    Define local work field U:Text (1)
           MOVE SPACES TO YL0073 OF WORK-CONTEXT
      *    Define local work field Vehicle External Height
           MOVE SPACES TO YL0074 OF WORK-CONTEXT
      *    Define local work field Vehicle Ext Height Units
           MOVE SPACES TO YL0075 OF WORK-CONTEXT
      *    Define local work field U:Length 3
           MOVE ZERO TO YL0076 OF WORK-CONTEXT
      *    Define local work field U:Text (4)
           MOVE SPACES TO YL0077 OF WORK-CONTEXT
      *    Define local work field U:Position Found (NBR)
           MOVE ZERO TO YL0078 OF WORK-CONTEXT
      *    Define local work field U:Found
           MOVE SPACES TO YL0079 OF WORK-CONTEXT
      *    Define local work field U:Length 2
           MOVE ZERO TO YL0080 OF WORK-CONTEXT
      *    Define local work field Vehicle Top Speed
           MOVE SPACES TO YL0081 OF WORK-CONTEXT
      *    Define local work field Vehicle Wheelbase
           MOVE SPACES TO YL0082 OF WORK-CONTEXT
      *    Define local work field Vehicle Range
           MOVE SPACES TO YL0083 OF WORK-CONTEXT
      *    Define local work field Vehicle Chassis No
           MOVE SPACES TO YL0084 OF WORK-CONTEXT
      *    Define local work field Dealer Type Code
           MOVE SPACES TO YN0019 OF WORK-CONTEXT
      *    Define local work field Dealer number
           MOVE SPACES TO YL0085 OF WORK-CONTEXT
      *    Define local work field Dealer number suffix
           MOVE SPACES TO YL0086 OF WORK-CONTEXT
      *    Define local work field Dealer number (fin)
           MOVE SPACES TO YL0087 OF WORK-CONTEXT
      *    Define local work field Name Number
           MOVE SPACES TO YN0020 OF WORK-CONTEXT
      *    Define local work field Address Number
           MOVE SPACES TO YN0021 OF WORK-CONTEXT
      *    Define local work field Dealer Network Type
           MOVE SPACES TO YL0088 OF WORK-CONTEXT
      *    Define local work field Dealer Region Code
           MOVE SPACES TO YN0022 OF WORK-CONTEXT
      *    Define local work field Dealer Zone code
           MOVE SPACES TO YN0023 OF WORK-CONTEXT
      *    Define local work field Dealer Trading Name
           MOVE SPACES TO YN0024 OF WORK-CONTEXT
      *    Define local work field Dealer Short Name
           MOVE SPACES TO YN0025 OF WORK-CONTEXT
      *    Define local work field Dealer Activity Start Dte
           MOVE ZERO TO YN0026 OF WORK-CONTEXT
      *    Define local work field Dealer Servicing End Date
           MOVE ZERO TO YN0027 OF WORK-CONTEXT
      *    Define local work field Dealer Cancel Final Date
           MOVE ZERO TO YN0028 OF WORK-CONTEXT
      *    Define local work field Dealer Set-up Date
           MOVE ZERO TO YN0029 OF WORK-CONTEXT
      *    Define local work field Dealer Change Date
           MOVE ZERO TO YN0030 OF WORK-CONTEXT
      *    Define local work field Dealer Cancel Date
           MOVE ZERO TO YN0031 OF WORK-CONTEXT
      *    Define local work field Dealer Financial Status
           MOVE SPACES TO YN0032 OF WORK-CONTEXT
      *    Define local work field Dealer Record Status
           MOVE SPACES TO YN0033 OF WORK-CONTEXT
      *    Define local work field BIR Address Identifier
           MOVE SPACES TO YN0034 OF WORK-CONTEXT
      *    Define local work field Dealer Address Line#1
           MOVE SPACES TO YN0035 OF WORK-CONTEXT
      *    Define local work field Dealer Address Line#2
           MOVE SPACES TO YN0036 OF WORK-CONTEXT
      *    Define local work field Dealer Address Line#3
           MOVE SPACES TO YN0037 OF WORK-CONTEXT
      *    Define local work field Dealer Address Line#4
           MOVE SPACES TO YN0038 OF WORK-CONTEXT
      *    Define local work field Dealer Postal Code
           MOVE SPACES TO YN0039 OF WORK-CONTEXT
      *    Define local work field Dealer Town
           MOVE SPACES TO YN0040 OF WORK-CONTEXT
      *    Define local work field Dealer Telephone Number
           MOVE SPACES TO YN0041 OF WORK-CONTEXT
      *    Define local work field Dealer Fax Number
           MOVE SPACES TO YN0042 OF WORK-CONTEXT
      *    Define local work field Dealer Country Identifier
           MOVE SPACES TO YN0043 OF WORK-CONTEXT
      *    Define local work field Network/Non Network Ind
           MOVE SPACES TO YN0044 OF WORK-CONTEXT
      *    Define local work field Dealer Number (Numeric)
           MOVE ZERO TO YN0045 OF WORK-CONTEXT
      *    Define local work field Lead Dealer Number
           MOVE SPACES TO YL0089 OF WORK-CONTEXT
      *    Define local work field Lead Dealer Number Suffix
           MOVE SPACES TO YL0090 OF WORK-CONTEXT
      *    Define local work field Lead Dealer Nbr (Numeric)
           MOVE ZERO TO YN0046 OF WORK-CONTEXT
      *    Define local work field Lead Country Identifier
           MOVE SPACES TO YN0047 OF WORK-CONTEXT
      *    Define local work field Dealer Spare Flag 1
           MOVE SPACES TO YN0048 OF WORK-CONTEXT
      *    Define local work field Dealer Spare Flag 2
           MOVE SPACES TO YN0049 OF WORK-CONTEXT
      *    Define local work field Dealer Spare Flag 3
           MOVE SPACES TO YN0050 OF WORK-CONTEXT
      *    Define local work field Dealer Spare Code 1
           MOVE SPACES TO YN0051 OF WORK-CONTEXT
      *    Define local work field Dealer Spare Code 2
           MOVE SPACES TO YN0052 OF WORK-CONTEXT
      *    Define local work field Dealer Percentage 1
           MOVE ZERO TO YN0053 OF WORK-CONTEXT
      *    Define local work field Dealer Percentage 2
           MOVE ZERO TO YN0054 OF WORK-CONTEXT
      *    Define local work field Dealer Percentage 3
           MOVE ZERO TO YN0055 OF WORK-CONTEXT
      *    Define local work field Dealer Percentage 4
           MOVE ZERO TO YN0056 OF WORK-CONTEXT
      *    Define local work field Dealer Known By Name
           MOVE SPACES TO YN0057 OF WORK-CONTEXT
      *    Define local work field Lead Dealer Number
           MOVE SPACES TO YN0058 OF WORK-CONTEXT
      *    Define local work field Lead Dealer Number Suffix
           MOVE SPACES TO YN0059 OF WORK-CONTEXT
      *    Define local work field Colour Type Code
           MOVE SPACES TO YN0060 OF WORK-CONTEXT
      *    Define local work field Vehicle MVRIS Colour Code
           MOVE SPACES TO YN0061 OF WORK-CONTEXT
      *    Define local work field Vehicle MVRIS Colour Cde2
           MOVE SPACES TO YN0062 OF WORK-CONTEXT
      *    Define local work field Vehicle MVRIS Colour Cde3
           MOVE SPACES TO YN0063 OF WORK-CONTEXT
      *    Define local work field Colour Type Category Code
           MOVE SPACES TO YN0064 OF WORK-CONTEXT
      *    Define local work field MVRIS Fuel Description
           MOVE SPACES TO YN0065 OF WORK-CONTEXT
      *    Define local work field MVRIS Fuel Code
           MOVE SPACES TO YN0066 OF WORK-CONTEXT
      *    Define local work field U:Count (3.0)
           MOVE ZERO TO YL0091 OF WORK-CONTEXT
      *    Define local work field U:Length
           MOVE ZERO TO YL0092 OF WORK-CONTEXT
      *    Define local work field U:Length 2
           MOVE ZERO TO YL0093 OF WORK-CONTEXT
      *    Define local work field U:Position Start (NBR)
           MOVE ZERO TO YL0094 OF WORK-CONTEXT
      *    Define local work field U:Position Found (NBR)
           MOVE ZERO TO YL0095 OF WORK-CONTEXT
      *    Define local work field U:Found
           MOVE SPACES TO YL0096 OF WORK-CONTEXT
      *    Define local work field *For length
           MOVE ZERO TO YL0097 OF WORK-CONTEXT
      *    Define local work field SC Option code
           MOVE SPACES TO YL0098 OF WORK-CONTEXT
      *    Define local work field Model option description
           MOVE SPACES TO YL0099 OF WORK-CONTEXT
      *    Define local work field Vehicle Database Rec Sts
           MOVE SPACES TO YN0067 OF WORK-CONTEXT
      *    Define local work field U:Number (2.0)
           MOVE ZERO TO YL0100 OF WORK-CONTEXT
      *    Define local work field U:Number (2.0) b
           MOVE ZERO TO YL0101 OF WORK-CONTEXT
      *    Define local work field U:Number (2.0) c
           MOVE ZERO TO YL0102 OF WORK-CONTEXT
      *    Define local work field U:Number (2.0) d
           MOVE ZERO TO YL0103 OF WORK-CONTEXT
      *    Define local work field Option Desc ATR 02
           MOVE SPACES TO YL0104 OF WORK-CONTEXT
      *    Define local work field U:Inspect tally
           MOVE ZERO TO YL0105 OF WORK-CONTEXT
      *    Define local work field CA Owning Account
           MOVE SPACES TO YL0106 OF WORK-CONTEXT
      *    Define local work field CA Customer Ord Number
           MOVE SPACES TO YL0107 OF WORK-CONTEXT
      *    Define local work field CA Invariant BCV
           MOVE SPACES TO YL0108 OF WORK-CONTEXT
      *    Define local work field CA Order Allocation SeqNb
           MOVE ZERO TO YL0109 OF WORK-CONTEXT
      *    Define local work field CA VIN
           MOVE SPACES TO YL0110 OF WORK-CONTEXT
      *    Define local work field CA Provisional Chass Flag
           MOVE SPACES TO YN0068 OF WORK-CONTEXT
      *    Define local work field CA Registering Account
           MOVE SPACES TO YN0069 OF WORK-CONTEXT
      *    Define local work field CA Secondary Network Acc
           MOVE SPACES TO YN0070 OF WORK-CONTEXT
      *    Define local work field CA SEDRE last message upd
           MOVE SPACES TO YN0071 OF WORK-CONTEXT
      *    Define local work field CA Dealer Order Number
           MOVE SPACES TO YN0072 OF WORK-CONTEXT
      *    Define local work field CA Order Type code
           MOVE SPACES TO YL0111 OF WORK-CONTEXT
      *    Define local work field CA Order Type(Central)
           MOVE SPACES TO YL0112 OF WORK-CONTEXT
      *    Define local work field CA Order Type(Local)
           MOVE SPACES TO YL0113 OF WORK-CONTEXT
      *    Define local work field CA SEDRE Customer Type
           MOVE SPACES TO YL0114 OF WORK-CONTEXT
      *    Define local work field CA SD Order Status Code
           MOVE SPACES TO YN0073 OF WORK-CONTEXT
      *    Define local work field CA SCP Model Code
           MOVE SPACES TO YN0074 OF WORK-CONTEXT
      *    Define local work field CA Model Phase
           MOVE SPACES TO YN0075 OF WORK-CONTEXT
      *    Define local work field CA SCP Model Version Code
           MOVE SPACES TO YN0076 OF WORK-CONTEXT
      *    Define local work field CA Colour Code
           MOVE SPACES TO YN0077 OF WORK-CONTEXT
      *    Define local work field CA SCP Trim Type
           MOVE SPACES TO YN0078 OF WORK-CONTEXT
      *    Define local work field CA Reg.Number
           MOVE SPACES TO YN0079 OF WORK-CONTEXT
      *    Define local work field CA Cus Ord Allocation Dte
           MOVE ZERO TO YL0115 OF WORK-CONTEXT
      *    Define local work field CA Cus Ord Dealloc Dte
           MOVE ZERO TO YL0116 OF WORK-CONTEXT
      *    Define local work field CA Dealer Order Cancel Da
           MOVE ZERO TO YL0117 OF WORK-CONTEXT
      *    Define local work field CA Cust Delivery Cancel D
           MOVE ZERO TO YN0080 OF WORK-CONTEXT
      *    Define local work field CA Registration Date 58
           MOVE ZERO TO YN0081 OF WORK-CONTEXT
      *    Define local work field CA Registration Date 60
           MOVE ZERO TO YN0082 OF WORK-CONTEXT
      *    Define local work field CA Date of Resale (SEDRE)
           MOVE ZERO TO YN0083 OF WORK-CONTEXT
      *    Define local work field CA Cust Order Alloc Sts
           MOVE SPACES TO YL0118 OF WORK-CONTEXT
      *    Define local work field CO Customer Order Date #
           MOVE ZERO TO YL0119 OF WORK-CONTEXT
      *    Define local work field CO Owning A/C Maille
           MOVE SPACES TO YN0084 OF WORK-CONTEXT
      *    Define local work field CO Owning A/C Category
           MOVE SPACES TO YN0085 OF WORK-CONTEXT
      *    Define local work field CO Sales Channel
           MOVE SPACES TO YL0120 OF WORK-CONTEXT
      *    Define local work field CO cust type P/S-derived
           MOVE SPACES TO YN0086 OF WORK-CONTEXT
      *    Define local work field CO OLD DVLA Flag
           MOVE SPACES TO YN0087 OF WORK-CONTEXT
      *    Define local work field CO Last Msg Sending Code
           MOVE SPACES TO YN0088 OF WORK-CONTEXT
      *    Define local work field CO APL Code
           MOVE SPACES TO YN0089 OF WORK-CONTEXT
      *    Define local work field CO Colour Short Descr
           MOVE SPACES TO YN0090 OF WORK-CONTEXT
      *    Define local work field CO SCP Options
           MOVE SPACES TO YN0091 OF WORK-CONTEXT
      *    Define local work field CO SCP Trim Colour
           MOVE SPACES TO YN0092 OF WORK-CONTEXT
      *    Define local work field CO Cust Desired Deliv Dte
           MOVE ZERO TO YL0121 OF WORK-CONTEXT
      *    Define local work field CO Type VP/VU
           MOVE SPACES TO YN0093 OF WORK-CONTEXT
      *    Define local work field CO Vehicle Fuel Code
           MOVE SPACES TO YN0094 OF WORK-CONTEXT
      *    Define local work field CO Order Changed Date
           MOVE ZERO TO YN0095 OF WORK-CONTEXT
      *    Define local work field CO Order Cancelled Date
           MOVE ZERO TO YL0122 OF WORK-CONTEXT
      *    Define local work field CO Order Cancellation Rsn
           MOVE SPACES TO YL0123 OF WORK-CONTEXT
      *    Define local work field CO Salesperson Code
           MOVE SPACES TO YN0096 OF WORK-CONTEXT
      *    Define local work field CO Fleet Operator Number
           MOVE SPACES TO YN0097 OF WORK-CONTEXT
      *    Define local work field CO SEDRE Customer Code
           MOVE SPACES TO YN0098 OF WORK-CONTEXT
      *    Define local work field CO Surname/Company name
           MOVE SPACES TO YN0099 OF WORK-CONTEXT
      *    Define local work field CO Customer Forename
           MOVE SPACES TO YN0100 OF WORK-CONTEXT
      *    Define local work field CO Initials
           MOVE SPACES TO YN0101 OF WORK-CONTEXT
      *    Define local work field CO Title Code
           MOVE SPACES TO YN0102 OF WORK-CONTEXT
      *    Define local work field CO Address L1
           MOVE SPACES TO YN0103 OF WORK-CONTEXT
      *    Define local work field CO Address L2
           MOVE SPACES TO YN0104 OF WORK-CONTEXT
      *    Define local work field CO Address L3
           MOVE SPACES TO YN0105 OF WORK-CONTEXT
      *    Define local work field CO Address Town (40)
           MOVE SPACES TO YN0106 OF WORK-CONTEXT
      *    Define local work field CO Postcode
           MOVE SPACES TO YN0107 OF WORK-CONTEXT
      *    Define local work field CO Gender
           MOVE SPACES TO YN0108 OF WORK-CONTEXT
      *    Define local work field CO Customer Date of Birth
           MOVE ZERO TO YN0109 OF WORK-CONTEXT
      *    Define local work field CO Cust. day phone code
           MOVE SPACES TO YN0110 OF WORK-CONTEXT
      *    Define local work field CO Cust. day phone nbr
           MOVE SPACES TO YN0111 OF WORK-CONTEXT
      *    Define local work field CO Cust. eve phone code
           MOVE SPACES TO YN0112 OF WORK-CONTEXT
      *    Define local work field CO Cust. eve phone nbr
           MOVE SPACES TO YN0113 OF WORK-CONTEXT
      *    Define local work field CO Cust. mobile phone cde
           MOVE SPACES TO YN0114 OF WORK-CONTEXT
      *    Define local work field CO Cust. mobile phone nbr
           MOVE SPACES TO YN0115 OF WORK-CONTEXT
      *    Define local work field CO Cust. fax phone code
           MOVE SPACES TO YN0116 OF WORK-CONTEXT
      *    Define local work field CO Cust. fax phone nbr
           MOVE SPACES TO YN0117 OF WORK-CONTEXT
      *    Define local work field CO E-Mail Address
           MOVE SPACES TO YN0118 OF WORK-CONTEXT
      *    Define local work field CO Annual Mileage
           MOVE ZERO TO YN0119 OF WORK-CONTEXT
      *    Define local work field CO OK to Mail?
           MOVE SPACES TO YN0120 OF WORK-CONTEXT
      *    Define local work field CO OK to phone?
           MOVE SPACES TO YN0121 OF WORK-CONTEXT
      *    Define local work field CO OK to email?
           MOVE SPACES TO YN0122 OF WORK-CONTEXT
      *    Define local work field CO OK to text ?
           MOVE SPACES TO YN0123 OF WORK-CONTEXT
      *    Define local work field CO OK to fax?
           MOVE SPACES TO YN0124 OF WORK-CONTEXT
      *    Define local work field CO Share mail data?
           MOVE SPACES TO YN0125 OF WORK-CONTEXT
      *    Define local work field CO Share email data?
           MOVE SPACES TO YN0126 OF WORK-CONTEXT
      *    Define local work field CO Profession
           MOVE SPACES TO YN0127 OF WORK-CONTEXT
      *    Define local work field CO Job Function
           MOVE SPACES TO YN0128 OF WORK-CONTEXT
      *    Define local work field CO Customer Business Type
           MOVE SPACES TO YN0129 OF WORK-CONTEXT
      *    Define local work field CO Customer VAT Number
           MOVE SPACES TO YN0130 OF WORK-CONTEXT
      *    Define local work field CO VED Exempt Certificate
           MOVE SPACES TO YN0131 OF WORK-CONTEXT
      *    Define local work field CO VED Exempt Expiry Date
           MOVE ZERO TO YN0132 OF WORK-CONTEXT
      *    Define local work field CO Social Security Number
           MOVE SPACES TO YN0133 OF WORK-CONTEXT
      *    Define local work field CO DVLA Fleet Number
           MOVE SPACES TO YN0134 OF WORK-CONTEXT
      *    Define local work field CO Part Ex-change Flag
           MOVE SPACES TO YN0135 OF WORK-CONTEXT
      *    Define local work field CO Current Vehicle Model
           MOVE SPACES TO YN0136 OF WORK-CONTEXT
      *    Define local work field CO Current Vehicle Reg Nb
           MOVE SPACES TO YN0137 OF WORK-CONTEXT
      *    Define local work field CO Part-Ex Veh Mileage
           MOVE ZERO TO YN0138 OF WORK-CONTEXT
      *    Define local work field CO Finance Period (Mnths)
           MOVE ZERO TO YN0139 OF WORK-CONTEXT
      *    Define local work field CO No. Renaults Owned
           MOVE ZERO TO YN0140 OF WORK-CONTEXT
      *    Define local work field CO No. Vehs in Household
           MOVE ZERO TO YN0141 OF WORK-CONTEXT
      *    Define local work field CO Planned Retention Per
           MOVE ZERO TO YN0142 OF WORK-CONTEXT
      *    Define local work field CO Insurance Renewal Dat#
           MOVE ZERO TO YN0143 OF WORK-CONTEXT
      *    Define local work field CO Paymemt/Finance Type
           MOVE SPACES TO YN0144 OF WORK-CONTEXT
      *    Define local work field CO V55 Requested?
           MOVE SPACES TO YN0145 OF WORK-CONTEXT
      *    Define local work field CO Offer Code 1
           MOVE SPACES TO YN0146 OF WORK-CONTEXT
      *    Define local work field CO Offer Code 2
           MOVE SPACES TO YN0147 OF WORK-CONTEXT
      *    Define local work field CO Prospect Lead Id
           MOVE SPACES TO YN0148 OF WORK-CONTEXT
      *    Define local work field CO Customer Order Comment
           MOVE SPACES TO YN0149 OF WORK-CONTEXT
      *    Define local work field CO Customer Ref/P.O. Numb
           MOVE SPACES TO YN0150 OF WORK-CONTEXT
      *    Define local work field CO Special Deal Id
           MOVE SPACES TO YN0151 OF WORK-CONTEXT
      *    Define local work field CO Fleet PCN
           MOVE SPACES TO YN0152 OF WORK-CONTEXT
      *    Define local work field CO Date of 1st Alloc
           MOVE ZERO TO YN0153 OF WORK-CONTEXT
      *    Define local work field CO Date of Last DeAlloc
           MOVE ZERO TO YN0154 OF WORK-CONTEXT
      *    Define local work field CO Buy/Lease Flag
           MOVE SPACES TO YN0155 OF WORK-CONTEXT
      *    Define local work field CO Spare Status 2
           MOVE SPACES TO YN0156 OF WORK-CONTEXT
      *    Define local work field CO Spare Status 3
           MOVE SPACES TO YN0157 OF WORK-CONTEXT
      *    Define local work field CO MR Contract date
           MOVE ZERO TO YN0158 OF WORK-CONTEXT
      *    Define local work field CO Spare Date 2
           MOVE ZERO TO YN0159 OF WORK-CONTEXT
      *    Define local work field CO MR Contract number
           MOVE SPACES TO YN0160 OF WORK-CONTEXT
      *    Define local work field CO Spare Code 2
           MOVE SPACES TO YN0161 OF WORK-CONTEXT
      *    Define local work field CO Spare Code 3
           MOVE SPACES TO YN0162 OF WORK-CONTEXT
      *    Define local work field CO Agreement (DEFIPRO) No
           MOVE SPACES TO YN0163 OF WORK-CONTEXT
      *    Define local work field CO Spare Text 2
           MOVE SPACES TO YN0164 OF WORK-CONTEXT
      *    Define local work field CO Spare Sts 4
           MOVE SPACES TO YN0165 OF WORK-CONTEXT
      *    Define local work field CO FM Fleet Acc Code
           MOVE SPACES TO YN0166 OF WORK-CONTEXT
      *    Define local work field CO FM Agreement No (FON)
           MOVE SPACES TO YN0167 OF WORK-CONTEXT
      *    Define local work field CO FM Agreement Vers No
           MOVE SPACES TO YN0168 OF WORK-CONTEXT
      *    Define local work field Cust Ord Alloc Exists
           MOVE SPACES TO YL0124 OF WORK-CONTEXT
      *    Define local work field List price
           MOVE ZERO TO YL0125 OF WORK-CONTEXT
      *    Define local work field Version price
           MOVE ZERO TO YL0126 OF WORK-CONTEXT
      *    Define local work field Delivery price
           MOVE ZERO TO YL0127 OF WORK-CONTEXT
      *    Define local work field Color price
           MOVE ZERO TO YL0128 OF WORK-CONTEXT
      *    Define local work field Accessories
           MOVE ZERO TO YL0129 OF WORK-CONTEXT
      *    Define local work field Options price     0060545
           MOVE ZERO TO YL0130 OF WORK-CONTEXT
      *    Define local work field Invariant BCV
           MOVE SPACES TO YN0169 OF WORK-CONTEXT
      *    Define local work field Provisional Chassis Flag
           MOVE SPACES TO YN0170 OF WORK-CONTEXT
      *    Define local work field Invariant SED
           MOVE SPACES TO YN0171 OF WORK-CONTEXT
      *    Define local work field SD last message update
           MOVE SPACES TO YN0172 OF WORK-CONTEXT
      *    Define local work field Dealer Order Number
           MOVE SPACES TO YN0173 OF WORK-CONTEXT
      *    Define local work field Supplying Order Number
           MOVE SPACES TO YN0174 OF WORK-CONTEXT
      *    Define local work field Order Type code
           MOVE SPACES TO YN0175 OF WORK-CONTEXT
      *    Define local work field Order Type Central
           MOVE SPACES TO YN0176 OF WORK-CONTEXT
      *    Define local work field Order Type Local
           MOVE SPACES TO YN0177 OF WORK-CONTEXT
      *    Define local work field SD Customer type
           MOVE SPACES TO YN0178 OF WORK-CONTEXT
      *    Define local work field Order Status
           MOVE SPACES TO YN0179 OF WORK-CONTEXT
      *    Define local work field Owning Account
           MOVE SPACES TO YN0180 OF WORK-CONTEXT
      *    Define local work field Owning Account (Numeric)
           MOVE ZERO TO YN0181 OF WORK-CONTEXT
      *    Define local work field Delivery Account
           MOVE SPACES TO YN0182 OF WORK-CONTEXT
      *    Define local work field Registering Account
           MOVE SPACES TO YN0183 OF WORK-CONTEXT
      *    Define local work field Invoice Account
           MOVE SPACES TO YN0184 OF WORK-CONTEXT
      *    Define local work field Supplying Account
           MOVE SPACES TO YN0185 OF WORK-CONTEXT
      *    Define local work field Commercial Area code
           MOVE SPACES TO YN0186 OF WORK-CONTEXT
      *    Define local work field SD Country code
           MOVE SPACES TO YN0187 OF WORK-CONTEXT
      *    Define local work field Commercial Region code
           MOVE SPACES TO YN0188 OF WORK-CONTEXT
      *    Define local work field SCP Model code
           MOVE SPACES TO YL0131 OF WORK-CONTEXT
      *    Define local work field SCP Model Version Code
           MOVE SPACES TO YL0132 OF WORK-CONTEXT
      *    Define local work field Colour Code
           MOVE SPACES TO YL0133 OF WORK-CONTEXT
      *    Define local work field SCP Body Colour
           MOVE SPACES TO YN0189 OF WORK-CONTEXT
      *    Define local work field SCP Options
           MOVE SPACES TO YL0134 OF WORK-CONTEXT
      *    Define local work field SCP Trim Type
           MOVE SPACES TO YL0135 OF WORK-CONTEXT
      *    Define local work field SCP Trim Colour
           MOVE SPACES TO YL0136 OF WORK-CONTEXT
      *    Define local work field SCR Model Year
           MOVE SPACES TO YL0137 OF WORK-CONTEXT
      *    Define local work field SCR Model Year Variation
           MOVE SPACES TO YL0138 OF WORK-CONTEXT
      *    Define local work field SCR Family
           MOVE SPACES TO YN0190 OF WORK-CONTEXT
      *    Define local work field SCR Model Code
           MOVE SPACES TO YN0191 OF WORK-CONTEXT
      *    Define local work field SCR Model Version Code
           MOVE SPACES TO YN0192 OF WORK-CONTEXT
      *    Define local work field SCR Body Colour
           MOVE SPACES TO YN0193 OF WORK-CONTEXT
      *    Define local work field SCR Options
           MOVE SPACES TO YN0194 OF WORK-CONTEXT
      *    Define local work field SCR Trim Type
           MOVE SPACES TO YN0195 OF WORK-CONTEXT
      *    Define local work field SCR Trim Colour
           MOVE SPACES TO YN0196 OF WORK-CONTEXT
      *    Define local work field Fiche Gamme Country Code
           MOVE SPACES TO YN0197 OF WORK-CONTEXT
      *    Define local work field Project Code
           MOVE SPACES TO YN0198 OF WORK-CONTEXT
      *    Define local work field Phase
           MOVE SPACES TO YL0139 OF WORK-CONTEXT
      *    Define local work field Fiche Gamme Type
           MOVE SPACES TO YL0140 OF WORK-CONTEXT
      *    Define local work field Fiche Gamme Version
           MOVE SPACES TO YL0141 OF WORK-CONTEXT
      *    Define local work field Type VP/VU
           MOVE SPACES TO YN0199 OF WORK-CONTEXT
      *    Define local work field Vehicle Fuel Code
           MOVE SPACES TO YN0200 OF WORK-CONTEXT
      *    Define local work field Registration number
           MOVE SPACES TO YN0201 OF WORK-CONTEXT
      *    Define local work field Fabrication No
           MOVE SPACES TO YN0202 OF WORK-CONTEXT
      *    Define local work field Engine number
           MOVE SPACES TO YN0203 OF WORK-CONTEXT
      *    Define local work field Gearbox Number
           MOVE SPACES TO YN0204 OF WORK-CONTEXT
      *    Define local work field SD after sales type
           MOVE SPACES TO YN0205 OF WORK-CONTEXT
      *    Define local work field Tachometer Units
           MOVE SPACES TO YN0206 OF WORK-CONTEXT
      *    Define local work field Homologated Colour
           MOVE SPACES TO YN0207 OF WORK-CONTEXT
      *    Define local work field SD Model type
           MOVE SPACES TO YN0208 OF WORK-CONTEXT
      *    Define local work field Dealer Comments
           MOVE SPACES TO YN0209 OF WORK-CONTEXT
      *    Define local work field Urgency Code
           MOVE SPACES TO YN0210 OF WORK-CONTEXT
      *    Define local work field Dealer Order Cancel Date
           MOVE ZERO TO YN0211 OF WORK-CONTEXT
      *    Define local work field Vehicle Transfer Origin
           MOVE SPACES TO YN0212 OF WORK-CONTEXT
      *    Define local work field SD top countermark ver
           MOVE SPACES TO YN0213 OF WORK-CONTEXT
      *    Define local work field Equipment Level
           MOVE SPACES TO YN0214 OF WORK-CONTEXT
      *    Define local work field Engine Level
           MOVE SPACES TO YN0215 OF WORK-CONTEXT
      *    Define local work field Engine type
           MOVE SPACES TO YN0216 OF WORK-CONTEXT
      *    Define local work field Tyre Brand
           MOVE SPACES TO YN0217 OF WORK-CONTEXT
      *    Define local work field Contremarque Usine
           MOVE SPACES TO YN0218 OF WORK-CONTEXT
      *    Define local work field C.O.C
           MOVE SPACES TO YN0219 OF WORK-CONTEXT
      *    Define local work field Version TVV
           MOVE SPACES TO YN0220 OF WORK-CONTEXT
      *    Define local work field SD repre plaque
           MOVE SPACES TO YN0221 OF WORK-CONTEXT
      *    Define local work field Key Code 1
           MOVE SPACES TO YN0222 OF WORK-CONTEXT
      *    Define local work field Key Code 2
           MOVE SPACES TO YN0223 OF WORK-CONTEXT
      *    Define local work field Key Code 3
           MOVE SPACES TO YN0224 OF WORK-CONTEXT
      *    Define local work field Radio Code
           MOVE SPACES TO YN0225 OF WORK-CONTEXT
      *    Define local work field Build Identification
           MOVE SPACES TO YN0226 OF WORK-CONTEXT
      *    Define local work field Build Year
           MOVE ZERO TO YN0227 OF WORK-CONTEXT
      *    Define local work field Build Week
           MOVE ZERO TO YN0228 OF WORK-CONTEXT
      *    Define local work field Build Day
           MOVE SPACES TO YN0229 OF WORK-CONTEXT
      *    Define local work field PRODEM Build Year
           MOVE ZERO TO YN0230 OF WORK-CONTEXT
      *    Define local work field PRODEM Build Week
           MOVE ZERO TO YN0231 OF WORK-CONTEXT
      *    Define local work field Assembly Line
           MOVE SPACES TO YN0232 OF WORK-CONTEXT
      *    Define local work field ACARD Date 05
           MOVE ZERO TO YN0233 OF WORK-CONTEXT
      *    Define local work field Production Start  Date 06
           MOVE ZERO TO YN0234 OF WORK-CONTEXT
      *    Define local work field TCM Date 07
           MOVE ZERO TO YN0235 OF WORK-CONTEXT
      *    Define local work field Planned PEC/MADC Date P10
           MOVE ZERO TO YN0236 OF WORK-CONTEXT
      *    Define local work field PEC/MADC Date 10
           MOVE ZERO TO YN0237 OF WORK-CONTEXT
      *    Define local work field MADC Admin Date 11
           MOVE ZERO TO YN0238 OF WORK-CONTEXT
      *    Define local work field TELCLI Date 12
           MOVE ZERO TO YN0239 OF WORK-CONTEXT
      *    Define local work field Vehicle Shipment Date 20
           MOVE ZERO TO YN0240 OF WORK-CONTEXT
      *    Define local work field Arrival at Dock Date 28
           MOVE ZERO TO YN0241 OF WORK-CONTEXT
      *    Define local work field Date 30 MADA (Real)
           MOVE ZERO TO YN0242 OF WORK-CONTEXT
      *    Define local work field Enter Import Ctr Date 32
           MOVE ZERO TO YN0243 OF WORK-CONTEXT
      *    Define local work field Block Start Date 33
           MOVE ZERO TO YN0244 OF WORK-CONTEXT
      *    Define local work field Record Block End Date 34
           MOVE ZERO TO YN0245 OF WORK-CONTEXT
      *    Define local work field Allocation Date 35
           MOVE ZERO TO YN0246 OF WORK-CONTEXT
      *    Define local work field In Commercial Stk Date 39
           MOVE ZERO TO YN0247 OF WORK-CONTEXT
      *    Define local work field Invoice After Date 40
           MOVE ZERO TO YN0248 OF WORK-CONTEXT
      *    Define local work field Dealer Invoiced Date 42
           MOVE ZERO TO YN0249 OF WORK-CONTEXT
      *    Define local work field Exit Import Centre Dte 45
           MOVE ZERO TO YN0250 OF WORK-CONTEXT
      *    Define local work field Official AAD Date 50
           MOVE ZERO TO YN0251 OF WORK-CONTEXT
      *    Define local work field Requested AAD Date 53
           MOVE ZERO TO YN0252 OF WORK-CONTEXT
      *    Define local work field Send Finance I/F Date 54
           MOVE ZERO TO YN0253 OF WORK-CONTEXT
      *    Define local work field Transfer Date 55
           MOVE ZERO TO YN0254 OF WORK-CONTEXT
      *    Define local work field Official Doc Req Date 56
           MOVE ZERO TO YN0255 OF WORK-CONTEXT
      *    Define local work field Registration Date 58
           MOVE ZERO TO YN0256 OF WORK-CONTEXT
      *    Define local work field Registration Date 60
           MOVE ZERO TO YN0257 OF WORK-CONTEXT
      *    Define local work field Veh Reg Cancelled Date
           MOVE ZERO TO YN0258 OF WORK-CONTEXT
      *    Define local work field Last Monitor Point
           MOVE ZERO TO YN0259 OF WORK-CONTEXT
      *    Define local work field SD customs information
           MOVE SPACES TO YN0260 OF WORK-CONTEXT
      *    Define local work field Customer Order Number
           MOVE SPACES TO YN0261 OF WORK-CONTEXT
      *    Define local work field Customer Order Date #
           MOVE ZERO TO YN0262 OF WORK-CONTEXT
      *    Define local work field Cust Allocation Date
           MOVE ZERO TO YN0263 OF WORK-CONTEXT
      *    Define local work field Cust 1st Allocation Date
           MOVE ZERO TO YN0264 OF WORK-CONTEXT
      *    Define local work field Cust Lst Deallocation Dt
           MOVE ZERO TO YN0265 OF WORK-CONTEXT
      *    Define local work field Veh ARC Planned Date
           MOVE ZERO TO YN0266 OF WORK-CONTEXT
      *    Define local work field Veh ARC Planned Location
           MOVE SPACES TO YN0267 OF WORK-CONTEXT
      *    Define local work field Veh DDD Requested Date
           MOVE ZERO TO YN0268 OF WORK-CONTEXT
      *    Define local work field Veh DDD Forecast Date
           MOVE ZERO TO YN0269 OF WORK-CONTEXT
      *    Define local work field Veh AAD Promise Date
           MOVE ZERO TO YN0270 OF WORK-CONTEXT
      *    Define local work field Veh AAD Planned Date
           MOVE ZERO TO YN0271 OF WORK-CONTEXT
      *    Define local work field Veh AAD System Date
           MOVE ZERO TO YN0272 OF WORK-CONTEXT
      *    Define local work field Veh AAD Actual Date
           MOVE ZERO TO YN0273 OF WORK-CONTEXT
      *    Define local work field Veh AAD Flag
           MOVE SPACES TO YN0274 OF WORK-CONTEXT
      *    Define local work field Veh AAD Official Source
           MOVE SPACES TO YN0275 OF WORK-CONTEXT
      *    Define local work field Veh Stock Status
           MOVE SPACES TO YN0276 OF WORK-CONTEXT
      *    Define local work field Veh Transfer Reason
           MOVE SPACES TO YN0277 OF WORK-CONTEXT
      *    Define local work field Veh Destination TABEUROP
           MOVE SPACES TO YN0278 OF WORK-CONTEXT
      *    Define local work field Vehicle Location
           MOVE SPACES TO YN0279 OF WORK-CONTEXT
      *    Define local work field Vehicle Transport from
           MOVE SPACES TO YN0280 OF WORK-CONTEXT
      *    Define local work field Vehicle Transport to
           MOVE SPACES TO YN0281 OF WORK-CONTEXT
      *    Define local work field Import Centre (Destined)
           MOVE SPACES TO YN0282 OF WORK-CONTEXT
      *    Define local work field Import Centre (Actual)
           MOVE SPACES TO YN0283 OF WORK-CONTEXT
      *    Define local work field MAC Flag
           MOVE SPACES TO YN0284 OF WORK-CONTEXT
      *    Define local work field Mac number
           MOVE SPACES TO YN0285 OF WORK-CONTEXT
      *    Define local work field Submac number
           MOVE SPACES TO YN0286 OF WORK-CONTEXT
      *    Define local work field Submac Date #
           MOVE ZERO TO YN0287 OF WORK-CONTEXT
      *    Define local work field Pre RVT V55
           MOVE SPACES TO YN0288 OF WORK-CONTEXT
      *    Define local work field Pre Rvt Date #
           MOVE ZERO TO YN0289 OF WORK-CONTEXT
      *    Define local work field WLTP Flag
           MOVE SPACES TO YN0290 OF WORK-CONTEXT
      *    Define local work field Veh Spare Sts 2
           MOVE SPACES TO YN0291 OF WORK-CONTEXT
      *    Define local work field Veh Spare Sts 3
           MOVE SPACES TO YN0292 OF WORK-CONTEXT
      *    Define local work field Veh Spare Date 1
           MOVE ZERO TO YN0293 OF WORK-CONTEXT
      *    Define local work field Veh Spare Date 2
           MOVE ZERO TO YN0294 OF WORK-CONTEXT
      *    Define local work field Original Owning Account
           MOVE SPACES TO YN0295 OF WORK-CONTEXT
      *    Define local work field Original Dlr Order Number
           MOVE SPACES TO YN0296 OF WORK-CONTEXT
      *    Define local work field Veh Co2
           MOVE SPACES TO YN0297 OF WORK-CONTEXT
      *    Define local work field Family Code (Projet)
           MOVE SPACES TO YL0142 OF WORK-CONTEXT
      *    Define local work field Veh Spare Text
           MOVE SPACES TO YN0298 OF WORK-CONTEXT
      *    Define local work field Vehicle Cancellation Code
           MOVE SPACES TO YN0299 OF WORK-CONTEXT
      *    Define local work field Vehicle Cancellation Orig
           MOVE SPACES TO YN0300 OF WORK-CONTEXT
      *    Define local work field Veh Overall Block
           MOVE SPACES TO YN0301 OF WORK-CONTEXT
      *    Define local work field Veh Financial Block
           MOVE SPACES TO YN0302 OF WORK-CONTEXT
      *    Define local work field Veh Commercial Block
           MOVE SPACES TO YN0303 OF WORK-CONTEXT
      *    Define local work field Veh Quality/CAT Block
           MOVE SPACES TO YN0304 OF WORK-CONTEXT
      *    Define local work field SD flexibility status
           MOVE SPACES TO YN0305 OF WORK-CONTEXT
      *    Define local work field Veh End Date Full Flex
           MOVE ZERO TO YN0306 OF WORK-CONTEXT
      *    Define local work field Veh End Date Partial Flex
           MOVE ZERO TO YN0307 OF WORK-CONTEXT
      *    Define local work field SEDRE hdr APL code
           MOVE SPACES TO YN0308 OF WORK-CONTEXT
      *    Define local work field SEDRE hdr owner a/c type
           MOVE SPACES TO YN0309 OF WORK-CONTEXT
      *    Define local work field SEDRE hdr lead dealer no
           MOVE SPACES TO YN0310 OF WORK-CONTEXT
      *    Define local work field SEDRE hdr MQ sending code
           MOVE SPACES TO YN0311 OF WORK-CONTEXT
      *    Define local work field SEDRE hdr dealer country
           MOVE SPACES TO YN0312 OF WORK-CONTEXT
      *    Define local work field SD vehicle progress st
           MOVE SPACES TO YN0313 OF WORK-CONTEXT
      *    Define local work field Veh Purged from SEDRE
           MOVE SPACES TO YN0314 OF WORK-CONTEXT
      *    Define local work field Vehicle Error Status
           MOVE SPACES TO YN0315 OF WORK-CONTEXT
      *    Define local work field Version Marketing Desc
           MOVE SPACES TO YN0316 OF WORK-CONTEXT
      *    Define local work field V55 Model Version Desc
           MOVE SPACES TO YL0143 OF WORK-CONTEXT
      *    Define local work field Manufacturer Code
           MOVE SPACES TO YN0317 OF WORK-CONTEXT
      *    Define local work field SMMT MVRIS Make Code
           MOVE SPACES TO YN0318 OF WORK-CONTEXT
      *    Define local work field SMMT Model MVRIS Code
           MOVE SPACES TO YN0319 OF WORK-CONTEXT
      *    Define local work field DVLA Make Code
           MOVE SPACES TO YN0320 OF WORK-CONTEXT
      *    Define local work field SMMT Model Code
           MOVE SPACES TO YN0321 OF WORK-CONTEXT
      *    Define local work field Vehicle Body Class Code
           MOVE SPACES TO YN0322 OF WORK-CONTEXT
      *    Define local work field Vehicle Body Code
           MOVE SPACES TO YN0323 OF WORK-CONTEXT
      *    Define local work field Vehicle Body Name
           MOVE SPACES TO YN0324 OF WORK-CONTEXT
      *    Define local work field DVLA Type Approval Categ
           MOVE SPACES TO YN0325 OF WORK-CONTEXT
      *    Define local work field Model Engine Capacity
           MOVE ZERO TO YN0326 OF WORK-CONTEXT
      *    Define local work field Gross Weight
           MOVE ZERO TO YN0327 OF WORK-CONTEXT
      *    Define local work field Net Weight
           MOVE ZERO TO YN0328 OF WORK-CONTEXT
      *    Define local work field Typemines
           MOVE SPACES TO YN0329 OF WORK-CONTEXT
      *    Define local work field High Performance (Y/N)
           MOVE SPACES TO YN0330 OF WORK-CONTEXT
      *    Define local work field Special Edition (Y/N)
           MOVE SPACES TO YN0331 OF WORK-CONTEXT
      *    Define local work field Gearbox Type Sts
           MOVE SPACES TO YN0332 OF WORK-CONTEXT
      *    Define local work field Number of doors
           MOVE ZERO TO YN0333 OF WORK-CONTEXT
      *    Define local work field Seating Capacity V55
           MOVE ZERO TO YN0334 OF WORK-CONTEXT
      *    Define local work field Tax Class Code
           MOVE ZERO TO YN0335 OF WORK-CONTEXT
      *    Define local work field Vehicle Database Rec Sts
           MOVE SPACES TO YN0336 OF WORK-CONTEXT
      *    Define local work field Colour Marketing Desc
           MOVE SPACES TO YL0144 OF WORK-CONTEXT
      *    Define local work field Colour Type Code
           MOVE SPACES TO YN0337 OF WORK-CONTEXT
      *    Define local work field Vehicle MVRIS Colour Code
           MOVE SPACES TO YN0338 OF WORK-CONTEXT
      *    Define local work field Vehicle MVRIS Colour Cde2
           MOVE SPACES TO YN0339 OF WORK-CONTEXT
      *    Define local work field Vehicle MVRIS Colour Cde3
           MOVE SPACES TO YN0340 OF WORK-CONTEXT
      *    Define local work field Colour Type Category Code
           MOVE SPACES TO YN0341 OF WORK-CONTEXT
      *    Define local work field NV Basic Selling Price
           MOVE ZERO TO YL0145 OF WORK-CONTEXT
      *    Define local work field NV Colour Price
           MOVE ZERO TO YL0146 OF WORK-CONTEXT
      *    Define local work field NV Upholstery Price
           MOVE ZERO TO YL0147 OF WORK-CONTEXT
      *    Define local work field NV Options Total Price
           MOVE ZERO TO YL0148 OF WORK-CONTEXT
      *    Define local work field NV Sub-total 1
           MOVE ZERO TO YL0149 OF WORK-CONTEXT
      *    Define local work field NV Dealer Margin
           MOVE ZERO TO YL0150 OF WORK-CONTEXT
      *    Define local work field NV Sub-total 2
           MOVE ZERO TO YL0151 OF WORK-CONTEXT
      *    Define local work field NV Other Vatable Charges
           MOVE ZERO TO YL0152 OF WORK-CONTEXT
      *    Define local work field NV Sub-total 3
           MOVE ZERO TO YL0153 OF WORK-CONTEXT
      *    Define local work field NV Accessory Retail Tot
           MOVE ZERO TO YL0154 OF WORK-CONTEXT
      *    Define local work field NV Accessory Discount Tot
           MOVE ZERO TO YN0342 OF WORK-CONTEXT
      *    Define local work field NV Accessory Net Total
           MOVE ZERO TO YL0155 OF WORK-CONTEXT
      *    Define local work field NV Sub-Total 4
           MOVE ZERO TO YL0156 OF WORK-CONTEXT
      *    Define local work field NV Other Vatable Discount
           MOVE ZERO TO YL0157 OF WORK-CONTEXT
      *    Define local work field NV Sub-Total 5
           MOVE ZERO TO YL0158 OF WORK-CONTEXT
      *    Define local work field NV VAT Amount
           MOVE ZERO TO YL0159 OF WORK-CONTEXT
      *    Define local work field NV Non-vatable Charges
           MOVE ZERO TO YN0343 OF WORK-CONTEXT
      *    Define local work field NV Non-vatable Discount
           MOVE ZERO TO YN0344 OF WORK-CONTEXT
      *    Define local work field NV Total Amount
           MOVE ZERO TO YL0160 OF WORK-CONTEXT
      *    Define local work field VP Option Price 1
           MOVE ZERO TO YL0161 OF WORK-CONTEXT
      *    Define local work field VP Option Price 2
           MOVE ZERO TO YL0162 OF WORK-CONTEXT
      *    Define local work field VP Option Price 3
           MOVE ZERO TO YL0163 OF WORK-CONTEXT
      *    Define local work field VP Option Price 4
           MOVE ZERO TO YL0164 OF WORK-CONTEXT
      *    Define local work field VP Option Price 5
           MOVE ZERO TO YL0165 OF WORK-CONTEXT
      *    Define local work field VP Option Price 6
           MOVE ZERO TO YL0166 OF WORK-CONTEXT
      *    Define local work field VP Option Price 7
           MOVE ZERO TO YL0167 OF WORK-CONTEXT
      *    Define local work field VP Option Price 8
           MOVE ZERO TO YL0168 OF WORK-CONTEXT
      *    Define local work field VP Option Price 9
           MOVE ZERO TO YL0169 OF WORK-CONTEXT
      *    Define local work field VP Option Price 10
           MOVE ZERO TO YL0170 OF WORK-CONTEXT
      *    Define local work field VP Option Price 11
           MOVE ZERO TO YL0171 OF WORK-CONTEXT
      *    Define local work field VP Option Price 12
           MOVE ZERO TO YL0172 OF WORK-CONTEXT
      *    Define local work field VP Option Price 13
           MOVE ZERO TO YL0173 OF WORK-CONTEXT
      *    Define local work field VP Option Price 14
           MOVE ZERO TO YL0174 OF WORK-CONTEXT
      *    Define local work field VP Option Price 15
           MOVE ZERO TO YL0175 OF WORK-CONTEXT
      *    Define local work field VP Option Price 16
           MOVE ZERO TO YL0176 OF WORK-CONTEXT
      *    Define local work field VP Option Price 17
           MOVE ZERO TO YL0177 OF WORK-CONTEXT
      *    Define local work field VP Option Price 18
           MOVE ZERO TO YL0178 OF WORK-CONTEXT
      *    Define local work field VP Option Price 19
           MOVE ZERO TO YL0179 OF WORK-CONTEXT
      *    Define local work field VP Option Price 20
           MOVE ZERO TO YL0180 OF WORK-CONTEXT
      *    Define local work field VP Option Price 21
           MOVE ZERO TO YL0181 OF WORK-CONTEXT
      *    Define local work field VP Option Price 22
           MOVE ZERO TO YL0182 OF WORK-CONTEXT
      *    Define local work field VP Option Price 23
           MOVE ZERO TO YL0183 OF WORK-CONTEXT
      *    Define local work field VP Option Price 24
           MOVE ZERO TO YL0184 OF WORK-CONTEXT
      *    Define local work field VP Option Price 25
           MOVE ZERO TO YL0185 OF WORK-CONTEXT
      *    Define local work field VP Option Price 26
           MOVE ZERO TO YL0186 OF WORK-CONTEXT
      *    Define local work field VP Option Price 27
           MOVE ZERO TO YL0187 OF WORK-CONTEXT
      *    Define local work field VP Option Price 28
           MOVE ZERO TO YL0188 OF WORK-CONTEXT
      *    Define local work field VP Option Price 29
           MOVE ZERO TO YL0189 OF WORK-CONTEXT
      *    Define local work field VP Option Price 30
           MOVE ZERO TO YL0190 OF WORK-CONTEXT
      *    Define local work field U:Vehicle Margin Value
           MOVE ZERO TO YL0191 OF WORK-CONTEXT
      *    Define local work field VP Option Margin 1
           MOVE ZERO TO YL0192 OF WORK-CONTEXT
      *    Define local work field VP Option Margin 2
           MOVE ZERO TO YL0193 OF WORK-CONTEXT
      *    Define local work field VP Option Margin 3
           MOVE ZERO TO YL0194 OF WORK-CONTEXT
      *    Define local work field VP Option Margin 4
           MOVE ZERO TO YL0195 OF WORK-CONTEXT
      *    Define local work field VP Option Margin 5
           MOVE ZERO TO YL0196 OF WORK-CONTEXT
      *    Define local work field VP Option Margin 6
           MOVE ZERO TO YL0197 OF WORK-CONTEXT
      *    Define local work field VP Option Margin 7
           MOVE ZERO TO YL0198 OF WORK-CONTEXT
      *    Define local work field VP Option Margin 8
           MOVE ZERO TO YL0199 OF WORK-CONTEXT
      *    Define local work field VP Option Margin 9
           MOVE ZERO TO YL0200 OF WORK-CONTEXT
      *    Define local work field VP Option Margin 10
           MOVE ZERO TO YL0201 OF WORK-CONTEXT
      *    Define local work field VP Option Margin 11
           MOVE ZERO TO YL0202 OF WORK-CONTEXT
      *    Define local work field VP Option Margin 12
           MOVE ZERO TO YL0203 OF WORK-CONTEXT
      *    Define local work field VP Option Margin 13
           MOVE ZERO TO YL0204 OF WORK-CONTEXT
      *    Define local work field VP Option Margin 14
           MOVE ZERO TO YL0205 OF WORK-CONTEXT
      *    Define local work field VP Option Margin 15
           MOVE ZERO TO YL0206 OF WORK-CONTEXT
      *    Define local work field VP Option Margin 16
           MOVE ZERO TO YL0207 OF WORK-CONTEXT
      *    Define local work field VP Option Margin 17
           MOVE ZERO TO YL0208 OF WORK-CONTEXT
      *    Define local work field VP Option Margin 18
           MOVE ZERO TO YL0209 OF WORK-CONTEXT
      *    Define local work field VP Option Margin 19
           MOVE ZERO TO YL0210 OF WORK-CONTEXT
      *    Define local work field VP Option Margin 20
           MOVE ZERO TO YL0211 OF WORK-CONTEXT
      *    Define local work field VP Option Margin 21
           MOVE ZERO TO YL0212 OF WORK-CONTEXT
      *    Define local work field VP Option Margin 22
           MOVE ZERO TO YL0213 OF WORK-CONTEXT
      *    Define local work field VP Option Margin 23
           MOVE ZERO TO YL0214 OF WORK-CONTEXT
      *    Define local work field VP Option Margin 24
           MOVE ZERO TO YL0215 OF WORK-CONTEXT
      *    Define local work field VP Option Margin 25
           MOVE ZERO TO YL0216 OF WORK-CONTEXT
      *    Define local work field VP Option Margin 26
           MOVE ZERO TO YL0217 OF WORK-CONTEXT
      *    Define local work field VP Option Margin 27
           MOVE ZERO TO YL0218 OF WORK-CONTEXT
      *    Define local work field Option Margin 28
           MOVE ZERO TO YL0219 OF WORK-CONTEXT
      *    Define local work field VP Option Margin 29
           MOVE ZERO TO YL0220 OF WORK-CONTEXT
      *    Define local work field VP Option Margin 30
           MOVE ZERO TO YL0221 OF WORK-CONTEXT
      *    Define local work field U:Colour Price Marg Val
           MOVE ZERO TO YL0222 OF WORK-CONTEXT
      *    Define local work field U:Trim Margin Ntwk
           MOVE ZERO TO YL0223 OF WORK-CONTEXT
      *    Define local work field NV Basic VAT Rate
           MOVE ZERO TO YL0224 OF WORK-CONTEXT
      *    Define local work field SC Option Code 1
           MOVE SPACES TO YL0225 OF WORK-CONTEXT
      *    Define local work field SC Option Code 2
           MOVE SPACES TO YL0226 OF WORK-CONTEXT
      *    Define local work field SC Option Code 3
           MOVE SPACES TO YL0227 OF WORK-CONTEXT
      *    Define local work field SC Option Code 4
           MOVE SPACES TO YL0228 OF WORK-CONTEXT
      *    Define local work field SC Option Code 5
           MOVE SPACES TO YL0229 OF WORK-CONTEXT
      *    Define local work field SC Option Code 6
           MOVE SPACES TO YL0230 OF WORK-CONTEXT
      *    Define local work field SC Option Code 7
           MOVE SPACES TO YL0231 OF WORK-CONTEXT
      *    Define local work field SC Option Code 8
           MOVE SPACES TO YL0232 OF WORK-CONTEXT
      *    Define local work field SC Option Code 9
           MOVE SPACES TO YL0233 OF WORK-CONTEXT
      *    Define local work field SC Option Code 10
           MOVE SPACES TO YL0234 OF WORK-CONTEXT
      *    Define local work field SC Option Code 11
           MOVE SPACES TO YL0235 OF WORK-CONTEXT
      *    Define local work field SC Option Code 12
           MOVE SPACES TO YL0236 OF WORK-CONTEXT
      *    Define local work field SC Option Code 13
           MOVE SPACES TO YL0237 OF WORK-CONTEXT
      *    Define local work field SC Option Code 14
           MOVE SPACES TO YL0238 OF WORK-CONTEXT
      *    Define local work field SC Option Code 15
           MOVE SPACES TO YL0239 OF WORK-CONTEXT
      *    Define local work field SC Option Code 16
           MOVE SPACES TO YL0240 OF WORK-CONTEXT
      *    Define local work field SC Option Code 17
           MOVE SPACES TO YL0241 OF WORK-CONTEXT
      *    Define local work field SC Option Code 18
           MOVE SPACES TO YL0242 OF WORK-CONTEXT
      *    Define local work field SC Option Code 19
           MOVE SPACES TO YL0243 OF WORK-CONTEXT
      *    Define local work field SC Option Code 20
           MOVE SPACES TO YL0244 OF WORK-CONTEXT
      *    Define local work field SC Option Code 21
           MOVE SPACES TO YL0245 OF WORK-CONTEXT
      *    Define local work field SC Option Code 22
           MOVE SPACES TO YL0246 OF WORK-CONTEXT
      *    Define local work field SC Option Code 23
           MOVE SPACES TO YL0247 OF WORK-CONTEXT
      *    Define local work field SC Option Code 24
           MOVE SPACES TO YL0248 OF WORK-CONTEXT
      *    Define local work field SC Option Code 25
           MOVE SPACES TO YL0249 OF WORK-CONTEXT
      *    Define local work field SC Option Code 26
           MOVE SPACES TO YL0250 OF WORK-CONTEXT
      *    Define local work field SC Option Code 27
           MOVE SPACES TO YL0251 OF WORK-CONTEXT
      *    Define local work field SC Option Code 28
           MOVE SPACES TO YL0252 OF WORK-CONTEXT
      *    Define local work field SC Option Code 29
           MOVE SPACES TO YL0253 OF WORK-CONTEXT
      *    Define local work field SC Option Code 30
           MOVE SPACES TO YL0254 OF WORK-CONTEXT
      *    Define local work field Error/Info Text
           MOVE SPACES TO YL0255 OF WORK-CONTEXT
      *    Define local work field U:Vehicle Pricing Status
           MOVE SPACES TO YL0256 OF WORK-CONTEXT
      *    Define local work field U:Option Pricing Status
           MOVE SPACES TO YL0257 OF WORK-CONTEXT
      *    Define local work field U:Total Options Marg Val
           MOVE ZERO TO YL0258 OF WORK-CONTEXT
      *    Define local work field VAT Rate 1
           MOVE ZERO TO YL0259 OF WORK-CONTEXT
      *    Define local work field U:Option Price
           MOVE ZERO TO YL0260 OF WORK-CONTEXT
      *    Define local work field U:Option Code 5
           MOVE SPACES TO YL0261 OF WORK-CONTEXT
      *    Define local work field AOC Price/Pct Value
           MOVE ZERO TO YL0262 OF WORK-CONTEXT
      *    Define local work field PICG amount to deduc val
           MOVE ZERO TO YL0263 OF WORK-CONTEXT
      *    Define local work field PICG Grant Amount
           MOVE ZERO TO YL0264 OF WORK-CONTEXT
      *    Define local work field PICG amount to deduc val
           MOVE ZERO TO YL0265 OF WORK-CONTEXT
      *    Define local work field PICG Grant Amount
           MOVE ZERO TO YL0266 OF WORK-CONTEXT
      *    Define local work field U:Record found
           MOVE SPACES TO YL0267 OF WORK-CONTEXT
      *    Define local work field SCR Trim Colour (12)
           MOVE SPACES TO YL0268 OF WORK-CONTEXT
      *    Define local work field SCR Trim Type (12)
           MOVE SPACES TO YL0269 OF WORK-CONTEXT
      *    Define local work field U:I.C. Total Retail Price
           MOVE ZERO TO YL0270 OF WORK-CONTEXT
      *    Define local work field Veh Co2
           MOVE SPACES TO YL0271 OF WORK-CONTEXT
      *    Define local work field KSP Attn text
           MOVE SPACES TO YL0272 OF WORK-CONTEXT
      *    Define local work field KSP Attn expiry date txt
           MOVE SPACES TO YL0273 OF WORK-CONTEXT
      *    Define local work field KSP Attn expiry date
           MOVE ZERO TO YL0274 OF WORK-CONTEXT
      *    Define local work field Error text
           MOVE SPACES TO YN0345 OF WORK-CONTEXT
      *    Define local work field U:Job date long (D8#)
           MOVE ZERO TO YL0275 OF WORK-CONTEXT
      *    Define local work field U:Text (1)
           MOVE SPACES TO YL0276 OF WORK-CONTEXT
      *    Define local work field Record Processed Status
           MOVE SPACES TO YL0277 OF WORK-CONTEXT
      *    Clear all neither parameters
      *    Crt/Chg Autotrader Bulk U - Autotrader Bulk Upload  *
      *    Create Date D8#
           MOVE ZEROS TO B1CRTDTD8 OF AGAUTOBUF0 OF AGAUTOBUL0-R
      *    Create Time
           MOVE ZEROS TO B1CRTTME OF AGAUTOBUF0 OF AGAUTOBUL0-R
      *    Date Last Changed D8#
           MOVE ZEROS TO B1CHGDT8 OF AGAUTOBUF0 OF AGAUTOBUL0-R
      *    Time Last Changed
           MOVE ZEROS TO B1CHGTME OF AGAUTOBUF0 OF AGAUTOBUL0-R
      *==============================================================
           CONTINUE.
       ZZEXIT.
           EXIT.
       RTV-TEXT-LENGTH SECTION.
      *==============================================================
           MOVE 132 TO WK-LN-INDEX
      *    Loop until the first non-blank is encountered.
           PERFORM UNTIL NOT (WK-LN-IN-BYTE(WK-LN-INDEX) = ' ')
              SUBTRACT 1 FROM WK-LN-INDEX GIVING WK-LN-INDEX
      *       Don't attempt to access beyond start of string.
              IF (WK-LN-INDEX <= 0) THEN
                 GO RTV-TEXT-LENGTH-EXIT
              END-IF
           END-PERFORM
      *==============================================================
           CONTINUE.
       RTV-TEXT-LENGTH-EXIT.
           EXIT.
       CHK-NUMERIC SECTION.
      *==============================================================
           MOVE SPACES TO W0RTN
           MOVE 1 TO WK-IND
           PERFORM UNTIL (    WK-IND >= 50
                     OR NOT ( W0RTN   = SPACES ) )
      *       Check each character of input field.
              IF ((   WK-BYT(WK-IND) >= '0'
                 AND  WK-BYT(WK-IND) <= '9' )
                OR (  WK-BYT(WK-IND)  = ' ' )) THEN CONTINUE
              ELSE
      *          Non-numeric, signal error and exit condition.
                 MOVE 'USR0000' TO W0RTN
              END-IF
              ADD 1, WK-IND GIVING WK-IND
           END-PERFORM
      *==============================================================
           CONTINUE.
       CHK-NUMERIC-EXIT.
           EXIT.
